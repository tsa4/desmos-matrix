(()=>{var j8=Object.create;var LC=Object.defineProperty;var Z8=Object.getOwnPropertyDescriptor;var J8=Object.getOwnPropertyNames;var Q8=Object.getPrototypeOf,e4=Object.prototype.hasOwnProperty;var tn=(e,t)=>()=>(e&&(t=e(e=0)),t);var Gd=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),nb=(e,t)=>{for(var r in t)LC(e,r,{get:t[r],enumerable:!0})},t4=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of J8(t))!e4.call(e,i)&&i!==r&&LC(e,i,{get:()=>t[i],enumerable:!(n=Z8(t,i))||n.enumerable});return e};var ut=(e,t,r)=>(r=e!=null?j8(Q8(e)):{},t4(t||!e||!e.__esModule?LC(r,"default",{value:e,enumerable:!0}):r,e));function RR(e){Xl=e}function ib(e,t){Xl==null||Xl.notify(e,t)}function cT(e,t,r){Xl==null||Xl.leaveBreadcrumb(e,t,r)}function kR(e){Xl==null||Xl.setBeforeSendCB(e)}var Xl,Bd=tn(()=>{});var VR=tn(()=>{});function lT(e){let t=()=>e;return t.isDCGViewConst=!0,t}function Ko(e){return typeof e=="function"&&!!e.isDCGViewConst}var dl=tn(()=>{});function FR(e){let t=e();if(typeof t=="string")return t;if(typeof t!="object")throw new Error(`Unsupported type returned from class getter: ${typeof t}`);return Object.keys(t).filter(r=>t.hasOwnProperty(r)&&t[r]).join(" ")}function r4(e,t,r){let n=e.className.replace(GR,"").split(BR),i=t.replace(GR,"").split(BR),o={};for(let s of i)o[s]=!0;let a=n.filter(s=>!o.hasOwnProperty(s));return r?`${r} ${a.join(" ")}`.trim():a.join(" ")}function qR(e){let t=FR(e),r=Ko(e)?void 0:{onUpdate:n=>{let i=FR(e);t!==i&&(n.className=n.className===t?i:r4(n,t,i),t=i)}};return{value:t,bindings:r}}var GR,BR,zR=tn(()=>{dl();GR=/^\s+|\s+$/g,BR=/\s+/});function UR(e){return t=>{if(typeof t!="function")throw new Error(`The ${e} attribute expects a function for the value`);if(Ko(t))throw new Error(`The ${e} attribute does not expect a const for the value`);return{bindings:{[e]:t}}}}var HR=tn(()=>{dl()});function uT(e,t,r){return r===void 0?e.removeAttribute(t):e.setAttribute(t,`${r}`)}var NC=tn(()=>{});function $R(e){let t=e(),r=typeof t;if(r==="string")return t;if(!r||r!=="object")throw new Error(`Unsupported type returned from style getter: ${r}`);return Object.entries(t).filter(([n,i])=>t.hasOwnProperty(n)&&i!==null&&i!==void 0).map(([n,i])=>`${n}:${i}`).join(";")}function YR(e){let t=$R(e),r=Ko(e)?void 0:{onUpdate:n=>{let i=$R(e);t!==i&&(uT(n,"style",i),t=i)}};return{value:t,bindings:r}}var WR=tn(()=>{NC();dl()});function rm(e,t){RC[e]=t}function XR(e){return RC.hasOwnProperty(e)}function KR(e,t){let r=RC[e];return r(t)}var RC,dT=tn(()=>{RC={}});function jR(e,t){if(t!=null){if(typeof e!="string")throw new Error("Must pass a string for an EventHandler name");if(typeof t!="function")throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount(r){r&&(r[e.toLowerCase()]=(n,...i)=>{n&&t.apply(r,[n,...i])})}}}}}var ZR=tn(()=>{});function JR(e,t){let r=t(),n;return Ko(t)||(n={onUpdate(i){if(!i)return;let o=t();o!==r&&(r=o,uT(i,e,o))}}),{value:r,bindings:n}}var QR=tn(()=>{NC();dl()});function ek(e){return e.startsWith("on")&&e[2]===e[2].toUpperCase()}var tk=tn(()=>{});function rk(e,t){if(typeof t!="function")throw new Error(`The "${e}" attr must be a function. It is: ${JSON.stringify(t)}`);return XR(e)?KR(e,t):ek(e)?jR(e,t):JR(e,t)}var nk=tn(()=>{ZR();QR();dT();tk()});function ik(e,t,r){let n=e._bindings[t];e._bindings[t]=n?[...n,r]:[r]}function pl(e,t){var n;((n=e._bindings[t])!=null?n:[]).forEach(i=>i())}var kC=tn(()=>{});function ok(e){ob.push(e)}function ak(e){let t=ob.filter(r=>r!==e);ob.length=0,ob.push(...t)}function gl(e,t){if(ku(t)){let n=`[${t._viewName}]`,i=t.traceViewHierarchy(),o=i.ancestors.length>0?`
View Hierarchy:
${i.formatted}`:"";e=`${e} ${n}${o}`}let r=new Error(e);console.warn(r),ob.forEach(n=>n(r))}var ob,nm=tn(()=>{rc();ob=[]});var ls,Cc,pT,gT,Vu=tn(()=>{dl();nm();ls=class{assertNotMounted(){if(this._domNode)throw new Error("Cannot remount a DCGElement")}},Cc=Symbol("DCGPlaceholderElement"),pT=class extends ls{renderTo(t){this.assertNotMounted(),this._domNode=document.createTextNode(""),t.appendChild(this._domNode)}},gT=class extends ls{constructor(r,n,i){super();this.tagName=r;this.attributes=n;this.children=i;Array.isArray(this.children)&&this.children.forEach(o=>{o instanceof ls&&(o._parentElement=this)})}appendTextNode(r){this._domNode.appendChild(document.createTextNode(r))}renderTo(r,n){this.assertNotMounted(),this._domNode=document.createElement(this.tagName),n.bindAttributesTo(this._domNode,this.attributes),r.appendChild(this._domNode),this.children.forEach(i=>{if(i instanceof ls){i.renderTo(this._domNode,n);return}if(Ko(i)){this.appendTextNode(i());return}if(typeof i=="function"){n.bindText(this._domNode,i);return}gl("Text should be a const or a getter: "+JSON.stringify(i),n),this.appendTextNode(i)})}}});function sk(e,t){e!=null&&(Array.isArray(e)?e.forEach(r=>sk(r,t)):t.push(e))}function nc(e,t,...r){let n=[];r.forEach(s=>sk(s,n));let i=t!=null?t:{},o;n.length===0?o=void 0:n.length===1?o=n[0]:o=n;let a={...i,children:o};return e===Cc?new pT:typeof e=="string"?new gT(e,i,n):new e(a)._construct()}var im=tn(()=>{Vu()});var ku,Mn,rc=tn(()=>{nk();kC();dl();im();Vu();nm();ku=e=>!!e&&e instanceof Mn,Mn=class extends ls{constructor(r){var n,i;super();this.__generatedHTMLBefore=!1;this._siblingElements=[];this._childViews=[];this._bindings={};this._isMounted=!1;this._willBeUnmounted=!1;this.const=lT;this.createElement=nc;this._viewName=(i=(n=this.constructor)==null?void 0:n.name)!=null?i:"Anonymous DCGView",Object.entries(r!=null?r:{}).filter(([o])=>o!=="children").forEach(([o,a])=>{if(typeof a!="function"&&a!==void 0)throw new Error(`The "${o}" prop must be a function. It is: ${JSON.stringify(a)}`)}),this.props=r!=null?r:{}}init(){}template(){throw new Error("template() must be implemented")}_construct(){var r;if((r=this.init)==null||r.call(this),this._element=this.template(),!(this._element instanceof ls))throw new Error("template() must return a DCGElement");return this._element._parentElement=this,this}bindFn(r){return r.bind(this)}bindIfMounted(r){return this.bindFn((...n)=>{if(this._isMounted)return r.apply(this,n)})}traceViewHierarchy(){let r=[],n=this._parentElement;for(;n;)r.unshift(n),n=n._parentElement;let i=a=>ku(a)&&!(a._viewName==="Switch"&&ku(a._parentElement)&&a._parentElement._viewName==="If")&&!["IfDefinedWrapper","SwitchWrapper","SwitchUnionWrapper"].includes(a._viewName),o=[...r,this].filter(i).map((a,s)=>"  ".repeat(s)+"<"+a._viewName+">").join(`
`);return{ancestors:r,formatted:o}}renderTo(r,n){if(n&&n._childViews.push(this),this.__generatedHTMLBefore)throw new Error("Cannot remount a DCGView");this.__generatedHTMLBefore=!0,this._element.renderTo(r,this),Array.isArray(this._siblingElements)&&this._siblingElements.forEach(i=>i.renderTo(r,this))}findRootNode(){let r=this._element;for(;ku(r);)r=r._element;return r._domNode}update(){var r,n,i;if(!this._isMounted)return gl("Trying to update view that is not mounted. Ignoring update.",this);this.shouldUpdate&&!this.shouldUpdate()||((r=this.willUpdate)==null||r.call(this),pl(this,"willUpdate"),pl(this,"onUpdate"),(n=this.onUpdate)==null||n.call(this),this.overrideChildUpdates?this.overrideChildUpdates():this._childViews.forEach(o=>o.update()),pl(this,"didUpdate"),(i=this.didUpdate)==null||i.call(this))}bindText(r,n){var a;let i=(a=n())!=null?a:"",o=document.createTextNode(i);r.appendChild(o),ik(this,"onUpdate",()=>{var c;let s=(c=n())!=null?c:"";i!==s&&(o.nodeValue=s,i=s)})}addAttributeBindingsTo(r,n){Object.entries(n).forEach(([i,o])=>{if(!o)return;if(["onMount","didMount","willUnmount","willUpdate","onUpdate","didUpdate"].includes(i)&&(o=o.bind(null,r)),["willMount","onMount","didMount","willUnmount","onUnmount","didUnmount"].includes(i)){let l=!1,u=o;o=(...d)=>{if(l){gl(`${i} is a one-time binding but was called multiple times`,this);return}l=!0,u(...d)}}let c=this._bindings[i];this._bindings[i]=c?[...c,o]:[o]})}bindAttributesTo(r,n){r instanceof Text||!n||Object.keys(n).filter(i=>i!=="children").forEach(i=>{let o=rk(i,n[i]);o&&("value"in o&&o.value!==void 0&&r.setAttribute(i,o.value),o.bindings&&this.addAttributeBindingsTo(r,o.bindings))})}}});var toe,fT,ck=tn(()=>{toe=ut(ft());rc();fT=class extends Mn{constructor(){super(...arguments),this._viewName="Checkbox"}computeChecked(){return!!this.props.checked()}template(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');let t={...this.props,type:this.const("checkbox"),checked:this.const(this.computeChecked()?"checked":void 0),onChange:(r=>{this.props.onChange(r.target.checked),this._isMounted&&this.update()}).bind(this)};return this.createElement("input",t)}didUpdate(){this.rootDOM||(this.rootDOM=this.findRootNode());let t=this.computeChecked();this.rootDOM.checked!==t&&(this.rootDOM.checked=t)}}});var lk,uk=tn(()=>{lk=e=>{let t=e.length,r=new Array(t),n=new Array(t+1),i=0,o;for(let c=0;c<t;c++){if(e[n[i]]<e[c])o=i+1;else{let l=1,u=i-1;for(;l<=u;){let d=Math.ceil((l+u)/2);e[n[d]]<e[c]?l=d+1:u=d-1}o=l}r[c]=n[o-1],n[o]=c,o>i&&(i=o)}let a=new Array(i),s=n[i];for(let c=i-1;c>=0;c--)a[c]=e[s],s=r[s];return a}});function mT(e,t){let r={};for(let c=0;c<t.length;c++)r[t[c]]=c;let n=e.filter(c=>r[c]===void 0),i=e.map(c=>r[c]).filter(c=>c!==void 0),o=lk(i),a={};for(let c=0;c<o.length;c++){let l=o[c];a[t[l]]=!0}let s=[];for(let c=t.length-1;c>=0;c--){let l=t[c];a[l]||s.push({key:l,beforeKey:t[c+1]})}return{removes:n,inserts:s}}var VC=tn(()=>{uk()});function dk(e,t,r){if(!t||t.nodeType!==1)throw new Error("Must pass an HTMLElement for the node");if(t._mountedDCGView)throw new Error("This node is already mounted by a view");let n=new e(r)._construct(),i=document.createDocumentFragment();return n.renderTo(i),t.innerHTML="",Pc(n),t._mountedDCGView=n,t.appendChild(i),Sc(n),Mc(n),n}function pk(e){let t=e._mountedDCGView;if(!t)throw new Error("This node is not mounted by a DCGView");Dc(t),e.innerHTML="",delete e._mountedDCGView,_c(t),Ac(t)}function Pc(e){e.willMount&&e.willMount(),pl(e,"willMount"),e._childViews.forEach(Pc)}function Sc(e){e._isMounted=!0,e.onMount&&e.onMount(),pl(e,"onMount"),e._childViews.forEach(Sc)}function Mc(e){e.didMount&&e.didMount(),pl(e,"didMount"),e._childViews.forEach(Mc)}function Dc(e){e.willUnmount&&e.willUnmount(),pl(e,"willUnmount"),e._childViews.forEach(Dc)}function _c(e){e._isMounted=!1,e._childViews.forEach(_c),pl(e,"onUnmount"),e.onUnmount&&e.onUnmount()}function Ac(e){e._childViews.forEach(Ac),pl(e,"didUnmount"),e.didUnmount&&e.didUnmount()}function Kl(e,t){let r=document.createDocumentFragment();return e.renderTo(r,t),r.firstChild}var gg=tn(()=>{kC()});function gk(e,t){return nc(GC,{items:e,keyFunction:t.key,viewFunction:t.item})}var loe,FC,GC,fk=tn(()=>{loe=ut(ft());VC();im();Vu();gg();rc();nm();FC=class extends Mn{constructor(){super(...arguments),this._viewName="EachWrapper"}template(){return this.props.children}},GC=class extends Mn{constructor(){super(...arguments),this._viewName="Each"}getKeys(){this._keyToItem={};let t=this.props.items(),r=this.props.keyFunction?t.map(this.props.keyFunction):[...t];if(!this._chosenKeyType&&r.length&&(this._chosenKeyType=typeof r[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error(`The key: ${JSON.stringify(r[0])} is not a string or number`);return r.forEach((n,i)=>{if(typeof n!==this._chosenKeyType)throw new Error(`Keys must be the same type. ${JSON.stringify(n)} is not a ${this._chosenKeyType}`);if(this._keyToItem[n])throw new Error(`The key: ${JSON.stringify(n)} is not unique`);this._keyToItem[n]=t[i]}),r}createViewForKey(t){let r=this._keyToItem[t],n=this.props.viewFunction(r,t),i=n;return ku(i)||(i=nc(FC,{},n)),this._keyToView[t]=i,i}template(){return this._keyToView={},this._keys=this.getKeys(),this._element=this.createElement(Cc,null),this._siblingElements=this._keys.map(t=>{let r=this.createViewForKey(t);return r._parentElement=this._element._parentElement,r}),this._element}detachAllRemovedViews(){let t=this._childViews,r=0;for(let n=0;n<t.length;n++){let i=t[n];i._willBeUnmounted?r++:t[n-r]=i}t.splice(t.length-r,r)}overrideChildUpdates(){let t=this._keys,r=this.getKeys();this._keys=r;let n=this._element._domNode.parentNode;if(!n){let s="Expected `parentNode` to be defined.";throw gl(s,this),new Error(s)}let i=mT(t,r),o=[];for(let s=i.removes.length-1;s>=0;s--){let c=i.removes[s],l=this._keyToView[c];Dc(l),delete this._keyToView[c],l._willBeUnmounted=!0,n.removeChild(l.findRootNode()),o.push(l)}o.length>0&&(this.detachAllRemovedViews(),o.forEach(_c),o.forEach(Ac));let a=[];for(let s=i.inserts.length-1;s>=0;s--){let c=i.inserts[s].key;if(c in this._keyToView)continue;let l=this.createViewForKey(c);Kl(l,this),a.push(l)}a.forEach(Pc),i.inserts.forEach(s=>{let c=this._keyToView[s.key].findRootNode(),l=s.beforeKey!==void 0?this._keyToView[s.beforeKey].findRootNode():null;n.insertBefore(c,l)}),a.forEach(Sc),a.forEach(Mc);for(let s=0;s<this._childViews.length-a.length;s++)this._childViews[s].update()}}});var yoe,BC,hT,mk=tn(()=>{yoe=ut(ft());VC();dl();Vu();gg();rc();nm();BC=class extends Mn{constructor(){super(...arguments),this._viewName="ForWrapper"}template(){return this.props.children}},hT=class extends Mn{constructor(){super(...arguments),this._viewName="For"}getKeys(){this._keyToItem={};let t=this.props.each();if(!Array.isArray(t))throw new Error("<For each={}> must return an array");let r=this.props.key?t.map(this.props.key):[...t];if(!this._chosenKeyType&&r.length&&(this._chosenKeyType=typeof r[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error(`The key: ${JSON.stringify(r[0])} is not a string or number`);return r.forEach((n,i)=>{if(typeof n!==this._chosenKeyType)throw new Error(`Keys must be the same type. ${JSON.stringify(n)} is not a ${this._chosenKeyType}`);if(n in this._keyToItem)throw new Error(`The key: ${JSON.stringify(n)} is not unique`);this._keyToItem[n]=t[i]}),r}createViewForKey(t){let r=this._keyToItem[t],n=this._viewFunction.call(this,r,t),i=n;return ku(i)||(i=this.createElement(BC,{},n)),this._keyToView[t]=i,i}template(){if(typeof this.props.each!="function")throw new Error("<For each={}> must be a function");if(!("children"in this.props))throw new Error("<For> expects a child.");if(Array.isArray(this.props.children))throw new Error(`<For> expects a single child. You passed ${this.props.children.length}.`);if(this._viewFunction=this.props.children,this._viewFunction&&this._viewFunction instanceof ls)throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){let t=JSON.stringify(this._viewFunction);throw new Error(`<For> expects a function that constructs a DCGElement. You passed ${t}`)}if(Ko(this._viewFunction))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");return this._keyToView={},this._keys=this.getKeys(),this._element=this.createElement(Cc,null),this._element._parentElement=this,this._siblingElements=this._keys.map(t=>{let r=this.createViewForKey(t);return r._parentElement=this,r}),this._element}detachAllRemovedViews(){let t=this._childViews,r=0;for(let n=0;n<t.length;n++){let i=t[n];i._willBeUnmounted?r++:t[n-r]=i}t.splice(t.length-r,r)}overrideChildUpdates(){let t=this._keys,r=this.getKeys();this._keys=r;let n=this._element._domNode.parentNode;if(!n){let s="Expected `parentNode` to be defined.";throw gl(s,this),new Error(s)}let i=mT(t,r),o=[];for(let s=i.removes.length-1;s>=0;s--){let c=i.removes[s],l=this._keyToView[c];Dc(l),delete this._keyToView[c],l._willBeUnmounted=!0,n.removeChild(l.findRootNode()),o.push(l)}o.length>0&&(this.detachAllRemovedViews(),o.forEach(_c),o.forEach(Ac));let a=[];for(let s=i.inserts.length-1;s>=0;s--){let c=i.inserts[s].key;if(c in this._keyToView)continue;let l=this.createViewForKey(c);Kl(l,this),a.push(l)}a.forEach(Pc),i.inserts.forEach(s=>{let c=this._keyToView[s.key].findRootNode(),l=s.beforeKey!==void 0?this._keyToView[s.beforeKey].findRootNode():null;n.insertBefore(c,l)}),a.forEach(Sc),a.forEach(Mc);for(let s=0;s<this._childViews.length-a.length;s++)this._childViews[s].update()}}});var Coe,qC,om,zC=tn(()=>{Coe=ut(ft());dl();Vu();gg();rc();qC=class extends Mn{constructor(){super(...arguments),this._viewName="SwitchWrapper"}template(){return this.props.children}},om=class extends Mn{constructor(){super(...arguments),this._viewName="Switch"}updateKey(){this._key=this.props.key()}createView(){let t=this._viewFunction(this._key);t=t!=null?t:this.createElement(Cc,null);let r=this.createElement(qC,{},t);return r._parentElement=this,r}template(){if(typeof this.props.key!="function")throw new Error("<Switch key={}> must be a function");if(!("children"in this.props))throw new Error("<Switch> expects a child.");if(Array.isArray(this.props.children))throw new Error(`<Switch> expects a single child. You passed ${this.props.children.length}.`);if(this._viewFunction=this.props.children,this._viewFunction&&this._viewFunction instanceof ls)throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){let t=JSON.stringify(this._viewFunction);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+t)}if(Ko(this._viewFunction))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this.updateKey(),this.createView()}overrideChildUpdates(){let t=this._key;this.updateKey();let r=this._key;if(t===r){this._element.update();return}let n=this.findRootNode(),i=document.createTextNode("");n.parentNode.insertBefore(i,n),Dc(this._element),this._childViews=[],n.parentNode.removeChild(n),_c(this._element),Ac(this._element),this._element=this.createView();let o=Kl(this._element,this);Pc(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Sc(this._element),Mc(this._element)}}});var Aoe,yT,hk=tn(()=>{Aoe=ut(ft());dl();Vu();zC();rc();yT=class extends Mn{constructor(){super(...arguments),this._viewName="If"}template(){let{predicate:t}=this.props;if(typeof t!="function")throw new Error("<If predicate={}> must be a function");if(!("children"in this.props))throw new Error("<If> expects a child.");if(Array.isArray(this.props.children))throw new Error(`<If> expects a single child. You passed ${this.props.children.length}.`);let r=this.props.children;if(r&&r instanceof ls)throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof r!="function"){let o=JSON.stringify(r);throw new Error(`<If> expects a function that constructs a DCGElement. You passed ${o}`)}if(Ko(r))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");let n=()=>!!t(),i=o=>o?r():void 0;return this.createElement(om,{key:n},i)}}});function yk(e,t){return nc(HC,{isDefined(){let r=e();return r!=null},buildChildView(){return t(e)}})}var Voe,UC,HC,bk=tn(()=>{Voe=ut(ft());im();Vu();gg();rc();UC=class extends Mn{constructor(){super(...arguments),this._viewName="IfDefinedWrapper"}template(){return this.props.children}},HC=class extends Mn{constructor(){super(...arguments),this._viewName="IfDefined"}updateIsDefined(){this._isDefined=this.props.isDefined()}createView(){let t=this._isDefined?this.props.buildChildView():null,r;t?r=t:r=this.createElement(Cc,null);let n=this.createElement(UC,{},r);return n._parentElement=this,n}template(){return this._isDefined=void 0,this.updateIsDefined(),this.createView()}overrideChildUpdates(){let t=this._isDefined;this.updateIsDefined();let r=this._isDefined;if(t===r){this._element.update();return}let n=this.findRootNode(),i=document.createTextNode("");n.parentNode.insertBefore(i,n),Dc(this._element),this._childViews=[],n.parentNode.removeChild(n),_c(this._element),Ac(this._element),this._element=this.createView();let o=Kl(this._element,this);Pc(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Sc(this._element),Mc(this._element)}}});function bT(e,t){return typeof e=="string"?xk.bind(this,e,t):xk(void 0,e,t)}var Uoe,$C,YC,xk,WC=tn(()=>{Uoe=ut(ft());im();Vu();gg();rc();$C=class extends Mn{constructor(){super(...arguments),this._viewName="SwitchUnionWrapper"}template(){return this.props.children}},YC=class extends Mn{constructor(){super(...arguments),this._viewName="SwitchUnion"}updateCase(){this._case=this.props.getCase()}createView(){let t=this.props.buildChildView(this._case),r;t?r=t:r=nc(Cc,null);let n=nc($C,{},r);return n._parentElement=this,n}template(){return this._case=void 0,this.updateCase(),this.createView()}overrideChildUpdates(){let t=this._case;this.updateCase();let r=this._case;if(t===r){this._element.update();return}let n=this.findRootNode(),i=document.createTextNode("");n.parentNode.insertBefore(i,n),Dc(this._element),this._childViews=[],n.parentNode.removeChild(n),_c(this._element),Ac(this._element),this._element=this.createView();let o=Kl(this._element,this);Pc(this._element),i.parentNode.insertBefore(o,i),i.parentNode.removeChild(i),Sc(this._element),Mc(this._element)}},xk=(e,t,r)=>nc(YC,{getCase(){let n=t();return e?n&&n[e]:n},buildChildView(n){let i=r[n];return i?i(t):void 0}})});function vk(e,t){let r=bT(()=>e()?"true":"false",t);return r._viewName="IfElse",r}var Koe,Tk=tn(()=>{Koe=ut(ft());WC()});var Joe,xT,wk=tn(()=>{Joe=ut(ft());rc();xT=class extends Mn{constructor(){super(...arguments),this._viewName="Input"}computeValue(){let t=this.props.value();return t==null?"":`${t}`}template(){let{value:t,onInput:r,onEnterPressed:n,disabled:i,readOnly:o}=this.props;if(!t)throw new Error('<Input> expects a "value={}" prop');if(!r)throw new Error('<Input> expects an "onInput={}" prop');let a={...this.props,value:this.const(this.computeValue()),onInput:(s=>{r(s.target.value),this._isMounted&&this.update()}).bind(this)};return n&&(a.onKeypress=s=>{s.which===13&&n()}),i&&(a.disabled=()=>i()?!0:void 0),o&&(a.readOnly=()=>o()?!0:void 0),a.hasOwnProperty("tabIndex")||(a.tabIndex=()=>i&&i()?"-1":"0"),this.createElement("input",a)}didUpdate(){this.rootDOM||(this.rootDOM=this.findRootNode());var t=this.computeValue();this.rootDOM.value!==t&&(this.rootDOM.value=t)}}});var tae,vT,Ek=tn(()=>{tae=ut(ft());rc();vT=class extends Mn{constructor(){super(...arguments),this._viewName="Textarea"}computeValue(){let t=this.props.value();return t==null?"":`${t}`}template(){let{value:t,onInput:r,disabled:n,readOnly:i}=this.props;if(!t)throw new Error('<Textarea> expects a "value={}" prop');if(!r)throw new Error('<Textarea> expects an "onInput={}" prop');let o={...this.props,onInput:(a=>{this.props.onInput(a.target.value),this._isMounted&&this.update()}).bind(this)};return n&&(o.disabled=()=>n()?!0:void 0),i&&(o.readOnly=()=>i()?!0:void 0),delete o.value,this.createElement("textarea",o,this.const(this.computeValue()))}didUpdate(){this.rootDOM||(this.rootDOM=this.findRootNode());let t=this.computeValue();this.rootDOM.value!==t&&(this.rootDOM.value=t)}}});var TT={};nb(TT,{Checkbox:()=>fT,Each:()=>gk,For:()=>hT,If:()=>yT,IfDefined:()=>yk,IfElse:()=>vk,Input:()=>xT,Switch:()=>om,SwitchUnion:()=>bT,Textarea:()=>vT});var Ik=tn(()=>{ck();fk();mk();hk();bk();Tk();wk();zC();WC();Ek()});var XC={};nb(XC,{Class:()=>n4,Components:()=>TT,View:()=>Mn,_warn:()=>gl,addCustomAttribute:()=>rm,addWarningHandler:()=>ok,const:()=>lT,createElement:()=>nc,isConst:()=>Ko,mountToNode:()=>dk,removeWarningHandler:()=>ak,unmountFromNode:()=>pk});var n4,KC=tn(()=>{zR();HR();WR();dT();rc();Ik();dl();im();dT();gg();rc();nm();n4=Mn;rm("style",YR);rm("class",qR);["willMount","onMount","didMount","willUnmount","onUnmount","didUnmount","willUpdate","onUpdate","didUpdate"].forEach(e=>rm(e,UR(e)))});var fl,Ck=tn(()=>{KC();KC();fl=XC});function ST(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?PT[Vk.call(e)]||"object":typeof e}function jC(e){var t=!!e&&"length"in e&&e.length,r=ST(e);return qu(e)||um(e)?!1:r==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e}function am(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}function p4(e,t){return t.toUpperCase()}function Fu(e){return e.replace(u4,"ms-").replace(d4,p4)}function cb(){this.expando=J.expando+cb.uid++}function m4(e){return e==="true"?!0:e==="false"?!1:e==="null"?null:e===+e+""?+e:g4.test(e)?JSON.parse(e):e}function Pk(e,t,r){var n;if(r===void 0&&e.nodeType===1)if(n="data-"+t.replace(f4,"-$&").toLowerCase(),r=e.getAttribute(n),typeof r=="string"){try{r=m4(r)}catch(i){}Gu.set(e,t,r)}else r=void 0;return r}function y4(e,t,r,n){var i,o,a=20,s=n?function(){return n.cur()}:function(){return J.css(e,t,"")},c=s(),l=r&&r[3]||(J.cssNumber[t]?"":"px"),u=e.nodeType&&(J.cssNumber[t]||l!=="px"&&+c)&&MT.exec(J.css(e,t));if(u&&u[3]!==l){for(c=c/2,l=l||u[3],u=+c||1;a--;)J.style(e,t,u+l),(1-o)*(1-(o=s()/c||.5))<=0&&(a=0),u=u/o;u=u*2,J.style(e,t,u+l),r=r||[]}return r&&(u=+u||+c||0,i=r[1]?u+(r[1]+1)*r[2]:+r[2],n&&(n.unit=l,n.start=u,n.end=i)),i}function cm(){return!0}function lm(){return!1}function b4(e,t){return e===x4()==(t==="focus")}function x4(){try{return Mo.activeElement}catch(e){}}function QC(e,t,r,n,i,o){var a,s;if(typeof t=="object"){typeof r!="string"&&(n=n||r,r=void 0);for(s in t)QC(e,s,r,n,t[s],o);return e}if(n==null&&i==null?(i=r,n=r=void 0):i==null&&(typeof r=="string"?(i=n,n=void 0):(i=n,n=r,r=void 0)),i===!1)i=lm;else if(!i)return e;return o===1&&(a=i,i=function(c){return J().off(c),a.apply(this,arguments)},i.guid=a.guid||(a.guid=J.guid++)),e.each(function(){J.event.add(this,t,i,n,r)})}function CT(e,t,r){if(!r){ai.get(e,t)===void 0&&J.event.add(e,t,cm);return}ai.set(e,t,!1),J.event.add(e,t,{namespace:!1,handler:function(n){var i,o,a=ai.get(this,t);if(n.isTrigger&1&&this[t]){if(a.length)(J.event.special[t]||{}).delegateType&&n.stopPropagation();else if(a=wT.call(arguments),ai.set(this,t,a),i=r(this,t),this[t](),o=ai.get(this,t),a!==o||i?ai.set(this,t,!1):o={},a!==o)return n.stopImmediatePropagation(),n.preventDefault(),o&&o.value}else a.length&&(ai.set(this,t,{value:J.event.trigger(J.extend(a[0],J.Event.prototype),a.slice(1),this)}),n.stopImmediatePropagation())}})}function ab(e,t,r){var n,i,o,a,s=e.style;return r=r||DT(e),r&&(a=r.getPropertyValue(t)||r[t],a===""&&!zk(e)&&(a=J.style(e,t)),!Do.pixelBoxStyles()&&rP.test(a)&&v4.test(t)&&(n=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=r.width,s.width=n,s.minWidth=i,s.maxWidth=o)),a!==void 0?a+"":a}function Hk(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function T4(e){for(var t=e[0].toUpperCase()+e.slice(1),r=Mk.length;r--;)if(e=Mk[r]+t,e in $k)return e}function _k(e){var t=J.cssProps[e]||Dk[e];return t||(e in $k?e:Dk[e]=T4(e)||e)}function Yk(e,t,r){var n=MT.exec(t);return n?Math.max(0,n[2]-(r||0))+(n[3]||"px"):t}function eP(e,t,r,n,i,o){var a=t==="width"?1:0,s=0,c=0;if(r===(n?"border":"content"))return 0;for(;a<4;a+=2)r==="margin"&&(c+=J.css(e,r+qd[a],!0,i)),n?(r==="content"&&(c-=J.css(e,"padding"+qd[a],!0,i)),r!=="margin"&&(c-=J.css(e,"border"+qd[a]+"Width",!0,i))):(c+=J.css(e,"padding"+qd[a],!0,i),r!=="padding"?c+=J.css(e,"border"+qd[a]+"Width",!0,i):s+=J.css(e,"border"+qd[a]+"Width",!0,i));return!n&&o>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-c-s-.5))||0),c}function Lk(e,t,r){var n=DT(e),i=!Do.boxSizingReliable()||r,o=i&&J.css(e,"boxSizing",!1,n)==="border-box",a=o,s=ab(e,t,n),c="offset"+t[0].toUpperCase()+t.slice(1);if(rP.test(s)){if(!r)return s;s="auto"}return(!Do.boxSizingReliable()&&o||!Do.reliableTrDimensions()&&am(e,"tr")||s==="auto"||!parseFloat(s)&&J.css(e,"display",!1,n)==="inline")&&e.getClientRects().length&&(o=J.css(e,"boxSizing",!1,n)==="border-box",a=c in e,a&&(s=e[c])),s=parseFloat(s)||0,s+eP(e,t,r||(o?"border":"content"),a,n,s)+"px"}function tP(e,t,r,n){var i;if(Array.isArray(t))J.each(t,function(o,a){r||I4.test(e)?n(e,a):tP(e+"["+(typeof a=="object"&&a!=null?o:"")+"]",a,r,n)});else if(!r&&ST(t)==="object")for(i in t)tP(e+"["+i+"]",t[i],r,n);else n(e,t)}var Bu,i4,wT,o4,kk,a4,PT,Vk,ET,Fk,s4,Do,qu,um,Mo,Gk,J,c4,Bk,l4,JC,sb,u4,d4,IT,ai,Gu,g4,f4,qk,MT,qd,sm,zk,h4,ZC,Sk,rP,DT,Uk,v4,Mk,$k,Dk,w4,Ak,E4,Ok,Nk,Rk,I4,C4,P4,S4,ze,fa=tn(()=>{"use strict";Bu=[],i4=Object.getPrototypeOf,wT=Bu.slice,o4=Bu.flat?function(e){return Bu.flat.call(e)}:function(e){return Bu.concat.apply([],e)},kk=Bu.push,a4=Bu.indexOf,PT={},Vk=PT.toString,ET=PT.hasOwnProperty,Fk=ET.toString,s4=Fk.call(Object),Do={},qu=function(t){return typeof t=="function"&&typeof t.nodeType!="number"&&typeof t.item!="function"},um=function(t){return t!=null&&t===t.window},Mo=window.document;Gk="3.6.0",J=function(e,t){return new J.fn.init(e,t)};J.fn=J.prototype={jquery:Gk,constructor:J,length:0,toArray:function(){return wT.call(this)},get:function(e){return e==null?wT.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=J.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return J.each(this,e)},map:function(e){return this.pushStack(J.map(this,function(t,r){return e.call(t,r,t)}))},slice:function(){return this.pushStack(wT.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(J.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(J.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,r=+e+(e<0?t:0);return this.pushStack(r>=0&&r<t?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:kk,sort:Bu.sort,splice:Bu.splice};J.extend=J.fn.extend=function(){var e,t,r,n,i,o,a=arguments[0]||{},s=1,c=arguments.length,l=!1;for(typeof a=="boolean"&&(l=a,a=arguments[s]||{},s++),typeof a!="object"&&!qu(a)&&(a={}),s===c&&(a=this,s--);s<c;s++)if((e=arguments[s])!=null)for(t in e)n=e[t],!(t==="__proto__"||a===n)&&(l&&n&&(J.isPlainObject(n)||(i=Array.isArray(n)))?(r=a[t],i&&!Array.isArray(r)?o=[]:!i&&!J.isPlainObject(r)?o={}:o=r,i=!1,a[t]=J.extend(l,o,n)):n!==void 0&&(a[t]=n));return a};J.extend({expando:"jQuery"+(Gk+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,r;return!e||Vk.call(e)!=="[object Object]"?!1:(t=i4(e),t?(r=ET.call(t,"constructor")&&t.constructor,typeof r=="function"&&Fk.call(r)===s4):!0)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},each:function(e,t){var r,n=0;if(jC(e))for(r=e.length;n<r&&t.call(e[n],n,e[n])!==!1;n++);else for(n in e)if(t.call(e[n],n,e[n])===!1)break;return e},makeArray:function(e,t){var r=t||[];return e!=null&&(jC(Object(e))?J.merge(r,typeof e=="string"?[e]:e):kk.call(r,e)),r},inArray:function(e,t,r){return t==null?-1:a4.call(t,e,r)},merge:function(e,t){for(var r=+t.length,n=0,i=e.length;n<r;n++)e[i++]=t[n];return e.length=i,e},grep:function(e,t,r){for(var n,i=[],o=0,a=e.length,s=!r;o<a;o++)n=!t(e[o],o),n!==s&&i.push(e[o]);return i},map:function(e,t,r){var n,i,o=0,a=[];if(jC(e))for(n=e.length;o<n;o++)i=t(e[o],o,r),i!=null&&a.push(i);else for(o in e)i=t(e[o],o,r),i!=null&&a.push(i);return o4(a)},guid:1,support:Do});typeof Symbol=="function"&&(J.fn[Symbol.iterator]=Bu[Symbol.iterator]);J.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){PT["[object "+t+"]"]=t.toLowerCase()});c4=function(e){var t,r,n,i,o,a,s,c=e.document,l=[],u=l.push,d=l.push,f=l.slice,g=/HTML$/i,y=/^[^{]+\{\s*\[native \w/,x=function(){n()};try{d.apply(l=f.call(c.childNodes),c.childNodes),l[c.childNodes.length].nodeType}catch(E){d={apply:l.length?function(I,S){u.apply(I,f.call(S))}:function(I,S){for(var D=I.length,O=0;I[D++]=S[O++];);I.length=D-1}}}function b(){}function w(E){var I=i.createElement("fieldset");try{return!!E(I)}catch(S){return!1}finally{I.parentNode&&I.parentNode.removeChild(I),I=null}}return t=b.support={},r=b.isXML=function(E){var I=E&&E.namespaceURI,S=E&&(E.ownerDocument||E).documentElement;return!g.test(I||S&&S.nodeName||"HTML")},n=b.setDocument=function(E){var I,S,D=E?E.ownerDocument||E:c;return D==i||D.nodeType!==9||!D.documentElement||(i=D,o=i.documentElement,a=!r(i),c!=i&&(S=i.defaultView)&&S.top!==S&&(S.addEventListener?S.addEventListener("unload",x,!1):S.attachEvent&&S.attachEvent("onunload",x)),t.attributes=w(function(O){return O.className="i",!O.getAttribute("className")}),t.getElementsByTagName=w(function(O){return O.appendChild(i.createComment("")),!O.getElementsByTagName("*").length}),I=y.test(o.compareDocumentPosition),s=I||y.test(o.contains)?function(O,_){var A=O.nodeType===9?O.documentElement:O,R=_&&_.parentNode;return O===R||!!(R&&R.nodeType===1&&(A.contains?A.contains(R):O.compareDocumentPosition&&O.compareDocumentPosition(R)&16))}:function(O,_){if(_){for(;_=_.parentNode;)if(_===O)return!0}return!1}),i},b.contains=function(E,I){return(E.ownerDocument||E)!=i&&n(E),s(E,I)},n(),t.sortDetached=w(function(E){return E.compareDocumentPosition(i.createElement("fieldset"))&1}),b}(window);J.contains=c4.contains;l4=J.fn.init=function(e,t,r){if(!e)return this;if(r=r||Bk,typeof e=="string")throw new Error("$(string) implementation has been removed");if(e.nodeType)return this[0]=e,this.length=1,this;if(qu(e))throw new Error("$(function) implementation has been removed");return J.makeArray(e,this)};l4.prototype=J.fn;Bk=J(Mo);JC=/[^\x20\t\r\n\f]+/g,sb=function(e,t,r,n,i,o,a){var s=0,c=e.length,l=r==null;if(ST(r)==="object"){i=!0;for(s in r)sb(e,t,s,r[s],!0,o,a)}else if(n!==void 0&&(i=!0,qu(n)||(a=!0),l&&(a?(t.call(e,n),t=null):(l=t,t=function(u,d,f){return l.call(J(u),f)})),t))for(;s<c;s++)t(e[s],r,a?n:n.call(e[s],s,t(e[s],r)));return i?e:l?t.call(e):c?t(e[0],r):o},u4=/^-ms-/,d4=/-([a-z])/g;IT=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};cb.uid=1;cb.prototype={cache:function(e){var t=e[this.expando];return t||(t={},IT(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,r){var n,i=this.cache(e);if(typeof t=="string")i[Fu(t)]=r;else for(n in t)i[Fu(n)]=t[n];return i},get:function(e,t){return t===void 0?this.cache(e):e[this.expando]&&e[this.expando][Fu(t)]},access:function(e,t,r){return t===void 0||t&&typeof t=="string"&&r===void 0?this.get(e,t):(this.set(e,t,r),r!==void 0?r:t)},remove:function(e,t){var r,n=e[this.expando];if(n!==void 0){if(t!==void 0)for(Array.isArray(t)?t=t.map(Fu):(t=Fu(t),t=t in n?[t]:t.match(JC)||[]),r=t.length;r--;)delete n[t[r]];(t===void 0||J.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return t!==void 0&&!J.isEmptyObject(t)}};ai=new cb,Gu=new cb,g4=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,f4=/[A-Z]/g;J.extend({hasData:function(e){return Gu.hasData(e)||ai.hasData(e)},data:function(e,t,r){return Gu.access(e,t,r)},removeData:function(e,t){Gu.remove(e,t)},_data:function(e,t,r){return ai.access(e,t,r)},_removeData:function(e,t){ai.remove(e,t)}});J.fn.extend({data:function(e,t){var r,n,i,o=this[0],a=o&&o.attributes;if(e===void 0){if(this.length&&(i=Gu.get(o),o.nodeType===1&&!ai.get(o,"hasDataAttrs"))){for(r=a.length;r--;)a[r]&&(n=a[r].name,n.indexOf("data-")===0&&(n=Fu(n.slice(5)),Pk(o,n,i[n])));ai.set(o,"hasDataAttrs",!0)}return i}return typeof e=="object"?this.each(function(){Gu.set(this,e)}):sb(this,function(s){var c;if(o&&s===void 0)return c=Gu.get(o,e),c!==void 0||(c=Pk(o,e),c!==void 0)?c:void 0;this.each(function(){Gu.set(this,e,s)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Gu.remove(this,e)})}});qk=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,MT=new RegExp("^(?:([+-])=|)("+qk+")([a-z%]*)$","i"),qd=["Top","Right","Bottom","Left"],sm=Mo.documentElement,zk=function(e){return J.contains(e.ownerDocument,e)},h4={composed:!0};sm.getRootNode&&(zk=function(e){return J.contains(e.ownerDocument,e)||e.getRootNode(h4)===e.ownerDocument});ZC=/^(?:checkbox|radio)$/i;(function(){var e=Mo.createDocumentFragment(),t=e.appendChild(Mo.createElement("div")),r=Mo.createElement("input");r.setAttribute("type","radio"),r.setAttribute("checked","checked"),r.setAttribute("name","t"),t.appendChild(r),Do.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Do.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,t.innerHTML="<option></option>",Do.option=!!t.lastChild})();Sk=/^([^.]*)(?:\.(.+)|)/;J.event={global:{},add:function(e,t,r,n,i){var o,a,s,c,l,u,d,f,g,y,x,b=ai.get(e);if(IT(e)){if(r.handler&&(o=r,r=o.handler,i=o.selector),i)throw new Error("Support for event delegation has been removed");for(r.guid||(r.guid=J.guid++),(c=b.events)||(c=b.events=Object.create(null)),(a=b.handle)||(a=b.handle=function(w){return typeof J!="undefined"&&J.event.triggered!==w.type?J.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(JC)||[""],l=t.length;l--;)if(s=Sk.exec(t[l])||[],g=x=s[1],y=(s[2]||"").split(".").sort(),!!g){if(d=J.event.special[g]||{},g=(i?d.delegateType:d.bindType)||g,d=J.event.special[g]||{},u=J.extend({type:g,origType:x,data:n,handler:r,guid:r.guid,selector:i,namespace:y.join(".")},o),(f=c[g])||(f=c[g]=[],f.delegateCount=0,(!d.setup||d.setup.call(e,n,y,a)===!1)&&e.addEventListener&&e.addEventListener(g,a)),d.add&&(d.add.call(e,u),u.handler.guid||(u.handler.guid=r.guid)),i)throw new Error("Support for event delegation has been removed");f.push(u),J.event.global[g]=!0}}},remove:function(e,t,r,n,i){var o,a,s,c,l,u,d,f,g,y,x,b=ai.hasData(e)&&ai.get(e);if(!(!b||!(c=b.events))){for(t=(t||"").match(JC)||[""],l=t.length;l--;){if(s=Sk.exec(t[l])||[],g=x=s[1],y=(s[2]||"").split(".").sort(),!g){for(g in c)J.event.remove(e,g+t[l],r,n,!0);continue}for(d=J.event.special[g]||{},g=(n?d.delegateType:d.bindType)||g,f=c[g]||[],s=s[2]&&new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)u=f[o],(i||x===u.origType)&&(!r||r.guid===u.guid)&&(!s||s.test(u.namespace))&&(!n||n===u.selector||n==="**"&&u.selector)&&(f.splice(o,1),u.selector&&f.delegateCount--,d.remove&&d.remove.call(e,u));a&&!f.length&&((!d.teardown||d.teardown.call(e,y,b.handle)===!1)&&J.removeEvent(e,g,b.handle),delete c[g])}J.isEmptyObject(c)&&ai.remove(e,"handle events")}},dispatch:function(e){var t,r,n,i,o,a,s=new Array(arguments.length),c=J.event.fix(e),l=(ai.get(this,"events")||Object.create(null))[c.type]||[],u=J.event.special[c.type]||{};for(s[0]=c,t=1;t<arguments.length;t++)s[t]=arguments[t];if(c.delegateTarget=this,!(u.preDispatch&&u.preDispatch.call(this,c)===!1)){for(a=J.event.handlers.call(this,c,l),t=0;(i=a[t++])&&!c.isPropagationStopped();)for(c.currentTarget=i.elem,r=0;(o=i.handlers[r++])&&!c.isImmediatePropagationStopped();)(!c.rnamespace||o.namespace===!1||c.rnamespace.test(o.namespace))&&(c.handleObj=o,c.data=o.data,n=((J.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s),n!==void 0&&(c.result=n)===!1&&(c.preventDefault(),c.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,c),c.result}},handlers:function(e,t){var r=[],n=t.delegateCount,i=e.target;if(n)throw new Error("Support for event delegtaion has been removed");return i=this,n<t.length&&r.push({elem:i,handlers:t.slice(n)}),r},addProp:function(e,t){Object.defineProperty(J.Event.prototype,e,{enumerable:!0,configurable:!0,get:qu(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(r){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:r})}})},fix:function(e){return e[J.expando]?e:new J.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return ZC.test(t.type)&&t.click&&am(t,"input")&&CT(t,"click",cm),!1},trigger:function(e){var t=this||e;return ZC.test(t.type)&&t.click&&am(t,"input")&&CT(t,"click"),!0},_default:function(e){var t=e.target;return ZC.test(t.type)&&t.click&&am(t,"input")&&ai.get(t,"click")||am(t,"a")}},beforeunload:{postDispatch:function(e){e.result!==void 0&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}};J.removeEvent=function(e,t,r){e.removeEventListener&&e.removeEventListener(t,r)};J.Event=function(e,t){if(!(this instanceof J.Event))return new J.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===void 0&&e.returnValue===!1?cm:lm,this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&J.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[J.expando]=!0};J.Event.prototype={constructor:J.Event,isDefaultPrevented:lm,isPropagationStopped:lm,isImmediatePropagationStopped:lm,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=cm,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=cm,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=cm,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}};J.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},J.event.addProp);J.each({focus:"focusin",blur:"focusout"},function(e,t){J.event.special[e]={setup:function(){return CT(this,e,b4),!1},trigger:function(){return CT(this,e),!0},_default:function(){return!0},delegateType:t}});J.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){J.event.special[e]={delegateType:t,bindType:t,handle:function(r){var n,i=this,o=r.relatedTarget,a=r.handleObj;return(!o||o!==i&&!J.contains(i,o))&&(r.type=a.origType,n=a.handler.apply(this,arguments),r.type=t),n}}});J.fn.extend({on:function(e,t,r,n){return QC(this,e,t,r,n)},one:function(e,t,r,n){return QC(this,e,t,r,n,1)},off:function(e,t,r){var n,i;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,J(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||typeof t=="function")&&(r=t,t=void 0),r===!1&&(r=lm),this.each(function(){J.event.remove(this,e,r,t)})}});rP=new RegExp("^("+qk+")(?!px)[a-z%]+$","i"),DT=function(e){var t=e.ownerDocument.defaultView;return(!t||!t.opener)&&(t=window),t.getComputedStyle(e)},Uk=function(e,t,r){var n,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];n=r.call(e);for(i in t)e.style[i]=o[i];return n},v4=new RegExp(qd.join("|"),"i");(function(){function e(){if(l){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",sm.appendChild(c).appendChild(l);var u=window.getComputedStyle(l);r=u.top!=="1%",s=t(u.marginLeft)===12,l.style.right="60%",o=t(u.right)===36,n=t(u.width)===36,l.style.position="absolute",i=t(l.offsetWidth/3)===12,sm.removeChild(c),l=null}}function t(u){return Math.round(parseFloat(u))}var r,n,i,o,a,s,c=Mo.createElement("div"),l=Mo.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",Do.clearCloneStyle=l.style.backgroundClip==="content-box",J.extend(Do,{boxSizingReliable:function(){return e(),n},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),r},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var u,d,f,g;return a==null&&(u=Mo.createElement("table"),d=Mo.createElement("tr"),f=Mo.createElement("div"),u.style.cssText="position:absolute;left:-11111px;border-collapse:separate",d.style.cssText="border:1px solid",d.style.height="1px",f.style.height="9px",f.style.display="block",sm.appendChild(u).appendChild(d).appendChild(f),g=window.getComputedStyle(d),a=parseInt(g.height,10)+parseInt(g.borderTopWidth,10)+parseInt(g.borderBottomWidth,10)===d.offsetHeight,sm.removeChild(u)),a}}))})();Mk=["Webkit","Moz","ms"],$k=Mo.createElement("div").style,Dk={};w4=/^(none|table(?!-c[ea]).+)/,Ak=/^--/,E4={position:"absolute",visibility:"hidden",display:"block"},Ok={letterSpacing:"0",fontWeight:"400"};J.extend({cssHooks:{opacity:{get:function(e,t){if(t){var r=ab(e,"opacity");return r===""?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,r,n){if(!(!e||e.nodeType===3||e.nodeType===8||!e.style)){var i,o,a,s=Fu(t),c=Ak.test(t),l=e.style;if(c||(t=_k(s)),a=J.cssHooks[t]||J.cssHooks[s],r!==void 0){if(o=typeof r,o==="string"&&(i=MT.exec(r))&&i[1]&&(r=y4(e,t,i),o="number"),r==null||r!==r)return;o==="number"&&!c&&(r+=i&&i[3]||(J.cssNumber[s]?"":"px")),!Do.clearCloneStyle&&r===""&&t.indexOf("background")===0&&(l[t]="inherit"),(!a||!("set"in a)||(r=a.set(e,r,n))!==void 0)&&(c?l.setProperty(t,r):l[t]=r)}else return a&&"get"in a&&(i=a.get(e,!1,n))!==void 0?i:l[t]}},css:function(e,t,r,n){var i,o,a,s=Fu(t),c=Ak.test(t);return c||(t=_k(s)),a=J.cssHooks[t]||J.cssHooks[s],a&&"get"in a&&(i=a.get(e,!0,r)),i===void 0&&(i=ab(e,t,n)),i==="normal"&&t in Ok&&(i=Ok[t]),r===""||r?(o=parseFloat(i),r===!0||isFinite(o)?o||0:i):i}});J.each(["height","width"],function(e,t){J.cssHooks[t]={get:function(r,n,i){if(n)return w4.test(J.css(r,"display"))&&(!r.getClientRects().length||!r.getBoundingClientRect().width)?Uk(r,E4,function(){return Lk(r,t,i)}):Lk(r,t,i)},set:function(r,n,i){var o,a=DT(r),s=!Do.scrollboxSize()&&a.position==="absolute",c=s||i,l=c&&J.css(r,"boxSizing",!1,a)==="border-box",u=i?eP(r,t,i,l,a):0;return l&&s&&(u-=Math.ceil(r["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(a[t])-eP(r,t,"border",!1,a)-.5)),u&&(o=MT.exec(n))&&(o[3]||"px")!=="px"&&(r.style[t]=n,n=J.css(r,t)),Yk(r,n,u)}}});J.cssHooks.marginLeft=Hk(Do.reliableMarginLeft,function(e,t){if(t)return(parseFloat(ab(e,"marginLeft"))||e.getBoundingClientRect().left-Uk(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"});J.each({margin:"",padding:"",border:"Width"},function(e,t){J.cssHooks[e+t]={expand:function(r){for(var n=0,i={},o=typeof r=="string"?r.split(" "):[r];n<4;n++)i[e+qd[n]+t]=o[n]||o[n-2]||o[0];return i}},e!=="margin"&&(J.cssHooks[e+t].set=Yk)});J.fn.extend({css:function(e,t){return sb(this,function(r,n,i){var o,a,s={},c=0;if(Array.isArray(n)){for(o=DT(r),a=n.length;c<a;c++)s[n[c]]=J.css(r,n[c],!1,o);return s}return i!==void 0?J.style(r,n,i):J.css(r,n)},e,t,arguments.length>1)}});(function(){var e=Mo.createElement("input"),t=Mo.createElement("select"),r=t.appendChild(Mo.createElement("option"));e.type="checkbox",Do.checkOn=e.value!=="",Do.optSelected=r.selected,e=Mo.createElement("input"),e.value="t",e.type="radio",Do.radioValue=e.value==="t"})();Do.focusin="onfocusin"in window;Nk=/^(?:focusinfocus|focusoutblur)$/,Rk=function(e){e.stopPropagation()};J.extend(J.event,{trigger:function(e,t,r,n){var i,o,a,s,c,l,u,d,f=[r||Mo],g=ET.call(e,"type")?e.type:e,y=ET.call(e,"namespace")?e.namespace.split("."):[];if(o=d=a=r=r||Mo,!(r.nodeType===3||r.nodeType===8)&&!Nk.test(g+J.event.triggered)&&(g.indexOf(".")>-1&&(y=g.split("."),g=y.shift(),y.sort()),c=g.indexOf(":")<0&&"on"+g,e=e[J.expando]?e:new J.Event(g,typeof e=="object"&&e),e.isTrigger=n?2:3,e.namespace=y.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),t=t==null?[e]:J.makeArray(t,[e]),u=J.event.special[g]||{},!(!n&&u.trigger&&u.trigger.apply(r,t)===!1))){if(!n&&!u.noBubble&&!um(r)){for(s=u.delegateType||g,Nk.test(s+g)||(o=o.parentNode);o;o=o.parentNode)f.push(o),a=o;a===(r.ownerDocument||Mo)&&f.push(a.defaultView||a.parentWindow||window)}for(i=0;(o=f[i++])&&!e.isPropagationStopped();)d=o,e.type=i>1?s:u.bindType||g,l=(ai.get(o,"events")||Object.create(null))[e.type]&&ai.get(o,"handle"),l&&l.apply(o,t),l=c&&o[c],l&&l.apply&&IT(o)&&(e.result=l.apply(o,t),e.result===!1&&e.preventDefault());return e.type=g,!n&&!e.isDefaultPrevented()&&(!u._default||u._default.apply(f.pop(),t)===!1)&&IT(r)&&c&&qu(r[g])&&!um(r)&&(a=r[c],a&&(r[c]=null),J.event.triggered=g,e.isPropagationStopped()&&d.addEventListener(g,Rk),r[g](),e.isPropagationStopped()&&d.removeEventListener(g,Rk),J.event.triggered=void 0,a&&(r[c]=a)),e.result}},simulate:function(e,t,r){var n=J.extend(new J.Event,r,{type:e,isSimulated:!0});J.event.trigger(n,null,t)}});J.fn.extend({trigger:function(e,t){return this.each(function(){J.event.trigger(e,t,this)})},triggerHandler:function(e,t){var r=this[0];if(r)return J.event.trigger(e,t,r,!0)}});Do.focusin||J.each({focus:"focusin",blur:"focusout"},function(e,t){var r=function(n){J.event.simulate(t,n.target,J.event.fix(n))};J.event.special[t]={setup:function(){var n=this.ownerDocument||this.document||this,i=ai.access(n,t);i||n.addEventListener(e,r,!0),ai.access(n,t,(i||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,i=ai.access(n,t)-1;i?ai.access(n,t,i):(n.removeEventListener(e,r,!0),ai.remove(n,t))}}});I4=/\[\]$/;J.param=function(e,t){var r,n=[],i=function(o,a){var s=qu(a)?a():a;n[n.length]=encodeURIComponent(o)+"="+encodeURIComponent(s==null?"":s)};if(e==null)return"";if(Array.isArray(e)||e.jquery&&!J.isPlainObject(e))J.each(e,function(){i(this.name,this.value)});else for(r in e)tP(r,e[r],t,i);return n.join("&")};J.offset={setOffset:function(e,t,r){var n,i,o,a,s,c,l,u=J.css(e,"position"),d=J(e),f={};u==="static"&&(e.style.position="relative"),s=d.offset(),o=J.css(e,"top"),c=J.css(e,"left"),l=(u==="absolute"||u==="fixed")&&(o+c).indexOf("auto")>-1,l?(n=d.position(),a=n.top,i=n.left):(a=parseFloat(o)||0,i=parseFloat(c)||0),qu(t)&&(t=t.call(e,r,J.extend({},s))),t.top!=null&&(f.top=t.top-s.top+a),t.left!=null&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):d.css(f)}};J.fn.extend({offset:function(e){if(arguments.length)return e===void 0?this:this.each(function(i){J.offset.setOffset(this,e,i)});var t,r,n=this[0];if(n)return n.getClientRects().length?(t=n.getBoundingClientRect(),r=n.ownerDocument.defaultView,{top:t.top+r.pageYOffset,left:t.left+r.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,r,n=this[0],i={top:0,left:0};if(J.css(n,"position")==="fixed")t=n.getBoundingClientRect();else{for(t=this.offset(),r=n.ownerDocument,e=n.offsetParent||r.documentElement;e&&(e===r.body||e===r.documentElement)&&J.css(e,"position")==="static";)e=e.parentNode;e&&e!==n&&e.nodeType===1&&(i=J(e).offset(),i.top+=J.css(e,"borderTopWidth",!0),i.left+=J.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-J.css(n,"marginTop",!0),left:t.left-i.left-J.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&J.css(e,"position")==="static";)e=e.offsetParent;return e||sm})}});J.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var r=t==="pageYOffset";J.fn[e]=function(n){return sb(this,function(i,o,a){var s;if(um(i)?s=i:i.nodeType===9&&(s=i.defaultView),a===void 0)return s?s[t]:i[o];s?s.scrollTo(r?s.pageXOffset:a,r?a:s.pageYOffset):i[o]=a},e,n,arguments.length)}});J.each(["top","left"],function(e,t){J.cssHooks[t]=Hk(Do.pixelPosition,function(r,n){if(n)return n=ab(r,t),rP.test(n)?J(r).position()[t]+"px":n})});J.each({Height:"height",Width:"width"},function(e,t){J.each({padding:"inner"+e,content:t,"":"outer"+e},function(r,n){J.fn[n]=function(i,o){var a=arguments.length&&(r||typeof i!="boolean"),s=r||(i===!0||o===!0?"margin":"border");return sb(this,function(c,l,u){var d;return um(c)?n.indexOf("outer")===0?c["inner"+e]:c.document.documentElement["client"+e]:c.nodeType===9?(d=c.documentElement,Math.max(c.body["scroll"+e],d["scroll"+e],c.body["offset"+e],d["offset"+e],d["client"+e])):u===void 0?J.css(c,l,s):J.style(c,l,u,s)},t,a?i:void 0,a)}})});J.fn.extend({bind:function(e,t,r){return this.on(e,null,t,r)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,r,n){return this.on(t,e,r,n)},undelegate:function(e,t,r){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",r)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});J.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){J.fn[t]=function(r,n){return arguments.length>0?this.on(t,null,r,n):this.trigger(t)}});C4=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;J.isArray=Array.isArray;J.parseJSON=JSON.parse;J.nodeName=am;J.isFunction=qu;J.isWindow=um;J.camelCase=Fu;J.type=ST;J.now=Date.now;J.isNumeric=function(e){var t=J.type(e);return(t==="number"||t==="string")&&!isNaN(e-parseFloat(e))};J.trim=function(e){return e==null?"":(e+"").replace(C4,"")};P4=window.jQuery,S4=window.$;J.noConflict=function(e){return window.$===J&&(window.$=S4),e&&window.jQuery===J&&(window.jQuery=P4),J};typeof noGlobal=="undefined"&&(window.jQuery=window.$=J);ze=J});var nP,Wk,fg,zu,zd=tn(()=>{nP=()=>{let e=typeof location!="undefined"?location.search:"";return new URLSearchParams(e)},Wk=()=>{let e=nP(),t=new Map;for(let[r,n]of e)t.set(r,n||"");return t},fg=e=>nP().get(e)||void 0,zu=(e,t=nP())=>t.has(e)&&t.get(e)!=="false"});function Xk(e,t){let n=new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(e);return n?decodeURIComponent(n[1].replace(/\+/g,"%20")):null}function M4(e,t){return new RegExp("[?|&]"+t+"(=|&|;|$)").test(e)}function D4(e,t,r){if(t!==encodeURIComponent(t))throw new Error("Programming error: parameter name should be URL-safe without encoding.");let n=encodeURIComponent(r);if(e.length){let i=e.split("#"),o=/\?/.test(e)?`${i[0]}&${t}=${n}`:`${i[0]}?${t}=${n}`;return i[1]!==void 0?`${o}#${i[1]}`:o}else return`?${t}=${n}`}function _4(e,t,r){let i=new RegExp("([?|&])"+t+"=([^&;]+?)(&|#|;|$)").exec(e);if(!i)return e;let o=i[1],a=i[2],s=`${o}${t}=${a}`,c=encodeURIComponent(r),l=`${o}${t}=${c}`;return e.replace(s,l)}function _T(e,t,r){return M4(e,t)?_4(e,t,r):D4(e,t,r)}var AT=tn(()=>{});function k4(e){let t=N4.exec(e);if(t){let r=t[1];return!R4.test(r)}return!1}function OT(e,t){var n;let r="";return t!==void 0?r=t:r=(n=fg("lang"))!=null?n:"",e===""||r===""||O4.test(e)||L4.test(e)||k4(e)?e:_T(e,"lang",r)}var O4,L4,N4,R4,Kk=tn(()=>{zd();AT();O4=/lang=[A-Za-z]+/,L4=/(cl|learn|help).desmos.com/,N4=/^(?:https?:)?(?:\/\/)?([^\s\/\?]+)/i,R4=/(^desmos\.com$)|(\.desmos.com$)/});var ft=Gd((kae,jk)=>{VR();Bd();Ck();fa();Kk();fl.addWarningHandler(e=>ib(e));fl.addCustomAttribute("href",e=>{let t=OT(e());return{value:`${OT(e())}`,bindings:{onMount(r){if(!["a","use"].includes(r.tagName.toLowerCase()))throw new Error("Cannot have an href on a non-link element.")},onUpdate(r){let n=OT(e());t!==n&&(t=n,r.setAttribute("href",n))}}}});fl.addCustomAttribute("onTap",e=>({value:"",bindings:{onMount(t){ze(t).on("dcg-tap",e)}}}));fl.addCustomAttribute("ignoreRealClick",e=>({bindings:{onMount(t){ze(t).on("click",function(r){e()&&r.preventDefault()})}}}));fl.addCustomAttribute("onTapStart",e=>({bindings:{onMount(t){ze(t).on("dcg-tapstart",e)}}}));fl.addCustomAttribute("onTapMove",e=>({bindings:{onMount(t){ze(t).on("dcg-tapmove",e)}}}));fl.addCustomAttribute("onTapEnd",e=>({bindings:{onMount(t){ze(t).on("dcg-tapend",e)}}}));fl.addCustomAttribute("onLongHold",e=>({bindings:{onMount(t){ze(t).on("dcg-longhold",e)}}}));fl.addCustomAttribute("manageFocus",e=>e()===void 0?{}:{bindings:{onMount(t){e().shouldBeFocused()&&t.focus(),t.onfocus=function(r){e().shouldBeFocused()||e().onFocusedChanged(!0,r)},t.onblur=function(r){e().shouldBeFocused()&&r.target!==document.activeElement&&e().onFocusedChanged(!1,r)}},onUpdate(t){let r=e().shouldBeFocused(),n=document.activeElement===t;r&&!n?t.focus():n&&!r&&t.blur()},willUnmount(t){t.onfocus=null,t.onblur=null}}});jk.exports=fl});var wF=Gd((Kce,TF)=>{TF.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var IF=Gd((jce,EF)=>{var t6=/([\w-]+)|=|(['"])([.\s\S]*?)\2/g,r6=wF();EF.exports=function(e){var t=0,r,n=!0,i={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return e.replace(t6,function(o){if(o==="="){n=!0,t++;return}n?t===0?((r6[o]||e.charAt(e.length-2)==="/")&&(i.voidElement=!0),i.name=o):(i.attrs[r]=o.replace(/^['"]|['"]$/g,""),r=void 0):(r&&(i.attrs[r]=r),r=o),t++,n=!1}),i}});var PF=Gd((Zce,CF)=>{var n6=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,i6=IF(),o6=Object.create?Object.create(null):{};function DP(e,t,r,n,i){var o=t.indexOf("<",n),a=t.slice(n,o===-1?void 0:o);/^\s*$/.test(a)&&(a=" "),(!i&&o>-1&&r+e.length>=0||a!==" ")&&e.push({type:"text",content:a})}CF.exports=function(t,r){r||(r={}),r.components||(r.components=o6);var n=[],i,o=-1,a=[],s={},c=!1;return t.replace(n6,function(l,u){if(c){if(l!=="</"+i.name+">")return;c=!1}var d=l.charAt(1)!=="/",f=l.indexOf("<!--")===0,g=u+l.length,y=t.charAt(g),x;d&&!f&&(o++,i=i6(l),i.type==="tag"&&r.components[i.name]&&(i.type="component",c=!0),!i.voidElement&&!c&&y&&y!=="<"&&DP(i.children,t,o,g,r.ignoreWhitespace),s[i.tagName]=i,o===0&&n.push(i),x=a[o-1],x&&x.children.push(i),a[o]=i),(f||!d||i.voidElement)&&(f||o--,!c&&y!=="<"&&y&&(x=o===-1?n:a[o].children,DP(x,t,o,g,r.ignoreWhitespace)))}),!n.length&&t.length&&DP(n,t,0,0,r.ignoreWhitespace),n}});var DF=Gd((Jce,MF)=>{function a6(e){var t=[];for(var r in e)t.push(r+'="'+e[r]+'"');return t.length?" "+t.join(" "):""}function SF(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?a6(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(SF,"")+"</"+t.name+">"}}MF.exports=function(e){return e.reduce(function(t,r){return t+SF("",r)},"")}});var AF=Gd((Qce,_F)=>{_F.exports={parse:PF(),stringify:DF()}});var OG=Gd(Vb=>{var bt=Vb&&Vb.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$0=Vb&&Vb.__assign||function(){return $0=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},$0.apply(this,arguments)};(function(){var e=-1,t=1,r=Math.min,n=Math.max;function i(){}function o(T){for(;T;){if(!T.parent)return T;T=T.parent}}function a(T,h,p){if(!h){var m=new Error("prayer failed: "+T);if(p){var v={};m.dcgExtraErrorMetaData=v;for(var M in p){var B=p[M],U=v[M]={};if(B){U.localLatex=B.latex();var X=o(B);X&&(U.rootLatex=X.latex())}else U.emptyNode=!0}}throw m}}function s(T){a("a direction was passed",T===e||T===t)}function c(T){var h=document.implementation.createHTMLDocument("");if(h.body.innerHTML=T,h.body.children.length===1)return h.body.children[0];for(var p=document.createDocumentFragment();h.body.firstChild;)p.appendChild(h.body.firstChild);return p}var l=function(h,p,m){var v;switch(h){case"svg":case"path":v=document.createElementNS("http://www.w3.org/2000/svg",h);break;default:v=document.createElement(h)}for(var M in p){var B=p[M];B!==void 0&&v.setAttribute(M,typeof B=="string"?B:String(B))}if(m)for(var U=0;U<m.length;U++)v.appendChild(m[U]);return v};l.text=function(T){return document.createTextNode(T)},l.block=function(T,h,p,m){var v=[p.html()];m!=null&&m.beforeChild&&v.unshift(m.beforeChild),m!=null&&m.afterChild&&v.push(m.afterChild);var M=l(T,h,v);return p.setDOM(M),ee.linkElementByBlockNode(M,p),M},l.entityText=function(T){var h=c(T);return a("entity parses to a single text node",h instanceof DocumentFragment&&h.childNodes.length===1&&h.childNodes[0]instanceof Text),h.childNodes[0]};function u(T,h){var p,m;if(typeof(T==null?void 0:T.closest)=="function")return T.closest(h);if(!(T instanceof HTMLElement))return null;var v=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,M=T;do{if(v.call(M,h))return M;M=(m=(p=M==null?void 0:M.parentElement)!==null&&p!==void 0?p:M==null?void 0:M.parentNode)!==null&&m!==void 0?m:null}while(M!==null&&M.nodeType===1);return null}var d="\xA0",f="\u200B",g="\u02D9",y="\u2211",x="\u220F",b="\u2210",w="\u222B";function E(T){return T.getClientRects().length?T.getBoundingClientRect():{top:0,left:0,height:0,width:0,x:0,y:0,bottom:0,right:0}}function I(){return window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function S(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}var D=function(){var T,h;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(T=requestAnimationFrame,h=cancelAnimationFrame):(T=function(p){return setTimeout(p,13)},h=clearTimeout),function(p,m){var v=Date.now(),M,B=0;function U(){var Ce=(Date.now()-v)/p;Ce<=B?te():B=Ce,m(B,te,X)}function X(){M!==void 0&&h(M),M=void 0}function te(){X(),M=T(U)}m(p<=0?1:0,te,X)}}(),O=function(){function T(h){this.span=l("span",{class:"dcg-mq-aria-alert","aria-live":"assertive","aria-atomic":"true"}),this.msg="",this.items=[],this.controller=h}return T.prototype.attach=function(){var h=this.controller.container;this.span.parentNode!==h&&A(h).prepend(A(this.span))},T.prototype.queue=function(h,p){p===void 0&&(p=!1);var m="";if(h instanceof Ga){var v=h.mathspeak({ignoreShorthand:!0});p&&(h.parent&&h.parent.ariaLabel&&h.ariaLabel==="block"?m=h.parent.ariaLabel+" "+v:h.ariaLabel&&(m=h.ariaLabel+" "+v)),m===""&&(m=v)}else m=h||"";return this.items.push(m),this},T.prototype.queueDirOf=function(h){return s(h),this.queue(h===e?"before":"after")},T.prototype.queueDirEndOf=function(h){return s(h),this.queue(h===e?"beginning of":"end of")},T.prototype.alert=function(h){return this.attach(),h&&this.queue(h),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.controller.containerHasFocus()&&(this.controller.options.logAriaAlerts&&this.msg&&console.log(this.msg),this.span.textContent=this.msg)),this.clear()},T.prototype.clear=function(){return this.items.length=0,this},T}(),_=function(){function T(h,p){var m;arguments.length===1&&(p=h),!(!h||!p)&&(this.ends=(m={},m[e]=h,m[t]=p,m))}return T.create=function(h,p){arguments.length===1&&(p=h),a("No half-empty DOMFragments",!!h==!!p);var m=new T(h,p);return a("last is a forward sibling of first",m.isValid()),m},T.prototype.isEmpty=function(){return this.ends===void 0},T.prototype.isOneNode=function(){return!!(this.ends&&this.ends[e]===this.ends[t])},T.prototype.isValid=function(){if(!this.ends||this.ends[e]===this.ends[t])return!0;var h;return this.eachNode(function(p){return h=p}),h===this.ends[t]},T.prototype.firstNode=function(){return a("Fragment is not empty",this.ends),this.ends[e]},T.prototype.lastNode=function(){return a("Fragment is not empty",this.ends),this.ends[t]},T.prototype.children=function(){var h=this.oneNode(),p=h.firstChild,m=h.lastChild;return p&&m?new T(p,m):new T},T.prototype.join=function(h){if(!this.ends)return h;if(!h.ends)return this;for(var p=!1,m=this.ends[t].nextSibling;m;){if(m===h.ends[e]){p=!0;break}m=m.nextSibling}return a("sibling must be a forward DOM sibling of this fragment",p),new T(this.ends[e],h.ends[t])},T.prototype.oneNode=function(){return a("Fragment has a single node",this.ends&&this.ends[e]===this.ends[t]),this.ends[e]},T.prototype.oneElement=function(){var h=this.oneNode();return a("Node is an Element",h.nodeType===Node.ELEMENT_NODE),h},T.prototype.oneText=function(){var h=this.oneNode();return a("Node is Text",h.nodeType===Node.TEXT_NODE),h},T.prototype.eachNode=function(h){if(!this.ends)return this;for(var p=this.ends[t],m=this.ends[e],v=void 0;m&&(v=m.nextSibling,h(m),m!==p);m=v);return this},T.prototype.eachElement=function(h){return this.eachNode(function(p){p.nodeType===Node.ELEMENT_NODE&&h(p)}),this},T.prototype.text=function(){var h="";return this.eachNode(function(p){h+=p.textContent||""}),h},T.prototype.toNodeArray=function(){var h=[];return this.eachNode(function(p){return h.push(p)}),h},T.prototype.toElementArray=function(){var h=[];return this.eachElement(function(p){return h.push(p)}),h},T.prototype.toDocumentFragment=function(){var h=document.createDocumentFragment();return this.eachNode(function(p){return h.appendChild(p)}),h},T.prototype.insertBefore=function(h){return this.insDirOf(e,h)},T.prototype.insertAfter=function(h){return this.insDirOf(t,h)},T.prototype.append=function(h){return h.appendTo(this.oneElement()),this},T.prototype.prepend=function(h){return h.prependTo(this.oneElement()),this},T.prototype.appendTo=function(h){return this.insAtDirEnd(t,h)},T.prototype.prependTo=function(h){return this.insAtDirEnd(e,h)},T.prototype.parent=function(){if(!this.ends)return this;var h=this.ends[e].parentNode;return h?new T(h):new T},T.prototype.wrapAll=function(h){if(h.textContent="",!this.ends)return this;var p=this.ends[e].parentNode,m=this.ends[t].nextSibling;return this.appendTo(h),p&&p.insertBefore(h,m),this},T.prototype.replaceWith=function(h){var p,m=(p=this.ends)===null||p===void 0?void 0:p[t],v=m==null?void 0:m.parentNode,M=m==null?void 0:m.nextSibling;this.detach();var B=h.toDocumentFragment();return!m||!v?this:(v.insertBefore(B,M||null),this)},T.prototype.nthElement=function(h){if(this.ends&&!(h<0||h!==Math.floor(h)))for(var p=this.ends[e];p;){if(p.nodeType===Node.ELEMENT_NODE){if(h<=0)return p;h-=1}if(p===this.ends[t])return;p=p.nextSibling}},T.prototype.firstElement=function(){return this.nthElement(0)},T.prototype.lastElement=function(){if(this.ends)for(var h=this.ends[t];h;){if(h.nodeType===Node.ELEMENT_NODE)return h;if(h===this.ends[e])return;h=h.previousSibling}},T.prototype.first=function(){return new T(this.firstElement())},T.prototype.last=function(){return new T(this.lastElement())},T.prototype.eq=function(h){return new T(this.nthElement(h))},T.prototype.slice=function(h){if(!this.ends)return this;var p=this.nthElement(h);return p?new T(p,this.ends[t]):new T},T.prototype.next=function(){for(var h=this.oneNode();h;)if(h=h.nextSibling,h&&h.nodeType===Node.ELEMENT_NODE)return new T(h);return new T},T.prototype.prev=function(){for(var h=this.oneNode();h;)if(h=h.previousSibling,h&&h.nodeType===Node.ELEMENT_NODE)return new T(h);return new T},T.prototype.empty=function(){return this.eachElement(function(h){h.textContent=""}),this},T.prototype.remove=function(){return this.toDocumentFragment(),this},T.prototype.detach=function(){return this.remove()},T.prototype.insDirOf=function(h,p){var m;if(!this.ends)return this;var v=(m=p.ends)===null||m===void 0?void 0:m[h];return!v||!v.parentNode?this.detach():(R(h,v.parentNode,this.toDocumentFragment(),v),this)},T.prototype.insAtDirEnd=function(h,p){return this.ends?(W(h,this.toDocumentFragment(),p),this):this},T.prototype.hasClass=function(h){var p=!1;return this.eachElement(function(m){m.classList.contains(h)&&(p=!0)}),p},T.prototype.addClass=function(h){for(var p=function(U){if(!U)return"continue";m.eachElement(function(X){X.classList.add(U)})},m=this,v=0,M=h.split(/\s+/);v<M.length;v++){var B=M[v];p(B)}return this},T.prototype.removeClass=function(h){for(var p=function(U){if(!U)return"continue";m.eachElement(function(X){X.classList.remove(U)})},m=this,v=0,M=h.split(/\s+/);v<M.length;v++){var B=M[v];p(B)}return this},T.prototype.toggleClass=function(h,p){if(p===!0)return this.addClass(h);if(p===!1)return this.removeClass(h);for(var m=function(X){if(!X)return"continue";v.eachElement(function(te){te.classList.toggle(X)})},v=this,M=0,B=h.split(/\s+/);M<B.length;M++){var U=B[M];m(U)}return this},T}(),A=_.create;function R(T,h,p,m){h.insertBefore(p,T===e?m:m.nextSibling)}function W(T,h,p){T===e?p.insertBefore(h,p.firstChild):p.appendChild(h)}var j=function(){function T(h,p,m){this.init(h,p,m)}return T.prototype.init=function(h,p,m){this.parent=h,this[e]=p,this[t]=m},T.copy=function(h){return new T(h.parent,h[e],h[t])},T}();function Q(T,h){var p=T[e];if(p){var m=T[t];if(m)for(m=m[t];p!==m;p=p[t]){var v=h(p);if(v===!1)break}}}function ce(T,h,p){var m=T[e];if(!m)return h;var v=T[t];if(!v)return h;for(v=v[t];m!==v;m=m[t])h=p(h,m);return h}var ee=function(){function T(){var m;this[h]=0,this[p]=0,this.parent=0,this.ends=(m={},m[e]=0,m[t]=0,m),this.id=T.uniqueNodeId()}T.uniqueNodeId=function(){return T.idCounter+=1},T.getNodeOfElement=function(m){if(m){if(!m.nodeType)throw new Error("must pass an Element to NodeBase.getNodeOfElement");var v=m;return v.mqBlockNode||v.mqCmdNode}},T.linkElementByBlockNode=function(m,v){m.mqBlockNode=v},T.linkElementByCmdNode=function(m,v){m.mqCmdNode=v},T.prototype.setEnds=function(m){this.ends=m,a("No half-empty node ends",!!this.ends[e]==!!this.ends[t])},T.prototype.getEnd=function(m){return this.ends[m]},T.prototype.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},T.prototype.setDOM=function(m){return m&&a("DOM is an element or a text node",m.nodeType===Node.ELEMENT_NODE||m.nodeType===Node.TEXT_NODE),this._el=m,this},T.prototype.domFrag=function(){return A(this._el)},T.prototype.createDir=function(m,v){s(m);var M=this;return M.html(),M.domFrag().insDirOf(m,v.domFrag()),v[m]=M.adopt(v.parent,v[e],v[t]),M},T.prototype.createLeftOf=function(m){this.createDir(e,m)},T.prototype.selectChildren=function(m,v){return new Vt(m,v)},T.prototype.bubble=function(m){for(var v=this.getSelfNode(),M=v;M;M=M.parent){var B=m(M);if(B===!1)break}return this},T.prototype.postOrder=function(m){var v=this.getSelfNode();return function M(B){return B?(B.eachChild(M),m(B),!0):!1}(v),v},T.prototype.isEmpty=function(){return this.ends[e]===0&&this.ends[t]===0},T.prototype.isQuietEmptyDelimiter=function(m){if(!this.isEmpty()||!m||!this.parent||this.parent.ctrlSeq===void 0)return!1;var v=this.parent.ctrlSeq.replace(/^\\(left|right)?/,"");return m.hasOwnProperty(v)},T.prototype.isStyleBlock=function(){return!1},T.prototype.isTextBlock=function(){return!1},T.prototype.children=function(){return new re(this.getEnd(e),this.getEnd(t))},T.prototype.eachChild=function(m){return Q(this.ends,m),this},T.prototype.foldChildren=function(m,v){return ce(this.ends,m,v)},T.prototype.withDirAdopt=function(m,v,M,B){var U=this.getSelfNode();return new re(U,U).withDirAdopt(m,v,M,B),this},T.prototype.adopt=function(m,v,M){var B=this.getSelfNode();return new re(B,B).adopt(m,v,M),this.getSelfNode()},T.prototype.disown=function(){var m=this.getSelfNode();return new re(m,m).disown(),this},T.prototype.remove=function(){return this.domFrag().remove(),this.disown()},T.prototype.shouldIgnoreSubstitutionInSimpleSubscript=function(m){return!(!m.disableAutoSubstitutionInSubscripts||!this.parent||!(this.parent.parent instanceof tc)||!this.parent.domFrag().hasClass("dcg-mq-sub"))},T.prototype.getSelfNode=function(){return this},T.prototype.parser=function(){a("Abstract parser() method is never called",!1)},T.prototype.html=function(){throw new Error("html() unimplemented in NodeBase")},T.prototype.text=function(){return""},T.prototype.latex=function(){var m={latex:"",startIndex:-1,endIndex:-1};return this.latexRecursive(m),m.latex},T.prototype.latexRecursive=function(m){},T.prototype.checkCursorContextOpen=function(m){m.startSelectionBefore===this&&(m.startIndex=m.latex.length),m.endSelectionBefore===this&&(m.endIndex=m.latex.length)},T.prototype.checkCursorContextClose=function(m){m.startSelectionAfter===this&&(m.startIndex=m.latex.length),m.endSelectionAfter===this&&(m.endIndex=m.latex.length)},T.prototype.finalizeTree=function(m,v){},T.prototype.contactWeld=function(m,v){},T.prototype.blur=function(m){},T.prototype.focus=function(){},T.prototype.intentionalBlur=function(){},T.prototype.reflow=function(){},T.prototype.registerInnerField=function(m,v){},T.prototype.chToCmd=function(m,v){a("Abstract chToCmd() method is never called",!1)},T.prototype.mathspeak=function(m){return""},T.prototype.seek=function(m,v){},T.prototype.siblingDeleted=function(m,v){},T.prototype.siblingCreated=function(m,v){},T.prototype.finalizeInsert=function(m,v){},T.prototype.fixDigitGrouping=function(m){},T.prototype.writeLatex=function(m,v){},T.prototype.write=function(m,v){};var h,p;return h=e,p=t,T.idCounter=0,T}();function pe(T,h,p){a("a parent is always present",T),a("leftward is properly set up",function(){return h?h[t]===p&&h.parent===T:T.getEnd(e)===p}(),{parent:T,leftward:h,leftwardL:h&&h[e],leftwardR:h&&h[t],rightwardL:p&&p[e],rightwardR:p&&p[t]}),a("rightward is properly set up",function(){return p?p[e]===h&&p.parent===T:T.getEnd(t)===h}(),{parent:T,rightward:p,leftwardL:h&&h[e],leftwardR:h&&h[t],rightwardL:p&&p[e],rightwardR:p&&p[t],rightwardParent:p&&p.parent})}var re=function(){function T(h,p,m){var v,M;if(this.disowned=!1,m===void 0&&(m=e),s(m),a("no half-empty fragments",!h==!p,{withDir:h,oppDir:p}),!h||!p){this.setEnds((v={},v[e]=0,v[t]=0,v));return}a("withDir is passed to Fragment",h instanceof Ga),a("oppDir is passed to Fragment",p instanceof Ga),a("withDir and oppDir have the same parent",h.parent===p.parent);var B=(M={},M[m]=h,M[-m]=p,M);this.setEnds(B);var U=0;this.each(function(X){U=X}),a("following direction siblings from start reaches end",U===B[t])}return T.prototype.getDOMFragFromEnds=function(){var h=this.ends[e],p=this.ends[t];return h===0||p===0?A():h===p?h.domFrag():h.domFrag().join(p.domFrag())},T.prototype.setEnds=function(h){this.ends=h},T.prototype.getEnd=function(h){return this.ends?this.ends[h]:0},T.prototype.domFrag=function(){return this.getDOMFragFromEnds()},T.prototype.withDirAdopt=function(h,p,m,v){return h===e?this.adopt(p,m,v):this.adopt(p,v,m)},T.prototype.adopt=function(h,p,m){var v;pe(h,p,m);var M=this;this.disowned=!1;var B=M.ends[e];if(!B)return this;var U=M.ends[t];if(!U)return this;var X=(v={},v[e]=h.getEnd(e),v[t]=h.getEnd(t),v);return p||(X[e]=B),m?m[e]=U:X[t]=U,h.setEnds(X),U[t]=m,M.each(function(te){return te[e]=p,te.parent=h,p&&(p[t]=te),p=te,!0}),M},T.prototype.disown=function(){var h,p=this,m=p.ends[e];if(!m||p.disowned)return p;this.disowned=!0;var v=p.ends[t];if(!v)return p;var M=m.parent;pe(M,m[e],m),pe(M,v,v[t]);var B=(h={},h[e]=M.getEnd(e),h[t]=M.getEnd(t),h);if(m[e]){var U=m[e];U[t]=v[t]}else B[e]=v[t];if(v[t]){var X=v[t];X[e]=m[e]}else B[t]=m[e];return B[e]&&B[t]?M.setEnds(B):M.ends=B,p},T.prototype.remove=function(){return this.domFrag().remove(),this.disown()},T.prototype.each=function(h){return Q(this.ends,h),this},T.prototype.fold=function(h,p){return ce(this.ends,h,p)},T}(),k={},Ke={};function ht(T){return T&&T.prototype instanceof Ga}var Ze=function(T){bt(h,T);function h(p,m,v){var M=T.call(this,p,m,v)||this;return M.ancestors={},M}return h.fromCursor=function(p){return new h(p.parent,p[e],p[t])},h}(j),Te=function(T){bt(h,T);function h(p,m,v){var M=T.call(this,p,0,0)||this;return M.upDownCache={},M.cursorElement=l("span",{class:"dcg-mq-cursor"},[l.text(f)]),M._domFrag=A(),M.controller=v,M.options=m,M.setDOMFrag(A(M.cursorElement)),M.blink=function(){A(M.cursorElement).toggleClass("dcg-mq-blink")},M}return h.prototype.setDOMFrag=function(p){return this._domFrag=p,this},h.prototype.domFrag=function(){return this._domFrag},h.prototype.show=function(){if(A(this.cursorElement).removeClass("dcg-mq-blink"),this.setDOMFrag(A(this.cursorElement)),this.intervalId)clearInterval(this.intervalId);else{var p=this[t];if(p){var m=this.selection;m&&m.getEnd(e)[e]===this[e]?this.domFrag().insertBefore(m.domFrag()):this.domFrag().insertBefore(p.domFrag())}else this.domFrag().appendTo(this.parent.domFrag().oneElement());this.parent.focus()}return this.intervalId=setInterval(this.blink,500),this},h.prototype.hide=function(){return this.intervalId&&clearInterval(this.intervalId),this.intervalId=0,this.domFrag().detach(),this.setDOMFrag(A()),this},h.prototype.withDirInsertAt=function(p,m,v,M){var B=this.parent;this.parent=m,this[p]=v,this[-p]=M,B!==m&&B.blur&&B.blur(this)},h.prototype.insDirOf=function(p,m){return s(p),this.domFrag().insDirOf(p,m.domFrag()),this.withDirInsertAt(p,m.parent,m[p],m),this.parent.domFrag().addClass("dcg-mq-hasCursor"),this},h.prototype.insLeftOf=function(p){return this.insDirOf(e,p)},h.prototype.insRightOf=function(p){return this.insDirOf(t,p)},h.prototype.insAtDirEnd=function(p,m){return s(p),this.domFrag().insAtDirEnd(p,m.domFrag().oneElement()),this.withDirInsertAt(p,m,0,m.getEnd(p)),m.focus(),this},h.prototype.insAtLeftEnd=function(p){return this.insAtDirEnd(e,p)},h.prototype.insAtRightEnd=function(p){return this.insAtDirEnd(t,p)},h.prototype.jumpUpDown=function(p,m){var v=this;v.upDownCache[p.id]=j.copy(v);var M=v.upDownCache[m.id];if(M){var B=M[t];B?v.insLeftOf(B):v.insAtRightEnd(M.parent)}else{var U=v.getBoundingClientRectWithoutMargin().left;m.seek(U,v)}v.controller.aria.queue(m,!0)},h.prototype.getBoundingClientRectWithoutMargin=function(){var p=this.domFrag();p.removeClass("dcg-mq-cursor");var m=E(p.oneElement()),v=m.left,M=m.right;return p.addClass("dcg-mq-cursor"),{left:v,right:M}},h.prototype.unwrapGramp=function(){var p=this.parent.parent,m=p.parent,v=p[t],M=this,B=p[e];if(p.disown().eachChild(function(ge){return ge.isEmpty()||(ge.children().adopt(m,B,v).each(function(_e){return _e.domFrag().insertBefore(p.domFrag()),!0}),B=ge.getEnd(t)),!0}),!this[t]){var U=this[e];if(U)this[t]=U[t];else for(;!this[t];){var X=this.parent[t];if(X)this.parent=X,this[t]=X.getEnd(e);else{this[t]=p[t],this.parent=m;break}}}var te=this[t];te?this.insLeftOf(te):this.insAtRightEnd(m),p.domFrag().remove();var Ce=p[e],ve=p[t];Ce&&Ce.siblingDeleted(M.options,t),ve&&ve.siblingDeleted(M.options,e)},h.prototype.startSelection=function(){for(var p=this.anticursor=Ze.fromCursor(this),m=p.ancestors,v=p;v.parent;v=v.parent)m[v.parent.id]=v},h.prototype.endSelection=function(){delete this.anticursor},h.prototype.select=function(){var p,m=this.anticursor;if(this[e]===m[e]&&this.parent===m.parent)return!1;for(var v=this;v.parent;v=v.parent)if(v.parent.id in m.ancestors){p=v.parent;break}a("cursor and anticursor in the same tree",p);var M=p,B=m.ancestors[M.id],U,X,te=t;if(v[e]!==B){for(var Ce=v;Ce;Ce=Ce[t])if(Ce[t]===B[t]){te=e,U=v,X=B;break}}te===t&&(U=B,X=v),U instanceof j&&(U=U[t]),X instanceof j&&(X=X[e]),this.hide().selection=M.selectChildren(U,X);var ve=this.selection.getEnd(te);return this.insDirOf(te,ve),this.selectionChanged(),!0},h.prototype.resetToEnd=function(p){this.clearSelection();var m=p.root;this[t]=0,this[e]=m.getEnd(t),this.parent=m},h.prototype.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},h.prototype.deleteSelection=function(){var p=this.selection;p&&(this[e]=p.getEnd(e)[e],this[t]=p.getEnd(t)[t],p.remove(),this.selectionChanged(),delete this.selection)},h.prototype.replaceSelection=function(){var p=this.selection;return p&&(this[e]=p.getEnd(e)[e],this[t]=p.getEnd(t)[t],delete this.selection),p},h.prototype.depth=function(){for(var p=this,m=0;p=p.parent;)m+=p instanceof Ba?1:0;return m},h.prototype.isTooDeep=function(p){return this.options.maxDepth!==void 0?this.depth()+(p||0)>this.options.maxDepth:!1},h.prototype.selectionChanged=function(){},h}(j),Vt=function(T){bt(h,T);function h(p,m,v){var M=T.call(this,p,m,v)||this;return M._el=l("span",{class:"dcg-mq-selection"}),M.getDOMFragFromEnds().wrapAll(M._el),M}return h.prototype.isCleared=function(){return this._el===void 0},h.prototype.domFrag=function(){return this.isCleared()?this.getDOMFragFromEnds():A(this._el)},h.prototype.setEnds=function(p){a("Selection ends are never empty",p[e]&&p[t]),this.ends=p},h.prototype.getEnd=function(p){return this.ends[p]},h.prototype.adopt=function(p,m,v){return this.clear(),T.prototype.adopt.call(this,p,m,v)},h.prototype.clear=function(){var p=this.getDOMFragFromEnds();return this.domFrag().replaceWith(p),this._el=void 0,this},h.prototype.join=function(p,m){return m===void 0&&(m=""),this.fold("",function(v,M){return v+m+M[p]()})},h}(re),yt=function(){function T(h,p,m){this.textareaEventListeners={},this.id=h.id,this.data={},this.root=h,this.container=p,this.options=m,this.aria=new O(this.getControllerSelf()),this.ariaLabel="Math Input",this.ariaPostLabel="",h.controller=this.getControllerSelf(),this.cursor=h.cursor=new Te(h,m,this.getControllerSelf())}return T.prototype.getControllerSelf=function(){return this},T.prototype.handle=function(h,p){var m,v=this.options.handlers,M=(m=this.options.handlers)===null||m===void 0?void 0:m.fns[h];if(M){var B=v==null?void 0:v.APIClasses[this.KIND_OF_MQ];a("APIClass is defined",B);var U=new B(this);p===e||p===t?M(p,U):M(U)}},T.onNotify=function(h){T.notifyees.push(h)},T.prototype.notify=function(h){for(var p=0;p<T.notifyees.length;p+=1)T.notifyees[p](this.cursor,h);return this},T.prototype.setAriaLabel=function(h){var p=this.getAriaLabel();return h&&typeof h=="string"&&h!==""?this.ariaLabel=h:this.editable?this.ariaLabel="Math Input":this.ariaLabel="",this.ariaLabel!==p&&!this.containerHasFocus()&&this.updateMathspeak(),this},T.prototype.getAriaLabel=function(){return this.ariaLabel!=="Math Input"?this.ariaLabel:this.editable?"Math Input":""},T.prototype.setAriaPostLabel=function(h,p){var m=this;return h&&typeof h=="string"&&h!==""?(h!==this.ariaPostLabel&&typeof p=="number"&&(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this._ariaAlertTimeout=setTimeout(function(){m.containerHasFocus()?m.aria.alert(m.root.mathspeak().trim()+" "+h.trim()):m.updateMathspeak()},p)),this.ariaPostLabel=h):(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this.ariaPostLabel=""),this},T.prototype.getAriaPostLabel=function(){return this.ariaPostLabel||""},T.prototype.containerHasFocus=function(){return document.activeElement&&this.container.contains(document.activeElement)},T.prototype.getTextareaOrThrow=function(){var h=this.textarea;if(!h)throw new Error("expected a textarea");return h},T.prototype.getTextareaSpanOrThrow=function(){var h=this.textareaSpan;if(!h)throw new Error("expected a textareaSpan");return h},T.prototype.addTextareaEventListeners=function(h){if(this.textarea)for(var p in h){var m=p;this.removeTextareaEventListener(m),this.textarea.addEventListener(m,h[m])}},T.prototype.removeTextareaEventListener=function(h){if(this.textarea){var p=this.textareaEventListeners[h];p&&this.textarea.removeEventListener(h,p)}},T.prototype.exportMathSpeak=function(){return this.root.mathspeak()},T.prototype.updateMathspeak=function(){},T.prototype.scrollHoriz=function(){},T.prototype.selectionChanged=function(){},T.prototype.setOverflowClasses=function(){},T.notifyees=[],T}(),qe={},at={},Ne={handlers:!0,autoCommands:!0,quietEmptyDelimiters:!0,autoParenthesizedFunctions:!0,autoOperatorNames:!0,infixOperatorNames:!0,prefixOperatorNames:!0,leftRightIntoCmdGoes:!0,maxDepth:!0,interpretTildeAsSim:!0},he={},ie=function(){function T(h){this.version=h}return T.prototype.assertJquery=function(){return a("Interface versions > 2 do not depend on JQuery",this.version<=2),a("JQuery is set for interface v < 3",this.jQuery),this.jQuery},T}(),ct=function(){function T(){}return T}(),je=function(){window.console&&console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Fe;function Je(T){return je(),Fe||(Fe=Qe(1)),Fe(T)}Je.prototype=ct.prototype,Je.VERSION="v0.10.1",Je.interfaceVersion=function(T){if(T!==1)throw"Only interface version 1 supported. You specified: "+T;return je=function(){window.console&&console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},je(),Je},Je.getInterface=Qe;var er=Qe.MIN=1,wt=Qe.MAX=3;function Qe(T){if(T!==1&&T!==2&&T!==3)throw"Only interface versions between "+er+" and "+wt+" supported. You specified: "+T;var h=T;if(h<3){var p=window.jQuery;if(!p)throw"MathQuill interface version ".concat(h," requires jQuery 1.5.2+ to be loaded first");ie.prototype.jQuery=p}var m=$0($0({},he),{handlers:function(ve){return{fns:ve||{},APIClasses:X}}});function v(ve,ge){for(var _e in ge)if(ge.hasOwnProperty(_e)){if(_e==="substituteKeyboardEvents"&&h>=3)throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'","option is no longer supported. Use 'overrideTypedText' and","'overrideKeystroke' instead."].join(" "));var Ae=ge[_e],nt=m[_e];ve[_e]=nt?nt(Ae):Ae}}var M=h<3?ie:function(ve){bt(ge,ve);function ge(){return ve!==null&&ve.apply(this,arguments)||this}return ge}(ie),B=function(ve){bt(ge,ve);function ge(_e){var Ae=ve.call(this)||this;return Ae.__controller=_e,Ae.__options=_e.options,Ae.id=_e.id,Ae.data=_e.data,Ae}return ge.prototype.mathquillify=function(_e){var Ae=this.__controller,nt=Ae.root,gt=Ae.container;Ae.createTextarea();var lt=A(gt).addClass(_e).children().detach();nt.setDOM(A(l("span",{class:"dcg-mq-root-block","aria-hidden":!0})).appendTo(gt).oneElement()),ee.linkElementByBlockNode(nt.domFrag().oneElement(),nt),this.latex(lt.text()),this.revert=function(){return Ae.removeMouseEventListener(),A(gt).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(lt),h<3?this.__options.assertJquery()(gt):gt}},ge.prototype.setAriaLabel=function(_e){return this.__controller.setAriaLabel(_e),this},ge.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},ge.prototype.config=function(_e){return v(this.__options,_e),this},ge.prototype.el=function(){return this.__controller.container},ge.prototype.text=function(){return this.__controller.exportText()},ge.prototype.mathspeak=function(){return this.__controller.exportMathSpeak()},ge.prototype.latex=function(_e){if(arguments.length>0){this.__controller.renderLatexMath(_e);var Ae=this.__controller.cursor;return this.__controller.blurred&&Ae.hide().parent.blur(Ae),this}return this.__controller.exportLatex()},ge.prototype.selection=function(){return this.__controller.exportLatexSelection()},ge.prototype.html=function(){return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},ge.prototype.reflow=function(){return this.__controller.root.postOrder(function(_e){_e.reflow()}),this},ge}(ct),U=function(ve){bt(ge,ve);function ge(){return ve!==null&&ve.apply(this,arguments)||this}return ge.prototype.mathquillify=function(_e){return ve.prototype.mathquillify.call(this,_e),this.__controller.editable=!0,this.__controller.addMouseEventListener(),this.__controller.editablesTextareaEvents(),this},ge.prototype.focus=function(){return this.__controller.getTextareaOrThrow().focus(),this.__controller.scrollHoriz(),this},ge.prototype.blur=function(){return this.__controller.getTextareaOrThrow().blur(),this},ge.prototype.write=function(_e){this.__controller.writeLatex(_e),this.__controller.scrollHoriz();var Ae=this.__controller.cursor;return this.__controller.blurred&&Ae.hide().parent.blur(Ae),this},ge.prototype.empty=function(){var _e,Ae=this.__controller.root,nt=this.__controller.cursor;return Ae.setEnds((_e={},_e[e]=0,_e[t]=0,_e)),Ae.domFrag().empty(),delete nt.selection,nt.insAtRightEnd(Ae),this},ge.prototype.cmd=function(_e){var Ae=this.__controller.notify(void 0),nt=Ae.cursor;if(/^\\[a-z]+$/i.test(_e)&&!nt.isTooDeep()){_e=_e.slice(1);var gt=k[_e],lt;gt&&(gt.constructor?lt=new gt(_e):lt=gt(_e),nt.selection&&lt.replaces(nt.replaceSelection()),lt.createLeftOf(nt.show()))}else nt.parent.write(nt,_e);return Ae.scrollHoriz(),Ae.blurred&&nt.hide().parent.blur(nt),this},ge.prototype.select=function(){return this.__controller.selectAll(),this},ge.prototype.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},ge.prototype.moveToDirEnd=function(_e){return this.__controller.notify("move").cursor.insAtDirEnd(_e,this.__controller.root),this},ge.prototype.moveToLeftEnd=function(){return this.moveToDirEnd(e)},ge.prototype.moveToRightEnd=function(){return this.moveToDirEnd(t)},ge.prototype.keystroke=function(_e,Ae){for(var nt=_e.replace(/^\s+|\s+$/g,"").split(/\s+/),gt=0;gt<nt.length;gt+=1)this.__controller.keystroke(nt[gt],Ae);return this},ge.prototype.typedText=function(_e){for(var Ae=0;Ae<_e.length;Ae+=1)this.__controller.typedText(_e.charAt(Ae));return this},ge.prototype.dropEmbedded=function(_e,Ae,nt){var gt=_e-I(),lt=Ae-S(),P=document.elementFromPoint(gt,lt);this.__controller.seek(P,gt,lt);var V=new sT().setOptions(nt);V.createLeftOf(this.__controller.cursor)},ge.prototype.setAriaPostLabel=function(_e,Ae){return this.__controller.setAriaPostLabel(_e,Ae),this},ge.prototype.getAriaPostLabel=function(){return this.__controller.getAriaPostLabel()},ge.prototype.clickAt=function(_e,Ae,nt){nt=nt||document.elementFromPoint(_e,Ae);var gt=this.__controller,lt=gt.root,P=lt.domFrag().oneElement();return P.contains(nt)||(nt=P),gt.seek(nt,_e,Ae),gt.blurred&&this.focus(),this},ge.prototype.ignoreNextMousedown=function(_e){return this.__controller.cursor.options.ignoreNextMousedown=_e,this},ge}(B),X={AbstractMathQuill:B,EditableField:U};a("API.StaticMath defined",qe.StaticMath),X.StaticMath=qe.StaticMath(X),a("API.MathField defined",qe.MathField),X.MathField=qe.MathField(X),a("API.InnerMathField defined",qe.InnerMathField),X.InnerMathField=qe.InnerMathField(X),qe.TextField&&(X.TextField=qe.TextField(X));var te=function(ve){if(!ve||!ve.nodeType)return null;for(var ge,_e=A(ve).children().toElementArray(),Ae=0,nt=_e;Ae<nt.length;Ae++){var gt=nt[Ae];if(gt.classList.contains("dcg-mq-root-block")){ge=gt;break}}var lt=ee.getNodeOfElement(ge),P=lt&&lt.controller,V=P&&X[P.KIND_OF_MQ];return P&&V?new V(P):null};te.L=e,te.R=t,te.config=function(ve){return v(M.prototype,ve),this},te.registerEmbed=function(ve,ge){if(!/^[a-z][a-z0-9]*$/i.test(ve))throw"Embed name must start with letter and be only letters and digits";at[ve]=ge},te.StaticMath=Ce("StaticMath",X.StaticMath),te.MathField=Ce("MathField",X.MathField),te.InnerMathField=Ce("InnerMathField",X.InnerMathField),X.TextField&&(te.TextField=Ce("TextField",X.TextField)),te.prototype=B.prototype,te.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},te.EditableField.prototype=U.prototype,h<3&&(te.saneKeyboardEvents=Fy);function Ce(ve,ge){a(ve+" is defined",ge);function _e(Ae,nt){if(!Ae||!Ae.nodeType)return null;var gt=te(Ae);if(gt instanceof ge)return gt;var lt=new Gy(new ge.RootBlock,Ae,new M(h));return lt.KIND_OF_MQ=ve,new ge(lt).__mathquillify(nt||{},h)}return _e.prototype=ge.prototype,_e}return te}Je.noConflict=function(){return window.MathQuill=zt,Je};var zt=window.MathQuill;window.MathQuill=Je;function Ms(T){T.moveOutOf=function(h){a("controller is defined",this.controller),this.controller.handle("moveOutOf",h)},T.deleteOutOf=function(h){a("controller is defined",this.controller),this.controller.handle("deleteOutOf",h)},T.selectOutOf=function(h){a("controller is defined",this.controller),this.controller.handle("selectOutOf",h)},T.upOutOf=function(){a("controller is defined",this.controller),this.controller.handle("upOutOf")},T.downOutOf=function(){a("controller is defined",this.controller),this.controller.handle("downOutOf")},T.reflow=function(){a("controller is defined",this.controller),this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function Qs(T,h){throw T?T="'"+T+"'":T="EOF","Parse Error: "+h+" at "+T}var Ft=function(){function T(h){this._=h}return T.prototype.parse=function(h){return this.skip(T.eof)._(""+h,p,Qs);function p(m,v){return v}},T.prototype.or=function(h){a("or is passed a parser",h instanceof T);var p=this;return new T(function(m,v,M){return p._(m,v,B);function B(U){return h._(m,v,M)}})},T.prototype.then=function(h){var p=this;return new T(function(m,v,M){return p._(m,B,M);function B(U,X){var te=h instanceof T?h:h(X);return a("a parser is returned",te instanceof T),te._(U,v,M)}})},T.prototype.many=function(){var h=this;return new T(function(p,m,v){for(var M=[];h._(p,B,U););return m(p,M);function B(X,te){return p=X,M.push(te),!0}function U(){return!1}})},T.prototype.times=function(h,p){arguments.length<2&&(p=h);var m=this;return new T(function(v,M,B){for(var U=[],X=!0,te,Ce=0;Ce<h;Ce+=1)if(X=!!m._(v,ve,ge),!X)return B(v,te);for(;Ce<p&&X;Ce+=1)m._(v,ve,_e);return M(v,U);function ve(Ae,nt){return U.push(nt),v=Ae,!0}function ge(Ae,nt){return te=nt,v=Ae,!1}function _e(Ae,nt){return!1}})},T.prototype.result=function(h){return this.then(T.succeed(h))},T.prototype.atMost=function(h){return this.times(0,h)},T.prototype.atLeast=function(h){var p=this;return p.times(h).then(function(m){return p.many().map(function(v){return m.concat(v)})})},T.prototype.map=function(h){return this.then(function(p){return T.succeed(h(p))})},T.prototype.skip=function(h){return this.then(function(p){return h.result(p)})},T.string=function(h){var p=h.length,m="expected '"+h+"'";return new T(function(v,M,B){var U=v.slice(0,p);return U===h?M(v.slice(p),U):B(v,m)})},T.regex=function(h){a("regexp parser is anchored",h.toString().charAt(1)==="^");var p="expected "+h;return new T(function(m,v,M){var B=h.exec(m);if(B){var U=B[0];return v(m.slice(U.length),U)}else return M(m,p)})},T.succeed=function(h){return new T(function(p,m){return m(p,h)})},T.fail=function(h){return new T(function(p,m,v){return v(p,h)})},T.letter=T.regex(/^[a-z]/i),T.letters=T.regex(/^[a-z]*/i),T.digit=T.regex(/^[0-9]/),T.digits=T.regex(/^[0-9]*/),T.whitespace=T.regex(/^\s+/),T.optWhitespace=T.regex(/^\s*/),T.any=new T(function(h,p,m){return h?p(h.slice(1),h.charAt(0)):m(h,"expected any character")}),T.all=new T(function(h,p,m){return p("",h)}),T.eof=new T(function(h,p,m){return h?m(h,"expected EOF"):p(h,h)}),T}(),lg=function(){function T(){this.fn=i}return T.prototype.listen=function(h){this.fn=h,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.fn)},T.prototype.listenOnce=function(h){var p=this;this.listen(function(){for(var m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];p.clearListener(),h.apply(void 0,m)})},T.prototype.clearListener=function(){this.fn=i,clearTimeout(this.timeoutId)},T.prototype.trigger=function(){for(var h=[],p=0;p<arguments.length;p++)h[p]=arguments[p];this.fn.apply(this,h)},T}(),Hf=function(){var T={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},h={ArrowRight:"Right",ArrowLeft:"Left",ArrowDown:"Down",ArrowUp:"Up",Delete:"Del",Escape:"Esc"," ":"Spacebar"};function p(B){switch(v(B)){case"Right":case"Left":case"Down":case"Up":return!0}return!1}function m(B){return B.length===1&&B>="a"&&B<="z"}function v(B){var U;if(B.key===void 0){var X=B.which||B.keyCode;return T[X]||String.fromCharCode(X)}return m(B.key)?B.key.toUpperCase():(U=h[B.key])!==null&&U!==void 0?U:B.key}function M(B){var U=v(B),X=[];return B.ctrlKey&&X.push("Ctrl"),B.metaKey&&X.push("Meta"),B.altKey&&X.push("Alt"),B.shiftKey&&X.push("Shift"),X.length?(U!=="Alt"&&U!=="Control"&&U!=="Meta"&&U!=="Shift"&&X.push(U),X.join("-")):U}return function(U,X){var te=null,Ce=null,ve=new lg;function ge(){try{U instanceof HTMLTextAreaElement&&U.select()}catch(ue){}}function _e(ue){ve.trigger(),ve.clearListener(),U instanceof HTMLTextAreaElement&&(U.value=ue),ue&&ge(),Ae=!!ue}var Ae=!1;function nt(){return!("selectionStart"in U)||!(U instanceof HTMLTextAreaElement)?!1:U.selectionStart!==U.selectionEnd}function gt(){X.options&&X.options.overrideKeystroke?X.options.overrideKeystroke(M(te),te):X.keystroke(M(te),te)}function lt(ue){ve.trigger(ue),ue.target===U&&(te=ue,Ce=null,Ae&&ve.listenOnce(function(ye){ye&&ye.type==="focusout"||ge()}),gt())}function P(ue){ve.trigger(ue),ue.target===U&&(te&&Ce&&gt(),Ce=ue,p(ue)?ve.listenOnce(G):ve.listen(F))}function V(ue){ve.trigger(ue),ue.target===U&&te&&!Ce&&(p(ue)?ve.listenOnce(G):ve.listen(F))}function F(){if(!nt()&&U instanceof HTMLTextAreaElement){var ue=U.value;te&&(te.key==="Unidentified"||!te.altKey&&te.ctrlKey&&!te.metaKey&&te.shiftKey&&(te.key==="U"||te.key==="Process"))||(ue.length===1?(U.value="",X.options&&X.options.overrideTypedText?X.options.overrideTypedText(ue):X.typedText(ue)):G())}}function G(){U instanceof HTMLTextAreaElement&&U.value.length>1&&ge()}function Y(){te=null,Ce=null,ve.clearListener(),U instanceof HTMLTextAreaElement&&(U.value="")}function Z(ue){ve.trigger(),ue.target===U&&(document.activeElement!==U&&U.focus(),ve.listen(function(){if(U instanceof HTMLTextAreaElement){var Ue=U.value;U.value="",Ue&&X.paste(Ue)}}))}function ne(ue){ve.trigger(ue)}return X.options&&X.options.disableCopyPaste?X.addTextareaEventListeners({keydown:lt,keypress:P,keyup:V,focusout:Y,copy:function(ue){ue.preventDefault()},cut:function(ue){ue.preventDefault()},paste:function(ue){ve.trigger(),ue.preventDefault()},input:ne}):X.addTextareaEventListeners({keydown:lt,keypress:P,keyup:V,focusout:Y,cut:function(){ve.listenOnce(function(){X.cut()})},copy:function(){ve.listenOnce(function(){X.copy()})},paste:Z,input:ne}),{select:_e}}}(),ky=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.exportText=function(){return this.root.foldChildren("",function(p,m){return p+m.text()})},h}(yt);yt.onNotify(function(T,h){if(h==="edit"||h==="replace"||h===void 0){var p=T.controller;if(!p||!p.options.enableDigitGrouping||p.blurred!==!1)return;p.disableGroupingForSeconds(1)}});var $f=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.handleTextareaFocusEditable=function(){var m=p.cursor;p.updateMathspeak(),p.blurred=!1,clearTimeout(p.blurTimeout),A(p.container).addClass("dcg-mq-focused"),m.parent||m.insAtRightEnd(p.root),m.selection?(m.selection.domFrag().removeClass("dcg-mq-blur"),p.selectionChanged()):m.show(),p.setOverflowClasses()},p.handleTextareaBlurEditable=function(){p.textareaSelectionTimeout&&(clearTimeout(p.textareaSelectionTimeout),p.textareaSelectionTimeout=0),p.disableGroupingForSeconds(0),p.blurred=!0,p.blurTimeout=setTimeout(function(){p.root.postOrder(function(m){m.intentionalBlur()}),p.cursor.clearSelection().endSelection(),p.blur(),p.updateMathspeak(),p.scrollHoriz()}),window.addEventListener("blur",p.handleWindowBlur)},p.handleTextareaFocusStatic=function(){p.blurred=!1},p.handleTextareaBlurStatic=function(){p.cursor.selection&&p.cursor.selection.clear(),setTimeout(function(){A(p.getTextareaSpanOrThrow()).detach(),p.blurred=!0})},p.handleWindowBlur=function(){clearTimeout(p.blurTimeout),p.cursor.selection&&p.cursor.selection.domFrag().addClass("dcg-mq-blur"),p.blurWithoutResettingCursor(),p.updateMathspeak()},p}return h.prototype.disableGroupingForSeconds=function(p){var m=this;clearTimeout(this.__disableGroupingTimeout),p===0?this.root.domFrag().removeClass("dcg-mq-suppress-grouping"):(this.root.domFrag().addClass("dcg-mq-suppress-grouping"),this.__disableGroupingTimeout=setTimeout(function(){m.root.domFrag().removeClass("dcg-mq-suppress-grouping")},p*1e3))},h.prototype.blur=function(){this.blurWithoutResettingCursor(),this.options&&this.options.resetCursorOnBlur&&this.cursor.resetToEnd(this)},h.prototype.blurWithoutResettingCursor=function(){this.cursor.hide().parent.blur(this.cursor),A(this.container).removeClass("dcg-mq-focused"),window.removeEventListener("blur",this.handleWindowBlur)},h.prototype.addEditableFocusBlurListeners=function(){var p=this,m=p.cursor;this.addTextareaEventListeners({focus:this.handleTextareaFocusEditable,blur:this.handleTextareaBlurEditable}),p.blurred=!0,m.hide().parent.blur(m)},h.prototype.addStaticFocusBlurListeners=function(){this.addTextareaEventListeners({focus:this.handleTextareaFocusStatic,blur:this.handleTextareaBlurStatic})},h}(ky),cl=!1,Ga=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.keystroke=function(p,m,v){var M=v.cursor;switch(p){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":v.ctrlDeleteDir(e);break;case"Shift-Backspace":case"Backspace":v.backspace();break;case"Esc":case"Tab":v.escapeDir(t,p,m);return;case"Shift-Tab":case"Shift-Esc":v.escapeDir(e,p,m);return;case"End":v.notify("move").cursor.insAtRightEnd(M.parent),v.aria.queue("end of").queue(M.parent,!0);break;case"Ctrl-End":v.notify("move").cursor.insAtRightEnd(v.root),v.aria.queue("end of").queue(v.ariaLabel).queue(v.root).queue(v.ariaPostLabel);break;case"Shift-End":v.selectToBlockEndInDir(t);break;case"Ctrl-Shift-End":v.selectToRootEndInDir(t);break;case"Home":v.notify("move").cursor.insAtLeftEnd(M.parent),v.aria.queue("beginning of").queue(M.parent,!0);break;case"Ctrl-Home":v.notify("move").cursor.insAtLeftEnd(v.root),v.aria.queue("beginning of").queue(v.ariaLabel).queue(v.root).queue(v.ariaPostLabel);break;case"Shift-Home":v.selectToBlockEndInDir(e);break;case"Ctrl-Shift-Home":v.selectToRootEndInDir(e);break;case"Left":v.moveLeft();break;case"Shift-Left":v.selectLeft();break;case"Ctrl-Left":break;case"Right":v.moveRight();break;case"Shift-Right":v.selectRight();break;case"Ctrl-Right":break;case"Up":v.moveUp();break;case"Down":v.moveDown();break;case"Shift-Up":v.withIncrementalSelection(function(B){if(M[e])for(;M[e];)B(e);else B(e)});break;case"Shift-Down":v.withIncrementalSelection(function(B){if(M[t])for(;M[t];)B(t);else B(t)});break;case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":v.ctrlDeleteDir(t);break;case"Shift-Del":case"Del":v.deleteForward();break;case"Meta-A":case"Ctrl-A":v.selectAll();break;case"Ctrl-Alt-Up":M.parent.parent&&M.parent.parent instanceof h?v.aria.queue(M.parent.parent):v.aria.queue("nothing above");break;case"Ctrl-Alt-Down":M.parent&&M.parent instanceof h?v.aria.queue(M.parent):v.aria.queue("block is empty");break;case"Ctrl-Alt-Left":M.parent.parent&&M.parent.parent.getEnd(e)?v.aria.queue(M.parent.parent.getEnd(e)):v.aria.queue("nothing to the left");break;case"Ctrl-Alt-Right":M.parent.parent&&M.parent.parent.getEnd(t)?v.aria.queue(M.parent.parent.getEnd(t)):v.aria.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":M.selection?v.aria.queue(M.selection.join("mathspeak"," ").trim()+" selected"):v.aria.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":v.ariaPostLabel.length?v.aria.queue(v.ariaPostLabel):v.aria.queue("no answer");break;default:return}v.aria.alert(),m==null||m.preventDefault(),v.scrollHoriz()},h.prototype.moveOutOf=function(p,m,v){a("overridden or never called on this node",!1)},h.prototype.moveTowards=function(p,m,v){a("overridden or never called on this node",!1)},h.prototype.deleteOutOf=function(p,m){a("overridden or never called on this node",!1)},h.prototype.deleteTowards=function(p,m){a("overridden or never called on this node",!1)},h.prototype.unselectInto=function(p,m){a("overridden or never called on this node",!1)},h.prototype.selectOutOf=function(p,m){a("overridden or never called on this node",!1)},h.prototype.selectTowards=function(p,m){a("overridden or never called on this node",!1)},h}(ee);yt.onNotify(function(T,h){(h==="move"||h==="upDown")&&T.show().clearSelection()}),he.leftRightIntoCmdGoes=function(T){if(T&&T!=="up"&&T!=="down")throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+T+'"';return T},yt.onNotify(function(T,h){h!=="upDown"&&(T.upDownCache={})}),yt.onNotify(function(T,h){h==="edit"&&T.show().deleteSelection()}),yt.onNotify(function(T,h){h!=="select"&&T.endSelection()});var _u=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.keystroke=function(p,m){this.cursor.parent.keystroke(p,m,this.getControllerSelf())},h.prototype.escapeDir=function(p,m,v){s(p);var M=this.cursor;if(M.parent!==this.root&&(v==null||v.preventDefault()),M.parent!==this.root)return M.clearSelection(),M.parent.moveOutOf(p,M),M.controller.aria.alert(),this.notify("move")},h.prototype.moveDir=function(p){s(p);var m=this.cursor,v=m.options.leftRightIntoCmdGoes,M=m[p];return m.selection?m.insDirOf(p,m.selection.getEnd(p)):M?M.moveTowards(p,m,v):m.parent.moveOutOf(p,m,v),this.notify("move")},h.prototype.moveLeft=function(){return this.moveDir(e)},h.prototype.moveRight=function(){return this.moveDir(t)},h.prototype.moveUp=function(){return this.moveUpDown("up")},h.prototype.moveDown=function(){return this.moveUpDown("down")},h.prototype.moveUpDown=function(p){var m=this,v=m.notify("upDown").cursor,M,B;p==="up"?(M="upInto",B="upOutOf"):(M="downInto",B="downOutOf");var U=v[e],X=v[t],te=X&&X[M],Ce=U&&U[M];return te?v.insAtLeftEnd(te):Ce?v.insAtRightEnd(Ce):v.parent.bubble(function(ve){var ge=ve[B];if(ge&&(typeof ge=="function"&&(ge=ge.call(ve,v)),ge instanceof Ga&&v.jumpUpDown(ve,ge),ge!==!0))return!1}),m},h.prototype.deleteDir=function(p){s(p);var m=this.cursor,v=m[p],M=m.parent.parent,B=m.controller;if(v&&v instanceof Ga)v.sides?B.aria.queue(v.parent.chToCmd(v.sides[-p].ch).mathspeak({createdLeftOf:m})):!v.blocks&&v.parent.ctrlSeq!=="\\text"&&B.aria.queue(v);else if(M&&M instanceof Ga)if(M.sides)B.aria.queue(M.parent.chToCmd(M.sides[p].ch).mathspeak({createdLeftOf:m}));else if(M.blocks&&M.mathspeakTemplate)if(M.upInto&&M.downInto)B.aria.queue(M.mathspeakTemplate[1]);else{var U=M.mathspeakTemplate,X=p===e?U[0]:U[U.length-1];B.aria.queue(X)}else B.aria.queue(M);var te=m.selection;if(this.notify("edit"),!te){var Ce=m[p];Ce?Ce.deleteTowards(p,m):m.parent.deleteOutOf(p,m)}var ve=m[e],ge=m[t];return ve.siblingDeleted&&ve.siblingDeleted(m.options,t),ge.siblingDeleted&&ge.siblingDeleted(m.options,e),m.parent.bubble(function(_e){_e.reflow()}),this},h.prototype.ctrlDeleteDir=function(p){s(p);var m=this.cursor;if(!m[p]||m.selection)return this.deleteDir(p);this.notify("edit");var v;p===e?v=new re(m.parent.getEnd(e),m[e]):v=new re(m[t],m.parent.getEnd(t)),m.controller.aria.queue(v),v.remove(),m.insAtDirEnd(p,m.parent);var M=m[e],B=m[t];return M&&M.siblingDeleted(m.options,t),B&&B.siblingDeleted(m.options,e),m.parent.bubble(function(U){U.reflow()}),this},h.prototype.backspace=function(){return this.deleteDir(e)},h.prototype.deleteForward=function(){return this.deleteDir(t)},h.prototype.startIncrementalSelection=function(){a("Multiple selections can't be simultaneously open",!cl),cl=!0,this.notify("select");var p=this.cursor;p.anticursor||p.startSelection()},h.prototype.selectDirIncremental=function(p){a("A selection is open",cl),cl=!0;var m=this.cursor,v=m.selection;s(p);var M=m[p];M?v&&v.getEnd(p)===M&&m.anticursor[-p]!==M?M.unselectInto(p,m):M.selectTowards(p,m):m.parent.selectOutOf(p,m)},h.prototype.finishIncrementalSelection=function(){a("A selection is open",cl);var p=this.cursor;p.clearSelection(),p.select()||p.show();var m=p.selection;m&&p.controller.aria.clear().queue(m.join("mathspeak"," ").trim()+" selected"),cl=!1},h.prototype.withIncrementalSelection=function(p){var m=this;try{this.startIncrementalSelection();try{p(function(v){return m.selectDirIncremental(v)})}finally{this.finishIncrementalSelection()}}finally{cl=!1}},h.prototype.selectDir=function(p){this.withIncrementalSelection(function(m){return m(p)})},h.prototype.selectLeft=function(){return this.selectDir(e)},h.prototype.selectRight=function(){return this.selectDir(t)},h.prototype.selectAll=function(){this.notify("move");var p=this.cursor;p.insAtRightEnd(this.root),this.withIncrementalSelection(function(m){for(;p[e];)m(e)})},h.prototype.selectToBlockEndInDir=function(p){var m=this.cursor;this.withIncrementalSelection(function(v){for(;m[p];)v(p)})},h.prototype.selectToRootEndInDir=function(p){var m=this,v=this.cursor;this.withIncrementalSelection(function(M){for(;v[p]||v.parent!==m.root;)M(p)})},h}($f),_d=function(T){bt(h,T);function h(p){return T.call(this)||this}return h}(Ga),_i=function(){function T(F){var G=new Ba;return F.adopt(G,0,0),G}function h(F){for(var G=F[0]||new Ba,Y=1;Y<F.length;Y+=1)F[Y].children().adopt(G,G.getEnd(t),0);return G}var p=Ft.string,m=Ft.regex,v=Ft.letter,M=Ft.digit,B=Ft.any,U=Ft.optWhitespace,X=Ft.succeed,te=Ft.fail,Ce=v.map(function(F){return new So(F)}),ve=M.map(function(F){return new Ld(F)}),ge=m(/^[^${}\\_^]/).map(function(F){return new ll(F)}),_e=m(/^[^\\a-eg-zA-Z]/).or(p("\\").then(m(/^[a-z]+/i).or(m(/^\s+/).result(" ")).or(B))).then(function(F){var G=k[F];if(G)if(G.constructor){var Y=G;return new Y(F).parser()}else{var Z=G;return Z(F).parser()}else return te("unknown command: \\"+F)}),Ae=_e.or(Ce).or(ve).or(ge),nt=p("{").then(function(){return lt}).skip(p("}")),gt=U.then(nt.or(Ae.map(T))),lt=gt.many().map(h).skip(U),P=p("[").then(gt.then(function(F){return F.join("latex")!=="]"?X(F):te("")}).many().map(h).skip(U)).skip(p("]")),V=lt;return V.block=gt,V.optBlock=P,V}();he.maxDepth=function(T){return typeof T=="number"?T:void 0};var Ad=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.cleanLatex=function(p){return p.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},h.prototype.exportLatex=function(){return this.cleanLatex(this.root.latex())},h.prototype.writeLatex=function(p){var m=this.notify("edit").cursor;return m.parent.writeLatex(m,p),this},h.prototype.exportLatexSelection=function(){var p={latex:"",startIndex:-1,endIndex:-1},m=this.cursor.selection;if(m)p.startSelectionBefore=m.getEnd(e),p.endSelectionAfter=m.getEnd(t);else{var v=this.cursor[e];v?p.startSelectionAfter=v:p.startSelectionBefore=this.cursor.parent;var M=this.cursor[t];M?p.endSelectionBefore=M:p.endSelectionAfter=this.cursor.parent}this.root.latexRecursive(p);for(var B=p.latex,U=this.cleanLatex(B),X=p.startIndex,te=p.endIndex,Ce=0,ve=0;ve<p.endIndex;ve++)B[ve]!==U[Ce]?(ve<p.startIndex&&(X-=1),te-=1):Ce+=1;return{latex:U,startIndex:X,endIndex:te}},h.prototype.classifyLatexForEfficientUpdate=function(p){if(typeof p=="string"){var m=p.match(/-?[0-9.]+$/g);if(m&&m.length===1)return{latex:p,prefix:p.substr(0,p.length-m[0].length),digits:m[0]}}},h.prototype.updateLatexMathEfficiently=function(p,m){var v,M,B,U,X=this.root,te,Ce=this.classifyLatexForEfficientUpdate(p);if(Ce){if(te=this.classifyLatexForEfficientUpdate(m),!te||te.prefix!==Ce.prefix)return!1}else return!1;var ve=te.digits,ge=Ce.digits,_e=!1,Ae=!1;ve[0]==="-"&&(_e=!0,ve=ve.substr(1)),ge[0]==="-"&&(Ae=!0,ge=ge.substr(1));for(var nt=this.root.getEnd(t),gt=[],lt=ve.length-1;lt>=0;lt--){if(!nt||nt.ctrlSeq!==ve[lt]||nt.parent!==X)return!1;gt.unshift(nt),nt=nt[e]}if(_e&&!Ae){var P=nt;if(!P||P.ctrlSeq!=="-"||P[t]!==gt[0]||P.parent!==X)return!1;var V=P[e];if(V&&V.parent!==X)return!1;gt[0][e]=P[e],X.getEnd(e)===P&&X.setEnds((v={},v[e]=gt[0],v[t]=X.getEnd(t),v)),V&&(V[t]=gt[0]),P.domFrag().remove()}if(!_e&&Ae){var F=new pg("-"),G=document.createElement("span");G.textContent="-",F.setDOM(G);var Y=gt[0][e];Y&&(Y[t]=F),X.getEnd(e)===gt[0]&&X.setEnds((M={},M[e]=F,M[t]=X.getEnd(t),M)),F.parent=X,F[e]=gt[0][e],F[t]=gt[0],gt[0][e]=F,F.contactWeld(this.cursor),F.domFrag().insertBefore(gt[0].domFrag())}var Z=Math.min(ve.length,ge.length);for(lt=0;lt<Z;lt++){var ne=ge[lt];nt=gt[lt],nt.ctrlSeq!==ne&&(nt.ctrlSeq=ne,nt.domFrag().oneElement().textContent=ne,nt.mathspeakName=ne)}if(ve.length>ge.length)for(nt=gt[ge.length-1],X.setEnds((B={},B[e]=X.getEnd(e),B[t]=nt,B)),nt[t]=0,lt=ve.length-1;lt>=Z;lt--)gt[lt].domFrag().remove();if(ge.length>ve.length){var ue=document.createDocumentFragment();for(lt=Z;lt<ge.length;lt++){var ye=document.createElement("span");ye.className="dcg-mq-digit",ye.textContent=ge[lt];var Ue=new Ld(ge[lt]);Ue.parent=X,Ue.setDOM(ye),ue.appendChild(ye),Ue[e]=X.getEnd(t),Ue[t]=0;var it=Ue[e];it[t]=Ue,X.setEnds((U={},U[e]=X.getEnd(e),U[t]=Ue,U))}X.domFrag().oneElement().appendChild(ue)}var Zt=this.exportLatex();if(Zt!==p)return console.warn("tried updating latex efficiently but did not work. Attempted: "+p+" but wrote: "+Zt),!1;var He=X.getEnd(t);return He&&He.fixDigitGrouping(this.cursor.options),!0},h.prototype.renderLatexMathFromScratch=function(p){var m,v=this.root,M=this.cursor,B=Ft.all,U=Ft.eof,X=_i.skip(U).or(B.result(!1)).parse(p);if(v.setEnds((m={},m[e]=0,m[t]=0,m)),X&&X.children().adopt(v,0,0),X){var te=v.domFrag();te.children().remove(),te.oneElement().appendChild(X.html()),v.finalizeInsert(M.options,M)}else v.domFrag().empty()},h.prototype.renderLatexMath=function(p){var m=this.cursor,v=this.root;this.notify("replace"),m.clearSelection();var M=this.exportLatex();(!v.getEnd(e)||!v.getEnd(t)||M!==p)&&(this.updateLatexMathEfficiently(p,M)||this.renderLatexMathFromScratch(p),this.updateMathspeak()),m.insAtRightEnd(v)},h.prototype.renderLatexText=function(p){var m,v=this.root,M=this.cursor;v.domFrag().children().slice(1).remove(),v.setEnds((m={},m[e]=0,m[t]=0,m)),delete M.selection,M.show().insAtRightEnd(v);var B=Ft.regex,U=Ft.string,X=Ft.eof,te=Ft.all,Ce=U("$").then(_i).skip(U("$").or(X)).map(function(gt){var lt=new RootMathCommand(M);lt.createBlocks();var P=lt.getEnd(e);return gt.children().adopt(P,0,0),lt}),ve=U("\\$").result("$"),ge=ve.or(B(/^[^$]/)).map(function(gt){return new ll(gt)}),_e=Ce.or(ge).many(),Ae=_e.skip(X).or(te.result(!1)).parse(p);if(Ae){for(var nt=0;nt<Ae.length;nt+=1)Ae[nt].adopt(v,v.getEnd(t),0);A(v.html()).appendTo(v.domFrag().oneElement()),v.finalizeInsert(M.options,M)}},h}(_u),Yf=function(T){return!1};ie.prototype.ignoreNextMousedown=Yf;var ug;(function(){yt.onNotify(function(T,h){(h==="edit"||h==="replace")&&ug&&ug.cursor===T&&ug.cb()})})();var Zv=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.handleMouseDown=function(m){var v=u(m.target,".dcg-mq-root-block"),M=v&&ee.getNodeOfElement(v)||ee.getNodeOfElement(p.root.domFrag().oneElement()),B=M.domFrag().firstNode().ownerDocument,U=M.controller,X=U.cursor,te=X.blink,Ce=U.getTextareaSpanOrThrow(),ve=U.getTextareaOrThrow();if(m.preventDefault(),m.target.unselectable=!0,X.options.ignoreNextMousedown(m)||u(m.target,".dcg-mq-ignore-mousedown"))return;var ge=null;function _e(V){ge=V.target}function Ae(V){X.anticursor||X.startSelection(),U.seek(ge,V.clientX,V.clientY).cursor.select(),X.selection&&X.controller.aria.clear().queue(X.selection.join("mathspeak")+" selected").alert(),ge=null}function nt(){v==null||v.removeEventListener("mousemove",_e),B==null||B.removeEventListener("mousemove",Ae),B==null||B.removeEventListener("mouseup",lt),ug=void 0}function gt(){U.editable?(X.show(),X.controller.aria.queue(X.parent).alert()):A(Ce).detach()}function lt(){X.blink=te,X.selection||gt(),nt()}var P;ug={cursor:X,cb:function(){P=!0,X.blink=te,X.clearSelection(),gt(),nt()}},!(U.blurred&&(v&&!U.editable&&A(v).prepend(A(Ce)),ve.focus(),P))&&(X.blink=i,U.seek(m.target,m.clientX,m.clientY).cursor.startSelection(),v==null||v.addEventListener("mousemove",_e),B==null||B.addEventListener("mousemove",Ae),B==null||B.addEventListener("mouseup",lt))},p}return h.prototype.addMouseEventListener=function(){this.container.addEventListener("mousedown",this.handleMouseDown)},h.prototype.removeMouseEventListener=function(){this.container.removeEventListener("mousedown",this.handleMouseDown)},h.prototype.seek=function(p,m,v){for(var M=this.notify("select").cursor,B;p&&(B=ee.getNodeOfElement(p),!B);)p=p.parentElement;return B||(B=this.root),M.clearSelection().show(),B.seek(m,M),this.scrollHoriz(),this},h}(Ad),Vy=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.setOverflowClasses=function(){var p=this.root.domFrag().oneElement(),m=!1,v=!1;if(!this.blurred){var M=E(p).width,B=p.scrollWidth,U=p.scrollLeft;m=B>M+U,v=U>0}p.classList.contains("dcg-mq-editing-overflow-right")!==m&&p.classList.toggle("dcg-mq-editing-overflow-right"),p.classList.contains("dcg-mq-editing-overflow-left")!==v&&p.classList.toggle("dcg-mq-editing-overflow-left")},h.prototype.scrollHoriz=function(){var p=this,m=this.cursor,v=m.selection,M=E(this.root.domFrag().oneElement());if(m.domFrag().isEmpty()&&!v){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var B=this.root.domFrag().oneElement(),U=B.scrollLeft;D(this.getScrollAnimationDuration(),function(gt,lt,P){gt>=1?(p.cancelScrollHoriz=void 0,B.scrollLeft=0,p.setOverflowClasses()):(p.cancelScrollHoriz=P,lt(),B.scrollLeft=Math.round((1-gt)*U))});return}else if(v){var Ce=E(v.domFrag().oneElement()),ve=Ce.left-(M.left+20),ge=Ce.right-(M.right-20);if(v.getEnd(e)===m[t])if(ve<0)var te=ve;else if(ge>0)if(Ce.left-ge<M.left+20)var te=ve;else var te=ge;else return;else if(ge>0)var te=ge;else if(ve<0)if(Ce.right-ve>M.right-20)var te=ge;else var te=ve;else return}else{var X=E(m.domFrag().oneElement()).left;if(X>M.right-20)var te=X-(M.right-20);else if(X<M.left+20)var te=X-(M.left+20);else return}var _e=this.root.domFrag().oneElement();if(!(te<0&&_e.scrollLeft===0)&&!(te>0&&_e.scrollWidth<=_e.scrollLeft+M.width)){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var Ae=this.root.domFrag().oneElement(),nt=Ae.scrollLeft;D(this.getScrollAnimationDuration(),function(gt,lt,P){gt>=1?(p.cancelScrollHoriz=void 0,Ae.scrollLeft=Math.round(nt+te),p.setOverflowClasses()):(p.cancelScrollHoriz=P,lt(),Ae.scrollLeft=Math.round(nt+gt*te))})}},h.prototype.getScrollAnimationDuration=function(){var p;return(p=this.options.scrollAnimationDuration)!==null&&p!==void 0?p:100},h}(Zv);ie.prototype.substituteTextarea=function(){return l("textarea",{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:!1,"x-palm-disable-ste-all":!0})};function Fy(T,h){return Hf(T[0],h)}ie.prototype.substituteKeyboardEvents=Fy;var Gy=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.selectFn=i,p}return h.prototype.createTextarea=function(){this.textareaSpan=l("span",{class:"dcg-mq-textarea"});var p=this.options.substituteTextarea();if(!p.nodeType)throw"substituteTextarea() must return a DOM element, got "+p;this.textarea=A(p).appendTo(this.textareaSpan).oneElement();var m=this;m.cursor.selectionChanged=function(){m.selectionChanged()}},h.prototype.selectionChanged=function(){var p=this;p.textareaSelectionTimeout||(p.textareaSelectionTimeout=setTimeout(function(){p.setTextareaSelection()}))},h.prototype.setTextareaSelection=function(){this.textareaSelectionTimeout=0;var p="";this.cursor.selection&&(p=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(p="$"+p+"$")),this.selectFn(p)},h.prototype.staticMathTextareaEvents=function(){var p=this;this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste"),p.options.disableCopyPaste?this.removeTextareaEventListener("copy"):this.addTextareaEventListeners({copy:function(){p.setTextareaSelection()}}),this.addStaticFocusBlurListeners(),p.selectFn=function(m){var v=p.getTextareaOrThrow();v instanceof HTMLTextAreaElement&&(v.value=m,m&&v.select())}},h.prototype.editablesTextareaEvents=function(){var p=this,m=p.getTextareaOrThrow(),v=p.getTextareaSpanOrThrow();if(this.options.version<3){var M=this.options.assertJquery(),B=this.options.substituteKeyboardEvents(M(m),this);this.selectFn=function(X){B.select(X)}}else{var U=Hf(m,this).select;this.selectFn=U}A(this.container).prepend(A(v)),this.addEditableFocusBlurListeners(),this.updateMathspeak()},h.prototype.unbindEditablesEvents=function(){var p=this,m=p.getTextareaOrThrow(),v=p.getTextareaSpanOrThrow();this.selectFn=function(M){m instanceof HTMLTextAreaElement&&(m.value=M,M&&m.select())},A(v).remove(),this.removeTextareaEventListener("focus"),this.removeTextareaEventListener("blur"),p.blurred=!0,this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste")},h.prototype.typedText=function(p){if(p===`
`)return this.handle("enter");var m=this.notify(void 0).cursor;m.parent.write(m,p),this.scrollHoriz()},h.prototype.cut=function(){var p=this,m=p.cursor;m.selection&&setTimeout(function(){p.notify("edit"),m.parent.bubble(function(v){v.reflow()}),p.options&&p.options.onCut&&p.options.onCut()})},h.prototype.copy=function(){this.setTextareaSelection()},h.prototype.paste=function(p){this.options.statelessClipboard&&(p.slice(0,1)==="$"&&p.slice(-1)==="$"?p=p.slice(1,-1):p="\\text{"+p+"}"),this.writeLatex(p).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()},h.prototype.setupStaticField=function(){this.mathspeakSpan=l("span",{class:"dcg-mq-mathspeak"}),A(this.container).prepend(A(this.mathspeakSpan)),this.updateMathspeak(),this.blurred=!0,this.cursor.hide().parent.blur(this.cursor)},h.prototype.updateMathspeak=function(){var p=this,m=p.getAriaLabel(),v=/[A-Za-z0-9]$/.test(m)?m+":":m,M=p.root.mathspeak().trim();this.aria.clear();var B=p.getTextareaOrThrow();p.mathspeakSpan?(B.setAttribute("aria-label",""),p.mathspeakSpan.textContent=(v+" "+M).trim()):B.setAttribute("aria-label",(v+" "+M+" "+p.ariaPostLabel).trim())},h}(Vy),Jv=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.finalizeInsert=function(p,m){var v=this;v.postOrder(function(U){U.finalizeTree(p)}),v.postOrder(function(U){U.contactWeld(m)}),v.postOrder(function(U){U.blur(m)}),v.postOrder(function(U){U.reflow()});var M=v[t],B=v[e];M&&M.siblingCreated(p,e),B&&B.siblingCreated(p,t),v.bubble(function(U){U.reflow()})},h.prototype.prepareInsertionAt=function(p){var m=p.options.maxDepth;if(m!==void 0){var v=p.depth();if(v>m)return!1;this.removeNodesDeeperThan(m-v)}return!0},h.prototype.removeNodesDeeperThan=function(p){for(var m=0,v=[[this,m]],M;M=v.shift();){var B=M;B[0].children().each(function(U){var X=U instanceof Ba?1:0;m=B[1]+X,m<=p?v.push([U,m]):(X?U.children():U).remove()})}},h}(Ga),Hi=function(){function T(h,p){this.childCount=h,this.render=p}return T}(),$i=function(T){bt(h,T);function h(p,m,v){var M=T.call(this)||this;return M.textTemplate=[""],M.mathspeakTemplate=[""],M.setCtrlSeqHtmlAndText(p,m,v),M}return h.prototype.setEnds=function(p){a("MathCommand ends are never empty",p[e]&&p[t]),this.ends=p},h.prototype.getEnd=function(p){return this.ends[p]},h.prototype.setCtrlSeqHtmlAndText=function(p,m,v){this.ctrlSeq||(this.ctrlSeq=p),m&&(this.domView=m),v&&(this.textTemplate=v)},h.prototype.replaces=function(p){p.disown(),this.replacedFragment=p},h.prototype.isEmpty=function(){return this.foldChildren(!0,function(p,m){return p&&m.isEmpty()})},h.prototype.parser=function(){var p=this,m=_i.block;return m.times(this.numBlocks()).map(function(v){p.blocks=v;for(var M=0;M<v.length;M+=1)v[M].adopt(p,p.getEnd(t),0);return p})},h.prototype.createLeftOf=function(p){var m=this,v=m.replacedFragment;if(m.createBlocks(),T.prototype.createLeftOf.call(this,p),v){var M=m.getEnd(e);v.adopt(M,0,0),v.domFrag().appendTo(M.domFrag().oneElement()),m.placeCursor(p),m.prepareInsertionAt(p)}m.finalizeInsert(p.options,p),m.placeCursor(p)},h.prototype.createBlocks=function(){for(var p=this,m=p.numBlocks(),v=p.blocks=Array(m),M=0;M<m;M+=1){var B=v[M]=new Ba;B.adopt(p,p.getEnd(t),0)}},h.prototype.placeCursor=function(p){p.insAtRightEnd(this.foldChildren(this.getEnd(e),function(m,v){return m.isEmpty()?m:v}))},h.prototype.moveTowards=function(p,m,v){var M;v==="up"?M=this.upInto:v==="down"&&(M=this.downInto);var B=M||this.getEnd(-p);m.insAtDirEnd(-p,B),m.controller.aria.queueDirEndOf(-p).queue(m.parent,!0)},h.prototype.deleteTowards=function(p,m){this.isEmpty()?m[p]=this.remove()[p]:this.moveTowards(p,m)},h.prototype.selectTowards=function(p,m){m[-p]=this,m[p]=this[p]},h.prototype.selectChildren=function(){return new Vt(this,this)},h.prototype.unselectInto=function(p,m){var v=m.anticursor,M=v.ancestors[this.id];m.insAtDirEnd(-p,M)},h.prototype.seek=function(p,m){function v(X){var te,Ce=X.domFrag().oneElement(),ve=E(Ce).left,ge=ve+Ce.offsetWidth;return te={},te[e]=ve,te[t]=ge,te}var M=this,B=v(M);if(p<B[e])return m.insLeftOf(M);if(p>B[t])return m.insRightOf(M);var U=B[e];M.eachChild(function(X){var te=v(X);if(p<te[e])return p-U<te[e]-p?X[e]?m.insAtRightEnd(X[e]):m.insLeftOf(M):m.insAtLeftEnd(X),!1;if(p>te[t]){X[t]?U=te[t]:B[t]-p<p-te[t]?m.insRightOf(M):m.insAtRightEnd(X);return}else return X.seek(p,m),!1})},h.prototype.numBlocks=function(){return this.domView.childCount},h.prototype.html=function(){var p=this.blocks;a("domView is defined",this.domView);var m=this.domView,v=m.render(p||[]);return this.setDOM(v),ee.linkElementByCmdNode(v,this),v},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),p.latex+=this.ctrlSeq||"",this.eachChild(function(m){p.latex+="{";var v=p.latex.length;m.latexRecursive(p);var M=p.latex.length;v===M&&(p.latex+=" "),p.latex+="}"}),this.checkCursorContextClose(p)},h.prototype.text=function(){var p=this,m=0;return p.foldChildren(p.textTemplate[m],function(v,M){m+=1;var B=M.text();return v&&p.textTemplate[m]==="("&&B[0]==="("&&B.slice(-1)===")"?v+B.slice(1,-1)+p.textTemplate[m]:v+B+(p.textTemplate[m]||"")})},h.prototype.mathspeak=function(){var p=this,m=0;return p.foldChildren(p.mathspeakTemplate[m]||"Start"+p.ctrlSeq+" ",function(v,M){return m+=1,v+" "+M.mathspeak()+" "+(p.mathspeakTemplate[m]+" "||"End"+p.ctrlSeq+" ")})},h}(Jv),pa=function(T){bt(h,T);function h(p,m,v,M){var B=T.call(this)||this;return B.setCtrlSeqHtmlTextAndMathspeak(p,m?new Hi(0,function(){return m.cloneNode(!0)}):void 0,v,M),B}return h.prototype.setCtrlSeqHtmlTextAndMathspeak=function(p,m,v,M){!v&&p&&(v=p.replace(/^\\/,"")),this.mathspeakName=M||v,T.prototype.setCtrlSeqHtmlAndText.call(this,p,m,[v||""])},h.prototype.parser=function(){return Ft.succeed(this)},h.prototype.numBlocks=function(){return 0},h.prototype.replaces=function(p){p.remove()},h.prototype.createBlocks=function(){},h.prototype.moveTowards=function(p,m){m.domFrag().insDirOf(p,this.domFrag()),m[-p]=this,m[p]=this[p],m.controller.aria.queue(this)},h.prototype.deleteTowards=function(p,m){m[p]=this.remove()[p]},h.prototype.seek=function(p,m){var v=this.domFrag().oneElement(),M=E(v).left;return p-M<v.offsetWidth/2?m.insLeftOf(this):m.insRightOf(this),m},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),p.latex+=this.ctrlSeq||"",this.checkCursorContextClose(p)},h.prototype.text=function(){return this.textTemplate.join("")},h.prototype.mathspeak=function(p){return this.mathspeakName||""},h.prototype.placeCursor=function(){},h.prototype.isEmpty=function(){return!0},h}($i),ll=function(T){bt(h,T);function h(p,m,v){return T.call(this,p,l("span",{},[m||l.text(p)]),void 0,v)||this}return h}(pa);function Yi(T,h,p){return function(){return new ll(T,h?l.entityText(h):void 0,p)}}var ga=function(T){bt(h,T);function h(p,m,v,M,B){var U=this;return B?U=T.call(this,p,l("span",{},[m||l.text(p||"")]),void 0,M)||this:U=T.call(this,p,l("span",{class:"dcg-mq-binary-operator"},m?[m]:[]),v,M)||this,U}return h.prototype.isBinaryOperator=function(){return!0},h}(pa);function Wl(T,h,p,m){return function(){return new ga(T,h?l.entityText(h):void 0,p,m)}}var Ba=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.ariaLabel="block",p}return h.prototype.join=function(p){return this.foldChildren("",function(m,v){return m+v[p]()})},h.prototype.html=function(){var p=document.createDocumentFragment();return this.eachChild(function(m){var v=m.html();p.appendChild(v)}),p},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),this.eachChild(function(m){return m.latexRecursive(p)}),this.checkCursorContextClose(p)},h.prototype.text=function(){var p=this.getEnd(e),m=this.getEnd(t);return p===m&&p!==0?p.text():this.join("text")},h.prototype.mathspeak=function(){var p="",m={};return this.controller&&(m=this.controller.options.autoOperatorNames),this.foldChildren([],function(v,M){if(M.isPartOfOperator)p+=M.mathspeak();else{if(p!==""){if(m._maxLength>0){var B=m[p.toLowerCase()];typeof B=="string"&&(p=B)}v.push(p+" "),p=""}var U=M.mathspeak(),X=M.ctrlSeq;isNaN(X)&&X!=="."&&(!M.parent||!M.parent.parent||!M.parent.parent.isTextBlock())&&(U=" "+U+" "),v.push(U)}return v}).join("").replace(/ +(?= )/g,"").replace(/(\.)([0-9]+)/g,function(v,M,B){return M+B.split("").join(" ").trim()})},h.prototype.keystroke=function(p,m,v){if(v.options.spaceBehavesLikeTab&&(p==="Spacebar"||p==="Shift-Spacebar")){m==null||m.preventDefault(),v.escapeDir(p==="Shift-Spacebar"?e:t,p,m);return}return T.prototype.keystroke.call(this,p,m,v)},h.prototype.moveOutOf=function(p,m,v){var M;if(v==="up"?M=this.parent.upInto:v==="down"&&(M=this.parent.downInto),!M&&this[p]){var B=-p;m.insAtDirEnd(B,this[p]),m.controller.aria.queueDirEndOf(B).queue(m.parent,!0)}else m.insDirOf(p,this.parent),m.controller.aria.queueDirOf(p).queue(this.parent)},h.prototype.selectOutOf=function(p,m){m.insDirOf(p,this.parent)},h.prototype.deleteOutOf=function(p,m){m.unwrapGramp()},h.prototype.seek=function(p,m){var v=this.getEnd(t);if(!v)return m.insAtRightEnd(this);var M=v.domFrag().oneElement(),B=E(M).left;if(B+M.offsetWidth<p)return m.insAtRightEnd(this);var U=this.getEnd(e);if(p<E(U.domFrag().oneElement()).left)return m.insAtLeftEnd(this);for(;p<E(v.domFrag().oneElement()).left;)v=v[e];return v.seek(p,m)},h.prototype.chToCmd=function(p,m){var v;return p.match(/^[a-eg-zA-Z]$/)?new So(p):/^\d$/.test(p)?new Ld(p):m&&m.typingSlashWritesDivisionSymbol&&p==="/"?k["\xF7"](p):m&&m.typingAsteriskWritesTimesSymbol&&p==="*"?k["\xD7"](p):m&&m.typingPercentWritesPercentOf&&p==="%"?k.percentof(p):(v=Ke[p]||k[p])?v.constructor?new v(p):v(p):new ll(p)},h.prototype.write=function(p,m){var v=this.chToCmd(m,p.options);p.selection&&v.replaces(p.replaceSelection()),p.isTooDeep()||(v.createLeftOf(p.show()),m==="/"?p.controller.aria.alert("over"):p.controller.aria.alert(v.mathspeak({createdLeftOf:p})))},h.prototype.writeLatex=function(p,m){var v=Ft.all,M=Ft.eof,B=_i.skip(M).or(v.result(!1)).parse(m);if(B&&!B.isEmpty()&&B.prepareInsertionAt(p)){B.children().adopt(p.parent,p[e],p[t]),A(B.html()).insertBefore(p.domFrag()),p[e]=B.getEnd(t),B.finalizeInsert(p.options,p);var U=B.getEnd(t),X=B.getEnd(e),te=U[t],Ce=X[e];te&&te.siblingCreated(p.options,e),Ce&&Ce.siblingCreated(p.options,t),p.parent.bubble(function(ve){ve.reflow()})}},h.prototype.focus=function(){return this.domFrag().addClass("dcg-mq-hasCursor"),this.domFrag().removeClass("dcg-mq-empty"),this},h.prototype.blur=function(p){return this.domFrag().removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.domFrag().addClass("dcg-mq-empty"),p&&this.isQuietEmptyDelimiter(p.options.quietEmptyDelimiters)&&this.domFrag().addClass("dcg-mq-quiet-delimiter")),this},h}(Jv);ie.prototype.mouseEvents=!0,qe.StaticMath=function(T){var h;return h=function(p){bt(m,p);function m(v){var M=p.call(this,v)||this,B=M.innerFields=[];return M.__controller.root.postOrder(function(U){U.registerInnerField(B,T.InnerMathField)}),M}return m.prototype.__mathquillify=function(v,M){return this.config(v),p.prototype.mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.setupStaticField(),this.__options.mouseEvents&&(this.__controller.addMouseEventListener(),this.__controller.staticMathTextareaEvents()),this},m.prototype.latex=function(v){var M=p.prototype.latex.apply(this,arguments);if(arguments.length>0){var B=this.innerFields=[];this.__controller.root.postOrder(function(U){U.registerInnerField(B,T.InnerMathField)}),this.__controller.updateMathspeak()}return M},m.prototype.setAriaLabel=function(v){return this.__controller.setAriaLabel(v),this},m.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},m}(T.AbstractMathQuill),h.RootBlock=Ba,h};var Qv=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h}(Ba);Ms(Qv.prototype),qe.MathField=function(T){var h;return h=function(p){bt(m,p);function m(){return p!==null&&p.apply(this,arguments)||this}return m.prototype.__mathquillify=function(v,M){return this.config(v),M>1&&(this.__controller.root.reflow=i),p.prototype.mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this},m}(T.EditableField),h.RootBlock=Qv,h},qe.InnerMathField=function(T){return a("MathField class is defined",T.MathField),function(h){bt(p,h);function p(){return h!==null&&h.apply(this,arguments)||this}return p.prototype.makeStatic=function(){this.__controller.editable=!1,this.__controller.root.blur(),this.__controller.unbindEditablesEvents(),A(this.__controller.container).removeClass("dcg-mq-editable-field")},p.prototype.makeEditable=function(){this.__controller.editable=!0,this.__controller.editablesTextareaEvents(),this.__controller.cursor.insAtRightEnd(this.__controller.root),A(this.__controller.container).addClass("dcg-mq-editable-field")},p}(T.MathField)};var Od="\\ ",eT=".",Wf=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.finalizeTree=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.siblingDeleted=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.siblingCreated=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.sharedSiblingMethod=function(p,m){m!==e&&this[t]instanceof h||this.fixDigitGrouping(p)},h.prototype.fixDigitGrouping=function(p){if(p.enableDigitGrouping){var m=this,v=m;do if(/^[0-9]$/.test(v.ctrlSeq))m=v;else if(v.ctrlSeq===Od)m=v;else if(v.ctrlSeq===eT)m=v;else break;while(v=m[e]);h.fixDigitGroupingFromLeft(p,m)}},h.fixDigitGroupingFromLeft=function(p,m){for(;m&&m.ctrlSeq===Od;){if(!m[t])return;m=m[t]}if(m instanceof h){var v=m;a("node",v);var M=m,B=0,U=0,X=[];do{if(/^[0-9]$/.test(v.ctrlSeq))M=v,U=0;else if(v.ctrlSeq===Od)M=v,B+=1,U=0;else if(v.ctrlSeq===eT&&v instanceof h)M=v,X.push(v),p.tripleDotsAreEllipsis&&(U+=1);else break;if(U==3)break}while(v=M[t]);if(U===3){var te=X.pop(),Ce=X.pop(),ve=X.pop();if(te[t]instanceof h&&h.fixDigitGroupingFromLeft(p,te[t]),te.setGroupingClass("dcg-mq-ellipsis-end"),Ce.setGroupingClass("dcg-mq-ellipsis-middle"),ve.setGroupingClass("dcg-mq-ellipsis-start"),M=ve[e],m===ve)return}for(;M!==m&&M&&M.ctrlSeq===Od;)M=M[e],B-=1;if(!(m===M&&m&&m.ctrlSeq===Od)){var ge=B>0||X.length>1;ge?h.removeGroupingBetween(m,M):X[0]?(X[0]!==m&&h.addGroupingBetween(X[0][e],m),X[0]!==M&&h.removeGroupingBetween(X[0],M)):h.addGroupingBetween(M,m)}}},h.removeGroupingBetween=function(p,m){var v=p;do if(v instanceof h&&v.setGroupingClass(void 0),!v||v===m)break;while(v=v[t])},h.addGroupingBetween=function(p,m){for(var U=p,v=0,M=0;U&&(M+=1,a("digit",U instanceof h),U!==m);)U=U[e];var B=M%3;B===0&&(B=3);for(var U=p;U;){v+=1;var X=void 0;if(M>=4&&(v===M?X="dcg-mq-group-leading-"+B:v%3===0&&v!==M&&(X="dcg-mq-group-start"),X||(X="dcg-mq-group-other")),U instanceof h&&U.setGroupingClass(X),U===m)break;U=U[e]}},h.prototype.setGroupingClass=function(p){this._groupingClass!==p&&(this._groupingClass&&this.domFrag().removeClass(this._groupingClass),p&&this.domFrag().addClass(p),this._groupingClass=p)},h}(pa),Ld=function(T){bt(h,T);function h(p,m){return T.call(this,p,l("span",{class:"dcg-mq-digit"},[l.text(p)]),void 0,m)||this}return h.prototype.createLeftOf=function(p){var m=p[e],v=m&&m[e],M=p.parent.parent instanceof tc?p.parent.parent.sub:void 0;p.options.autoSubscriptNumerals&&p.parent!==M&&(m instanceof Nd&&m.isItalic!==!1||m instanceof tc&&v instanceof Nd&&v.isItalic!==!1)?(new iT().createLeftOf(p),T.prototype.createLeftOf.call(this,p),p.insRightOf(p.parent.parent)):T.prototype.createLeftOf.call(this,p)},h.prototype.mathspeak=function(p){if(p&&p.createdLeftOf){var m=p.createdLeftOf,v=m[e],M=v&&v[e],B=m.parent.parent instanceof tc?m.parent.parent.sub:void 0;if(m.options.autoSubscriptNumerals&&m.parent!==B&&(v instanceof Nd&&v.isItalic!==!1||m[e]instanceof tc&&M instanceof Nd&&M.isItalic!==!1))return"Subscript "+T.prototype.mathspeak.call(this)+" Baseline"}return T.prototype.mathspeak.call(this)},h}(Wf),Nd=function(T){bt(h,T);function h(p,m){return T.call(this,p,l("var",{},[m||l.text(p)]))||this}return h.prototype.text=function(){var p=this.ctrlSeq||"";return this.isPartOfOperator?p[0]=="\\"?p=p.slice(1,p.length):p[p.length-1]==" "&&(p=p.slice(0,-1)):(this[e]&&!(this[e]instanceof h)&&!(this[e]instanceof ga)&&this[e].ctrlSeq!=="\\ "&&(p="*"+p),this[t]&&!(this[t]instanceof ga)&&!(this[t]instanceof tc)&&(p+="*")),p},h.prototype.mathspeak=function(){var p=this.ctrlSeq||"";return this.isPartOfOperator||p.length>1||this.parent&&this.parent.parent&&this.parent.parent.isTextBlock()?T.prototype.mathspeak.call(this):'"'+p+'"'},h}(pa);function Ds(T,h,p){return function(){return new Nd(T,l.entityText(h))}}ie.prototype.autoCommands={_maxLength:0},he.autoCommands=function(T){if(typeof T!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(T))throw'"'+T+'" not a space-delimited list of only letters';for(var h=T.split(" "),p={},m=0,v=0;v<h.length;v+=1){var M=h[v];if(M.length<2)throw'autocommand "'+M+'" not minimum length of 2';if(k[M]===Au)throw'"'+M+'" is a built-in operator name';p[M]=1,m=n(m,M.length)}return p._maxLength=m,p},ie.prototype.quietEmptyDelimiters={},he.quietEmptyDelimiters=function(T){T===void 0&&(T="");for(var h=T.split(" "),p={},m=0;m<h.length;m+=1){var v=h[m];p[v]=1}return p},ie.prototype.autoParenthesizedFunctions={_maxLength:0},he.autoParenthesizedFunctions=function(T){if(typeof T!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(T))throw'"'+T+'" not a space-delimited list of only letters';for(var h=T.split(" "),p={},m=0,v=0;v<h.length;v+=1){var M=h[v];if(M.length<2)throw'autocommand "'+M+'" not minimum length of 2';p[M]=1,m=n(m,M.length)}return p._maxLength=m,p};function By(T,h){for(var p="",m=0;T instanceof So&&T.ctrlSeq===T.letter&&m<h;)p=T.letter+p,T=T[e],m+=1;return p}var So=function(T){bt(h,T);function h(p){var m=T.call(this,p)||this;return m.letter=p,m}return h.prototype.checkAutoCmds=function(p){var m;if(!this.shouldIgnoreSubstitutionInSimpleSubscript(p.options)){var v=p.options.autoCommands,M=v._maxLength||0;if(M>0)for(var B=(m=By(this,M))!==null&&m!==void 0?m:"";B.length;){if(v.hasOwnProperty(B)){for(var U=this,X=1;U&&X<B.length;X+=1,U=U[e]);new re(U,this).remove(),p[e]=U[e];var te=k[B],Ce;return ht(te)?Ce=new te(B):Ce=te(B),Ce.createLeftOf(p)}B=B.slice(1)}}},h.prototype.autoParenthesize=function(p){var m=p.parent.getEnd(t);if(!(m&&m instanceof As&&m.ctrlSeq==="\\left(")&&!this.shouldIgnoreSubstitutionInSimpleSubscript(p.options)){for(var v="",M=this,B=0,U=p.options.autoParenthesizedFunctions,X=U._maxLength||0,te=p.options.autoOperatorNames;M instanceof h&&B<X;)v=M.letter+v,M=M[e],B+=1;for(;v.length;){if(U.hasOwnProperty(v)&&te.hasOwnProperty(v))return p.parent.write(p,"(");v=v.slice(1)}}},h.prototype.createLeftOf=function(p){T.prototype.createLeftOf.call(this,p),this.checkAutoCmds(p),this.autoParenthesize(p)},h.prototype.italicize=function(p){return this.isItalic=p,this.isPartOfOperator=!p,p&&delete this.endsCategory,this.domFrag().toggleClass("dcg-mq-operator-name",!p),this},h.prototype.finalizeTree=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.siblingDeleted=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.siblingCreated=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.sharedSiblingMethod=function(p,m){m!==e&&this[t]instanceof h||this.autoUnItalicize(p)},h.prototype.autoUnItalicize=function(p){var m=p.autoOperatorNames;if(m._maxLength!==0&&!this.shouldIgnoreSubstitutionInSimpleSubscript(p)){for(var v=this.letter,M=this[e];M instanceof h;M=M[e])v=M.letter+v;for(var B=this[t];B instanceof h;B=B[t])v+=B.letter;var U=M&&M[t],X=B&&B[e];new re(U||this.parent.getEnd(e),X||this.parent.getEnd(t)).each(function(Z){Z instanceof h&&(Z.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),Z.ctrlSeq=Z.letter)});var te=m._maxLength||0;e:for(var Ce=0,ve=M[t]||this.parent.getEnd(e);ve&&Ce<v.length;Ce+=1,ve=ve[t])for(var ge=r(te,v.length-Ce);ge>0;ge-=1){var _e=v.slice(Ce,Ce+ge),Ae=void 0;if(m.hasOwnProperty(_e)){for(var nt=0,gt=ve;nt<ge;nt+=1,gt=gt[t])gt instanceof h&&(gt.italicize(!1),Ae=gt);var lt=qy.hasOwnProperty(_e);if(ve.ctrlSeq=(lt?"\\":"\\operatorname{")+ve.ctrlSeq,Ae.ctrlSeq+=lt?" ":"}",p.infixOperatorNames[_e]?Ae.endsCategory="infix":p.prefixOperatorNames[_e]&&(Ae.endsCategory="prefix"),PC.hasOwnProperty(_e)){var P=Ae[e],V=P&&P[e],F=V&&V[e];F.domFrag().addClass("dcg-mq-last")}if(this.shouldOmitPadding(ve[e])||ve.domFrag().addClass("dcg-mq-first"),!this.shouldOmitPadding(Ae[t]))if(Ae[t]instanceof tc){var G=Ae[t],Y=G.siblingCreated=G.siblingDeleted=function(){G.domFrag().toggleClass("dcg-mq-after-operator-name",!(G[t]instanceof As))};Y()}else Ae.domFrag().toggleClass("dcg-mq-last",!(Ae[t]instanceof As));Ce+=ge-1,ve=Ae;continue e}}}},h.prototype.shouldOmitPadding=function(p){return!!(!p||p.ctrlSeq==="."||p instanceof ga&&p.isBinaryOperator()||p instanceof Ru)},h}(Nd),qy={};ie.prototype.autoOperatorNames=SC();var PC={limsup:1,liminf:1,projlim:1,injlim:1};function SC(){for(var T={_maxLength:9},h="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),p=0;p<h.length;p+=1)qy[h[p]]=T[h[p]]=1;for(var m="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),p=0;p<m.length;p+=1)qy[m[p]]=1;for(var v="sin cos tan sec cosec csc cotan cot ctg".split(" "),p=0;p<v.length;p+=1)T[v[p]]=T["arc"+v[p]]=T[v[p]+"h"]=T["ar"+v[p]+"h"]=T["arc"+v[p]+"h"]=1;for(var M="gcf hcf lcm proj span".split(" "),p=0;p<M.length;p+=1)T[M[p]]=1;return T}he.autoOperatorNames=function(T){if(typeof T!="string")throw'"'+T+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(T))throw'"'+T+'" not a space-delimited list of letters or "|"';for(var h=T.split(" "),p={},m=0,v=0;v<h.length;v+=1){var M=h[v];if(M.length<2)throw'"'+M+'" not minimum length of 2';if(M.indexOf("|")<0)p[M]=M,m=n(m,M.length);else{var B=M.split("|");if(B.length>2)throw'"'+M+'" has more than 1 mathspeak delimiter';if(B[0].length<2)throw'"'+M[0]+'" not minimum length of 2';p[B[0]]=B[1].replace(/-/g," "),m=n(m,B[0].length)}}return p._maxLength=m,p},ie.prototype.infixOperatorNames={},he.infixOperatorNames=Xf,ie.prototype.prefixOperatorNames={},he.prefixOperatorNames=Xf;function Xf(T){if(typeof T!="string")throw'"'+T+'" not a space-delimited list';if(!/^[a-z]+(?: [a-z]+)*$/i.test(T))throw'"'+T+'" not a space-delimited list of letters';for(var h=T.split(" "),p={},m=0;m<h.length;m+=1){var v=h[m];if(v.length<2)throw'"'+v+'" not minimum length of 2';p[v]=!0}return p}var Au=function(T){bt(h,T);function h(p){return T.call(this,p||"")||this}return h.prototype.createLeftOf=function(p){for(var m=this.ctrlSeq,v=0;v<m.length;v+=1)new So(m.charAt(v)).createLeftOf(p)},h.prototype.parser=function(){for(var p=this.ctrlSeq,m=new Ba,v=0;v<p.length;v+=1)new So(p.charAt(v)).adopt(m,m.getEnd(t),0);return Ft.succeed(m.children())},h}(pa);for(var zy in ie.prototype.autoOperatorNames)ie.prototype.autoOperatorNames.hasOwnProperty(zy)&&(k[zy]=Au);k.operatorname=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.createLeftOf=function(){},h.prototype.numBlocks=function(){return 1},h.prototype.parser=function(){return _i.block.map(function(p){var m=!0,v="",M=p.children();return M.each(function(B){B instanceof So?v+=B.letter:m=!1}),m&&v==="ans"?oT():M})},h}($i),k.f=function(T){bt(h,T);function h(){var p=this,m="f";return p=T.call(this,m)||this,p.letter=m,p.domView=new Hi(0,function(){return l("var",{class:"dcg-mq-f"},[l.text("f")])}),p}return h.prototype.italicize=function(p){return this.domFrag().eachElement(function(m){return m.textContent="f"}),this.domFrag().toggleClass("dcg-mq-f",p),T.prototype.italicize.call(this,p)},h}(So),k[" "]=k.space=function(){return new Wf("\\ ",l("span",{},[l.text(d)])," ")},k["."]=function(){return new Wf(".",l("span",{class:"dcg-mq-digit"},[l.text(".")]),".")},k["'"]=k.prime=Yi("'","&prime;","prime"),k["\u2033"]=k.dprime=Yi("\u2033","&Prime;","double prime"),k.backslash=Yi("\\backslash ","\\","backslash"),Ke["\\"]||(Ke["\\"]=k.backslash),k.$=Yi("\\$","$","dollar"),k["\u25A1"]=k.square=Yi("\\square ","\u25A1","square"),k.mid=Yi("\\mid ","\u2223","mid");var Ou=function(T){bt(h,T);function h(p,m,v){return T.call(this,p,l("span",{class:"dcg-mq-nonSymbola"},[m||l.text(p)]))||this}return h}(pa);k["@"]=function(){return new Ou("@")},k["&"]=function(){return new Ou("\\&",l.entityText("&amp;"),"and")},k["%"]=function(T){bt(h,T);function h(){return T.call(this,"\\%",l.text("%"),"percent")||this}return h.prototype.parser=function(){var p=Ft.optWhitespace,m=Ft.string;return p.then(m("\\operatorname{of}").map(function(){return aT()})).or(T.prototype.parser.call(this))},h}(Ou),k["\u2225"]=k.parallel=Yi("\\parallel ","&#x2225;","parallel"),k["\u2226"]=k.nparallel=Yi("\\nparallel ","&#x2226;","not parallel"),k["\u27C2"]=k.perp=Yi("\\perp ","&#x27C2;","perpendicular");function Wi(T){return Ds("\\"+T+" ","&"+T+";",T)}k.\u03B1=k.alpha=Wi("alpha"),k.\u03B2=k.beta=Wi("beta"),k.\u03B3=k.gamma=Wi("gamma"),k.\u03B4=k.delta=Wi("delta"),k.\u03B6=k.zeta=Wi("zeta"),k.\u03B7=k.eta=Wi("eta"),k.\u03B8=k.theta=Wi("theta"),k.\u03B9=k.iota=Wi("iota"),k.\u03BA=k.kappa=Wi("kappa"),k.\u03BC=k.mu=Wi("mu"),k.\u03BD=k.nu=Wi("nu"),k.\u03BE=k.xi=Wi("xi"),k.\u03C1=k.rho=Wi("rho"),k.\u03C3=k.sigma=Wi("sigma"),k.\u03C4=k.tau=Wi("tau"),k.\u03C7=k.chi=Wi("chi"),k.\u03C8=k.psi=Wi("psi"),k.\u03C9=k.omega=Wi("omega"),k.\u03D5=k.phi=Ds("\\phi ","&#981;","phi"),k.\u03C6=k.phiv=k.varphi=Ds("\\varphi ","&phi;","phi"),k["\u03F5"]=k.epsilon=Ds("\\epsilon ","&#1013;","epsilon"),k.\u03B5=k.epsiv=k.varepsilon=Ds("\\varepsilon ","&epsilon;","epsilon"),k.\u03D6=k.piv=k.varpi=Ds("\\varpi ","&piv;","piv"),k.\u03C2=k.sigmaf=k.sigmav=k.varsigma=Ds("\\varsigma ","&sigmaf;","sigma"),k.\u03D1=k.thetav=k.vartheta=k.thetasym=Ds("\\vartheta ","&thetasym;","theta"),k.\u03C5=k.upsilon=k.upsi=Ds("\\upsilon ","&upsilon;","upsilon"),k.\u03DC=k.gammad=k.Gammad=k.digamma=Ds("\\digamma ","&#989;","gamma"),k.\u03F0=k.kappav=k.varkappa=Ds("\\varkappa ","&#1008;","kappa"),k.\u03F1=k.rhov=k.varrho=Ds("\\varrho ","&#1009;","rho"),k.pi=k.\u03C0=function(){return new Ou("\\pi ",l.entityText("&pi;"),"pi")},k.\u03BB=k.lambda=function(){return new Ou("\\lambda ",l.entityText("&lambda;"),"lambda")},k.\u03A5=k.Upsilon=k.Upsi=k.upsih=k.Upsih=function(){return new pa("\\Upsilon ",l("var",{style:"font-family: serif"},[l.entityText("&upsih;")]),"capital upsilon")};function ec(T){return function(){return new ll("\\"+T+" ",l.entityText("&"+T+";"))}}k.\u0393=k.Gamma=ec("Gamma"),k.\u0394=k.Delta=ec("Delta"),k.\u0398=k.Theta=ec("Theta"),k.\u039B=k.Lambda=ec("Lambda"),k.\u039E=k.Xi=ec("Xi"),k.\u03A0=k.Pi=ec("Pi"),k.\u03A3=k.Sigma=ec("Sigma"),k.\u03A6=k.Phi=ec("Phi"),k.\u03A8=k.Psi=ec("Psi"),k.\u03A9=k.Omega=ec("Omega"),k["\u2200"]=k.forall=ec("forall");var qa=function(T){bt(h,T);function h(p){var m=T.call(this)||this;return m.latexStr=p,m}return h.prototype.createLeftOf=function(p){var m=_i.parse(this.latexStr);m.children().adopt(p.parent,p[e],p[t]),p[e]=m.getEnd(t),A(m.html()).insertBefore(p.domFrag()),m.finalizeInsert(p.options,p);var v=m.getEnd(t),M=v&&v[t];M&&M.siblingCreated(p.options,e);var B=m.getEnd(e),U=B&&B[e];U&&U.siblingCreated(p.options,t),p.parent.bubble(function(X){X.reflow()})},h.prototype.mathspeak=function(){return _i.parse(this.latexStr).mathspeak()},h.prototype.parser=function(){var p=_i.parse(this.latexStr).children();return Ft.succeed(p)},h}($i);k["\u2070"]=function(){return new qa("^0")},k["\xB9"]=function(){return new qa("^1")},k["\xB2"]=function(){return new qa("^2")},k["\xB3"]=function(){return new qa("^3")},k["\u2074"]=function(){return new qa("^4")},k["\u2075"]=function(){return new qa("^5")},k["\u2076"]=function(){return new qa("^6")},k["\u2077"]=function(){return new qa("^7")},k["\u2078"]=function(){return new qa("^8")},k["\u2079"]=function(){return new qa("^9")},k["\xBC"]=function(){return new qa("\\frac14")},k["\xBD"]=function(){return new qa("\\frac12")},k["\xBE"]=function(){return new qa("\\frac34")},k["\u221A"]=function(){return new qa("\\sqrt{}")};function Uy(T){return T instanceof ga||T instanceof So&&T.endsCategory=="infix"}function dg(T){if(!T)return!1;var h=T[e];if(h){if(Uy(h)||h instanceof So&&h.endsCategory=="prefix"||!(h instanceof As)&&/^(\\ )|[,;:\(\[]$/.test(h.ctrlSeq))return!1}else return T.parent&&T.parent.parent&&T.parent.parent.isStyleBlock()?dg(T.parent.parent):!1;return!0}var pg=function(T){bt(h,T);function h(p,m,v){return T.call(this,p,m,void 0,v,!0)||this}return h.prototype.isBinaryOperator=function(){return dg(this)},h.prototype.contactWeld=function(p,m){this.sharedSiblingMethod(p.options,m)},h.prototype.siblingCreated=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.siblingDeleted=function(p,m){this.sharedSiblingMethod(p,m)},h.prototype.sharedSiblingMethod=function(p,m){if(m!==t)return this.domFrag().oneElement().className=dg(this)?"dcg-mq-binary-operator":"",this},h}(ga);k["+"]=function(T){bt(h,T);function h(){return T.call(this,"+",l.text("+"))||this}return h.prototype.mathspeak=function(){return dg(this)?"plus":"positive"},h}(pg);var tT=function(T){bt(h,T);function h(){return T.call(this,"-",l.entityText("&minus;"))||this}return h.prototype.mathspeak=function(){return dg(this)?"minus":"negative"},h}(pg);k["\u2212"]=k["\u2014"]=k["\u2013"]=k["-"]=tT,k["\xB1"]=k.pm=k.plusmn=k.plusminus=function(){return new pg("\\pm ",l.entityText("&plusmn;"),"plus-or-minus")},k.mp=k.mnplus=k.minusplus=function(){return new pg("\\mp ",l.entityText("&#8723;"),"minus-or-plus")},Ke["*"]=k.sdot=k.cdot=Wl("\\cdot ","&middot;","*","times");var Kf=function(T){bt(h,T);function h(){return T.call(this,"\\to ",l.entityText("&rarr;"),"to")||this}return h.prototype.deleteTowards=function(p,m){if(p===e){var v=m[e];new re(v,this).remove(),m[e]=v[e],new tT().createLeftOf(m),m[e].bubble(function(M){M.reflow()});return}T.prototype.deleteTowards.call(this,p,m)},h}(ga);k["\u2192"]=k.to=Kf;var Rd=function(T){bt(h,T);function h(p,m){var v=this,M=m?"Strict":"";return v=T.call(this,p["ctrlSeq".concat(M)],l.entityText(p["htmlEntity".concat(M)]),p["text".concat(M)],p["mathspeak".concat(M)])||this,v.data=p,v.strict=m,v}return h.prototype.swap=function(p){this.strict=p;var m=p?"Strict":"";this.ctrlSeq=this.data["ctrlSeq".concat(m)],this.domFrag().children().replaceWith(A(l.entityText(this.data["htmlEntity".concat(m)]))),this.textTemplate=[this.data["text".concat(m)]],this.mathspeakName=this.data["mathspeak".concat(m)]},h.prototype.deleteTowards=function(p,m){if(p===e&&!this.strict){this.swap(!0),this.bubble(function(v){v.reflow()});return}T.prototype.deleteTowards.call(this,p,m)},h}(ga),Hy={ctrlSeq:"\\le ",htmlEntity:"&le;",text:"\u2264",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlEntityStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},rT={ctrlSeq:"\\ge ",htmlEntity:"&ge;",text:"\u2265",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlEntityStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"},MC=function(T){bt(h,T);function h(){return T.call(this,rT,!0)||this}return h.prototype.createLeftOf=function(p){var m=p[e];if(m instanceof ga&&m.ctrlSeq==="-"){var v=m;p[e]=v[e],v.remove(),new Kf().createLeftOf(p),p[e].bubble(function(M){M.reflow()});return}T.prototype.createLeftOf.call(this,p)},h}(Rd);k["<"]=k.lt=function(){return new Rd(Hy,!0)},k[">"]=k.gt=MC,k["\u2264"]=k.le=k.leq=function(){return new Rd(Hy,!1)},k["\u2265"]=k.ge=k.geq=function(){return new Rd(rT,!1)},k["\u221E"]=k.infty=k.infin=k.infinity=Yi("\\infty ","&infin;","infinity"),k["\u2260"]=k.ne=k.neq=Wl("\\ne ","&ne;","not equal");var nT=function(T){bt(h,T);function h(){return T.call(this,"=",l.text("="),"=","equals")||this}return h.prototype.createLeftOf=function(p){var m=p[e];if(m instanceof Rd&&m.strict){m.swap(!1),m.bubble(function(v){v.reflow()});return}T.prototype.createLeftOf.call(this,p)},h}(ga);k["="]=nT,k["\xD7"]=k.times=k.cross=Wl("\\times ","&times;","[x]","times"),k["\xF7"]=k.div=k.divide=k.divides=Wl("\\div ","&divide;","[/]","over");var $y=function(T){bt(h,T);function h(){return T.call(this,"\\sim ",l.text("~"),"~","tilde")||this}return h.prototype.createLeftOf=function(p){if(p[e]instanceof h){var m=p[e];p[e]=m[e],m.remove(),new kd().createLeftOf(p),p[e].bubble(function(v){v.reflow()});return}T.prototype.createLeftOf.call(this,p)},h}(ga),kd=function(T){bt(h,T);function h(){return T.call(this,"\\approx ",l.entityText("&approx;"),"\u2248","approximately equal")||this}return h.prototype.deleteTowards=function(p,m){if(p===e){var v=m[e];new re(v,this).remove(),m[e]=v[e],new $y().createLeftOf(m),m[e].bubble(function(M){M.reflow()});return}T.prototype.deleteTowards.call(this,p,m)},h}(ga);k.tildeNbsp=Yi("~",d," "),k.sim=$y,k["\u2248"]=k.approx=kd,Ke["~"]=k.sim,k["~"]=k.tildeNbsp,he.interpretTildeAsSim=function(T){var h=!!T;return h?k["~"]=k.sim:k["~"]=k.tildeNbsp,h},k["\u25EF"]=k.bigcirc=Yi("\\bigcirc ","&#9711;","circle"),k["\u2220"]=k.ang=k.angle=Yi("\\angle ","&ang;","angle"),k["\xB0"]=k.degree=Yi("\\degree ","&deg;","degrees"),k["\u25B3"]=k.triangle=Yi("\\triangle ","&#9651;","triangle"),k["\u2245"]=k.cong=Wl("\\cong ","&cong;","cong","congruent"),k["\u2221"]=k.measuredangle=Yi("\\measuredangle ","&#8737;","measured angle"),k["\u25B1"]=k.parallelogram=Yi("\\parallelogram ","&#9649;","parallelogram"),k["\u2247"]=k.ncong=Wl("\\ncong ","&ncong;","ncong","not congruent"),k["\u2241"]=k.nsim=Wl("\\nsim ","&nsim;","nsim","not similar");var Lu={sqrt:{width:"",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 32 54"},[l("path",{d:"M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33"})])}},"|":{width:".4em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M4.4 0 L4.4 54 L5.6 54 L5.6 0"})])}},"[":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[l("path",{d:"M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1"})])}},"]":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[l("path",{d:"M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1"})])}},"(":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[l("path",{d:"M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0"})])}},")":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[l("path",{d:"M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0"})])}},"{":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[l("path",{d:"M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0"})])}},"}":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[l("path",{d:"M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0"})])}},"&#8741;":{width:".7em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0"})])}},"&lang;":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0"})])}},"&rang;":{width:".55em",html:function(){return l("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[l("path",{d:"M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0"})])}}},Nu="\u27A4",_s=function(T){bt(h,T);function h(p,m,v,M,B){var U=T.call(this,p,new Hi(1,function(X){var te,Ce;return l.block(m,v,X[0],{beforeChild:(te=B==null?void 0:B.beforeChild)===null||te===void 0?void 0:te.call(B),afterChild:(Ce=B==null?void 0:B.afterChild)===null||Ce===void 0?void 0:Ce.call(B)})}))||this;return U.ariaLabel=M||p.replace(/^\\/,""),U.mathspeakTemplate=["Start"+U.ariaLabel+",","End"+U.ariaLabel],U.shouldNotSpeakDelimiters=B&&B.shouldNotSpeakDelimiters,U}return h.prototype.mathspeak=function(p){return!this.shouldNotSpeakDelimiters||p&&p.ignoreShorthand?T.prototype.mathspeak.call(this):this.foldChildren("",function(m,v){return m+" "+v.mathspeak(p)}).trim()},h}($i);k.mathrm=function(T){bt(h,T);function h(){return T.call(this,"\\mathrm","span",{class:"dcg-mq-roman dcg-mq-font"},"Roman Font",{shouldNotSpeakDelimiters:!0})||this}return h.prototype.isTextBlock=function(){return!0},h}(_s),k.mathit=function(){return new _s("\\mathit","i",{class:"dcg-mq-font"},"Italic Font")},k.mathbf=function(){return new _s("\\mathbf","b",{class:"dcg-mq-font"},"Bold Font")},k.mathsf=function(){return new _s("\\mathsf","span",{class:"dcg-mq-sans-serif dcg-mq-font"},"Serif Font")},k.mathtt=function(){return new _s("\\mathtt","span",{class:"dcg-mq-monospace dcg-mq-font"},"Math Text")},k.underline=function(){return new _s("\\underline","span",{class:"dcg-mq-non-leaf dcg-mq-underline"},"Underline")},k.overline=k.bar=function(){return new _s("\\overline","span",{class:"dcg-mq-non-leaf dcg-mq-overline"},"Overline")},k.overrightarrow=function(){return new _s("\\overrightarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Right Arrow",{afterChild:function(){return l("span",{class:"dcg-mq-arrow-right-content"},[l.text(Nu)])}})},k.overleftarrow=function(){return new _s("\\overleftarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Left Arrow",{beforeChild:function(){return l("span",{class:"dcg-mq-arrow-left-content"},[l.text(Nu)])}})},k.overleftrightarrow=function(){return new _s("\\overleftrightarrow ","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow"},"Over Left and Right Arrow",{beforeChild:function(){return l("span",{class:"dcg-mq-arrow-left-content"},[l.text(Nu)])},afterChild:function(){return l("span",{class:"dcg-mq-arrow-right-content"},[l.text(Nu)])}})},k.overarc=function(){return new _s("\\overarc","span",{class:"dcg-mq-non-leaf dcg-mq-overarc"},"Over Arc")},k.dot=function(){return new $i("\\dot",new Hi(1,function(T){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-dot-recurring-inner"},[l("span",{class:"dcg-mq-dot-recurring"},[l.text(g)]),l.block("span",{class:"dcg-mq-empty-box"},T[0])])])}))},k.textcolor=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.setColor=function(p){this.color=p,this.domView=new Hi(1,function(m){return l.block("span",{class:"dcg-mq-textcolor",style:"color:"+p},m[0])}),this.ariaLabel=p.replace(/^\\/,""),this.mathspeakTemplate=["Start "+this.ariaLabel+",","End "+this.ariaLabel]},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p);var m=this.blocks[0];p.latex+="\\textcolor{"+this.color+"}{",m.latexRecursive(p),p.latex+="}",this.checkCursorContextClose(p)},h.prototype.parser=function(){var p=this,m=Ft.optWhitespace,v=Ft.string,M=Ft.regex;return m.then(v("{")).then(M(/^[#\w\s.,()%-]*/)).skip(v("}")).then(function(B){return p.setColor(B),T.prototype.parser.call(p)})},h.prototype.isStyleBlock=function(){return!0},h}($i);var DC=k.class=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.parser=function(){var p=this,m=Ft.string,v=Ft.regex;return Ft.optWhitespace.then(m("{")).then(v(/^[-\w\s\\\xA0-\xFF]*/)).skip(m("}")).then(function(M){return p.cls=M||"",p.domView=new Hi(1,function(B){return l.block("span",{class:"dcg-mq-class ".concat(M)},B[0])}),p.ariaLabel=M+" class",p.mathspeakTemplate=["Start "+p.ariaLabel+",","End "+p.ariaLabel],T.prototype.parser.call(p)})},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p);var m=this.blocks[0];p.latex+="\\class{"+this.cls+"}{",m.latexRecursive(p),p.latex+="}",this.checkCursorContextClose(p)},h.prototype.isStyleBlock=function(){return!0},h}($i),jf=/^[\+\-]?[\d]+$/;function Zf(T){if(!T)return"";var h="";return T.eachChild(function(p){p.ctrlSeq!==void 0&&(h+=p.ctrlSeq)}),h}ie.prototype.charsThatBreakOutOfSupSub="";var tc=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.ctrlSeq="_{...}^{...}",p}return h.prototype.setEnds=function(p){a("SupSub ends must be MathBlocks",p[e]instanceof Ba&&p[t]instanceof Ba),this.ends=p},h.prototype.getEnd=function(p){return this.ends[p]},h.prototype.createLeftOf=function(p){if(!(!this.replacedFragment&&!p[e]&&p.options.supSubsRequireOperand))return T.prototype.createLeftOf.call(this,p)},h.prototype.contactWeld=function(p){for(var m=e;m;m=m===e?t:!1){var v=this[m],M=void 0;if(v instanceof h){for(var B="sub";B;B=B==="sub"?"sup":!1){var U=this[B],X=v[B];if(U){if(!X)v.addBlock(U.disown());else if(U.isEmpty())M=new j(X,0,X.getEnd(e));else{U.domFrag().children().insAtDirEnd(-m,X.domFrag().oneElement());var te=U.children().disown();M=new j(X,te.getEnd(t),X.getEnd(e)),m===e?te.adopt(X,X.getEnd(t),0):te.adopt(X,0,X.getEnd(e))}this.placeCursor=function(Ce,ve){return function(ge){ge.insAtDirEnd(-m,Ce||ve)}}(X,U)}}this.remove(),p&&p[e]===this&&(m===t&&M?M[e]?p.insRightOf(M[e]):p.insAtLeftEnd(M.parent):p.insRightOf(v));break}}},h.prototype.finalizeTree=function(){var p=this.getEnd(e);p.write=function(m,v){if(m.options.autoSubscriptNumerals&&this===this.parent.sub&&"0123456789".indexOf(v)>=0){var M=this.chToCmd(v,m.options);M instanceof pa?m.deleteSelection():m.clearSelection().insRightOf(this.parent),M.createLeftOf(m.show()),m.controller.aria.queue("Baseline").alert(M.mathspeak({createdLeftOf:m}));return}m[e]&&!m[t]&&!m.selection&&m.options.charsThatBreakOutOfSupSub.indexOf(v)>-1&&(m.insRightOf(this.parent),m.controller.aria.queue("Baseline")),Ba.prototype.write.call(this,m,v)}},h.prototype.moveTowards=function(p,m,v){m.options.autoSubscriptNumerals&&!this.sup?m.insDirOf(p,this):T.prototype.moveTowards.call(this,p,m,v)},h.prototype.deleteTowards=function(p,m){if(m.options.autoSubscriptNumerals&&this.sub){var v=this.sub.getEnd(-p);v instanceof pa?v.remove():v&&v.deleteTowards(p,m.insAtDirEnd(-p,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(e,m.insAtLeftEnd(this.sub)),this.sup&&m.insDirOf(-p,this))}else T.prototype.deleteTowards.call(this,p,m)},h.prototype.latexRecursive=function(p){if(this.checkCursorContextOpen(p),this.sub){p.latex+="_{";var m=p.latex.length;this.sub.latexRecursive(p);var v=p.latex.length;m===v&&(p.latex+=" "),p.latex+="}"}if(this.sup){p.latex+="^{";var m=p.latex.length;this.sup.latexRecursive(p);var v=p.latex.length;m===v&&(p.latex+=" "),p.latex+="}"}this.checkCursorContextClose(p)},h.prototype.text=function(){function p(m,v){var M=v&&v.text()||"";return v?m+(M.length===1?M:"("+(M||" ")+")"):""}return p("_",this.sub)+p("^",this.sup)},h.prototype.addBlock=function(p){this.supsub==="sub"?(this.sup=this.upInto=this.sub.upOutOf=p,p.adopt(this,this.sub,0).downOutOf=this.sub,p.setDOM(A(l("span",{class:"dcg-mq-sup"})).append(p.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()),ee.linkElementByBlockNode(p.domFrag().oneElement(),p)):(this.sub=this.downInto=this.sup.downOutOf=p,p.adopt(this,0,this.sup).upOutOf=this.sup,this.domFrag().removeClass("dcg-mq-sup-only"),p.setDOM(A(l("span",{class:"dcg-mq-sub"})).append(p.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()),ee.linkElementByBlockNode(p.domFrag().oneElement(),p),this.domFrag().append(A(l("span",{style:"display:inline-block;width:0"},[l.text(f)]))));for(var m=0;m<2;m+=1)(function(v,M,B,U){var X=v[M];X.deleteOutOf=function(te,Ce){if(Ce.insDirOf(this[te]?-te:te,this.parent),!this.isEmpty()){var ve=this.getEnd(te);this.children().disown().withDirAdopt(te,Ce.parent,Ce[te],Ce[-te]).domFrag().insDirOf(-te,Ce.domFrag()),Ce[-te]=ve}v.supsub=B,delete v[M],delete v["".concat(U,"Into")];var ge=v[B];ge["".concat(U,"OutOf")]=Jf,delete ge.deleteOutOf,M==="sub"&&v.domFrag().addClass("dcg-mq-sup-only").children().last().remove(),this.remove()}})(this,"sub sup".split(" ")[m],"sup sub".split(" ")[m],"down up".split(" ")[m])},h}($i);function Jf(T){var h=this.parent,p=T;do{if(p[t])return T.insLeftOf(h);p=p.parent.parent}while(p!==h);T.insRightOf(h)}var iT=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.supsub="sub",p.domView=new Hi(1,function(m){return l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[l.block("span",{class:"dcg-mq-sub"},m[0]),l("span",{style:"display:inline-block;width:0"},[l.text(f)])])}),p.textTemplate=["_"],p.mathspeakTemplate=["Subscript,",", Baseline"],p.ariaLabel="subscript",p}return h.prototype.finalizeTree=function(){this.downInto=this.sub=this.getEnd(e),this.sub.upOutOf=Jf,T.prototype.finalizeTree.call(this)},h}(tc);k.subscript=k._=iT,k.superscript=k.supscript=k["^"]=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.supsub="sup",p.domView=new Hi(1,function(m){return l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"},[l.block("span",{class:"dcg-mq-sup"},m[0])])}),p.textTemplate=["^(",")"],p.ariaLabel="superscript",p.mathspeakTemplate=["Superscript,",", Baseline"],p}return h.prototype.mathspeak=function(p){var m=this.upInto;if(m!==void 0){var v=Zf(m);if((!p||!p.ignoreShorthand)&&jf.test(v)){if(v==="0")return"to the 0 power";if(v==="2")return"squared";if(v==="3")return"cubed";var M="";/^[+-]?\d{1,3}$/.test(v)&&(/(11|12|13|4|5|6|7|8|9|0)$/.test(v)?M="th":/1$/.test(v)?M="st":/2$/.test(v)?M="nd":/3$/.test(v)&&(M="rd"));var B=typeof m=="object"?m.mathspeak():v;return"to the "+B+M+" power"}}return T.prototype.mathspeak.call(this)},h.prototype.finalizeTree=function(){this.upInto=this.sup=this.getEnd(t),this.sup.downOutOf=Jf,T.prototype.finalizeTree.call(this)},h}(tc);var Ru=function(T){bt(h,T);function h(p,m,v){var M=T.call(this)||this;M.ariaLabel=v||p.replace(/^\\/,"");var B=new Hi(2,function(U){return l("span",{class:"dcg-mq-large-operator dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-to"},[l.block("span",{},U[1])]),l("big",{},[l.text(m)]),l("span",{class:"dcg-mq-from"},[l.block("span",{},U[0])])])});return pa.prototype.setCtrlSeqHtmlTextAndMathspeak.call(M,p,B),M}return h.prototype.createLeftOf=function(p){T.prototype.createLeftOf.call(this,p),p.options.sumStartsWithNEquals&&(new So("n").createLeftOf(p),new nT().createLeftOf(p))},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),p.latex+=this.ctrlSeq+"_{";var m=p.latex.length;this.getEnd(e).latexRecursive(p);var v=p.latex.length;v===m&&(p.latex+=" "),p.latex+="}^{",m=p.latex.length,this.getEnd(t).latexRecursive(p),v=p.latex.length,m===v&&(p.latex+=" "),p.latex+="}",this.checkCursorContextClose(p)},h.prototype.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.getEnd(e).mathspeak()+" to "+this.getEnd(t).mathspeak()+", end "+this.ariaLabel+", "},h.prototype.parser=function(){for(var p=Ft.string,m=Ft.optWhitespace,v=Ft.succeed,M=_i.block,B=this,U=B.blocks=[new Ba,new Ba],X=0;X<U.length;X+=1)U[X].adopt(B,B.getEnd(t),0);return m.then(p("_").or(p("^"))).then(function(te){var Ce=U[te==="_"?0:1];return M.then(function(ve){return ve.children().adopt(Ce,Ce.getEnd(t),0),v(B)})}).many().result(B)},h.prototype.finalizeTree=function(){var p=this.getEnd(e),m=this.getEnd(t);p.ariaLabel="lower bound",m.ariaLabel="upper bound",this.downInto=p,this.upInto=m,p.upOutOf=m,m.downOutOf=p},h}($i);k["\u2211"]=k.sum=k.summation=function(){return new Ru("\\sum ",y,"sum")},k["\u220F"]=k.prod=k.product=function(){return new Ru("\\prod ",x,"product")},k.coprod=k.coproduct=function(){return new Ru("\\coprod ",b,"co product")},k["\u222B"]=k.int=k.integral=function(T){bt(h,T);function h(){var p=T.call(this,"\\int ","","integral")||this;return p.ariaLabel="integral",p.domView=new Hi(2,function(m){return l("span",{class:"dcg-mq-int dcg-mq-non-leaf"},[l("big",{},[l.text(w)]),l("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-sup"},[l.block("span",{class:"dcg-mq-sup-inner"},m[1])]),l.block("span",{class:"dcg-mq-sub"},m[0]),l("span",{style:"display:inline-block;width:0"},[l.text(f)])])])}),p}return h.prototype.createLeftOf=function(p){$i.prototype.createLeftOf.call(this,p)},h}(Ru);var Yy=k.frac=k.dfrac=k.cfrac=k.fraction=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.ctrlSeq="\\frac",p.domView=new Hi(2,function(m){return l("span",{class:"dcg-mq-fraction dcg-mq-non-leaf"},[l.block("span",{class:"dcg-mq-numerator"},m[0]),l.block("span",{class:"dcg-mq-denominator"},m[1]),l("span",{style:"display:inline-block;width:0"},[l.text(f)])])}),p.textTemplate=["(",")/(",")"],p}return h.prototype.finalizeTree=function(){var p=this.getEnd(e),m=this.getEnd(t);this.upInto=m.upOutOf=p,this.downInto=p.downOutOf=m,p.ariaLabel="numerator",m.ariaLabel="denominator",this.getFracDepth()>1?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},h.prototype.mathspeak=function(p){if(p&&p.createdLeftOf){var m=p.createdLeftOf;return m.parent.mathspeak()}var v=Zf(this.getEnd(e)),M=Zf(this.getEnd(t));if((!p||!p.ignoreShorthand)&&jf.test(v)&&jf.test(M)){var B=v==="1"||v==="-1",U="";if(M==="2"?U=B?"half":"halves":M==="3"?U=B?"third":"thirds":M==="4"?U=B?"quarter":"quarters":M==="5"?U=B?"fifth":"fifths":M==="6"?U=B?"sixth":"sixths":M==="7"?U=B?"seventh":"sevenths":M==="8"?U=B?"eighth":"eighths":M==="9"&&(U=B?"ninth":"ninths"),U!==""){for(var X="",te=!1,Ce=this[e];Ce&&Ce[e]!==void 0;Ce=Ce[e])if(Ce.ctrlSeq!=="\\ ")if(jf.test(Ce.ctrlSeq||""))te=!0;else{te=!1;break}return te&&(X+="and "),X+=this.getEnd(e).mathspeak()+" "+U,X}}return T.prototype.mathspeak.call(this)},h.prototype.getFracDepth=function(){var p=0,m=function(v,M){return v instanceof Ga&&v.ctrlSeq&&v.ctrlSeq.toLowerCase().search("frac")>=0&&(M+=1),v&&v.parent?m(v.parent,M):M};return m(this,p)},h}($i),_C=k.over=Ke["/"]=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.createLeftOf=function(p){if(!this.replacedFragment){var m=p[e],v=p.options.typingSlashCreatesNewFraction&&this instanceof Yy;if(!v)for(;m&&!(Uy(m)||m instanceof Wf&&m._groupingClass==="dcg-mq-ellipsis-end"||m instanceof(k.text||i)||m instanceof Ru||m.ctrlSeq==="\\ "||/^[,;:]$/.test(m.ctrlSeq));)m=m[e];if(m instanceof Ru&&m[t]instanceof tc){m=m[t];var M=m[t];M instanceof tc&&M.ctrlSeq!=m.ctrlSeq&&(m=m[t])}if(m!==p[e]&&!p.isTooDeep(1)){var M=m[t],B=p[e];this.replaces(new re(M||p.parent.getEnd(e),B)),p[e]=m}}T.prototype.createLeftOf.call(this,p)},h}(Yy),oT=function(){return new pa("\\operatorname{ans}",l("span",{class:"dcg-mq-ans"},[l.text("ans")]),"ans")};k.ans=oT;var aT=function(){return new pa("\\%\\operatorname{of}",l("span",{class:"dcg-mq-nonSymbola dcg-mq-operator-name"},[l.text("% of ")]),"percent of")};k.percent=k.percentof=aT;var AC=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.tokenId="",p.ctrlSeq="\\token",p.textTemplate=["token(",")"],p.mathspeakTemplate=["StartToken,",", EndToken"],p.ariaLabel="token",p}return h.prototype.html=function(){var p=l("span",{class:"dcg-mq-token dcg-mq-ignore-mousedown","data-dcg-mq-token":this.tokenId});return this.setDOM(p),ee.linkElementByCmdNode(p,this),p},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),p.latex+="\\token{"+this.tokenId+"}",this.checkCursorContextClose(p)},h.prototype.mathspeak=function(){var p=[];return this.domFrag().children().eachElement(function(m){var v=m.getAttribute("aria-label");typeof v=="string"&&v!==""&&p.push(v)}),p.length>0?p.join(" ").trim():"token "+this.tokenId},h.prototype.parser=function(){var p=this;return _i.block.map(function(m){var v=m.getEnd(e);if(v)for(p.tokenId+=v.ctrlSeq;v=v[t];)p.tokenId+=v.ctrlSeq;return p})},h}(pa);k.token=AC;var Wy=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.ctrlSeq="\\sqrt",p.domView=new Hi(1,function(m){return l("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-container"},[l("span",{class:"dcg-mq-scaled dcg-mq-sqrt-prefix"},[Lu.sqrt.html()]),l.block("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-stem"},m[0])])}),p.textTemplate=["sqrt(",")"],p.mathspeakTemplate=["StartRoot,",", EndRoot"],p.ariaLabel="root",p}return h.prototype.parser=function(){return _i.optBlock.then(function(p){return _i.block.map(function(m){var v=new Xy;return v.blocks=[p,m],p.adopt(v,0,0),m.adopt(v,p,0),v})}).or(T.prototype.parser.call(this))},h.prototype.deleteTowards=function(p,m){if(!this.isEmpty()&&p===1){this.moveTowards(t,m),m.parent.deleteOutOf(e,m);return}T.prototype.deleteTowards.call(this,p,m)},h}($i);k.sqrt=Wy,k.hat=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.ctrlSeq="\\hat",p.domView=new Hi(1,function(m){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-hat-prefix"},[l.text("^")]),l.block("span",{class:"dcg-mq-hat-stem"},m[0])])}),p.textTemplate=["hat(",")"],p}return h}($i);var Xy=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.domView=new Hi(2,function(m){return l("span",{class:"dcg-mq-nthroot-container dcg-mq-non-leaf"},[l.block("sup",{class:"dcg-mq-nthroot dcg-mq-non-leaf"},m[0]),l("span",{class:"dcg-mq-scaled dcg-mq-sqrt-container"},[l("span",{class:"dcg-mq-sqrt-prefix dcg-mq-scaled"},[Lu.sqrt.html()]),l.block("span",{class:"dcg-mq-sqrt-stem dcg-mq-non-leaf"},m[1])])])}),p.textTemplate=["sqrt[","](",")"],p}return h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),p.latex+="\\sqrt[",this.getEnd(e).latexRecursive(p),p.latex+="]{",this.getEnd(t).latexRecursive(p),p.latex+="}",this.checkCursorContextClose(p)},h.prototype.mathspeak=function(){var p=this.getEnd(e).mathspeak(),m=this.getEnd(t).mathspeak();return this.getEnd(e).ariaLabel="Index",this.getEnd(t).ariaLabel="Radicand",p==="3"?"Start Cube Root, "+m+", End Cube Root":"Root Index "+p+", Start Root, "+m+", End Root"},h.prototype.deleteTowards=function(p,m){$i.prototype.deleteTowards.call(this,p,m)},h}(Wy);k.nthroot=Xy,k.cbrt=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.createLeftOf=function(p){T.prototype.createLeftOf.call(this,p),new Ld("3").createLeftOf(p),p.controller.moveRight()},h}(Xy);var Ky=function(T){bt(h,T);function h(p,m,v){var M=new Hi(1,function(B){return l("span",{class:"dcg-mq-non-leaf"},[l("span",{class:"dcg-mq-diacritic-above"},[m]),l.block("span",{class:"dcg-mq-diacritic-stem"},B[0])])});return T.call(this,p,M,v)||this}return h}($i);k.vec=function(){return new Ky("\\vec",l.entityText("&rarr;"),["vec(",")"])},k.tilde=function(){return new Ky("\\tilde",l.text("~"),["tilde(",")"])};var jy=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.setDOM=function(p){var m;T.prototype.setDOM.call(this,p);var v=this.domFrag().children();return v.isEmpty()||(this.delimFrags=(m={},m[e]=v.first(),m[t]=v.last(),m)),this},h}($i),As=function(T){bt(h,T);function h(p,m,v,M,B){var U,X=T.call(this,"\\left"+M,void 0,[m,v])||this;return X.side=p,X.sides=(U={},U[e]={ch:m,ctrlSeq:M},U[t]={ch:v,ctrlSeq:B},U),X}return h.prototype.numBlocks=function(){return 1},h.prototype.html=function(){var p=this,m=this.getSymbol(e),v=this.getSymbol(t);return this.domView=new Hi(1,function(M){return l("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[l("span",{style:"width:"+m.width,class:"dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"+(p.side===t?" dcg-mq-ghost":"")},[m.html()]),l.block("span",{style:"margin-left:"+m.width+";margin-right:"+v.width,class:"dcg-mq-bracket-middle dcg-mq-non-leaf"},M[0]),l("span",{style:"width:"+v.width,class:"dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"+(p.side===e?" dcg-mq-ghost":"")},[v.html()])])}),T.prototype.html.call(this)},h.prototype.getSymbol=function(p){var m=this.sides[p||t].ch;return Lu[m]||{width:"0",html:""}},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),p.latex+="\\left"+this.sides[e].ctrlSeq,this.getEnd(e).latexRecursive(p),p.latex+="\\right"+this.sides[t].ctrlSeq,this.checkCursorContextClose(p)},h.prototype.mathspeak=function(p){var m=this.sides[e].ch,v=this.sides[t].ch;if(m==="|"&&v==="|")this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else if(p&&p.createdLeftOf&&this.side){var M="";return this.side===e?M=this.textTemplate[0]:this.side===t&&(M=this.textTemplate[1]),(this.side===e?"left ":"right ")+Fd[M]}else this.mathspeakTemplate=["left "+Fd[m]+",",", right "+Fd[v]],this.ariaLabel=Fd[m]+" block";return T.prototype.mathspeak.call(this)},h.prototype.matchBrack=function(p,m,v){return v instanceof h&&v.side&&v.side!==-m&&(!p.restrictMismatchedBrackets||Vd[this.sides[this.side].ch]===v.sides[v.side].ch||p.restrictMismatchedBrackets!=="none"&&{"(":"]","[":")"}[this.sides[e].ch]===v.sides[t].ch)&&v},h.prototype.closeOpposing=function(p){p.side=0,p.sides[this.side]=this.sides[this.side];var m=p.delimFrags[this.side===e?e:t].removeClass("dcg-mq-ghost");this.replaceBracket(m,this.side)},h.prototype.createLeftOf=function(p){var m;if(!this.replacedFragment){var v=p.options;this.sides[e].ch==="|"?m=this.matchBrack(v,t,p[t])||this.matchBrack(v,e,p[e])||this.matchBrack(v,0,p.parent.parent):m=this.matchBrack(v,-this.side,p[-this.side])||this.matchBrack(v,-this.side,p.parent.parent)}if(m){var M=this.side=-m.side;this.closeOpposing(m),m===p.parent.parent&&p[M]&&new re(p[M],p.parent.getEnd(M),-M).disown().withDirAdopt(-M,m.parent,m,m[M]).domFrag().insDirOf(M,m.domFrag()),m.bubble(function(B){B.reflow()})}else m=this,M=m.side,m.replacedFragment?m.side=0:p[-M]&&(m.replaces(new re(p[-M],p.parent.getEnd(-M),M)),p[-M]=0),T.prototype.createLeftOf.call(this,p);M===e?p.insAtLeftEnd(m.getEnd(e)):p.insRightOf(m)},h.prototype.placeCursor=function(){},h.prototype.unwrap=function(){this.getEnd(e).children().disown().adopt(this.parent,this,this[t]).domFrag().insertAfter(this.domFrag()),this.remove()},h.prototype.deleteSide=function(p,m,v){var M=this.parent,B=this[p],U=M.getEnd(p);if(p===this.side){this.unwrap(),B?v.insDirOf(-p,B):v.insAtDirEnd(p,M);return}var X=v.options,te=!this.side;if(this.side=-p,this.matchBrack(X,p,this.getEnd(e).getEnd(this.side))){this.closeOpposing(this.getEnd(e).getEnd(this.side));var Ce=this.getEnd(e).getEnd(p);this.unwrap(),Ce&&Ce.siblingCreated(v.options,p),B?v.insDirOf(-p,B):v.insAtDirEnd(p,M)}else{if(this.matchBrack(X,p,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(m&&te){this.unwrap(),B?v.insDirOf(-p,B):v.insAtDirEnd(p,M);return}else{this.sides[p]=Zy(this),this.delimFrags[e].removeClass("dcg-mq-ghost"),this.delimFrags[t].removeClass("dcg-mq-ghost");var ve=this.delimFrags[p].addClass("dcg-mq-ghost");this.replaceBracket(ve,p)}if(B){var ge=this.getEnd(e),Ce=ge.getEnd(p);ge.domFrag().removeClass("dcg-mq-empty"),new re(B,U,-p).disown().withDirAdopt(-p,ge,Ce,0).domFrag().insAtDirEnd(p,ge.domFrag().oneElement()),Ce&&Ce.siblingCreated(v.options,p),v.insDirOf(-p,B)}else m?v.insDirOf(p,this):v.insAtDirEnd(p,this.getEnd(e))}},h.prototype.replaceBracket=function(p,m){var v=this.getSymbol(m);if(p.children().replaceWith(A(v.html())),p.oneElement().style.width=v.width,m===e){var M=p.next();M.isEmpty()||(M.oneElement().style.marginLeft=v.width)}else{var B=p.prev();B.isEmpty()||(B.oneElement().style.marginRight=v.width)}},h.prototype.deleteTowards=function(p,m){this.deleteSide(-p,!1,m)},h.prototype.finalizeTree=function(){this.getEnd(e).deleteOutOf=function(p,m){this.parent.deleteSide(p,!0,m)},this.finalizeTree=this.intentionalBlur=function(){this.delimFrags[this.side===e?t:e].removeClass("dcg-mq-ghost"),this.side=0}},h.prototype.siblingCreated=function(p,m){m===-this.side&&this.finalizeTree()},h}(jy);function Zy(T){var h=T.side,p=T.sides[h];return{ch:Vd[p.ch],ctrlSeq:Vd[p.ctrlSeq]}}var Vd={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},Fd={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};function Jy(T,m,p){var m=m||T,v=Vd[T],M=Vd[m];Ke[T]=function(){return new As(e,T,v,m,M)},Ke[v]=function(){return new As(t,T,v,m,M)},Fd[T]=Fd[v]=p}Jy("(","","parenthesis"),Jy("[","","bracket"),Jy("{","\\{","brace"),k.langle=function(){return new As(e,"&lang;","&rang;","\\langle ","\\rangle ")},k.rangle=function(){return new As(t,"&lang;","&rang;","\\langle ","\\rangle ")},Ke["|"]=function(){return new As(e,"|","|","|","|")},k.lVert=function(){return new As(e,"&#8741;","&#8741;","\\lVert ","\\rVert ")},k.rVert=function(){return new As(t,"&#8741;","&#8741;","\\lVert ","\\rVert ")},k.left=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.parser=function(){var p=Ft.regex,m=Ft.string,v=Ft.optWhitespace;return v.then(p(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(M){var B=M.replace(/^\\/,"");return M=="\\langle"&&(B="&lang;",M=M+" "),M=="\\lVert"&&(B="&#8741;",M=M+" "),_i.then(function(U){return m("\\right").skip(v).then(p(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(X){var te=X.replace(/^\\/,"");X=="\\rangle"&&(te="&rang;",X=X+" "),X=="\\rVert"&&(te="&#8741;",X=X+" ");var Ce=new As(0,B,te,M,X);return Ce.blocks=[U],U.adopt(Ce,0,0),Ce})})})},h}($i),k.right=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.parser=function(){return Ft.fail("unmatched \\right")},h}($i);var Qy=Lu["("],Qf=Lu[")"],eb=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.ctrlSeq="\\binom",p.domView=new Hi(2,function(m){return l("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[l("span",{style:"width:"+Qy.width,class:"dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled"},[Qy.html()]),l("span",{style:"margin-left:"+Qy.width+"; margin-right:"+Qf.width,class:"dcg-mq-non-leaf dcg-mq-bracket-middle"},[l("span",{class:"dcg-mq-array dcg-mq-non-leaf"},[l.block("span",{},m[0]),l.block("span",{},m[1])])]),l("span",{style:"width:"+Qf.width,class:"dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled"},[Qf.html()])])}),p.textTemplate=["choose(",",",")"],p.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],p.ariaLabel="binomial",p}return h.prototype.finalizeTree=function(){var p=this.getEnd(e),m=this.getEnd(t);this.upInto=m.upOutOf=p,this.downInto=p.downOutOf=m,p.ariaLabel="upper index",m.ariaLabel="lower index"},h}(jy);k.binom=k.binomial=eb,k.choose=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.createLeftOf=function(p){_C.prototype.createLeftOf.call(this,p)},h}(eb);var em=function(T){bt(h,T);function h(){var p=T!==null&&T.apply(this,arguments)||this;return p.ctrlSeq="\\MathQuillMathField",p.domView=new Hi(1,function(m){return l("span",{class:"dcg-mq-editable-field"},[l.block("span",{class:"dcg-mq-root-block","aria-hidden":"true"},m[0])])}),p}return h.prototype.parser=function(){var p=this,m=Ft.string,v=Ft.regex,M=Ft.succeed;return m("[").then(v(/^[a-z][a-z0-9]*/i)).skip(m("]")).map(function(B){p.name=B}).or(M(void 0)).then(T.prototype.parser.call(this))},h.prototype.finalizeTree=function(p){var m=new Gy(this.getEnd(e),this.domFrag().oneElement(),p);m.KIND_OF_MQ="MathField",m.editable=!0,m.createTextarea(),m.editablesTextareaEvents(),m.cursor.insAtRightEnd(m.root),Ms(m.root);function v(M){if(M.parentNode&&!A(M).hasClass("dcg-mq-root-block")&&v(M.parentNode),M.nodeType===Node.ELEMENT_NODE){var B=M;B.getAttribute("aria-hidden")==="true"&&(B.removeAttribute("aria-hidden"),A(M).children().eachElement(function(U){U.setAttribute("aria-hidden","true")}))}}v(this.domFrag().parent().oneElement()),this.domFrag().oneElement().removeAttribute("aria-hidden")},h.prototype.registerInnerField=function(p,m){var v=this.getEnd(e).controller,M=new m(v);p[this.name]=M,p.push(M)},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),this.getEnd(e).latexRecursive(p),this.checkCursorContextClose(p)},h.prototype.text=function(){return this.getEnd(e).text()},h}($i);k.editable=k.MathQuillMathField=em;var sT=function(T){bt(h,T);function h(){return T!==null&&T.apply(this,arguments)||this}return h.prototype.setOptions=function(p){function m(){return""}return this.text=p.text||m,this.domView=new Hi(0,function(){return l("span",{},[c(p.htmlString||"")])}),this.latex=p.latex||m,this},h.prototype.latexRecursive=function(p){this.checkCursorContextOpen(p),p.latex+=this.latex(),this.checkCursorContextClose(p)},h.prototype.parser=function(){var p=this,m=Ft.string,v=Ft.regex,M=Ft.succeed;return m("{").then(v(/^[a-z][a-z0-9]*/i)).skip(m("}")).then(function(B){return m("[").then(v(/^[-\w\s]*/)).skip(m("]")).or(M(void 0)).map(function(U){return p.setOptions(at[B](U))})})},h}(pa);if(k.embed=sT,window.jQuery){Fe=Qe(1);for(var tb in Fe)(function(T,h){typeof h=="function"?(Je[T]=function(){return je(),h.apply(this,arguments)},Je[T].prototype=h.prototype):Je[T]=h})(tb,Fe[tb])}})()});var q8=Gd((B8,OR)=>{(function(e){if(typeof B8=="object"&&typeof OR!="undefined")OR.exports=e();else{var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t=this,t.Bugsnag=e()}})(function(){var e,t,r,n=["navigation","request","process","log","user","state","error","manual"],i=function(P,V,F){for(var G=F,Y=0,Z=P.length;Y<Z;Y++)G=V(G,P[Y],Y,P);return G},o=function(P,V){return i(P,function(F,G,Y,Z){return V(G,Y,Z)?F.concat(G):F},[])},a=function(P,V){return i(P,function(F,G,Y,Z){return F===!0||G===V},!1)},s=function(P){return Object.prototype.toString.call(P)==="[object Array]"},c=!{toString:null}.propertyIsEnumerable("toString"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(P){var V=[],F;for(F in P)Object.prototype.hasOwnProperty.call(P,F)&&V.push(F);if(!c)return V;for(var G=0,Y=l.length;G<Y;G++)Object.prototype.hasOwnProperty.call(P,l[G])&&V.push(l[G]);return V},d=function(P,V){return P===void 0&&(P=1),V===void 0&&(V=1/0),function(F){return typeof F=="number"&&parseInt(""+F,10)===F&&F>=P&&F<=V}},f=function(P){return typeof P=="function"||s(P)&&o(P,function(V){return typeof V=="function"}).length===P.length},g=function(P){return typeof P=="string"&&!!P.length},y={},x=function(){return{unhandledExceptions:!0,unhandledRejections:!0}};y.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:g},appVersion:{defaultValue:function(){},message:"should be a string",validate:function(P){return P===void 0||g(P)}},appType:{defaultValue:function(){},message:"should be a string",validate:function(P){return P===void 0||g(P)}},autoDetectErrors:{defaultValue:function(){return!0},message:"should be true|false",validate:function(P){return P===!0||P===!1}},enabledErrorTypes:{defaultValue:function(){return x()},message:"should be an object containing the flags { unhandledExceptions:true|false, unhandledRejections:true|false }",allowPartialObject:!0,validate:function(P){if(typeof P!="object"||!P)return!1;var V=u(P),F=u(x());return!(o(V,function(G){return a(F,G)}).length<V.length||o(u(P),function(G){return typeof P[G]!="boolean"}).length>0)}},onError:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:f},onSession:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:f},onBreadcrumb:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:f},endpoints:{defaultValue:function(){return{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}},message:"should be an object containing endpoint URLs { notify, sessions }",validate:function(P){return P&&typeof P=="object"&&g(P.notify)&&g(P.sessions)&&o(u(P),function(V){return!a(["notify","sessions"],V)}).length===0}},autoTrackSessions:{defaultValue:function(P){return!0},message:"should be true|false",validate:function(P){return P===!0||P===!1}},enabledReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(P){return P===null||s(P)&&o(P,function(V){return typeof V=="string"}).length===P.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(P){return typeof P=="string"&&P.length}},maxBreadcrumbs:{defaultValue:function(){return 25},message:"should be a number \u2264100",validate:function(P){return d(0,100)(P)}},enabledBreadcrumbTypes:{defaultValue:function(){return n},message:"should be null or a list of available breadcrumb types ("+n.join(",")+")",validate:function(P){return P===null||s(P)&&i(P,function(V,F){return V===!1?V:a(n,F)},!0)}},context:{defaultValue:function(){},message:"should be a string",validate:function(P){return P===void 0||typeof P=="string"}},user:{defaultValue:function(){return{}},message:"should be an object with { id, email, name } properties",validate:function(P){return P===null||P&&i(u(P),function(V,F){return V&&a(["id","email","name"],F)},!0)}},metadata:{defaultValue:function(){return{}},message:"should be an object",validate:function(P){return typeof P=="object"&&P!==null}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(P){return!P||P&&i(["debug","info","warn","error"],function(V,F){return V&&typeof P[F]=="function"},!0)}},redactedKeys:{defaultValue:function(){return["password"]},message:"should be an array of strings|regexes",validate:function(P){return s(P)&&P.length===o(P,function(V){return typeof V=="string"||V&&typeof V.test=="function"}).length}},plugins:{defaultValue:function(){return[]},message:"should be an array of plugin objects",validate:function(P){return s(P)&&P.length===o(P,function(V){return V&&typeof V=="object"&&typeof V.load=="function"}).length}},featureFlags:{defaultValue:function(){return[]},message:'should be an array of objects that have a "name" property',validate:function(P){return s(P)&&P.length===o(P,function(V){return V&&typeof V=="object"&&typeof V.name=="string"}).length}}};var b=function(P){for(var V=1;V<arguments.length;V++){var F=arguments[V];for(var G in F)Object.prototype.hasOwnProperty.call(F,G)&&(P[G]=F[G])}return P},w=function(P,V){return i(P,function(F,G,Y,Z){return F.concat(V(G,Y,Z))},[])};function E(){return E=Object.assign?Object.assign.bind():function(P){for(var V=1;V<arguments.length;V++){var F=arguments[V];for(var G in F)Object.prototype.hasOwnProperty.call(F,G)&&(P[G]=F[G])}return P},E.apply(this,arguments)}var I=y.schema,S={releaseStage:b({},I.releaseStage,{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"}}),appType:E({},I.appType,{defaultValue:function(){return"browser"}}),logger:b({},I.logger,{defaultValue:function(){return typeof console!="undefined"&&typeof console.debug=="function"?D():void 0}})},D=function(){var P={},V=console.log;return w(["debug","info","warn","error"],function(F){var G=console[F];P[F]=typeof G=="function"?G.bind(console,"[bugsnag]"):V.bind(console,"[bugsnag]")}),P},O=function(){function P(F,G,Y,Z){Z===void 0&&(Z=new Date),this.type=Y,this.message=F,this.metadata=G,this.timestamp=Z}var V=P.prototype;return V.toJSON=function(){return{type:this.type,name:this.message,timestamp:this.timestamp,metaData:this.metadata}},P}(),_=O,A={};(function(P,V){"use strict";typeof e=="function"&&e.amd?e("stackframe",[],V):typeof A=="object"?A=V():P.StackFrame=V()})(this,function(){"use strict";function P(He){return!isNaN(parseFloat(He))&&isFinite(He)}function V(He){return He.charAt(0).toUpperCase()+He.substring(1)}function F(He){return function(){return this[He]}}var G=["isConstructor","isEval","isNative","isToplevel"],Y=["columnNumber","lineNumber"],Z=["fileName","functionName","source"],ne=["args"],ue=G.concat(Y,Z,ne);function ye(He){if(He instanceof Object)for(var tr=0;tr<ue.length;tr++)He.hasOwnProperty(ue[tr])&&He[ue[tr]]!==void 0&&this["set"+V(ue[tr])](He[ue[tr]])}ye.prototype={getArgs:function(){return this.args},setArgs:function(He){if(Object.prototype.toString.call(He)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=He},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(He){if(He instanceof ye)this.evalOrigin=He;else if(He instanceof Object)this.evalOrigin=new ye(He);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var He=this.getFunctionName()||"{anonymous}",tr="("+(this.getArgs()||[]).join(",")+")",jn=this.getFileName()?"@"+this.getFileName():"",On=P(this.getLineNumber())?":"+this.getLineNumber():"",Xt=P(this.getColumnNumber())?":"+this.getColumnNumber():"";return He+tr+jn+On+Xt}};for(var Ue=0;Ue<G.length;Ue++)ye.prototype["get"+V(G[Ue])]=F(G[Ue]),ye.prototype["set"+V(G[Ue])]=function(He){return function(tr){this[He]=!!tr}}(G[Ue]);for(var it=0;it<Y.length;it++)ye.prototype["get"+V(Y[it])]=F(Y[it]),ye.prototype["set"+V(Y[it])]=function(He){return function(tr){if(!P(tr))throw new TypeError(He+" must be a Number");this[He]=Number(tr)}}(Y[it]);for(var Zt=0;Zt<Z.length;Zt++)ye.prototype["get"+V(Z[Zt])]=F(Z[Zt]),ye.prototype["set"+V(Z[Zt])]=function(He){return function(tr){this[He]=String(tr)}}(Z[Zt]);return ye});var R={};(function(P,V){"use strict";typeof e=="function"&&e.amd?e("error-stack-parser",["stackframe"],V):typeof R=="object"?R=V(A):P.ErrorStackParser=V(P.StackFrame)})(this,function(V){"use strict";var F=/(^|@)\S+\:\d+/,G=/^\s*at .*(\S+\:\d+|\(native\))/m,Y=/^(eval@)?(\[native code\])?$/;return{parse:function(ne){if(typeof ne.stacktrace!="undefined"||typeof ne["opera#sourceloc"]!="undefined")return this.parseOpera(ne);if(ne.stack&&ne.stack.match(G))return this.parseV8OrIE(ne);if(ne.stack)return this.parseFFOrSafari(ne);throw new Error("Cannot parse given Error object")},extractLocation:function(ne){if(ne.indexOf(":")===-1)return[ne];var ue=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,ye=ue.exec(ne.replace(/[\(\)]/g,""));return[ye[1],ye[2]||void 0,ye[3]||void 0]},parseV8OrIE:function(ne){var ue=ne.stack.split(`
`).filter(function(ye){return!!ye.match(G)},this);return ue.map(function(ye){ye.indexOf("(eval ")>-1&&(ye=ye.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var Ue=ye.replace(/^\s+/,"").replace(/\(eval code/g,"("),it=Ue.match(/ (\((.+):(\d+):(\d+)\)$)/);Ue=it?Ue.replace(it[0],""):Ue;var Zt=Ue.split(/\s+/).slice(1),He=this.extractLocation(it?it[1]:Zt.pop()),tr=Zt.join(" ")||void 0,jn=["eval","<anonymous>"].indexOf(He[0])>-1?void 0:He[0];return new V({functionName:tr,fileName:jn,lineNumber:He[1],columnNumber:He[2],source:ye})},this)},parseFFOrSafari:function(ne){var ue=ne.stack.split(`
`).filter(function(ye){return!ye.match(Y)},this);return ue.map(function(ye){if(ye.indexOf(" > eval")>-1&&(ye=ye.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),ye.indexOf("@")===-1&&ye.indexOf(":")===-1)return new V({functionName:ye});var Ue=/((.*".+"[^@]*)?[^@]*)(?:@)/,it=ye.match(Ue),Zt=it&&it[1]?it[1]:void 0,He=this.extractLocation(ye.replace(Ue,""));return new V({functionName:Zt,fileName:He[0],lineNumber:He[1],columnNumber:He[2],source:ye})},this)},parseOpera:function(ne){return!ne.stacktrace||ne.message.indexOf(`
`)>-1&&ne.message.split(`
`).length>ne.stacktrace.split(`
`).length?this.parseOpera9(ne):ne.stack?this.parseOpera11(ne):this.parseOpera10(ne)},parseOpera9:function(ne){for(var ue=/Line (\d+).*script (?:in )?(\S+)/i,ye=ne.message.split(`
`),Ue=[],it=2,Zt=ye.length;it<Zt;it+=2){var He=ue.exec(ye[it]);He&&Ue.push(new V({fileName:He[2],lineNumber:He[1],source:ye[it]}))}return Ue},parseOpera10:function(ne){for(var ue=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,ye=ne.stacktrace.split(`
`),Ue=[],it=0,Zt=ye.length;it<Zt;it+=2){var He=ue.exec(ye[it]);He&&Ue.push(new V({functionName:He[3]||void 0,fileName:He[2],lineNumber:He[1],source:ye[it]}))}return Ue},parseOpera11:function(ne){var ue=ne.stack.split(`
`).filter(function(ye){return!!ye.match(F)&&!ye.match(/^Error created at/)},this);return ue.map(function(ye){var Ue=ye.split("@"),it=this.extractLocation(Ue.pop()),Zt=Ue.shift()||"",He=Zt.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0,tr;Zt.match(/\(([^\)]*)\)/)&&(tr=Zt.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var jn=tr===void 0||tr==="[arguments not available]"?void 0:tr.split(",");return new V({functionName:He,args:jn,fileName:it[0],lineNumber:it[1],columnNumber:it[2],source:ye})},this)}}});var W=R,j=function(P,V,F,G){var Y=G&&G.redactedKeys?G.redactedKeys:[],Z=G&&G.redactedPaths?G.redactedPaths:[];return JSON.stringify(yt(P,Y,Z),V,F)},Q=20,ce=25e3,ee=8,pe="...";function re(P){return P instanceof Error||/^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(P))}function k(P){return"[Throws: "+(P?P.message:"?")+"]"}function Ke(P,V){for(var F=0,G=P.length;F<G;F++)if(P[F]===V)return!0;return!1}function ht(P,V){for(var F=0,G=P.length;F<G;F++)if(V.indexOf(P[F])===0)return!0;return!1}function Ze(P,V){for(var F=0,G=P.length;F<G;F++)if(typeof P[F]=="string"&&P[F].toLowerCase()===V.toLowerCase()||P[F]&&typeof P[F].test=="function"&&P[F].test(V))return!0;return!1}function Te(P){return Object.prototype.toString.call(P)==="[object Array]"}function Vt(P,V){try{return P[V]}catch(F){return k(F)}}function yt(P,V,F){var G=[],Y=0;function Z(ne,ue){function ye(){return ue.length>ee&&Y>ce}if(Y++,ue.length>Q||ye())return pe;if(ne===null||typeof ne!="object")return ne;if(Ke(G,ne))return"[Circular]";if(G.push(ne),typeof ne.toJSON=="function")try{Y--;var Ue=Z(ne.toJSON(),ue);return G.pop(),Ue}catch(Ur){return k(Ur)}var it=re(ne);if(it){Y--;var Zt=Z({name:ne.name,message:ne.message},ue);return G.pop(),Zt}if(Te(ne)){for(var He=[],tr=0,jn=ne.length;tr<jn;tr++){if(ye()){He.push(pe);break}He.push(Z(ne[tr],ue.concat("[]")))}return G.pop(),He}var On={};try{for(var Xt in ne)if(Object.prototype.hasOwnProperty.call(ne,Xt)){if(ht(F,ue.join("."))&&Ze(V,Xt)){On[Xt]="[REDACTED]";continue}if(ye()){On[Xt]=pe;break}On[Xt]=Z(Vt(ne,Xt),ue.concat(Xt))}}catch(Ur){}return G.pop(),On}return Z(P,[])}function qe(P,V,F,G){if(typeof F=="string"){G===void 0?G=null:G!==null&&typeof G!="string"&&(G=j(G));var Y=V[F];if(typeof Y=="number"){P[Y]={name:F,variant:G};return}P.push({name:F,variant:G}),V[F]=P.length-1}}function at(P,V,F){if(s(V)){for(var G=0;G<V.length;++G){var Y=V[G];Y===null||typeof Y!="object"||qe(P,F,Y.name,Y.variant)}return P}}function Ne(P){return w(o(P,Boolean),function(V){var F=V.name,G=V.variant,Y={featureFlag:F};return typeof G=="string"&&(Y.variant=G),Y})}function he(P,V,F){var G=V[F];typeof G=="number"&&(P[G]=null,delete V[F])}var ie={add:qe,clear:he,merge:at,toEventApi:Ne},ct=function(P){return!!P&&(!!P.stack||!!P.stacktrace||!!P["opera#sourceloc"])&&typeof(P.stack||P.stacktrace||P["opera#sourceloc"])=="string"&&P.stack!==P.name+": "+P.message},je=Fe;function Fe(P){switch(Object.prototype.toString.call(P)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return P instanceof Error}}var Je=je,er=function(P,V,F,G){var Y;if(V){var Z;if(F===null)return Qe(P,V);typeof F=="object"&&(Z=F),typeof F=="string"&&(Z=(Y={},Y[F]=G,Y)),Z&&(V==="__proto__"||V==="constructor"||V==="prototype"||(P[V]||(P[V]={}),P[V]=b({},P[V],Z)))}},wt=function(P,V,F){if(typeof V=="string"){if(!F)return P[V];if(P[V])return P[V][F]}},Qe=function(P,V,F){if(typeof V=="string"){if(!F){delete P[V];return}V==="__proto__"||V==="constructor"||V==="prototype"||P[V]&&delete P[V][F]}},zt={add:er,get:wt,clear:Qe},Ms={};(function(P,V){"use strict";typeof e=="function"&&e.amd?e("stack-generator",["stackframe"],V):typeof Ms=="object"?Ms=V(A):P.StackGenerator=V(P.StackFrame)})(this,function(P){return{backtrace:function(F){var G=[],Y=10;typeof F=="object"&&typeof F.maxStackSize=="number"&&(Y=F.maxStackSize);for(var Z=arguments.callee;Z&&G.length<Y&&Z.arguments;){for(var ne=new Array(Z.arguments.length),ue=0;ue<ne.length;++ue)ne[ue]=Z.arguments[ue];/function(?:\s+([\w$]+))+\s*\(/.test(Z.toString())?G.push(new P({functionName:RegExp.$1||void 0,args:ne})):G.push(new P({args:ne}));try{Z=Z.caller}catch(ye){break}}return G}}});function Qs(){return Qs=Object.assign?Object.assign.bind():function(P){for(var V=1;V<arguments.length;V++){var F=arguments[V];for(var G in F)Object.prototype.hasOwnProperty.call(F,G)&&(P[G]=F[G])}return P},Qs.apply(this,arguments)}var Ft=function(){function P(F,G,Y,Z,ne){Y===void 0&&(Y=[]),Z===void 0&&(Z=ky()),this.apiKey=void 0,this.context=void 0,this.groupingHash=void 0,this.originalError=ne,this._handledState=Z,this.severity=this._handledState.severity,this.unhandled=this._handledState.unhandled,this.app={},this.device={},this.request={},this.breadcrumbs=[],this.threads=[],this._metadata={},this._features=[],this._featuresIndex={},this._user={},this._session=void 0,this._correlation=void 0,this.errors=[cl(F,G,P.__type,Y)]}var V=P.prototype;return V.addMetadata=function(G,Y,Z){return zt.add(this._metadata,G,Y,Z)},V.setTraceCorrelation=function(G,Y){typeof G=="string"&&(this._correlation=Qs({traceId:G},typeof Y=="string"?{spanId:Y}:{}))},V.getMetadata=function(G,Y){return zt.get(this._metadata,G,Y)},V.clearMetadata=function(G,Y){return zt.clear(this._metadata,G,Y)},V.addFeatureFlag=function(G,Y){Y===void 0&&(Y=null),ie.add(this._features,this._featuresIndex,G,Y)},V.addFeatureFlags=function(G){ie.merge(this._features,G,this._featuresIndex)},V.getFeatureFlags=function(){return ie.toEventApi(this._features)},V.clearFeatureFlag=function(G){ie.clear(this._features,this._featuresIndex,G)},V.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},V.getUser=function(){return this._user},V.setUser=function(G,Y,Z){this._user={id:G,email:Y,name:Z}},V.toJSON=function(){return{payloadVersion:"4",exceptions:w(this.errors,function(G){return b({},G,{message:G.errorMessage})}),severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,request:this.request,breadcrumbs:this.breadcrumbs,context:this.context,groupingHash:this.groupingHash,metaData:this._metadata,user:this._user,session:this._session,featureFlags:this.getFeatureFlags(),correlation:this._correlation}},P}(),lg=function(P){var V={file:P.fileName,method:Hf(P.functionName),lineNumber:P.lineNumber,columnNumber:P.columnNumber,code:void 0,inProject:void 0};return V.lineNumber>-1&&!V.file&&!V.method&&(V.file="global code"),V},Hf=function(P){return/^global code$/i.test(P)?"global code":P},ky=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},$f=function(P){return typeof P=="string"?P:""};function cl(P,V,F,G){return{errorClass:$f(P),errorMessage:$f(V),type:F,stacktrace:i(G,function(Y,Z){var ne=lg(Z);try{return JSON.stringify(ne)==="{}"?Y:Y.concat(ne)}catch(ue){return Y}},[])}}function Ga(P){return P.cause?[P].concat(Ga(P.cause)):[P]}Ft.getStacktrace=function(P,V,F){if(ct(P))return W.parse(P).slice(V);try{return o(Ms.backtrace(),function(G){return(G.functionName||"").indexOf("StackGenerator$$")===-1}).slice(1+F)}catch(G){return[]}},Ft.create=function(P,V,F,G,Y,Z){Y===void 0&&(Y=0);var ne=_d(P,V,G,Z),ue=ne[0],ye=ne[1],Ue;try{var it=Ft.getStacktrace(ue,ye>0?1+ye+Y:0,1+Y);Ue=new Ft(ue.name,ue.message,it,F,P)}catch(jn){Ue=new Ft(ue.name,ue.message,[],F,P)}if(ue.name==="InvalidError"&&Ue.addMetadata(""+G,"non-error parameter",_u(P)),ue.cause){var Zt,He=Ga(ue).slice(1),tr=w(He,function(jn){var On=Je(jn)&&ct(jn)?W.parse(jn):[],Xt=_d(jn,!0,"error cause"),Ur=Xt[0];return Ur.name==="InvalidError"&&Ue.addMetadata("error cause",_u(jn)),cl(Ur.name,Ur.message,Ft.__type,On)});(Zt=Ue.errors).push.apply(Zt,tr)}return Ue};var _u=function(P){return P===null?"null":P===void 0?"undefined":P},_d=function(P,V,F,G){var Y,Z=0,ne=function(ue){var ye=F==="error cause"?"was":"received";G&&G.warn(F+" "+ye+' a non-error: "'+ue+'"');var Ue=new Error(F+" "+ye+' a non-error. See "'+F+'" tab for more detail.');return Ue.name="InvalidError",Ue};if(!V)Je(P)?Y=P:(Y=ne(typeof P),Z+=2);else switch(typeof P){case"string":case"number":case"boolean":Y=new Error(String(P)),Z+=1;break;case"function":Y=ne("function"),Z+=2;break;case"object":P!==null&&Je(P)?Y=P:P!==null&&_i(P)?(Y=new Error(P.message||P.errorMessage),Y.name=P.name||P.errorClass,Z+=1):(Y=ne(P===null?"null":"unsupported object"),Z+=2);break;default:Y=ne("nothing"),Z+=2}if(!ct(Y))try{throw Y}catch(ue){ct(ue)&&(Y=ue,Z=1)}return[Y,Z]};Ft.__type="browserjs";var _i=function(P){return(typeof P.name=="string"||typeof P.errorClass=="string")&&(typeof P.message=="string"||typeof P.errorMessage=="string")},Ad=Ft,Yf=function(P,V,F){var G=0,Y=function(){if(G>=P.length)return F(null,!0);V(P[G],function(Z,ne){if(Z)return F(Z);if(ne===!1)return F(null,!1);G++,Y()})};Y()},ug=function(P,V,F,G){var Y=function(Z,ne){if(typeof Z!="function")return ne(null);try{if(Z.length!==2){var ue=Z(V);return ue&&typeof ue.then=="function"?ue.then(function(ye){return setTimeout(function(){return ne(null,ye)})},function(ye){setTimeout(function(){return F(ye),ne(null,!0)})}):ne(null,ue)}Z(V,function(ye,Ue){if(ye)return F(ye),ne(null);ne(null,Ue)})}catch(ye){F(ye),ne(null)}};Yf(P,Y,G)},Zv=function(P,V,F,G){for(var Y=!1,Z=P.slice();!Y&&Z.length;)try{Y=Z.pop()(V)===!1}catch(ne){G.error("Error occurred in "+F+" callback, continuing anyway\u2026"),G.error(ne)}return Y},Vy=function(V,F){var G="000000000"+V;return G.substr(G.length-F)},Fy=typeof window=="object"?window:self,Gy=0;for(var Jv in Fy)Object.hasOwnProperty.call(Fy,Jv)&&Gy++;var Hi=navigator.mimeTypes?navigator.mimeTypes.length:0,$i=Vy((Hi+navigator.userAgent.length).toString(36)+Gy.toString(36),4),pa=function(){return $i},ll=0,Yi=4,ga=36,Wl=Math.pow(ga,Yi);function Ba(){return Vy((Math.random()*Wl<<0).toString(ga),Yi)}function Qv(){return ll=ll<Wl?ll:0,ll++,ll-1}function Od(){var P="c",V=new Date().getTime().toString(ga),F=Vy(Qv().toString(ga),Yi),G=pa(),Y=Ba()+Ba();return P+V+F+G+Y}Od.fingerprint=pa;var eT=Od,Wf=function(){function P(){this.id=eT(),this.startedAt=new Date,this._handled=0,this._unhandled=0,this._user={},this.app={},this.device={}}var V=P.prototype;return V.getUser=function(){return this._user},V.setUser=function(G,Y,Z){this._user={id:G,email:Y,name:Z}},V.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},V._track=function(G){this[G._handledState.unhandled?"_unhandled":"_handled"]+=1},P}(),Ld=Wf,Nd=ie.add,Ds=ie.clear,By=ie.merge,So=function(){},qy=function(){function P(F,G,Y,Z){var ne=this;G===void 0&&(G=y.schema),Y===void 0&&(Y=[]),this._notifier=Z,this._config={},this._schema=G,this._delivery={sendSession:So,sendEvent:So},this._logger={debug:So,info:So,warn:So,error:So},this._plugins={},this._breadcrumbs=[],this._session=null,this._metadata={},this._featuresIndex={},this._features=[],this._context=void 0,this._user={},this._cbs={e:[],s:[],sp:[],b:[]},this.Client=P,this.Event=Ad,this.Breadcrumb=_,this.Session=Ld,this._config=this._configure(F,Y),w(Y.concat(this._config.plugins),function(Ue){Ue&&ne._loadPlugin(Ue)}),this._depth=1;var ue=this,ye=this.notify;this.notify=function(){return ye.apply(ue,arguments)}}var V=P.prototype;return V.addMetadata=function(G,Y,Z){return zt.add(this._metadata,G,Y,Z)},V.getMetadata=function(G,Y){return zt.get(this._metadata,G,Y)},V.clearMetadata=function(G,Y){return zt.clear(this._metadata,G,Y)},V.addFeatureFlag=function(G,Y){Y===void 0&&(Y=null),Nd(this._features,this._featuresIndex,G,Y)},V.addFeatureFlags=function(G){By(this._features,G,this._featuresIndex)},V.clearFeatureFlag=function(G){Ds(this._features,this._featuresIndex,G)},V.clearFeatureFlags=function(){this._features=[],this._featuresIndex={}},V.getContext=function(){return this._context},V.setContext=function(G){this._context=G},V._configure=function(G,Y){var Z=i(Y,function(Ue,it){return it&&it.configSchema?b({},Ue,it.configSchema):Ue},this._schema),ne=i(u(Z),function(Ue,it){var Zt=Z[it].defaultValue(G[it]);if(G[it]!==void 0){var He=Z[it].validate(G[it]);He?Z[it].allowPartialObject?Ue.config[it]=b(Zt,G[it]):Ue.config[it]=G[it]:(Ue.errors[it]=Z[it].message,Ue.config[it]=Zt)}else Ue.config[it]=Zt;return Ue},{errors:{},config:{}}),ue=ne.errors,ye=ne.config;if(Z.apiKey){if(!ye.apiKey)throw new Error("No Bugsnag API Key set");/^[0-9a-f]{32}$/i.test(ye.apiKey)||(ue.apiKey="should be a string of 32 hexadecimal characters")}return this._metadata=b({},ye.metadata),By(this._features,ye.featureFlags,this._featuresIndex),this._user=b({},ye.user),this._context=ye.context,ye.logger&&(this._logger=ye.logger),ye.onError&&(this._cbs.e=this._cbs.e.concat(ye.onError)),ye.onBreadcrumb&&(this._cbs.b=this._cbs.b.concat(ye.onBreadcrumb)),ye.onSession&&(this._cbs.s=this._cbs.s.concat(ye.onSession)),u(ue).length&&this._logger.warn(PC(ue,G)),ye},V.getUser=function(){return this._user},V.setUser=function(G,Y,Z){this._user={id:G,email:Y,name:Z}},V._loadPlugin=function(G){var Y=G.load(this);return G.name&&(this._plugins["~"+G.name+"~"]=Y),this},V.getPlugin=function(G){return this._plugins["~"+G+"~"]},V._setDelivery=function(G){this._delivery=G(this)},V.startSession=function(){var G=new Ld;G.app.releaseStage=this._config.releaseStage,G.app.version=this._config.appVersion,G.app.type=this._config.appType,G._user=b({},this._user);var Y=Zv(this._cbs.s,G,"onSession",this._logger);return Y?(this._logger.debug("Session not started due to onSession callback"),this):this._sessionDelegate.startSession(this,G)},V.addOnError=function(G,Y){Y===void 0&&(Y=!1),this._cbs.e[Y?"unshift":"push"](G)},V.removeOnError=function(G){this._cbs.e=o(this._cbs.e,function(Y){return Y!==G})},V._addOnSessionPayload=function(G){this._cbs.sp.push(G)},V.addOnSession=function(G){this._cbs.s.push(G)},V.removeOnSession=function(G){this._cbs.s=o(this._cbs.s,function(Y){return Y!==G})},V.addOnBreadcrumb=function(G,Y){Y===void 0&&(Y=!1),this._cbs.b[Y?"unshift":"push"](G)},V.removeOnBreadcrumb=function(G){this._cbs.b=o(this._cbs.b,function(Y){return Y!==G})},V.pauseSession=function(){return this._sessionDelegate.pauseSession(this)},V.resumeSession=function(){return this._sessionDelegate.resumeSession(this)},V.leaveBreadcrumb=function(G,Y,Z){if(G=typeof G=="string"?G:"",Z=typeof Z=="string"&&a(n,Z)?Z:"manual",Y=typeof Y=="object"&&Y!==null?Y:{},!!G){var ne=new _(G,Y,Z),ue=Zv(this._cbs.b,ne,"onBreadcrumb",this._logger);if(ue){this._logger.debug("Breadcrumb not attached due to onBreadcrumb callback");return}this._breadcrumbs.push(ne),this._breadcrumbs.length>this._config.maxBreadcrumbs&&(this._breadcrumbs=this._breadcrumbs.slice(this._breadcrumbs.length-this._config.maxBreadcrumbs))}},V._isBreadcrumbTypeEnabled=function(G){var Y=this._config.enabledBreadcrumbTypes;return Y===null||a(Y,G)},V.notify=function(G,Y,Z){Z===void 0&&(Z=So);var ne=Ad.create(G,!0,void 0,"notify()",this._depth+1,this._logger);this._notify(ne,Y,Z)},V._notify=function(G,Y,Z){var ne=this;if(Z===void 0&&(Z=So),G.app=b({},G.app,{releaseStage:this._config.releaseStage,version:this._config.appVersion,type:this._config.appType}),G.context=G.context||this._context,G._metadata=b({},G._metadata,this._metadata),G._user=b({},G._user,this._user),G.breadcrumbs=this._breadcrumbs.slice(),By(G._features,this._features,G._featuresIndex),this._config.enabledReleaseStages!==null&&!a(this._config.enabledReleaseStages,this._config.releaseStage))return this._logger.warn("Event not sent due to releaseStage/enabledReleaseStages configuration"),Z(null,G);var ue=G.severity,ye=function(it){ne._logger.error("Error occurred in onError callback, continuing anyway\u2026"),ne._logger.error(it)},Ue=[].concat(this._cbs.e).concat(Y);ug(Ue,G,ye,function(it,Zt){if(it&&ye(it),!Zt)return ne._logger.debug("Event not sent due to onError callback"),Z(null,G);ne._isBreadcrumbTypeEnabled("error")&&P.prototype.leaveBreadcrumb.call(ne,G.errors[0].errorClass,{errorClass:G.errors[0].errorClass,errorMessage:G.errors[0].errorMessage,severity:G.severity},"error"),ue!==G.severity&&(G._handledState.severityReason={type:"userCallbackSetSeverity"}),G.unhandled!==G._handledState.unhandled&&(G._handledState.severityReason.unhandledOverridden=!0,G._handledState.unhandled=G.unhandled),ne._session&&(ne._session._track(G),G._session=ne._session),ne._delivery.sendEvent({apiKey:G.apiKey||ne._config.apiKey,notifier:ne._notifier,events:[G]},function(He){return Z(He,G)})})},P}(),PC=function(P,V){var F=new Error(`Invalid configuration
`+w(u(P),function(G){return"  - "+G+" "+P[G]+", got "+SC(V[G])}).join(`

`));return F},SC=function(P){switch(typeof P){case"string":case"number":case"object":return JSON.stringify(P);default:return String(P)}},Xf=qy,Au={},zy=["events.[].metaData","events.[].breadcrumbs.[].metaData","events.[].request"];Au.event=function(P,V){var F=j(P,null,null,{redactedPaths:zy,redactedKeys:V});return F.length>1e6&&(P.events[0]._metadata={notifier:`WARNING!
Serialized payload was `+F.length/1e6+`MB (limit = 1MB)
metadata was removed`},F=j(P,null,null,{redactedPaths:zy,redactedKeys:V})),F},Au.session=function(P,V){var F=j(P,null,null);return F};var Ou={};Ou=function(P,V){return V===void 0&&(V=window),{sendEvent:function(F,G){G===void 0&&(G=function(){});var Y=Wi(P._config,"notify","4",V),Z=Au.event(F,P._config.redactedKeys),ne=new V.XDomainRequest;ne.onload=function(){G(null)},ne.onerror=function(){var ue=new Error("Event failed to send");P._logger.error("Event failed to send\u2026",ue),Z.length>1e6&&P._logger.warn("Event oversized ("+(Z.length/1e6).toFixed(2)+" MB)"),G(ue)},ne.open("POST",Y),setTimeout(function(){try{ne.send(Z)}catch(ue){P._logger.error(ue),G(ue)}},0)},sendSession:function(F,G){G===void 0&&(G=function(){});var Y=Wi(P._config,"sessions","1",V),Z=new V.XDomainRequest;Z.onload=function(){G(null)},Z.open("POST",Y),setTimeout(function(){try{Z.send(Au.session(F,P._config.redactedKeys))}catch(ne){P._logger.error(ne),G(ne)}},0)}}};var Wi=function(P,V,F,G){var Y=JSON.parse(JSON.stringify(new Date)),Z=ec(P.endpoints[V],G.location.protocol);return Z+"?apiKey="+encodeURIComponent(P.apiKey)+"&payloadVersion="+F+"&sentAt="+encodeURIComponent(Y)},ec=Ou._matchPageProtocol=function(P,V){return V==="http:"?P.replace(/^https:/,"http:"):P},qa=function(P,V){return V===void 0&&(V=window),{sendEvent:function(F,G){G===void 0&&(G=function(){});try{var Y=P._config.endpoints.notify,Z=new V.XMLHttpRequest,ne=Au.event(F,P._config.redactedKeys);Z.onreadystatechange=function(){if(Z.readyState===V.XMLHttpRequest.DONE){var ue=Z.status;if(ue===0||ue>=400){var ye=new Error("Request failed with status "+ue);P._logger.error("Event failed to send\u2026",ye),ne.length>1e6&&P._logger.warn("Event oversized ("+(ne.length/1e6).toFixed(2)+" MB)"),G(ye)}else G(null)}},Z.open("POST",Y),Z.setRequestHeader("Content-Type","application/json"),Z.setRequestHeader("Bugsnag-Api-Key",F.apiKey||P._config.apiKey),Z.setRequestHeader("Bugsnag-Payload-Version","4"),Z.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),Z.send(ne)}catch(ue){P._logger.error(ue)}},sendSession:function(F,G){G===void 0&&(G=function(){});try{var Y=P._config.endpoints.sessions,Z=new V.XMLHttpRequest;Z.onreadystatechange=function(){if(Z.readyState===V.XMLHttpRequest.DONE){var ne=Z.status;if(ne===0||ne>=400){var ue=new Error("Request failed with status "+ne);P._logger.error("Session failed to send\u2026",ue),G(ue)}else G(null)}},Z.open("POST",Y),Z.setRequestHeader("Content-Type","application/json"),Z.setRequestHeader("Bugsnag-Api-Key",P._config.apiKey),Z.setRequestHeader("Bugsnag-Payload-Version","1"),Z.setRequestHeader("Bugsnag-Sent-At",new Date().toISOString()),Z.send(Au.session(F,P._config.redactedKeys))}catch(ne){P._logger.error(ne)}}}},Uy=new Date,dg=function(){Uy=new Date},pg={name:"appDuration",load:function(P){return P.addOnError(function(V){var F=new Date;V.app.duration=F-Uy},!0),{reset:dg}}},tT=function(P){return P===void 0&&(P=window),{load:function(V){V.addOnError(function(F){F.context===void 0&&(F.context=P.location.pathname)},!0)}}},Kf=function(V,F){var G="000000000"+V;return G.substr(G.length-F)},Rd=typeof window=="object"?window:self,Hy=0;for(var rT in Rd)Object.hasOwnProperty.call(Rd,rT)&&Hy++;var MC=navigator.mimeTypes?navigator.mimeTypes.length:0,nT=Kf((MC+navigator.userAgent.length).toString(36)+Hy.toString(36),4),$y=function(){return nT},kd=0,Lu=4,Nu=36,_s=Math.pow(Nu,Lu);function DC(){return Kf((Math.random()*_s<<0).toString(Nu),Lu)}function jf(){return kd=kd<_s?kd:0,kd++,kd-1}function Zf(){var P="c",V=new Date().getTime().toString(Nu),F=Kf(jf().toString(Nu),Lu),G=$y(),Y=DC()+DC();return P+V+F+G+Y}Zf.fingerprint=$y;var tc=Zf,Jf="bugsnag-anonymous-id",iT=function(P){try{var V=P.localStorage,F=V.getItem(Jf);return F&&/^c[a-z0-9]{20,32}$/.test(F)||(F=tc(),V.setItem(Jf,F)),F}catch(G){}},Ru=function(P,V){return P===void 0&&(P=navigator),V===void 0&&(V=window),{load:function(F){var G={locale:P.browserLanguage||P.systemLanguage||P.userLanguage||P.language,userAgent:P.userAgent};V&&V.screen&&V.screen.orientation&&V.screen.orientation.type?G.orientation=V.screen.orientation.type:V&&V.document&&(G.orientation=V.document.documentElement.clientWidth>V.document.documentElement.clientHeight?"landscape":"portrait"),F._config.generateAnonymousId&&(G.id=iT(V)),F.addOnSession(function(Y){Y.device=b({},Y.device,G),F._config.collectUserIp||Yy(Y)}),F.addOnError(function(Y){Y.device=b({},Y.device,G,{time:new Date}),F._config.collectUserIp||Yy(Y)},!0)},configSchema:{generateAnonymousId:{validate:function(F){return F===!0||F===!1},defaultValue:function(){return!0},message:"should be true|false"}}}},Yy=function(P){var V=P.getUser();(!V||!V.id)&&P.setUser(P.device.id)},_C=function(P){return P===void 0&&(P=window),{load:function(V){V.addOnError(function(F){F.request&&F.request.url||(F.request=b({},F.request,{url:P.location.href}))},!0)}}},oT={load:function(P){P._sessionDelegate=aT}},aT={startSession:function(P,V){var F=P;return F._session=V,F._pausedSession=null,F._config.enabledReleaseStages!==null&&!a(F._config.enabledReleaseStages,F._config.releaseStage)?(F._logger.warn("Session not sent due to releaseStage/enabledReleaseStages configuration"),F):(F._delivery.sendSession({notifier:F._notifier,device:V.device,app:V.app,sessions:[{id:V.id,startedAt:V.startedAt,user:V._user}]}),F)},resumeSession:function(P){return P._session?P:P._pausedSession?(P._session=P._pausedSession,P._pausedSession=null,P):P.startSession()},pauseSession:function(P){P._pausedSession=P._session,P._session=null}},AC={load:function(P){P._config.collectUserIp||P.addOnError(function(V){V._user&&typeof V._user.id=="undefined"&&delete V._user.id,V._user=b({id:"[REDACTED]"},V._user),V.request=b({clientIp:"[REDACTED]"},V.request)})},configSchema:{collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(P){return P===!0||P===!1}}}},Wy={};Wy.load=function(P){var V=/^(local-)?dev(elopment)?$/.test(P._config.releaseStage);V||!P._isBreadcrumbTypeEnabled("log")||w(Xy,function(F){var G=console[F];console[F]=function(){for(var Y=arguments.length,Z=new Array(Y),ne=0;ne<Y;ne++)Z[ne]=arguments[ne];P.leaveBreadcrumb("Console output",i(Z,function(ue,ye,Ue){var it="[Unknown value]";try{it=String(ye)}catch(Zt){}if(it==="[object Object]")try{it=JSON.stringify(ye)}catch(Zt){}return ue["["+Ue+"]"]=it,ue},{severity:F.indexOf("group")===0?"log":F}),"log"),G.apply(console,Z)},console[F]._restore=function(){console[F]=G}})};var Xy=o(["log","debug","info","warn","error"],function(P){return typeof console!="undefined"&&typeof console[P]=="function"}),Ky=200,jy=5e5,As=function(P,V){return P===void 0&&(P=document),V===void 0&&(V=window),{load:function(F){if(!F._config.trackInlineScripts)return;var G=V.location.href,Y="",Z=!!P.attachEvent,ne=Z?P.readyState==="complete":P.readyState!=="loading",ue=function(){return P.documentElement.outerHTML};Y=ue();var ye=P.onreadystatechange;P.onreadystatechange=function(){P.readyState==="interactive"&&(Y=ue(),ne=!0);try{ye.apply(this,arguments)}catch(Xt){}};var Ue=null,it=function(Xt){Ue=Xt},Zt=function(){var Xt=P.currentScript||Ue;if(!Xt&&!ne){var Ur=P.scripts||P.getElementsByTagName("script");Xt=Ur[Ur.length-1]}return Xt},He=function(Xt){(!ne||!Y)&&(Y=ue());var Ur=["<!-- DOC START -->"].concat(Y.split(`
`)),ao=Xt-1,Xi=Math.max(ao-3,0),ul=Math.min(ao+3,Ur.length);return i(Ur.slice(Xi,ul),function(so,rb,OC){return so[Xi+1+OC]=rb.length<=Ky?rb:rb.substr(0,Ky),so},{})};F.addOnError(function(Xt){Xt.errors[0].stacktrace=o(Xt.errors[0].stacktrace,function(so){return!/__trace__$/.test(so.method)});var Ur=Xt.errors[0].stacktrace[0],ao=function(so){return so.replace(/#.*$/,"").replace(/\?.*$/,"")};if(!(Ur&&Ur.file&&ao(Ur.file)!==ao(G))){var Xi=Zt();if(Xi){var ul=Xi.innerHTML;Xt.addMetadata("script","content",ul.length<=jy?ul:ul.substr(0,jy)),Ur&&Ur.lineNumber&&(Ur.code=He(Ur.lineNumber))}}},!0);var tr=w(["setTimeout","setInterval","setImmediate","requestAnimationFrame"],function(Xt){return Zy(V,Xt,function(Ur){return On(Ur,function(ao){return{get:function(){return ao[0]},replace:function(Xi){ao[0]=Xi}}})})}),jn=tr[0];w(["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],function(Xt){!V[Xt]||!V[Xt].prototype||!Object.prototype.hasOwnProperty.call(V[Xt].prototype,"addEventListener")||(Zy(V[Xt].prototype,"addEventListener",function(Ur){return On(Ur,Vd)}),Zy(V[Xt].prototype,"removeEventListener",function(Ur){return On(Ur,Vd,!0)}))});function On(Xt,Ur,ao){return ao===void 0&&(ao=!1),function(){var Xi=[].slice.call(arguments);try{var ul=Ur(Xi),so=ul.get();if(ao&&Xt.apply(this,Xi),typeof so!="function")return Xt.apply(this,Xi);if(so.__trace__)ul.replace(so.__trace__);else{var rb=Zt();so.__trace__=function(){it(rb),jn(function(){it(null)},0);var K8=so.apply(this,arguments);return it(null),K8},so.__trace__.__trace__=so.__trace__,ul.replace(so.__trace__)}}catch(OC){}if(Xt.apply)return Xt.apply(this,Xi);switch(Xi.length){case 1:return Xt(Xi[0]);case 2:return Xt(Xi[0],Xi[1]);default:return Xt()}}}},configSchema:{trackInlineScripts:{validate:function(F){return F===!0||F===!1},defaultValue:function(){return!0},message:"should be true|false"}}}};function Zy(P,V,F){var G=P[V];if(!G)return G;var Y=F(G);return P[V]=Y,G}function Vd(P){var V=!!P[1]&&typeof P[1].handleEvent=="function";return{get:function(){return V?P[1].handleEvent:P[1]},replace:function(F){V?P[1].handleEvent=F:P[1]=F}}}var Fd=function(P){return P===void 0&&(P=window),{load:function(V){"addEventListener"in P&&V._isBreadcrumbTypeEnabled("user")&&P.addEventListener("click",function(F){var G,Y;try{G=Qy(F.target),Y=Qf(F.target,P)}catch(Z){G="[hidden]",Y="[hidden]",V._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/yy3rn63z")}V.leaveBreadcrumb("UI click",{targetText:G,targetSelector:Y},"user")},!0)}}},Jy=/^\s*([^\s][\s\S]{0,139}[^\s])?\s*/;function Qy(P){var V=P.textContent||P.innerText||"";return!V&&(P.type==="submit"||P.type==="button")&&(V=P.value),V=V.replace(Jy,"$1"),V.length>140?V.slice(0,135)+"(...)":V}function Qf(P,V){var F=[P.tagName];if(P.id&&F.push("#"+P.id),P.className&&P.className.length&&F.push("."+P.className.split(" ").join(".")),!V.document.querySelectorAll||!Array.prototype.indexOf)return F.join("");try{if(V.document.querySelectorAll(F.join("")).length===1)return F.join("")}catch(Y){return F.join("")}if(P.parentNode.childNodes.length>1){var G=Array.prototype.indexOf.call(P.parentNode.childNodes,P)+1;F.push(":nth-child("+G+")")}return V.document.querySelectorAll(F.join("")).length===1?F.join(""):P.parentNode?Qf(P.parentNode,V)+" > "+F.join(""):F.join("")}var eb={};eb=function(P){P===void 0&&(P=window);var V={load:function(F){if("addEventListener"in P&&F._isBreadcrumbTypeEnabled("navigation")){var G=function(Y){return function(){return F.leaveBreadcrumb(Y,{},"navigation")}};P.addEventListener("pagehide",G("Page hidden"),!0),P.addEventListener("pageshow",G("Page shown"),!0),P.addEventListener("load",G("Page loaded"),!0),P.document.addEventListener("DOMContentLoaded",G("DOMContentLoaded"),!0),P.addEventListener("load",function(){return P.addEventListener("popstate",G("Navigated back"),!0)}),P.addEventListener("hashchange",function(Y){var Z=Y.oldURL?{from:em(Y.oldURL,P),to:em(Y.newURL,P),state:T(P)}:{to:em(P.location.href,P)};F.leaveBreadcrumb("Hash changed",Z,"navigation")},!0),P.history.replaceState&&tb(F,P.history,"replaceState",P),P.history.pushState&&tb(F,P.history,"pushState",P)}}};return V};var em=function(P,V){var F=V.document.createElement("A");return F.href=P,""+F.pathname+F.search+F.hash},sT=function(P,V,F,G){var Y=em(P.location.href,P);return{title:F,state:V,prevState:T(P),to:G||Y,from:Y}},tb=function(P,V,F,G){var Y=V[F];V[F]=function(Z,ne,ue){P.leaveBreadcrumb("History "+F,sT(G,Z,ne,ue),"navigation"),typeof P.resetEventCount=="function"&&P.resetEventCount(),P._config.autoTrackSessions&&P.startSession(),Y.apply(V,[Z,ne].concat(ue!==void 0?ue:[]))}},T=function(P){try{return P.history.state}catch(V){}},h="request",p=function(P,V){P===void 0&&(P=[]),V===void 0&&(V=window);var F=[],G={load:function(Y){if(!Y._isBreadcrumbTypeEnabled("request"))return;var Z=[Y._config.endpoints.notify,Y._config.endpoints.sessions].concat(P);ne(),Ue();function ne(){if("addEventListener"in V.XMLHttpRequest.prototype){var He=V.XMLHttpRequest.prototype.open;V.XMLHttpRequest.prototype.open=function(jn,On){var Xt=this,Ur=!1,ao=function(){return ye(jn,On)},Xi=function(){return ue(jn,On,Xt.status)};Ur&&(this.removeEventListener("load",Xi),this.removeEventListener("error",ao)),this.addEventListener("load",Xi),this.addEventListener("error",ao),Ur=!0,He.apply(this,arguments)}}}function ue(He,tr,jn){if(tr===void 0){Y._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}if(!(typeof tr=="string"&&a(Z,tr.replace(/\?.*$/,"")))){var On={status:jn,request:He+" "+tr};jn>=400?Y.leaveBreadcrumb("XMLHttpRequest failed",On,h):Y.leaveBreadcrumb("XMLHttpRequest succeeded",On,h)}}function ye(He,tr){if(tr===void 0){Y._logger.warn("The request URL is no longer present on this XMLHttpRequest. A breadcrumb cannot be left for this request.");return}typeof tr=="string"&&a(Z,tr.replace(/\?.*$/,""))||Y.leaveBreadcrumb("XMLHttpRequest error",{request:He+" "+tr},h)}function Ue(){if(!(!("fetch"in V)||V.fetch.polyfill)){var He=V.fetch;V.fetch=function(){var jn=arguments,On=arguments[0],Xt=arguments[1],Ur,ao=null;return On&&typeof On=="object"?(ao=On.url,Xt&&"method"in Xt?Ur=Xt.method:On&&"method"in On&&(Ur=On.method)):(ao=On,Xt&&"method"in Xt&&(Ur=Xt.method)),Ur===void 0&&(Ur="GET"),new Promise(function(Xi,ul){He.apply(void 0,jn).then(function(so){it(so,Ur,ao),Xi(so)}).catch(function(so){Zt(Ur,ao),ul(so)})})}}}var it=function(He,tr,jn){var On={status:He.status,request:tr+" "+jn};He.status>=400?Y.leaveBreadcrumb("fetch() failed",On,h):Y.leaveBreadcrumb("fetch() succeeded",On,h)},Zt=function(He,tr){Y.leaveBreadcrumb("fetch() error",{request:He+" "+tr},h)}}};return G},m={load:function(P){var V=0;P.addOnError(function(F){if(V>=P._config.maxEvents)return P._logger.warn("Cancelling event send due to maxEvents per session limit of "+P._config.maxEvents+" being reached"),!1;V++}),P.resetEventCount=function(){V=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer \u2264100",validate:function(P){return d(1,100)(P)}}}},v={};v={load:function(P){P.addOnError(function(V){var F=i(V.errors,function(G,Y){return G.concat(Y.stacktrace)},[]);w(F,function(G){G.file=M(G.file)})})}};var M=v._strip=function(P){return typeof P=="string"?P.replace(/\?.*$/,"").replace(/#.*$/,""):P},B=function(P,V){return P===void 0&&(P=window),V===void 0&&(V="window onerror"),{load:function(F){if(!F._config.autoDetectErrors||!F._config.enabledErrorTypes.unhandledExceptions)return;function G(Z,ne,ue,ye,Ue){if(ue===0&&/Script error\.?/.test(Z))F._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/yy3rn63z");else{var it={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}},Zt;if(Ue)Zt=F.Event.create(Ue,!0,it,V,1),U(Zt.errors[0].stacktrace,ne,ue,ye);else if(typeof Z=="object"&&Z!==null&&(!ne||typeof ne!="string")&&!ue&&!ye&&!Ue){var He=Z.type?"Event: "+Z.type:"Error",tr=Z.message||Z.detail||"";Zt=F.Event.create({name:He,message:tr},!0,it,V,1),Zt.originalError=Z,Zt.addMetadata(V,{event:Z,extraParameters:ne})}else Zt=F.Event.create(Z,!0,it,V,1),U(Zt.errors[0].stacktrace,ne,ue,ye);F._notify(Zt)}typeof Y=="function"&&Y.apply(this,arguments)}var Y=P.onerror;P.onerror=G}}},U=function(P,V,F,G){P[0]||P.push({});var Y=P[0];!Y.file&&typeof V=="string"&&(Y.file=V),!Y.lineNumber&&X(F)&&(Y.lineNumber=F),Y.columnNumber||(X(G)?Y.columnNumber=G:window.event&&X(window.event.errorCharacter)&&(Y.columnNumber=window.event.errorCharacter))},X=function(P){return typeof P=="number"&&String.call(P)!=="NaN"},te,Ce=function(P){P===void 0&&(P=window);var V={load:function(F){if(!(!F._config.autoDetectErrors||!F._config.enabledErrorTypes.unhandledRejections)){var G=function(Y){var Z=Y.reason,ne=!1;try{Y.detail&&Y.detail.reason&&(Z=Y.detail.reason,ne=!0)}catch(ye){}var ue=F.Event.create(Z,!1,{severity:"error",unhandled:!0,severityReason:{type:"unhandledPromiseRejection"}},"unhandledrejection handler",1,F._logger);ne&&w(ue.errors[0].stacktrace,ve(Z)),F._notify(ue,function(ye){if(Je(ye.originalError)&&!ye.originalError.stack){var Ue;ye.addMetadata("unhandledRejection handler",(Ue={},Ue[Object.prototype.toString.call(ye.originalError)]={name:ye.originalError.name,message:ye.originalError.message,code:ye.originalError.code},Ue))}})};"addEventListener"in P?P.addEventListener("unhandledrejection",G):P.onunhandledrejection=function(Y,Z){G({detail:{reason:Y,promise:Z}})},te=G}}};return V},ve=function(P){return function(V){V.file!==P.toString()&&V.method&&(V.method=V.method.replace(/^\s+/,""))}},ge={},_e="Bugsnag JavaScript",Ae="7.25.0",nt="https://github.com/bugsnag/bugsnag-js",gt=b({},y.schema,S),lt={_client:null,createClient:function(P){typeof P=="string"&&(P={apiKey:P}),P||(P={});var V=[pg,Ru(),tT(),_C(),m,oT,AC,v,B(),Ce(),eb(),Fd(),p(),Wy,As()],F=new Xf(P,gt,V,{name:_e,version:Ae,url:nt});return F._setDelivery(window.XDomainRequest?Ou:qa),F._logger.debug("Loaded!"),F.leaveBreadcrumb("Bugsnag loaded",{},"state"),F._config.autoTrackSessions?F.startSession():F},start:function(P){return lt._client?(lt._client._logger.warn("Bugsnag.start() was called more than once. Ignoring."),lt._client):(lt._client=lt.createClient(P),lt._client)},isStarted:function(){return lt._client!=null}};return w(["resetEventCount"].concat(u(Xf.prototype)),function(P){/^_/.test(P)||(lt[P]=function(){if(!lt._client)return console.log("Bugsnag."+P+"() was called before Bugsnag.start()");lt._client._depth+=1;var V=lt._client[P].apply(lt._client,arguments);return lt._client._depth-=1,V})}),ge=lt,ge.Client=Xf,ge.Event=Ad,ge.Session=Ld,ge.Breadcrumb=_,ge.default=lt,ge})});Bd();var sl=ut(ft());Bd();function Bn(e){var t=e;if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object")return t;if(Array.isArray(t))return t.map(Bn);var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=Bn(t[n]));return r}zd();var _o={},Os=Wk();if(typeof Desmos!="undefined"&&Desmos.config)for(LT in Desmos.config)Desmos.config.hasOwnProperty(LT)&&Os.set(LT,Desmos.config[LT]);var LT,jl=function(e){return zu(e,Os)},br=function(e){_o[e]=jl(e)},Ln=function(e){_o[e]=!jl(`no${e}`)};br("testing");br("maintenance");br("disableScrollFix");br("nativeOnscreenKeypad");br("hidden");br("disableMouseInteractions");br("advancedStyling");br("outofdom");br("beta3d");Os.has("cacheRenderedSvgs")&&(_o.cacheRenderedSvgs=!0);Os.has("lang")&&(_o.language=Os.get("lang"));Os.has("fontSize")&&(_o.fontSize=Os.get("fontSize"));Os.has("backgroundColor")&&(_o.backgroundColor="#"+Os.get("backgroundColor"));Os.has("textColor")&&(_o.textColor="#"+Os.get("textColor"));_o.no_navigation_warning=jl("noconcat")||jl("testing");br("lockViewport");br("authorFeatures");br("degreeMode");br("clearIntoDegreeMode");br("plaidMode");br("wireframe");br("editOnWeb");br("crossOriginSaveTest");br("showResetButtonOnGraphpaper");br("transparentBackground");br("forceLogModeRegressions");br("defaultLogModeRegressions");Ln("links");Ln("trace");Ln("zoomFit");br("expressionsCollapsed");br("invertedColors");br("projectorMode");Ln("images");Ln("folders");Ln("settingsMenu");Ln("expressionsTopbar");Ln("zoomButtons");Ln("keypad");Ln("graphpaper");Ln("expressions");Ln("branding");Ln("pointsOfInterest");Ln("plotSingleVariableImplicitEquations");Ln("plotImplicits");Ln("plotInequalities");Ln("notes");Ln("sliders");br("pauseWhenOffscreen");br("worksheetSVG");Ln("brailleControls");br("audioTraceKeypad");br("audioTraceSimult");Ln("audio");br("sciKeypad");br("4fnKeypad");br("ans");jl("braille")&&(_o.braille=!0);Ln("qwertyKeyboard");br("restrictedFunctions");br("forceEnableGeometryFunctions");Ln("functionDefinition");br("singleExpression");br("restrictedEditing");br("replaceCommaWith10Exp");br("replaceRoundWithReciprocal");jl("typingAsteriskWritesTimesSymbol")&&(_o.typingAsteriskWritesTimesSymbol=!0);Ln("substitutions");Ln("intervalComprehensions");Ln("recursion");Ln("logScales");Ln("labels");Ln("distributions");_o["4fnKeypad"]?br("decimalToFraction"):Ln("decimalToFraction");br("translucentSurfaces");br("3d");br("disableWorkerOnZoom");br("disableLighting");br("showPerformanceMeter");var Zk;jl("exponentButtonForSquareRoot")?_o.additionalFunctions=["exponent"]:Os.has("additionalFunctions")&&(_o.additionalFunctions=(Zk=Os.get("additionalFunctions"))==null?void 0:Zk.split(","));Os.has("disableParentheses")&&(_o.disableParentheses=!0);jl("actions")?_o.actions=!0:jl("noactions")?_o.actions=!1:jl("clickableObjects")&&(_o.actions=!0);function lb(e){return _o[e]}function Jk(){return Bn(_o)}var V4=1;function eV(e){NT&&F4(e)}var NT=!1;function tV(){NT=!0}function F4(e){var r,n;if(!NT)return;let t=["trackEvent",e.category,e.action,e.name,e.value];lb("testing")?(r=window.paqTest)==null||r.push(t):(n=window._paq)==null||n.push(t)}var Qk;function rV(e=!0){if(!NT)return;let t=document.location.href,r=document.referrer,n=window._paq=window._paq||[];Qk!==t&&(Qk=t,e&&!lb("testing")&&(n==null||n.push(["setReferrerUrl",r]),n==null||n.push(["setDocumentTitle",window.document.title]),n==null||n.push(["setCustomDimension",V4,window.location!==window.parent.location]),n==null||n.push(["trackPageView"])))}var nV={cb20221031:"1"};fa();function iV(e){let t={};return ze.extend(!0,t,e),ze.param(t)}var RT="";function oP(){return RT}var oV=[];function aV(e){oV.push(e)}function G4(e){if(e.status===401)for(let t of oV)t()}async function B4(e){if(e&&e.routeDeprecated)throw e.js&&new Function(e.js)(),e}function sV(e){let t=new URLSearchParams;return Object.entries(e).forEach(([r,n])=>{Array.isArray(n)?n.forEach(i=>t.append(r,String(i))):t.set(r,String(n))}),t}function q4(){throw{status:0,responseJSON:{errors:[{key:"connection_failed",message:"Connection failed. Check your internet connection?"}]}}}async function aP(e){let t=await e.catch(q4);if(G4(t),!t.ok){let n;try{n=await t.json()}catch(i){}throw{status:t.status,statusText:t.statusText,responseJSON:n}}let r=await t.json();return await B4(r),r}async function ml(e,t,r){let n={method:"POST",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}};t&&(n.body=iV(t),n.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8");let i="";return r!==void 0&&(i=`?${sV(r).toString()}}`),await aP(fetch(`${RT}${e}${i}`,n))}async function cV(e,t){let r={method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript, */*; q=0.01"},body:JSON.stringify(t||null)};return await aP(fetch(RT+e,r))}async function mg(e,t){let r={method:"GET",credentials:"include",headers:{Accept:"application/json, text/javascript, */*; q=0.01"}},n=/\?/.test(String(e))?"&":"?";return await aP(fetch(`${RT}${e}${n}${sV({...t,...nV})}`,r))}zd();function sP(){return ml("/account/logout_xhr")}function uV(e){let t=function(){return ml("/account/login_xhr",e)};return sP().then(t,t).then(()=>dm({lang:e.lang}))}function dV(e){if("loggedIn"in e&&e.loggedIn===!1)throw e;return e}function dm(e){return mg("/account/user_info",e).then(t=>dV(t))}async function kT(){return mg("/account/user_info?no401").then(e=>dV(e))}function pV(e){return ml("/account/check_account_status",e)}function gV(e){return ml("/account/register_xhr",e).then(()=>dm({lang:e.lang}))}function fV(e){e===void 0&&(e={});let t="?source="+(e.fromUI||"");return e.teacher&&(t+="&teacher=true"),oP()+"/drive_api/calculator/login"+t}function mV(e){e===void 0&&(e={});let t="?source="+(e.fromUI||"");return e.teacher&&(t+="&teacher=true"),oP()+"/apple_api/calculator/login"+t}function hV(e){return ml("/account/change_name",e).then(()=>dm({lang:e.lang}))}function yV(e){return ml("/account/change_name_detail",{lang:e.lang,userProvidedName:{given:e.given,family:e.family}}).then(()=>dm({lang:e.lang}))}function bV(e){return ml("/account/recover_xhr",e)}function xV(e){return mg("/account/initiate_delete_account",e)}function vV(e){return mg("/account/initiate_email_change",e)}function TV(e){return ml("/account/set_email",e).then(()=>dm({lang:e.lang}))}function wV(e){return cV("/account/update_feature_flags",e).then(()=>dm({lang:e.lang}))}function CV(e,t){e.closed?t.askServerIfLoggedIn():setTimeout(()=>{CV(e,t)},1e3)}function IV(e){var t=window.open(e.url,"login_window","width=650,height=530,resizable,scrollbars");t?CV(t,e.userController):alert(e.blockedMessage)}function PV(e,t){window.userController=e,e.observeEvent("googleLogin",function(r,n){IV({url:fV(n),userController:e,blockedMessage:t("account-shell-text-login-window-blocked-google")})}),e.observeEvent("appleLogin",function(r,n){IV({url:mV(n),userController:e,blockedMessage:t("account-shell-text-login-window-blocked-apple")})})}var VT=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},GT=Array.prototype,dP=Object.prototype,SV=typeof Symbol!="undefined"?Symbol.prototype:null,Xae=GT.push,U4=GT.slice,FT=dP.toString,H4=dP.hasOwnProperty,$4=Array.isArray,MV=Object.keys,DV=Object.create,Y4=VT.isNaN,Kae=VT.isFinite,cP=function(){};function co(e){if(e instanceof co)return e;if(!(this instanceof co))return new co(e);this._wrapped=e}var jae=co.VERSION="1.10.2";function BT(e,t,r){if(t===void 0)return e;switch(r==null?3:r){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,o){return e.call(t,n,i,o)};case 4:return function(n,i,o,a){return e.call(t,n,i,o,a)}}return function(){return e.apply(t,arguments)}}function OV(e,t,r){return e==null?mY:Hu(e)?BT(e,t,r):fm(e)&&!Hd(e)?hY(e):WV(e)}co.iteratee=LV;function LV(e,t){return OV(e,t,1/0)}function Ud(e,t,r){return co.iteratee!==LV?co.iteratee(e,t):OV(e,t,r)}function ic(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=n,e.apply(this,o)}}function W4(e){if(!fm(e))return{};if(DV)return DV(e);cP.prototype=e;var t=new cP;return cP.prototype=null,t}function NV(e){return function(t){return t==null?void 0:t[e]}}function pm(e,t){return e!=null&&H4.call(e,t)}function RV(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}var X4=Math.pow(2,53)-1,hg=NV("length");function yg(e){var t=hg(e);return typeof t=="number"&&t>=0&&t<=X4}function bg(e,t,r){t=BT(t,r);var n,i;if(yg(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var o=hl(e);for(n=0,i=o.length;n<i;n++)t(e[o[n]],o[n],e)}return e}function qT(e,t,r){t=Ud(t,r);for(var n=!yg(e)&&hl(e),i=(n||e).length,o=Array(i),a=0;a<i;a++){var s=n?n[a]:a;o[a]=t(e[s],s,e)}return o}function kV(e){var t=function(r,n,i,o){var a=!yg(r)&&hl(r),s=(a||r).length,c=e>0?0:s-1;for(o||(i=r[a?a[c]:c],c+=e);c>=0&&c<s;c+=e){var l=a?a[c]:c;i=n(i,r[l],l,r)}return i};return function(r,n,i,o){var a=arguments.length>=3;return t(r,BT(n,o,4),i,a)}}var Zae=kV(1),Jae=kV(-1);function xg(e,t,r){var n=[];return t=Ud(t,r),bg(e,function(i,o,a){t(i,o,a)&&n.push(i)}),n}function pP(e,t,r){t=Ud(t,r);for(var n=!yg(e)&&hl(e),i=(n||e).length,o=0;o<i;o++){var a=n?n[o]:o;if(!t(e[a],a,e))return!1}return!0}function Uu(e,t,r,n){return yg(e)||(e=hP(e)),(typeof r!="number"||n)&&(r=0),tY(e,t,r)>=0}var Qae=ic(function(e,t,r){var n,i;return Hu(t)?i=t:Hd(t)&&(n=t.slice(0,-1),t=t[t.length-1]),qT(e,function(o){var a=i;if(!a){if(n&&n.length&&(o=RV(o,n)),o==null)return;a=o[t]}return a==null?a:a.apply(o,r)})});function K4(e,t){return qT(e,WV(t))}function j4(e,t,r){var n=-1/0,i=-1/0,o,a;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=yg(e)?e:hP(e);for(var s=0,c=e.length;s<c;s++)o=e[s],o!=null&&o>n&&(n=o)}else t=Ud(t,r),bg(e,function(l,u,d){a=t(l,u,d),(a>i||a===-1/0&&n===-1/0)&&(n=l,i=a)});return n}function zT(e,t){return function(r,n,i){var o=t?[[],[]]:{};return n=Ud(n,i),bg(r,function(a,s){var c=n(a,s,r);e(o,a,c)}),o}}var ese=zT(function(e,t,r){pm(e,r)?e[r].push(t):e[r]=[t]}),tse=zT(function(e,t,r){e[r]=t}),rse=zT(function(e,t,r){pm(e,r)?e[r]++:e[r]=1});var nse=zT(function(e,t,r){e[r?0:1].push(t)},!0);function gm(e,t,r,n){n=n||[];for(var i=n.length,o=0,a=hg(e);o<a;o++){var s=e[o];if(yg(s)&&(Hd(s)||uP(s)))if(t)for(var c=0,l=s.length;c<l;)n[i++]=s[c++];else gm(s,t,r,n),i=n.length;else r||(n[i++]=s)}return n}var VV=ic(function(e,t){return Z4(e,t)});function gP(e,t,r,n){fY(t)||(n=r,r=t,t=!1),r!=null&&(r=Ud(r,n));for(var i=[],o=[],a=0,s=hg(e);a<s;a++){var c=e[a],l=r?r(c,a,e):c;t&&!r?((!a||o!==l)&&i.push(c),o=l):r?Uu(o,l)||(o.push(l),i.push(c)):Uu(i,c)||i.push(c)}return i}var ise=ic(function(e){return gP(gm(e,!0,!0))});var Z4=ic(function(e,t){return t=gm(t,!0,!0),xg(e,function(r){return!Uu(t,r)})});function J4(e){for(var t=e&&j4(e,hg).length||0,r=Array(t),n=0;n<t;n++)r[n]=K4(e,n);return r}var ose=ic(J4);function FV(e){return function(t,r,n){r=Ud(r,n);for(var i=hg(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(r(t[o],o,t))return o;return-1}}var fP=FV(1),Q4=FV(-1);function eY(e,t,r,n){r=Ud(r,n,1);for(var i=r(t),o=0,a=hg(e);o<a;){var s=Math.floor((o+a)/2);r(e[s])<i?o=s+1:a=s}return o}function GV(e,t,r){return function(n,i,o){var a=0,s=hg(n);if(typeof o=="number")e>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(r&&o&&s)return o=r(n,i),n[o]===i?o:-1;if(i!==i)return o=t(U4.call(n,a,s),gY),o>=0?o+a:-1;for(o=e>0?a:s-1;o>=0&&o<s;o+=e)if(n[o]===i)return o;return-1}}var tY=GV(1,fP,eY),ase=GV(-1,Q4);function BV(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var o=W4(e.prototype),a=e.apply(o,i);return fm(a)?a:o}var rY=ic(function(e,t,r){if(!Hu(e))throw new TypeError("Bind must be called on a function");var n=ic(function(i){return BV(e,n,t,this,r.concat(i))});return n}),UT=ic(function(e,t){var r=UT.placeholder,n=function(){for(var i=0,o=t.length,a=Array(o),s=0;s<o;s++)a[s]=t[s]===r?arguments[i++]:t[s];for(;i<arguments.length;)a.push(arguments[i++]);return BV(e,n,this,this,a)};return n});UT.placeholder=co;var sse=ic(function(e,t){t=gm(t,!1,!1);var r=t.length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=rY(e[n],e)}});var qV=ic(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),cse=UT(qV,co,1);function ub(e,t,r){var n,i,o,a,s=0;r||(r={});var c=function(){s=r.leading===!1?0:AV(),n=null,a=e.apply(i,o),n||(i=o=null)},l=function(){var u=AV();!s&&r.leading===!1&&(s=u);var d=t-(u-s);return i=this,o=arguments,d<=0||d>t?(n&&(clearTimeout(n),n=null),s=u,a=e.apply(i,o),n||(i=o=null)):!n&&r.trailing!==!1&&(n=setTimeout(c,d)),a};return l.cancel=function(){clearTimeout(n),s=0,n=i=o=null},l}function zV(e,t,r){var n,i,o=function(s,c){n=null,c&&(i=e.apply(s,c))},a=ic(function(s){if(n&&clearTimeout(n),r){var c=!n;n=setTimeout(o,t),c&&(i=e.apply(this,s))}else n=qV(o,t,this,s);return i});return a.cancel=function(){clearTimeout(n),n=null},a}function nY(e){return function(){return!e.apply(this,arguments)}}function iY(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var lse=UT(iY,2),UV=!{toString:null}.propertyIsEnumerable("toString"),_V=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function HV(e,t){var r=_V.length,n=e.constructor,i=Hu(n)&&n.prototype||dP,o="constructor";for(pm(e,o)&&!Uu(t,o)&&t.push(o);r--;)o=_V[r],o in e&&e[o]!==i[o]&&!Uu(t,o)&&t.push(o)}function hl(e){if(!fm(e))return[];if(MV)return MV(e);var t=[];for(var r in e)pm(e,r)&&t.push(r);return UV&&HV(e,t),t}function mP(e){if(!fm(e))return[];var t=[];for(var r in e)t.push(r);return UV&&HV(e,t),t}function hP(e){for(var t=hl(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}function oY(e){for(var t={},r=hl(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}function yP(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var i=1;i<n;i++)for(var o=arguments[i],a=e(o),s=a.length,c=0;c<s;c++){var l=a[c];(!t||r[l]===void 0)&&(r[l]=o[l])}return r}}var aY=yP(mP),sY=yP(hl);function cY(e,t,r){return t in r}var lY=ic(function(e,t){var r={},n=t[0];if(e==null)return r;Hu(n)?(t.length>1&&(n=BT(n,t[1])),t=mP(e)):(n=cY,t=gm(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var a=t[i],s=e[a];n(s,a,e)&&(r[a]=s)}return r}),use=ic(function(e,t){var r=t[0],n;return Hu(r)?(r=nY(r),t.length>1&&(n=t[1])):(t=qT(gm(t,!1,!1),String),r=function(i,o){return!Uu(t,o)}),lY(e,r,n)}),dse=yP(mP,!0);function $V(e){return fm(e)?Hd(e)?e.slice():aY({},e):e}function uY(e,t){var r=hl(t),n=r.length;if(e==null)return!n;for(var i=Object(e),o=0;o<n;o++){var a=r[o];if(t[a]!==i[a]||!(a in i))return!1}return!0}function lP(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!=="function"&&i!=="object"&&typeof t!="object"?!1:dY(e,t,r,n)}function dY(e,t,r,n){e instanceof co&&(e=e._wrapped),t instanceof co&&(t=t._wrapped);var i=FT.call(e);if(i!==FT.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return SV.valueOf.call(e)===SV.valueOf.call(t)}var o=i==="[object Array]";if(!o){if(typeof e!="object"||typeof t!="object")return!1;var a=e.constructor,s=t.constructor;if(a!==s&&!(Hu(a)&&a instanceof a&&Hu(s)&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var c=r.length;c--;)if(r[c]===e)return n[c]===t;if(r.push(e),n.push(t),o){if(c=e.length,c!==t.length)return!1;for(;c--;)if(!lP(e[c],t[c],r,n))return!1}else{var l=hl(e),u;if(c=l.length,hl(t).length!==c)return!1;for(;c--;)if(u=l[c],!(pm(t,u)&&lP(e[u],t[u],r,n)))return!1}return r.pop(),n.pop(),!0}function pi(e,t){return lP(e,t)}function oc(e){return function(t){return FT.call(t)==="[object "+e+"]"}}var Hd=$4||oc("Array");function fm(e){var t=typeof e;return t==="function"||t==="object"&&!!e}var uP=oc("Arguments"),Hu=oc("Function"),pse=oc("String"),YV=oc("Number"),gse=oc("Date"),fse=oc("RegExp"),mse=oc("Error"),hse=oc("Symbol"),yse=oc("Map"),bse=oc("WeakMap"),xse=oc("Set"),vse=oc("WeakSet");(function(){uP(arguments)||(uP=function(e){return pm(e,"callee")})})();var pY=VT.document&&VT.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof pY!="function"&&(Hu=function(e){return typeof e=="function"||!1});function gY(e){return YV(e)&&Y4(e)}function fY(e){return e===!0||e===!1||FT.call(e)==="[object Boolean]"}function mY(e){return e}function WV(e){return Hd(e)?function(t){return RV(t,e)}:NV(e)}function hY(e){return e=sY({},e),function(t){return uY(t,e)}}var AV=Date.now||function(){return new Date().getTime()},XV={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},yY=oY(XV);function KV(e){var t=function(o){return e[o]},r="(?:"+hl(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(o){return o=o==null?"":""+o,n.test(o)?o.replace(i,t):o}}var bY=KV(XV),Tse=KV(yY);var xY=0;function jV(e){var t=++xY+"";return e?e+t:t}var wse=co.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};function ZV(e,t){return e._chain?co(t).chain():t}bg(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=GT[e];co.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),(e==="shift"||e==="splice")&&r.length===0&&delete r[0],ZV(this,r)}});bg(["concat","join","slice"],function(e){var t=GT[e];co.prototype[e]=function(){return ZV(this,t.apply(this._wrapped,arguments))}});co.prototype.value=function(){return this._wrapped};co.prototype.valueOf=co.prototype.toJSON=co.prototype.value;co.prototype.toString=function(){return String(this._wrapped)};var vY=0,TY="guid_"+Math.round(Math.random()*1e6)+"_"+new Date().getTime()+"_",bP=class{constructor(){this.__observers={},this.__eventObservers={},this.__oldProperties={},this.__propertyComparators={},this.guid=TY+ ++vY}unobserveAll(){this.__observers={},this.__eventObservers={}}getProperty(t){return this[t]}getOldProperty(t){return this.__oldProperties[t]}setProperty(t,r){var n=this[t];this[t]=r;var i=this.__propertyComparators[t];if(i){if(i(n,r))return}else if(pi(n,r))return;this.__oldProperties[t]=n,this.notifyPropertyChange(t)}setProperties(t){for(var r in t)t.hasOwnProperty(r)&&this.setProperty(r,t[r])}setPropertyComparator(t,r){this.__propertyComparators[t]=r}notifyPropertyChange(t){this.__callObservers(this.__observers,t,this)}observe(t,r){this.__addObservers(this.__observers,t,r)}unobserve(t){this.__removeObservers(this.__observers,t)}observeAndSync(t,r){this.observe(t,r);for(var n=t.split(" "),i=0;i<n.length;i++){var o=n[i].split("."),a=o[0];this.hasOwnProperty(a)&&r(a,this)}}triggerEvent(t,r){this.__callObservers(this.__eventObservers,t,r)}observeEvent(t,r){this.__addObservers(this.__eventObservers,t,r)}unobserveEvent(t){this.__removeObservers(this.__eventObservers,t)}__callObservers(t,r,n){var i=t[r];if(i)for(var o=0;o<i.length;o++)i[o].callback(r,n)}__removeObservers(t,r){for(var n=r.split(" "),i=0;i<n.length;i++){var o=n[i].split("."),a=o[0],s=o[1];if(a&&s){var c=t[a],l=[];if(!c)continue;for(var u=0;u<c.length;u++){var d=c[u];d.namespace!==s&&l.push(d)}t[a]=l}else if(a)delete t[a];else if(s)for(a in t)t.hasOwnProperty(a)&&this.__removeObservers(t,a+"."+s)}}__addObservers(t,r,n){for(var i=r.split(" "),o=0;o<i.length;o++){var a=i[o].split("."),s=a[0];if(!s)throw"Must supply a property to observe";var c=a[1],l={namespace:c,callback:n},u=t[s];u?u.push(l):t[s]=[l]}}},mm=bP;AT();var HT=class extends mm{constructor(){super();this.loggedIn="not-checked";this.logoutFailed=!1;this.loggingOut=!1;this.userId="";this.name="";this.email="";this.teacher=!1;this.featureFlags=[];this.emailVerificationStatus="";aV(()=>this.logout())}desmosLogin(r){return uV(r).then(this.completeLogin.bind(this))}googleLogin(r){this.triggerEvent("googleLogin",r)}appleLogin(r){this.triggerEvent("appleLogin",r)}askServerIfLoggedIn(){return kT().then(r=>{r.isMaintenanceMode&&this.triggerEvent("detectedMaintenanceMode",void 0),this.completeLogin(r)},r=>{var n,i,o;r.status===503&&((o=(i=(n=r.responseJSON)==null?void 0:n.errors)==null?void 0:i[0])==null?void 0:o.key)==="maintenance_mode"?this.triggerEvent("detectedMaintenanceMode",void 0):r.isMaintenanceMode&&this.triggerEvent("detectedMaintenanceMode",void 0),this.completeLogout()})}driveCallback(){return kT().then(this.completeLogin.bind(this),this.logout.bind(this))}createAccount(r){let n={...r,name:r.userProvidedName.given};return n.teacher===!1&&delete n.teacher,gV(n).then(this.completeLogin.bind(this))}checkPendingDeletion(r){return pV(r)}isTeacher(){return!!this.teacher}setNameLegacy(r){return hV(r).then(n=>{this.name=n.name||"",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}setNameDetail(r){return yV({...r,source:"user"}).then(n=>{this.name=n.name||"",this.nameDetail=n.nameDetail,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}recoverPassword(r){return bV(r)}completeLogin(r){this.loggedIn="logged-in",this.userId=r.userId||"",this.name=r.name||"",this.nameDetail=r.nameDetail,this.email=r.email||"",this.featureFlags=r.featureFlags||[],this.emailVerificationStatus=r.emailVerificationStatus||"",this.teacher=!!r.isTeacher,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}async logout(){this.loggingOut=!0,this.triggerEvent("logout",void 0),this.triggerEvent("triggerRender",void 0);try{await sP(),this.completeLogout()}catch(r){await kT().then(()=>this._onLogoutFailure()).catch(n=>{"loggedIn"in n&&!n.loggedIn?this.completeLogout():this._onLogoutFailure()})}finally{this.loggingOut=!1,this.triggerEvent("triggerRender",void 0)}}completeLogout(){this.loggedIn="logged-out",this.logoutFailed=!1,this.userId="",this.email="",this.name="",this.featureFlags=[],this.emailVerificationStatus="",this.teacher=!1,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}_onLogoutFailure(){this.logoutFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.logoutFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}initiateAccountDeletion(r){return xV(r)}getEmailChangeToken(){return Xk(location.search,"changeToken")}initiateEmailChange(r){return vV(r)}setEmail(r){return TV(r).then(()=>{this.email=r.newEmail||"",this.emailVerificationStatus="VERIFYING",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}updateFeatureFlags(r){return wV(r).then(n=>{this.featureFlags=n.featureFlags,this.triggerEvent("userUpdated",void 0)})}getFeatureFlags(){return this.featureFlags}hasFeatureFlag(r){return this.featureFlags.some(n=>n===r)}getLoginStatus(){return this.loggedIn}isLoggedIn(){return this.loggedIn==="logged-in"}isLoggingOut(){return!!this.loggingOut}didLogoutFail(){return!!this.logoutFailed}getEmail(){return this.email}getFirstName(){return wY(this.name)}getFullName(){return this.name}getNameDetail(){return this.nameDetail}getUserId(){return this.userId}getVerificationStatus(){return this.emailVerificationStatus}getUserAsJSON(){if(this.isLoggedIn())return{email:this.email,name:this.name,emailVerificationStatus:this.emailVerificationStatus}}};function wY(e){if(!e)return"";if(e.match(/[\d@_&\.\']/))return e;var t=e.split(" ");return t[0].length>=3?t[0]:e}function EY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var IY="ID_",$T=function(){function e(){EY(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(r){var n=IY+this._lastID++;return this._callbacks[n]=r,n},e.prototype.unregister=function(r){this._callbacks[r]||db(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",r),delete this._callbacks[r]},e.prototype.waitFor=function(r){this._isDispatching||db(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var n=0;n<r.length;n++){var i=r[n];if(this._isPending[i]){this._isHandled[i]||db(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",i);continue}this._callbacks[i]||db(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",i),this._invokeCallback(i)}},e.prototype.dispatch=function(r){this._isDispatching&&db(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(r);try{for(var n in this._callbacks)this._isPending[n]||this._invokeCallback(n)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(r){this._isPending[r]=!0,this._callbacks[r](this._pendingPayload),this._isHandled[r]=!0},e.prototype._startDispatching=function(r){for(var n in this._callbacks)this._isPending[n]=!1,this._isHandled[n]=!1;this._pendingPayload=r,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();function db(e,t,r,n,i,o,a,s){if(t===void 0)throw new Error("invariant requires an error message argument");if(!e){var c;if(t===void 0)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[r,n,i,o,a,s],u=0;c=new Error(t.replace(/%s/g,function(){return l[u++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}}var JV=function(){{var e=function(){},t=["log","info","warn","error","assert","dir","clear","profile","profileEnd","time","timeEnd","group","groupCollapsed","groupEnd","trace"],r={},n=function(i){typeof window!="undefined"&&window.console&&window.console[i]?r[i]=function(){Function.prototype.apply.call(window.console[i],window.console,arguments)}:r[i]=e};return t.forEach(n),r}}(),Ki=JV,{log:Mse,warn:Dse,error:_se,assert:Ase,dir:Ose,clear:Lse,profile:Nse,profileEnd:Rse,time:kse,timeEnd:Vse,group:Fse,groupCollapsed:Gse,groupEnd:Bse,trace:qse}=JV;function pb(e){var t=[];for(let n of e)if(!(!n||typeof n!="string")){var r=n.split("-")[0];t.push(n),t.push(r);for(let i in yl){let o=yl[i];i.split("-")[0]===r&&o.useAsRoot&&t.push(i)}}return t}function QV(){let e={},t=Object.keys(yl);for(let r in t){let n=t[r];e[n]={code:n,display_name:yl[n].displayName}}return e}var yl={en:{displayName:"English (US)",userGuideURL:"https://docs.google.com/document/d/1gV-WgDjgR9hKKb32ffeUpjwggNAgfqxl0Gsg6xocbok/preview",useAsRoot:!1},es:{displayName:"Espa\xF1ol (LATAM)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},et:{displayName:"Eesti",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ru:{displayName:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Portugu\xEAs (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},"pt-PT":{displayName:"Portugu\xEAs (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Catal\xE0",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Fran\xE7ais",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!0},"fr-CA":{displayName:"Fran\xE7ais (Canada)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!0},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"\xCDslenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"\u010Ce\u0161tina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Ti\u1EBFng Vi\u1EC7t",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},uk:{displayName:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"T\xFCrk\xE7e",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},"zh-CN":{displayName:"\u7B80\u4F53\u4E2D\u6587",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"\u7E41\u9AD4\u4E2D\u6587",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"\uD55C\uAD6D\uC5B4",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"\u65E5\u672C\u8A9E",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}};function gb(e){return{__isLocalizableNumericValue:!0,value:e}}function YT(e){return e&&e.__isLocalizableNumericValue}var eF=`account-shell-error-connection-failed = Connection failed. Try checking your internet connection.
account-shell-error-unexpected-server = Unexpected server error. Try again, or e-mail { $email }.
account-shell-text-login-window-blocked-apple = Login window blocked. Please allow popups from desmos.com to sign in with Apple
account-shell-text-login-window-blocked-google = Login window blocked. Please allow popups from desmos.com to sign in with Google.
shared-button-cancel = Cancel
shared-button-change-email-address = Change email address
shared-button-change-email-and-password = Change email and password
shared-button-close-dialog = Close Dialog
shared-button-confirm-name = Confirm Name
shared-button-continue-to-desmos = Continue to Desmos
shared-button-create-account = Create Account
shared-button-delete-account-question = Delete your Desmos account?
shared-button-email-address-narrow = Email
shared-button-email-address-wide = Email Address
shared-button-external-account-narrow = External
shared-button-external-account-wide = External Account
shared-button-google-account-narrow = Google
shared-button-google-account-wide = Google Account
shared-button-login = Log in
shared-button-login-capitalized = Log In
shared-button-recover-password = Recover Password
shared-button-save = Save
shared-button-send-delete-account-email = Send Delete Account Email
shared-button-send-email = Send Email
shared-button-sign-in-with-apple = Sign in with Apple
shared-button-sign-in-with-google = Sign in with Google
shared-button-try-again = Didn't work? Try again!
shared-calculator-button-clear = clear
shared-calculator-button-clear-all = clear all
shared-calculator-button-language = Language
shared-calculator-button-print = Print
shared-calculator-button-reverse-contrast = Reverse Contrast
shared-calculator-error-3d-bad-equality-slice = We don't support this type of equality restriction.
shared-calculator-error-3d-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the 3d calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-3d-mixed-restriction-equation = Cannot apply both an inequality restriction and an equality restriction to this expression.
shared-calculator-error-3d-multiple-equality-restrictions = Cannot apply more than one equality restriction.
shared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable '{ $symbol }'.
shared-calculator-error-add-arguments-to-definition-many = Try including '{ $symbols }' and '{ $lastSymbol }' as arguments by defining the function as '{ $newSignature }'.
shared-calculator-error-add-arguments-to-definition-one = Try including '{ $lastSymbol }' as an argument by defining the function as '{ $newSignature }'.
shared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.
shared-calculator-error-adjacent-mixed-number = Sorry, I don't know what to do with mixed number '{ $mixedNumber }'. Try using a '*' symbol around it.
shared-calculator-error-adjacent-numbers = Sorry, I don't know what to do with adjacent numbers '{ $left }' and '{ $right }'. Try using parentheses or a '*' symbol.
shared-calculator-error-ans-undefined = The previous expression didn't define any value for ans.
shared-calculator-error-assignments-unsupported = This calculator does not support defining variables.
shared-calculator-error-bad-for-input-list-dependency = A definition on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-for-interval-dependency = Parameter bounds on the right-hand side of 'for' can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-implicit-call = Use parentheses around the argument of '{ $symbol }'.
shared-calculator-error-bad-integral-bound-dependency = Integration bounds can't depend on integration variable '{ $symbol }'.
shared-calculator-error-bad-interval-comprehension-arity =
    { $count ->
        [one] You can't use 'for' to parameterize { $type } using 1 parameter.
       *[other] You can't use 'for' to parameterize { $type } using { $count } parameters.
    }
shared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.
shared-calculator-error-bad-product-bound-dependency = Product bounds can't depend on product index '{ $symbol }'.
shared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.
shared-calculator-error-bad-sum-bound-dependency = Summation bounds can't depend on summation index '{ $symbol }'.
shared-calculator-error-bad-symbol-context = You can't use '{ $symbol }' in this context.
shared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.
shared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.
shared-calculator-error-binary-operator-missing-operand = You need something on both sides of the '{ $symbol }' symbol.
shared-calculator-error-blank-expression = You haven't written anything yet.
shared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.
shared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.
shared-calculator-error-cannot-assign-color = Cannot assign a color to '{ $variable }'.
shared-calculator-error-cannot-redefine = You can't redefine '{ $symbol }' because it's already defined.
shared-calculator-error-cannot-redefine-root = You can't define '{ $symbol }' because '{ $symbolRoot }' is already defined.
shared-calculator-error-cannot-restrict = Cannot create a restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-restrict-with-equality = Cannot create an equality restriction based on '{ $variable }' in this type of expression.
shared-calculator-error-cannot-subscript = '{ $symbol }' cannot have a subscript.
shared-calculator-error-cant-combine-spherical-and-cylindrical = Can't combine spherical and cylindrical coordinates.
shared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.
shared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.
shared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.
shared-calculator-error-cdf-too-many-arguments = 'cdf' should be called on a distribution with at most two numbers. { $recommendation }
shared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().
shared-calculator-error-cdf-wrong-arity = 'cdf' should be called on a distribution with at least one number. { $recommendation }
shared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().
shared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.
shared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.
shared-calculator-error-clickable-object-invalid-expression = Can't evaluate this. Try a number or simple expression.
shared-calculator-error-colon-missing-condition = The left side of a ':' must be a condition, like 'x>1'.
shared-calculator-error-color-arity = '{ $symbol }' should be called with 3 arguments. { $recommendation }
shared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.
shared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.
shared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.
shared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.
shared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.
shared-calculator-error-constant-unsupported = This calculator does not support the constant '{ $symbol }'.
shared-calculator-error-coordinate-access-type-error = Cannot access coordinate '{ $coordinate }' of { $symbol }.
shared-calculator-error-deeply-nested = Definitions are nested too deeply.
shared-calculator-error-dependency-cycle = '{ $symbols }' and '{ $lastSymbol }' can't be defined in terms of each other.
shared-calculator-error-depends-on-deleted-geo-object = This depends on a geometric object that's no longer defined.
shared-calculator-error-derivative-missing-body = What do you want to take the derivative of?
shared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.
shared-calculator-error-derivative-type-error-respect = Cannot take the derivative of { $symbol1 } with respect to { $symbol2 }.
shared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to '{ $symbol1 }' because it is { $symbol2 }.
shared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.
shared-calculator-error-distribution-as-function = Cannot call distribution '{ $symbol }' as a function. Try '{ $symbol }.pdf(x)'.
shared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.
shared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.
shared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.
shared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.
shared-calculator-error-dot-lhs-constant-number = Sorry, I don't understand this use of '.' after a constant number.
shared-calculator-error-dot-lhs-type-error = Cannot call '.{ $symbol }' on { $type }.
shared-calculator-error-dot-rhs-property-error = '.{ $symbol }' cannot be followed by parentheses.
shared-calculator-error-duplicate-function-parameter = Cannot use '{ $dependency }' for multiple parameters of this function.
shared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for '{ $symbol }'.
shared-calculator-error-empty-paren = Parentheses cannot be empty.
shared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.
shared-calculator-error-empty-radical = Radical cannot be empty.
shared-calculator-error-empty-radical-index = Radical index cannot be empty.
shared-calculator-error-empty-square-bracket = Square brackets cannot be empty.
shared-calculator-error-empty-subscript = Subscripts cannot be empty.
shared-calculator-error-empty-superscript = Superscripts cannot be empty.
shared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.
shared-calculator-error-equation-required-symbol = Try adding '{ $lhs }' to the beginning of this equation.
shared-calculator-error-equations-unsupported = This calculator does not support this type of equation.
shared-calculator-error-event-handler-type-error = This should be an action. Try '{ $example }'.
shared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.
shared-calculator-error-feature-unavailable = This feature is not available in the current calculator.
shared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.
shared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.
shared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.
shared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.
shared-calculator-error-function-name-as-parameter = Cannot use function name '{ $dependency }' as a function parameter.
shared-calculator-error-function-not-defined = Function '{ $dependency }' is not defined.
shared-calculator-error-function-type-error-1 = Function '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-function-type-error-2 = Function '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-function-type-error-many = Function '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-function-unsupported = This calculator does not support the '{ $symbol }' function.
shared-calculator-error-geometry-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the geometry calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-gpu-function-unsupported = Cannot use the '{ $symbol }' function here.
shared-calculator-error-gpu-integral-unsupported = Cannot use integrals here.
shared-calculator-error-gpu-long-product = Products may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-long-sum = Sums may not have more than { $maxTermCount } terms here.
shared-calculator-error-gpu-max-list-size = Lists may not have more than { $maxListSize } elements here.
shared-calculator-error-gpu-variable-list-length = List length cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-product = Product bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-gpu-variable-sum = Sum bound cannot depend on variable '{ $symbol }' here.
shared-calculator-error-heterogeneous-list = All elements of a list must have the same type.
shared-calculator-error-identifier-as-function = '{ $symbol }' is a function. Try using parentheses.
shared-calculator-error-identifier-is-not-function = '{ $symbol }' is not a function. Try defining it as '{ $symbol }(x) = x^2' instead.
shared-calculator-error-illegal-bin-width = The second argument to '{ $symbol }' must be a positive number.
shared-calculator-error-illegal-dot-call = Function '{ $symbol }' cannot be called with dot notation.
shared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.
shared-calculator-error-incorrect-list-comprehension-input = Definitions on the right-hand side of 'for' must set a variable equal to a list. Try i=[1...10].
shared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.
shared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.
shared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.
shared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.
shared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.
shared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.
shared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.
shared-calculator-error-integral-missing-body = What do you want to take the integral of?
shared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.
shared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.
shared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.
shared-calculator-error-internal-error = [internal] { $msg }
shared-calculator-error-invalid-dependent-first-table-column = This column header can't be defined elsewhere in the calculator.
shared-calculator-error-invalid-double-equality-3d = Sorry, we only plot double equalities that contain z. Try adding 0*z to one side.
shared-calculator-error-invalid-double-inequality-3d = We only plot double inequalities of x, y, and z.
shared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.
shared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.
shared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.
shared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.
shared-calculator-error-invalid-implicit-variables-3d = We only support implicit equations of x, y, and z.
shared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and \u03B8.
shared-calculator-error-invalid-interval-comprehension-invalid-bound = Parameter bounds on the right-hand side of 'for' must be of the form '0<{ $identifier }<1'.
shared-calculator-error-invalid-interval-comprehension-return-type = You can't use 'for' to parameterize { $type }.
shared-calculator-error-invalid-lhs = Sorry, you can't graph { $symbol } as a function of anything yet.
shared-calculator-error-invalid-operator-name = Operator names may only contain letters.
shared-calculator-error-invalid-regression-parameter = '{ $symbol }' may not be used as a regression parameter. Try using a list.
shared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. '{ $symbol }' is not allowed.
shared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }
shared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }
shared-calculator-error-list-comprehension-input-type-error = A definition on the right-hand side of 'for' must be a list, but { $identifier } is { $actual }. Try { $identifier }={ $example }.
shared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.
shared-calculator-error-log-scale-box-plot = Cannot plot a box plot on a log scale.
shared-calculator-error-log-scale-dot-plot = Cannot plot a dot plot on a log scale.
shared-calculator-error-log-scale-histogram = Cannot plot a histogram on a log scale.
shared-calculator-error-log-scale-type-error = Cannot plot { $symbol } on a log scale.
shared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try 'log' or 'ln'.
shared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].
shared-calculator-error-malformed-point = Points are written like this: (1, 2).
shared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.
shared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using 'New Matrix'.
shared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.
shared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.
shared-calculator-error-matrix-invalid-variable = Cannot use '{ $symbol }' as a variable.
shared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.
shared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.
shared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.
shared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.
shared-calculator-error-method-requires-list = '{ $symbol }' requires a list. For example, try typing: { $recommendation }.
shared-calculator-error-mismatched-braces = Expected '{ $symbol1 }' to match '{ $symbol2 }'.
shared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.
shared-calculator-error-mixed-comparator-chain = Cannot mix inequalities and equations in a chain of comparisons.
shared-calculator-error-multiply-defined = You've defined '{ $dependency }' in more than one place. Try deleting some of the definitions of '{ $dependency }'.
shared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.
shared-calculator-error-multiply-type-error-2d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2) * (2, 1).
shared-calculator-error-multiply-type-error-3d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2, 3) cross (2, 1, 0).
shared-calculator-error-multiply-type-error-cross = Cannot take the cross product of { $symbol1 } and { $symbol2 }.
shared-calculator-error-negative-type-error = Cannot negate { $symbol }.
shared-calculator-error-nested-interval-comprehension = You can't yet use 'for' to introduce a new parameter to an already parameterized point.
shared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.
shared-calculator-error-non-list-double-reducer = Both arguments of '{ $symbol }' must be lists. For example, try typing: { $recommendation }.
shared-calculator-error-non-list-parameterized-reducer = The first argument of '{ $symbol }' must be a list. For example, try typing: { $recommendation }.
shared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.
shared-calculator-error-non-square-determinant = Only square matrices have a determinant.
shared-calculator-error-non-square-inverse = Only square matrices have an inverse.
shared-calculator-error-non-square-trace = Only square matrices have a trace.
shared-calculator-error-operator-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.
shared-calculator-error-optimization-error = We couldn't find any region where this model is defined.
shared-calculator-error-parameter-already-defined = You can't use '{ $dependency }' as a parameter of this function because '{ $dependency }' is already defined.
shared-calculator-error-parse-error = Sorry, I don't understand this.
shared-calculator-error-pdf-wrong-arity = 'pdf' should be called on a distribution with a number. { $recommendation }
shared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().
shared-calculator-error-percent-missing-of = '%' must be used with 'of'. Try '25% of 12'.
shared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.
shared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.
shared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.
shared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.
shared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.
shared-calculator-error-points-unsupported = This calculator does not support points.
shared-calculator-error-polygon-unsupported-in-3d = This calculator does not support the 'polygon' function. Try 'triangle' instead.
shared-calculator-error-prime-variable-type-error = Cannot take derivative of '{ $symbol1 }' with respect to { $symbol2 }.
shared-calculator-error-prime-without-paren = Primed function calls must use parentheses.
shared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.
shared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.
shared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.
shared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.
shared-calculator-error-product-missing-body = What do you want to take the product of?
shared-calculator-error-product-missing-bound = Products must have upper and lower bounds.
shared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.
shared-calculator-error-random-arity = 'random' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).
shared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions
shared-calculator-error-recursion-argument-type = Expected argument { $index } to be { $expectedType } but found { $foundType }.
shared-calculator-error-recursion-base-case-argument-non-number = Base case arguments must be simple numbers. Try using piecewise syntax.
shared-calculator-error-recursion-base-case-free-variable = This recursion's base case can't depend on variable '{ $freeVariable }'.
shared-calculator-error-recursion-base-case-same-type = Base cases must all have the same return type.
shared-calculator-error-recursion-base-case-too-complicated = For a recursion with multiple parameters, try using piecewise syntax.
shared-calculator-error-recursion-depth-limit-exceeded = Recursive depth limit exceeded without reaching a base case.
shared-calculator-error-recursion-does-not-terminate = This recursion doesn't reach a base case.
shared-calculator-error-recursion-missing-base-case =
    { $count ->
        [one] The definition of function '{ $lastSymbol }' depends on itself. If '{ $lastSymbol }' is meant to be a recursive function, try adding a valid base case.
       *[other] The definitions of functions '{ $symbols }' and '{ $lastSymbol }' depend on each other. If they are meant to be mutually recursive functions, try adding a valid base case.
    }
shared-calculator-error-recursion-wrong-arity =
    { $count ->
        [one] Function '{ $fnSymbol }' requires 1 argument.
       *[other] Function '{ $fnSymbol }' requires { $count } arguments.
    }
shared-calculator-error-regression-recursion = Recursive functions may not be used inside regressions.
shared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.
shared-calculator-error-regressions-unsupported = This calculator does not support regressions.
shared-calculator-error-required-arguments-area = Function '{ $symbol }' requires a polygon.
shared-calculator-error-required-arguments-circle = Function 'circle' requires a center point and another point, segment, or radius value.
shared-calculator-error-required-arguments-coterminal = Function '{ $symbol }' requires an angle.
shared-calculator-error-required-arguments-dilate = Function '{ $symbol }' requires an object, then a point and a number.
shared-calculator-error-required-arguments-glider = Function 'glider' requires an object, then a number.
shared-calculator-error-required-arguments-intersection = Function 'intersection' requires 2 objects (lines, circles, or arcs).
shared-calculator-error-required-arguments-length = Function 'length' requires a segment.
shared-calculator-error-required-arguments-midpoint = Function 'midpoint' requires a segment or 2 points.
shared-calculator-error-required-arguments-perpendicular = Function '{ $symbol }' requires a line and a point.
shared-calculator-error-required-arguments-points = Function '{ $symbol }' requires { $count } points.
shared-calculator-error-required-arguments-polygon = Function 'polygon' requires several points.
shared-calculator-error-required-arguments-radius = Function '{ $symbol }' requires a circle or arc.
shared-calculator-error-required-arguments-reflect = Function 'reflect' requires an object, then a line, segment, ray, or vector.
shared-calculator-error-required-arguments-sphere = Function 'sphere' requires a center point and a radius value.
shared-calculator-error-required-arguments-start = Function '{ $symbol }' requires a vector.
shared-calculator-error-required-arguments-supplement = Function 'supplement' requires a directed angle.
shared-calculator-error-required-arguments-translate = Function 'translate' requires an object, then 2 points or a vector.
shared-calculator-error-required-arguments-triangle = Function 'triangle' requires three 3d points.
shared-calculator-error-required-arguments-vector = Function 'vector' requires a start point and end point.
shared-calculator-error-self-referential-base-case = A base case for recursive function '{ $symbol }' cannot depend on '{ $symbol }'.
shared-calculator-error-self-referential-functions =
    { $count ->
        [one] The definition of function '{ $lastSymbol }' depends on itself.
       *[other] The definitions of functions '{ $symbols }' and '{ $lastSymbol }' depend on each other.
    }
shared-calculator-error-shadowed-index = You can't use '{ $symbol }' as an index because it's already defined.
shared-calculator-error-shadowed-integration-variable = You can't use '{ $symbol }' as an integration variable because it's already defined.
shared-calculator-error-shadowed-list-comprehension-input = You can't define '{ $symbol }' more than once on the right-hand side of 'for'.
shared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.
shared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable '{ $symbol }'.
shared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.
shared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.
shared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.
shared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.
shared-calculator-error-substitution-ambiguous-comma = Ambiguous use of ',' and '{ $operation }'. Add parentheses around the '{ $operation }' expression.
shared-calculator-error-substitution-body-action = The left hand side of a 'with' substitution cannot be an action.
shared-calculator-error-substitution-body-regression-parameter-dependency = Can't use '{ $operator }' to substitute for the existing variable '{ $globalVariable }' because the expression on the left-hand side depends on '{ $regressionParameter }', which is a regression parameter.
shared-calculator-error-substitution-duplicate-assignment = A 'with' expression cannot make multiple substitutions for '{ $symbol }'.
shared-calculator-error-substitution-function-lhs = Substituting for '{ $symbol }' is not allowed because it is a function.
shared-calculator-error-substitution-illegal-lhs = Substituting for '{ $symbol }' is not allowed.
shared-calculator-error-substitution-invalid-assignments = 'with' must be followed by one or more variable definitions.
shared-calculator-error-substitution-local-lhs = Substituting for variable '{ $symbol }' is not allowed because it is locally defined.
shared-calculator-error-substitution-nested = Using one 'with' expression inside another 'with' expression is not allowed.
shared-calculator-error-substitution-recursive-call-lhs = Can't use '{ $operator }' to substitute for the existing variable '{ $globalVariable }' because the expression on the left-hand side depends on a recursive function call to '{ $fnSymbol }'.
shared-calculator-error-substitution-type-error = Cannot substitute { $actual } for { $expected }.
shared-calculator-error-substitution-unsupported-interval = Intervals are not allowed on the right-hand side of 'with'. You might want to try using 'for' instead.
shared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.
shared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.
shared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.
shared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.
shared-calculator-error-sum-missing-body = What do you want to take the sum of?
shared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.
shared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.
shared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.
shared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.
shared-calculator-error-table-equation-supplement = Equations are not allowed.
shared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.
shared-calculator-error-table-generic-supplement = This type of expression is not allowed.
shared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.
shared-calculator-error-table-inequality-supplement = Inequalities are not allowed.
shared-calculator-error-table-list-supplement = Lists are not allowed.
shared-calculator-error-table-regression-supplement = Regressions are not allowed.
shared-calculator-error-tdist-wrong-arity = 'tdist' requires 1 argument. For example, try typing: tdist(1).
shared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.
shared-calculator-error-token-with-subscript = Tokens may not have subscripts.
shared-calculator-error-too-many-arguments = '{ $symbol }' accepts at most { $max } arguments.
shared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining '{ $variables }' or '{ $lastVariable }'.
shared-calculator-error-too-many-variables-no-symbols = Too many variables, I don't know what to do with this.
shared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining '{ $variable }'.
shared-calculator-error-transformation-definition-expected-types-1 = Try using { $arg }.
shared-calculator-error-transformation-definition-expected-types-2 = Try using { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-1 = Try using just { $arg }.
shared-calculator-error-transformation-definition-expected-types-use-fewer-2 = Try using just { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-type-error-1 = A { $fn } cannot be defined using { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-2 = A { $fn } cannot be defined using { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-many = A '{ $fn }' cannot be defined with these arguments.
shared-calculator-error-transformation-definition-type-error-use-more-1 = A { $fn } cannot be defined using just { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-use-more-2 = A { $fn } cannot be defined using just { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-type-error-1 = Transformation '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-transformation-type-error-2 = Transformation '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-type-error-many = Transformation '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-ttest-list-too-short = Lists for '{ $symbol }' must have at least 2 elements.
shared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.
shared-calculator-error-unary-operator-missing-left = You need something before the '{ $symbol }' symbol.
shared-calculator-error-unary-operator-missing-right = You need something after the '{ $symbol }' symbol.
shared-calculator-error-unexpected-equality = Cannot use an equality here.
shared-calculator-error-unexpected-inequality = Cannot use an inequality here.
shared-calculator-error-unexpected-prime = Sorry, I don't understand this use of prime notation.
shared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.
shared-calculator-error-unexpected-symbol = Sorry, I don't understand the way that '{ $symbol }' is used here.
shared-calculator-error-unplottable-chained-equality = This calculator cannot plot chained equations.
shared-calculator-error-unplottable-long-inequality-chain = This calculator cannot plot chains of more than 2 inequalities.
shared-calculator-error-unplottable-polar-function = We can't plot \u03B8 as a function of r. Try plotting r(\u03B8) instead.
shared-calculator-error-unrecognized-symbol = Sorry, I don't understand the '{ $symbol }' symbol.
shared-calculator-error-update-rule-function-lhs = '{ $symbol }' cannot be updated because it is a function.
shared-calculator-error-update-rule-illegal-lhs = Variable '{ $symbol }' cannot be updated.
shared-calculator-error-update-rule-local-lhs = Variable '{ $symbol }' cannot be updated because it is locally defined.
shared-calculator-error-update-rule-non-identifier-lhs = The left hand side of '{ $arrow }' should be a variable name like '{ $example }'.
shared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.
shared-calculator-error-update-rule-undefined-lhs = Variable '{ $symbol }' must be defined to be updated.
shared-calculator-error-use-r-for-cylindrical-coordinates = Can't combine '\u03C1' and 'z'. Try 'r' for cylindrical coordinates.
shared-calculator-error-use-rho-for-spherical-coordinates = Can't combine 'r' and '\u03C6'. Try '\u03C1' (rho) for spherical coordinates.
shared-calculator-error-variable-as-function = Variable '{ $dependency }' can't be used as a function.
shared-calculator-error-variable-invalid-function-name = This calculator can not use '{ $symbol }' as a function name.
shared-calculator-error-variable-length-distribution-list = The length of a list of distributions can't depend on free variable '{ $symbol }'.
shared-calculator-error-variable-length-integral-depends-on-integration-var = Can't integrate a list whose length depends on integration variable '{ $symbol }'.
shared-calculator-error-variable-length-product-body-depends-on-index = Can't take the product of a list whose length depends on product index '{ $symbol }'.
shared-calculator-error-variable-length-sum-body-depends-on-index = Can't sum a list whose length depends on summation index '{ $symbol }'.
shared-calculator-error-variable-length-top-level-list = Can't plot a list whose length depends on free variable '{ $symbol }'.
shared-calculator-error-variable-seed = Random seed cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-unsupported = This calculator does not support the '{ $symbol }' variable.
shared-calculator-error-variables-unsupported = This calculator does not support variables like '{ $variable }'.
shared-calculator-error-write-integral = Type '{ $command }' for { $symbol }.
shared-calculator-error-wrong-arity-many-arg = Function '{ $dependency }' requires { $assignment_arity } arguments. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-few = Function '{ $dependency }' requires an argument. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-many = Function '{ $dependency }' requires only 1 argument. { $supplement }
shared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.
shared-calculator-error-wrong-two-arg-arity = Function '{ $symbol }' requires 2 arguments. For example, try typing: { $recommendation }.
shared-calculator-error-zero-arg-reducer = Function '{ $symbol }' requires at least one argument. For example, try typing: { $symbol }(1, 2).
shared-calculator-label-accessibility = Accessibility
shared-calculator-label-tooltip-convert-to-decimal = Convert to decimal.
shared-calculator-label-tooltip-convert-to-fraction = Convert to fraction.
shared-calculator-label-value-type-action = an action
shared-calculator-label-value-type-angle = an angle
shared-calculator-label-value-type-any = an unknown object
shared-calculator-label-value-type-arc = an arc
shared-calculator-label-value-type-bool = a true/false value
shared-calculator-label-value-type-circle = a circle
shared-calculator-label-value-type-color = a color
shared-calculator-label-value-type-complex = a complex number
shared-calculator-label-value-type-directed-angle = a directed angle
shared-calculator-label-value-type-distribution = a distribution
shared-calculator-label-value-type-empty-list = an empty list
shared-calculator-label-value-type-error = an error object
shared-calculator-label-value-type-lambda-complex = a parameterized complex number
shared-calculator-label-value-type-lambda-point = a parameterized point
shared-calculator-label-value-type-lambda-point3d = a parameterized 3d point
shared-calculator-label-value-type-line = a line
shared-calculator-label-value-type-list-of-2d-points = a list of 2d points
shared-calculator-label-value-type-list-of-3d-points = a list of 3d points
shared-calculator-label-value-type-list-of-angles = a list of angles
shared-calculator-label-value-type-list-of-any = a list of unknown objects
shared-calculator-label-value-type-list-of-arcs = a list of arcs
shared-calculator-label-value-type-list-of-bool = a list of true/false values
shared-calculator-label-value-type-list-of-circles = a list of circles
shared-calculator-label-value-type-list-of-colors = a list of colors
shared-calculator-label-value-type-list-of-complex = a list of complex numbers
shared-calculator-label-value-type-list-of-directed-angles = a list of directed angles
shared-calculator-label-value-type-list-of-distributions = a list of distributions
shared-calculator-label-value-type-list-of-lambda-complex = a list of parameterized complex numbers
shared-calculator-label-value-type-list-of-lambda-point = a list of parameterized points
shared-calculator-label-value-type-list-of-lambda-point3d = a list of parameterized 3d points
shared-calculator-label-value-type-list-of-lines = a list of lines
shared-calculator-label-value-type-list-of-numbers = a list of numbers
shared-calculator-label-value-type-list-of-points = a list of points
shared-calculator-label-value-type-list-of-polygons = a list of polygons
shared-calculator-label-value-type-list-of-rays = a list of rays
shared-calculator-label-value-type-list-of-restrictions = a list of restrictions
shared-calculator-label-value-type-list-of-segment3d = a list of 3d segments
shared-calculator-label-value-type-list-of-segments = a list of segments
shared-calculator-label-value-type-list-of-sphere3d = a list of 3d sphere
shared-calculator-label-value-type-list-of-tone = a list of tones
shared-calculator-label-value-type-list-of-transformations = a list of transformations
shared-calculator-label-value-type-list-of-triangle3d = a list of 3d triangles
shared-calculator-label-value-type-list-of-vector3d = a list of 3d vectors
shared-calculator-label-value-type-list-of-vectors = a list of vectors
shared-calculator-label-value-type-matrix = a matrix
shared-calculator-label-value-type-number = a number
shared-calculator-label-value-type-point = a point
shared-calculator-label-value-type-point2d = a 2d point
shared-calculator-label-value-type-point3d = a 3d point
shared-calculator-label-value-type-polygon = a polygon
shared-calculator-label-value-type-ray = a ray
shared-calculator-label-value-type-restriction = a restriction
shared-calculator-label-value-type-seed = a string
shared-calculator-label-value-type-segment = a segment
shared-calculator-label-value-type-segment3d = a 3d segment
shared-calculator-label-value-type-sphere3d = a 3d sphere
shared-calculator-label-value-type-tone = a tone
shared-calculator-label-value-type-transformation = a transformation
shared-calculator-label-value-type-triangle3d = a 3d triangle
shared-calculator-label-value-type-vector = a vector
shared-calculator-label-value-type-vector3d = a 3d vector
shared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal
shared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction
shared-calculator-narration-evaluation = equals { $answer }
shared-calculator-narration-expression = Expression
shared-calculator-narration-expression-list = Expression List
shared-calculator-narration-item-clickable = { $item } clickable
shared-calculator-narration-item-selected = { $item } selected
shared-calculator-narration-item-unknown = Unknown
shared-calculator-narration-item-unselected = { $item } unselected
shared-calculator-narration-keypad = keypad
shared-calculator-narration-keypad-controlbar = Control Bar
shared-calculator-narration-keypad-key-10-n = Times ten to the power of
shared-calculator-narration-keypad-key-abs = Absolute Value
shared-calculator-narration-keypad-key-action-to = Set Value To
shared-calculator-narration-keypad-key-action-with = Substitute With
shared-calculator-narration-keypad-key-alpha = Alpha
shared-calculator-narration-keypad-key-angle = Angle
shared-calculator-narration-keypad-key-angles = Angles
shared-calculator-narration-keypad-key-ans = Answer
shared-calculator-narration-keypad-key-arc = Arc
shared-calculator-narration-keypad-key-arccos = Inverse Cosine
shared-calculator-narration-keypad-key-arccot = Inverse Cotangent
shared-calculator-narration-keypad-key-arccsc = Inverse Cosecant
shared-calculator-narration-keypad-key-arcsec = Inverse Secant
shared-calculator-narration-keypad-key-arcsin = Inverse Sine
shared-calculator-narration-keypad-key-arctan = Inverse Tangent
shared-calculator-narration-keypad-key-area = Area
shared-calculator-narration-keypad-key-backspace = Backspace
shared-calculator-narration-keypad-key-beta = Beta
shared-calculator-narration-keypad-key-binomialdist = Binomial Distribution
shared-calculator-narration-keypad-key-boxplot = Box Plot
shared-calculator-narration-keypad-key-ceil = Ceiling
shared-calculator-narration-keypad-key-center = Center
shared-calculator-narration-keypad-key-circle = Circle
shared-calculator-narration-keypad-key-corr = Correlation
shared-calculator-narration-keypad-key-cos = Cosine
shared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine
shared-calculator-narration-keypad-key-cot = Cotangent
shared-calculator-narration-keypad-key-coterminal = Coterminal
shared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent
shared-calculator-narration-keypad-key-cov = Co Variance
shared-calculator-narration-keypad-key-covp = Population Co Variance
shared-calculator-narration-keypad-key-csc = Cosecant
shared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant
shared-calculator-narration-keypad-key-cubed = Cubed
shared-calculator-narration-keypad-key-decimal = Decimal
shared-calculator-narration-keypad-key-dilate = Dilate
shared-calculator-narration-keypad-key-directed-angle = Directed Angle
shared-calculator-narration-keypad-key-directed-angles = Directed Angles
shared-calculator-narration-keypad-key-distance = Distance
shared-calculator-narration-keypad-key-divide = Divide
shared-calculator-narration-keypad-key-dotplot = Dot Plot
shared-calculator-narration-keypad-key-enter = Enter
shared-calculator-narration-keypad-key-erf = Error Function
shared-calculator-narration-keypad-key-exp = Exponent
shared-calculator-narration-keypad-key-factorial = Factorial
shared-calculator-narration-keypad-key-floor = Floor
shared-calculator-narration-keypad-key-fraction = A over B
shared-calculator-narration-keypad-key-glider = Glider
shared-calculator-narration-keypad-key-histogram = Histogram
shared-calculator-narration-keypad-key-int = Integral
shared-calculator-narration-keypad-key-intersection = Intersection
shared-calculator-narration-keypad-key-inversecdf = Inverse CDF function
shared-calculator-narration-keypad-key-ittest = Independent T Test
shared-calculator-narration-keypad-key-left-arrow = Left Arrow
shared-calculator-narration-keypad-key-left-bracket = Left Bracket
shared-calculator-narration-keypad-key-left-paren = Left Parenthesis
shared-calculator-narration-keypad-key-line = Line
shared-calculator-narration-keypad-key-ln = Natural Log
shared-calculator-narration-keypad-key-log = Log
shared-calculator-narration-keypad-key-loga = Log A
shared-calculator-narration-keypad-key-mean = Mean
shared-calculator-narration-keypad-key-median = Median
shared-calculator-narration-keypad-key-midpoint = Midpoint
shared-calculator-narration-keypad-key-minus = Minus
shared-calculator-narration-keypad-key-normaldist = Normal Distribution
shared-calculator-narration-keypad-key-nthroot = Nth Root
shared-calculator-narration-keypad-key-parallel = Parallel
shared-calculator-narration-keypad-key-pdf = Probability Density Function
shared-calculator-narration-keypad-key-percent-of = Percent Of
shared-calculator-narration-keypad-key-perimeter = Perimeter
shared-calculator-narration-keypad-key-perpendicular = Perpendicular
shared-calculator-narration-keypad-key-phi = Phi
shared-calculator-narration-keypad-key-pi = Pi
shared-calculator-narration-keypad-key-plus = Plus
shared-calculator-narration-keypad-key-poissondist = Poisson Distribution
shared-calculator-narration-keypad-key-polygon = Polygon
shared-calculator-narration-keypad-key-prime = Function derivative
shared-calculator-narration-keypad-key-product = Product
shared-calculator-narration-keypad-key-quantile = Quantile
shared-calculator-narration-keypad-key-quartile = Quartile
shared-calculator-narration-keypad-key-radius = Radius
shared-calculator-narration-keypad-key-random = Random Number
shared-calculator-narration-keypad-key-ray = Ray
shared-calculator-narration-keypad-key-reciprocal = Reciprocal
shared-calculator-narration-keypad-key-reflect = Reflect
shared-calculator-narration-keypad-key-rho = Rho
shared-calculator-narration-keypad-key-right-arrow = Right Arrow
shared-calculator-narration-keypad-key-right-bracket = Right Bracket
shared-calculator-narration-keypad-key-right-paren = Right Parenthesis
shared-calculator-narration-keypad-key-rotate = Rotate
shared-calculator-narration-keypad-key-round = Round
shared-calculator-narration-keypad-key-sec = Secant
shared-calculator-narration-keypad-key-segment = Segment
shared-calculator-narration-keypad-key-segments = Segments
shared-calculator-narration-keypad-key-shift = Shift
shared-calculator-narration-keypad-key-sin = Sine
shared-calculator-narration-keypad-key-sinh = Hyperbolic Sine
shared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation
shared-calculator-narration-keypad-key-sphere = Sphere
shared-calculator-narration-keypad-key-sqrt = Square Root
shared-calculator-narration-keypad-key-squared = Squared
shared-calculator-narration-keypad-key-stats = Summary statistics
shared-calculator-narration-keypad-key-stdev = Standard Deviation
shared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population
shared-calculator-narration-keypad-key-subscript = Subscript
shared-calculator-narration-keypad-key-sum = Sum
shared-calculator-narration-keypad-key-superscript = Superscript
shared-calculator-narration-keypad-key-supplement = Supplement
shared-calculator-narration-keypad-key-tan = Tangent
shared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent
shared-calculator-narration-keypad-key-tau = Tau
shared-calculator-narration-keypad-key-tdist = Student-t Distribution
shared-calculator-narration-keypad-key-theta = Theta
shared-calculator-narration-keypad-key-times = Times
shared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace
shared-calculator-narration-keypad-key-toggle-letters = Toggle Letters
shared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers
shared-calculator-narration-keypad-key-tone = Tone
shared-calculator-narration-keypad-key-translate = Translate
shared-calculator-narration-keypad-key-triangle = Triangle
shared-calculator-narration-keypad-key-tscore = T Score
shared-calculator-narration-keypad-key-ttest = T Test
shared-calculator-narration-keypad-key-uniformdist = Uniform Distribution
shared-calculator-narration-keypad-key-vector = Vector
shared-calculator-narration-keypad-key-vertices = Vertices
shared-calculator-narration-keypad-key-ythroot = Yth Root
shared-calculator-narration-keypad-plus-minus = Plus-Minus
shared-calculator-narration-redo = redo
shared-calculator-narration-settings-display-size = Display Size
shared-calculator-narration-settings-display-size-default = Display size: default
shared-calculator-narration-settings-display-size-large = Display size: large
shared-calculator-narration-table-cell-coordinates = Row { $rowNumber } Column { $columnNumber }
shared-calculator-narration-undo = undo
shared-label-email = Email
shared-label-family-name = Last Name (optional)
shared-label-given-name-or-nickname = First Name or Nickname
shared-label-name = Name
shared-label-new-email-address = New Email Address
shared-label-password = Password
shared-message-account-reactivated = You previously requested to delete your account, but because you logged back in within 30 days, we will not delete your account. Welcome back!
shared-message-change-password-email-sent = We will send a link to your email address ({ $emailAddress }) so you can change your password.
shared-message-check-email-for-delete-link = Please check your email ({ $emailAddress }) for the link to delete your account.
shared-message-check-email-for-link = Please check { $emailAddress } for the Change Email link.
shared-message-check-email-for-password-link = Please check your email ({ $emailAddress }) for the link to change your password.
shared-message-check-email-for-password-recovery-link = Message sent. Please check your email for a password recovery link.
shared-message-consent-text = I agree to let Desmos store and maintain the information I provide (e.g. login credentials, saved work) in order to provide and improve its service. To withdraw consent, you may delete your account at any time.
shared-message-cookie-notice = <1>Note:</1> Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in. <2>Learn More.</2>
shared-message-delete-account-notice = When you delete your account, <1>we will retain your data for 30 days.</1> You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please <2>let us know.</2>
shared-message-delete-account-will-send-email = We will send you a link to your email address ({ $email }) so you can delete your account.
shared-message-email-sent = Email sent
shared-message-email-settings-will-send-email = We will send a Change Email link to { $emailAddress }.
shared-message-google-login-not-available = Google Login is not available on this device.
shared-message-information-saved = Saved!
shared-message-maintenance-starts-at = Saving, sharing, and signing in will be temporarily disabled on { $localizedStartDate } starting at approximately { $localizedStartTime }.
shared-message-maintenance-window = Saving, sharing, and signing in will be temporarily disabled on { $localizedStartDate } between approximately { $localizedStartTime } and { $localizedEndTime }.
shared-message-or-login-with-desmos = Or log in with Desmos
shared-message-please-review-name = We tried to split your name into first and last name. Please review your name below and edit any mistakes.
shared-message-privacy-notice = I have read, understand, and accept the <1>Terms of Service</1> and <2>Privacy Policy</2>.
shared-message-set-new-email-address = Set a new email address and password.
shared-prompt-already-have-account = Already have a Desmos account?
shared-prompt-enter-email-for-password-recovery-link = Enter your email address to get a password recovery link.
shared-prompt-forgot-your-password = Forgot your password?
shared-prompt-new-to-desmos-sign-up-here = New to Desmos? <1>Sign up</1>.
shared-prompt-new-to-desmos-teacher-or-student = New to Desmos? <1>Sign up!</1>
shared-prompt-please-consent-to-sign-up-with-apple = Please consent above to sign up with Apple
shared-prompt-please-consent-to-sign-up-with-google = Please consent above to sign up with Google
shared-prompt-sign-up-with-apple = Sign up with Apple
shared-prompt-sign-up-with-google = Sign up with Google
shared-title-account-reactivated = Your account has been reactivated.
shared-title-account-settings = Account Settings
shared-title-change-email-address = Change your Desmos email address
shared-title-change-password-narrow = Password
shared-title-change-password-wide = Change Password
shared-title-delete-account = Are you sure you want to delete your account?
shared-title-email-settings = Email
shared-title-language-menu = Language
shared-title-login = Log In
shared-title-profile-information-narrow = Profile
shared-title-profile-information-wide = Profile Information
shared-title-recover-password = Recover Password
shared-title-signup = Sign-Up
basic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.
basic-calculator-error-parentheses-unavailable = Parentheses are not available in this calculator.
basic-calculator-link-help = Help
basic-calculator-link-privacy-policy = Privacy Policy
basic-calculator-link-terms-of-service = Terms of Service
graphing-calculator-button-audio-trace-hear-graph = Hear Graph
graphing-calculator-button-audio-trace-stop-graph = Stop Graph
graphing-calculator-button-keypad-audio-trace-off = Audio Trace Off
graphing-calculator-link-learn-more = Learn more.
graphing-calculator-narration-audio-trace-property-x = X: { $x }.
graphing-calculator-narration-audio-trace-property-y = Y: { $y }.
graphing-calculator-narration-collapse = Collapse
graphing-calculator-narration-collapse-folder-index = Collapse Folder { $index }
graphing-calculator-narration-collapse-folder-title = Collapse { $folder } folder
graphing-calculator-narration-create-table = Create Table
graphing-calculator-narration-create-table-expression = Create Table from Expression { $index }
graphing-calculator-narration-create-table-secret-expression = Create Table from Secret Expression { $index }
graphing-calculator-narration-delete = Delete
graphing-calculator-narration-delete-expression = Delete Expression { $index }
graphing-calculator-narration-delete-folder-index = Delete Folder { $index }
graphing-calculator-narration-delete-folder-title = Delete { $folder } folder
graphing-calculator-narration-delete-image = Delete Image { $index }
graphing-calculator-narration-delete-secret-expression = Delete Secret Expression { $index }
graphing-calculator-narration-delete-table = Delete Table { $index }
graphing-calculator-narration-delete-text = Delete Note { $index }
graphing-calculator-narration-describe = Unknown object
graphing-calculator-narration-describe-expression = Expression { $index }
graphing-calculator-narration-describe-folder-index = Folder { $index }
graphing-calculator-narration-describe-folder-title = { $folder } folder
graphing-calculator-narration-describe-image = Image { $index }
graphing-calculator-narration-describe-secret-expression = Secret expression { $index }
graphing-calculator-narration-describe-table = Table { $index }
graphing-calculator-narration-describe-text = Note { $index }
graphing-calculator-narration-duplicate = Duplicate
graphing-calculator-narration-duplicate-expression = Duplicate Expression { $index }
graphing-calculator-narration-duplicate-folder-index = Duplicate Folder { $index }
graphing-calculator-narration-duplicate-folder-title = Duplicate { $folder } folder
graphing-calculator-narration-duplicate-image = Duplicate Image { $index }
graphing-calculator-narration-duplicate-secret-expression = Duplicate Secret Expression { $index }
graphing-calculator-narration-duplicate-table = Duplicate Table { $index }
graphing-calculator-narration-duplicate-text = Duplicate Note { $index }
graphing-calculator-narration-edit-folder-title = Edit Folder { $index } Title
graphing-calculator-narration-edit-image-title = Edit Image { $index } Title
graphing-calculator-narration-edit-text-title = Note { $index }
graphing-calculator-narration-edit-title = Edit Title
graphing-calculator-narration-expand = Expand
graphing-calculator-narration-expand-folder-index = Expand Folder { $index }
graphing-calculator-narration-expand-folder-title = Expand { $folder } folder
graphing-calculator-narration-geometry-angle-of-polygon = { $itemDescription } of { $parent }
graphing-calculator-narration-geometry-angle-through-points = { $itemDescription } through { $parent1 }, { $parent2 }, and { $parent3 }
graphing-calculator-narration-geometry-anglebisector-of-item = { $bisectorDescription }, bisector of { $item }
graphing-calculator-narration-geometry-arc-through-points = Arc { $index } starting at { $start }. Middle at { $middle }. End at { $end }.
graphing-calculator-narration-geometry-circle-with-center-and-radius = Circle { $index } with center at { $center } and radius { $radius }.
graphing-calculator-narration-geometry-construction-role-description = construction
graphing-calculator-narration-geometry-dilated-item = dilated { $item }
graphing-calculator-narration-geometry-edge-of-polygon = Edge { $polygonEdge } of { $item }
graphing-calculator-narration-geometry-glider-on-item = { $gliderDescription } on { $item }
graphing-calculator-narration-geometry-glider-with-assignment = Glider { $assignment }
graphing-calculator-narration-geometry-hidden-construction-description = Hidden { $description }
graphing-calculator-narration-geometry-hidden-line = Hidden line
graphing-calculator-narration-geometry-hidden-parallel = Hidden parrallel
graphing-calculator-narration-geometry-hidden-perpendicular = Hidden perpendicular
graphing-calculator-narration-geometry-hidden-ray = Hidden ray
graphing-calculator-narration-geometry-hidden-segment = Hidden segment
graphing-calculator-narration-geometry-hidden-vector = Hidden vector
graphing-calculator-narration-geometry-intersection-of-items = { $intersectionDescription } of { $item1 } and { $item2 }
graphing-calculator-narration-geometry-intersection-with-assignment = Intersection { $assignment }
graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates = { $itemDescription } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-labeled-angle = Angle { $label }
graphing-calculator-narration-geometry-labeled-directed-angle = Directed Angle { $label }
graphing-calculator-narration-geometry-list-of-angles = List of { $count } angles
graphing-calculator-narration-geometry-list-of-any = List of { $count } unknown objects
graphing-calculator-narration-geometry-list-of-arcs = List of { $count } arcs
graphing-calculator-narration-geometry-list-of-circles = List of { $count } circles
graphing-calculator-narration-geometry-list-of-directed-angles = List of { $count } directed angles
graphing-calculator-narration-geometry-list-of-lines = List of { $count } lines
graphing-calculator-narration-geometry-list-of-points = List of { $count } points
graphing-calculator-narration-geometry-list-of-polygons = List of { $count } polygons
graphing-calculator-narration-geometry-list-of-rays = List of { $count } rays
graphing-calculator-narration-geometry-list-of-segments = List of { $count } segments
graphing-calculator-narration-geometry-midpoint-of-item = { $midpointDescription } of { $item }
graphing-calculator-narration-geometry-midpoint-with-assignment = Midpoint { $assignment }
graphing-calculator-narration-geometry-nothing-selected = Nothing selected.
graphing-calculator-narration-geometry-parallel-to-line-through-point = Parallel line { $index } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-perpendicular-to-line-through-point = Perpedicular line { $index } to { $line }, passing through { $point }
graphing-calculator-narration-geometry-point-with-assignment = Point { $assignment }
graphing-calculator-narration-geometry-polygon-through-vertices = { $itemDescription } through vertices { $vertices }
graphing-calculator-narration-geometry-reflected-item = reflected { $item }
graphing-calculator-narration-geometry-rotated-item = rotated { $item }
graphing-calculator-narration-geometry-segment-length = { $segmentDescription } with length { $length }
graphing-calculator-narration-geometry-segment-with-assignment = Segment { $assignment }
graphing-calculator-narration-geometry-straight-from-item-to-item = { $straightType } from { $start } to { $end }
graphing-calculator-narration-geometry-straight-index-of-item = { $straightType } { $index } of { $item }
graphing-calculator-narration-geometry-transformed-item = transformed { $item }
graphing-calculator-narration-geometry-translated-item = translated { $item }
graphing-calculator-narration-geometry-unlabeled-angle = Angle { $index }
graphing-calculator-narration-geometry-unlabeled-angle-with-measurement = { $measurementText } Angle { $index }
graphing-calculator-narration-geometry-unlabeled-arc = Arc { $index }
graphing-calculator-narration-geometry-unlabeled-circle = Circle { $index }
graphing-calculator-narration-geometry-unlabeled-decagon = Decagon { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle = Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement = { $measurementText } Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-glider = Glider { $index }
graphing-calculator-narration-geometry-unlabeled-heptagon = Heptagon { $index }
graphing-calculator-narration-geometry-unlabeled-hexagon = Hexagon { $index }
graphing-calculator-narration-geometry-unlabeled-intersection = Intersection { $index }
graphing-calculator-narration-geometry-unlabeled-line = Line
graphing-calculator-narration-geometry-unlabeled-line-with-index = Line { $index }
graphing-calculator-narration-geometry-unlabeled-midpoint = Midpoint { $index }
graphing-calculator-narration-geometry-unlabeled-nonagon = Nonagon { $index }
graphing-calculator-narration-geometry-unlabeled-octagon = Octagon { $index }
graphing-calculator-narration-geometry-unlabeled-parallel = Parallel line
graphing-calculator-narration-geometry-unlabeled-parallel-with-index = Parallel line { $index }
graphing-calculator-narration-geometry-unlabeled-pentagon = Pentagon { $index }
graphing-calculator-narration-geometry-unlabeled-perpendicular = Perpendicular line
graphing-calculator-narration-geometry-unlabeled-perpendicular-with-index = Perpendicular line { $index }
graphing-calculator-narration-geometry-unlabeled-point = Point { $index }
graphing-calculator-narration-geometry-unlabeled-polygon = Polygon { $index } with { $sideCount } sides
graphing-calculator-narration-geometry-unlabeled-quadrilateral = Quadrilateral { $index }
graphing-calculator-narration-geometry-unlabeled-ray = Ray
graphing-calculator-narration-geometry-unlabeled-ray-with-index = Ray { $index }
graphing-calculator-narration-geometry-unlabeled-segment = Segment
graphing-calculator-narration-geometry-unlabeled-segment-with-index = Segment { $index }
graphing-calculator-narration-geometry-unlabeled-triangle = Triangle { $index }
graphing-calculator-narration-geometry-unlabeled-vector = Vector
graphing-calculator-narration-geometry-unlabeled-vector-with-index = Vector { $index }
graphing-calculator-narration-hide = Hide
graphing-calculator-narration-hide-expression = Hide Expression { $index }
graphing-calculator-narration-hide-folder-index = Hide Folder { $index }
graphing-calculator-narration-hide-folder-title = Hide { $folder } folder
graphing-calculator-narration-hide-image = Hide Image { $index }
graphing-calculator-narration-hide-options = Hide Options
graphing-calculator-narration-hide-options-expression = Hide Options for Expression { $index }
graphing-calculator-narration-hide-options-image = Hide Options for Image { $index }
graphing-calculator-narration-hide-options-secret-expression = Hide Options for Secret Expression { $index }
graphing-calculator-narration-hide-secret-expression = Hide Secret Expression { $index }
graphing-calculator-narration-hide-table = Hide Table { $index }
graphing-calculator-narration-hide-text = Hide Note { $index }
graphing-calculator-narration-item-at-coordinates = { $itemDescription } at { $x } { $y }
graphing-calculator-narration-item-with-list-index = index { $listIndex } of { $item }
graphing-calculator-narration-keypad-key-next-curve = Next Curve
graphing-calculator-narration-keypad-key-next-poi = Next Point of Interest
graphing-calculator-narration-keypad-key-next-point = Next Point
graphing-calculator-narration-keypad-key-previous-curve = Previous Curve
graphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest
graphing-calculator-narration-keypad-key-previous-point = Previous Point
graphing-calculator-narration-keypad-key-speed-down = Speed Down
graphing-calculator-narration-keypad-key-speed-up = Speed Up
graphing-calculator-narration-keypad-key-volume-down = Volume Down
graphing-calculator-narration-keypad-key-volume-up = Volume Up
graphing-calculator-narration-mute = Mute
graphing-calculator-narration-mute-expression = Mute Expression { $index }
graphing-calculator-narration-mute-secret-expression = Mute Secret Expression { $index }
graphing-calculator-narration-rename = Rename
graphing-calculator-narration-rename-expression = Rename in Expression { $index }
graphing-calculator-narration-rename-secret-expression = Rename in Secret Expression { $index }
graphing-calculator-narration-rename-table = Rename in Table { $index }
graphing-calculator-narration-show = Show
graphing-calculator-narration-show-expression = Show Expression { $index }
graphing-calculator-narration-show-folder-index = Show Folder { $index }
graphing-calculator-narration-show-folder-title = Show { $folder } folder
graphing-calculator-narration-show-image = Show Image { $index }
graphing-calculator-narration-show-options = Show Options
graphing-calculator-narration-show-options-expression = Show Options for Expression { $index }
graphing-calculator-narration-show-options-image = Show Options for Image { $index }
graphing-calculator-narration-show-options-secret-expression = Show Options for Secret Expression { $index }
graphing-calculator-narration-show-secret-expression = Show Secret Expression { $index }
graphing-calculator-narration-show-table = Show Table { $index }
graphing-calculator-narration-show-text = Show Note { $index }
graphing-calculator-narration-unmute = Unmute
graphing-calculator-narration-unmute-expression = Unmute Expression { $index }
graphing-calculator-narration-unmute-secret-expression = Unmute Secret Expression { $index }
graphing-calculator-narration-x-percentage-coordinate = { $x } percent from left.
graphing-calculator-narration-y-percentage-coordinate = { $y } percent from top.
matrix-calculator-button-new = New Matrix
matrix-calculator-button-settings = settings
matrix-calculator-heading-edit-matrix = Edit Matrix { $variable }
matrix-calculator-label-columns = Columns
matrix-calculator-label-rows = Rows
matrix-calculator-narration-add-column = Add Column
matrix-calculator-narration-add-row = Add Row
matrix-calculator-narration-evaluation = equals { $rowCount } by { $columnCount } matrix.
matrix-calculator-narration-evaluation-row = Row { $rowNumber }: { $values }.
matrix-calculator-narration-keypad-key-det = Determinant
matrix-calculator-narration-keypad-key-inverse = Inverse
matrix-calculator-narration-keypad-key-rref = Reduced row echelon form
matrix-calculator-narration-keypad-key-trace = Trace
matrix-calculator-narration-keypad-key-transpose = Transpose
matrix-calculator-narration-matrix-with-variable = Matrix { $variable }
matrix-calculator-narration-matrix-without-variable = Matrix
matrix-calculator-narration-new-dimensions = Matrix size: { $rows } by { $cols }
matrix-calculator-narration-remove-column = Remove Column
matrix-calculator-narration-remove-row = Remove Row
matrix-calculator-narration-resize-controls = Resize Matrix Controls
matrix-calculator-narration-settings-menu = Settings Menu
matrix-calculator-narration-title = Desmos Matrix Calculator
frontpage-button-account-menu = Account Menu
frontpage-error-something-went-wrong-try-again-later = Sorry! Something went wrong. Please try again later.
frontpage-label-partners-company-website = Company Website (Optional)
frontpage-label-partners-how-work-with-us = How would you like to work with us?
frontpage-label-partners-send = Send
frontpage-label-partners-sending = Sending...
frontpage-label-partners-your-email = Your Email
frontpage-label-partners-your-name = Your Name
frontpage-link-header-math-tools = Math Tools
frontpage-link-header-resources = Resources
frontpage-link-shared-3d-calculator = 3D Calculator
frontpage-link-shared-about-us = About Us
frontpage-link-shared-account-settings = Account Settings
frontpage-link-shared-assessments = Assessments
frontpage-link-shared-blog = Des-Blog
frontpage-link-shared-careers = Careers
frontpage-link-shared-equity-principles = Equity Principles
frontpage-link-shared-four-function-calculator = Four-Function Calculator
frontpage-link-shared-geometry-tool = Geometry Tool
frontpage-link-shared-graphing-calculator = Graphing Calculator
frontpage-link-shared-guiding-principles = Guiding Principles
frontpage-link-shared-help-center = Help Center
frontpage-link-shared-log-in = Log In
frontpage-link-shared-log-out = Log Out
frontpage-link-shared-matrix-calculator = Matrix Calculator
frontpage-link-shared-partnerships = Partnerships
frontpage-link-shared-scientific-calculator = Scientific Calculator
frontpage-link-shared-store = Desmos Store
frontpage-link-shared-test-practice = Test Practice
frontpage-narration-shared-desmos-logo = Desmos Logo
frontpage-text-header-app-links = Download our apps in the <1>Google Play Store</1> and <2>iOS App Store</2>.
frontpage-text-header-terms-update = We've updated our Terms of Service.
frontpage-text-header-terms-update-link = Read about the changes.
frontpage-text-partners-email-sent = Email Sent! We'll be in touch soon!
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































`;var $d=class{constructor(t){this.value=t}valueOf(){return this.value}},Zn=class extends $d{constructor(t="???"){super(t)}toString(t){return`{${this.value}}`}},Ls=class extends $d{constructor(t,r={}){super(t),this.opts=r}toString(t){try{return t.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(r){return t.reportError(r),this.value.toString(10)}}},Zl=class extends $d{constructor(t,r={}){super(t),this.opts=r}toString(t){try{return t.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(r){return t.reportError(r),new Date(this.value).toISOString()}}};var tF=100,PY="\u2068",SY="\u2069";function MY(e,t,r){if(r===t||r instanceof Ls&&t instanceof Ls&&r.value===t.value)return!0;if(t instanceof Ls&&typeof r=="string"){let n=e.memoizeIntlObject(Intl.PluralRules,t.opts).select(t.value);if(r===n)return!0}return!1}function rF(e,t,r){return t[r]?hm(e,t[r].value):(e.reportError(new RangeError("No default")),new Zn)}function xP(e,t){let r=[],n=Object.create(null);for(let i of t)i.type==="narg"?n[i.name]=fb(e,i.value):r.push(fb(e,i));return{positional:r,named:n}}function fb(e,t){switch(t.type){case"str":return t.value;case"num":return new Ls(t.value,{minimumFractionDigits:t.precision});case"var":return DY(e,t);case"mesg":return _Y(e,t);case"term":return AY(e,t);case"func":return OY(e,t);case"select":return LY(e,t);default:return new Zn}}function DY(e,{name:t}){let r;if(e.params)if(Object.prototype.hasOwnProperty.call(e.params,t))r=e.params[t];else return new Zn(`$${t}`);else if(e.args&&Object.prototype.hasOwnProperty.call(e.args,t))r=e.args[t];else return e.reportError(new ReferenceError(`Unknown variable: $${t}`)),new Zn(`$${t}`);if(r instanceof $d)return r;switch(typeof r){case"string":return r;case"number":return new Ls(r);case"object":if(r instanceof Date)return new Zl(r.getTime());default:return e.reportError(new TypeError(`Variable type not supported: $${t}, ${typeof r}`)),new Zn(`$${t}`)}}function _Y(e,{name:t,attr:r}){let n=e.bundle._messages.get(t);if(!n)return e.reportError(new ReferenceError(`Unknown message: ${t}`)),new Zn(t);if(r){let i=n.attributes[r];return i?hm(e,i):(e.reportError(new ReferenceError(`Unknown attribute: ${r}`)),new Zn(`${t}.${r}`))}return n.value?hm(e,n.value):(e.reportError(new ReferenceError(`No value: ${t}`)),new Zn(t))}function AY(e,{name:t,attr:r,args:n}){let i=`-${t}`,o=e.bundle._terms.get(i);if(!o)return e.reportError(new ReferenceError(`Unknown term: ${i}`)),new Zn(i);if(r){let s=o.attributes[r];if(s){e.params=xP(e,n).named;let c=hm(e,s);return e.params=null,c}return e.reportError(new ReferenceError(`Unknown attribute: ${r}`)),new Zn(`${i}.${r}`)}e.params=xP(e,n).named;let a=hm(e,o.value);return e.params=null,a}function OY(e,{name:t,args:r}){let n=e.bundle._functions[t];if(!n)return e.reportError(new ReferenceError(`Unknown function: ${t}()`)),new Zn(`${t}()`);if(typeof n!="function")return e.reportError(new TypeError(`Function ${t}() is not callable`)),new Zn(`${t}()`);try{let i=xP(e,r);return n(i.positional,i.named)}catch(i){return e.reportError(i),new Zn(`${t}()`)}}function LY(e,{selector:t,variants:r,star:n}){let i=fb(e,t);if(i instanceof Zn)return rF(e,r,n);for(let o of r){let a=fb(e,o.key);if(MY(e,i,a))return hm(e,o.value)}return rF(e,r,n)}function vP(e,t){if(e.dirty.has(t))return e.reportError(new RangeError("Cyclic reference")),new Zn;e.dirty.add(t);let r=[],n=e.bundle._useIsolating&&t.length>1;for(let i of t){if(typeof i=="string"){r.push(e.bundle._transform(i));continue}if(e.placeables++,e.placeables>tF)throw e.dirty.delete(t),new RangeError(`Too many placeables expanded: ${e.placeables}, max allowed is ${tF}`);n&&r.push(PY),r.push(fb(e,i).toString(e)),n&&r.push(SY)}return e.dirty.delete(t),r.join("")}function hm(e,t){return typeof t=="string"?e.bundle._transform(t):vP(e,t)}var WT=class{constructor(t,r,n){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=t,this.errors=r,this.args=n}reportError(t){if(!this.errors||!(t instanceof Error))throw t;this.errors.push(t)}memoizeIntlObject(t,r){let n=this.bundle._intls.get(t);n||(n={},this.bundle._intls.set(t,n));let i=JSON.stringify(r);return n[i]||(n[i]=new t(this.bundle.locales,r)),n[i]}};function XT(e,t){let r=Object.create(null);for(let[n,i]of Object.entries(e))t.includes(n)&&(r[n]=i.valueOf());return r}var nF=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function oF(e,t){let r=e[0];if(r instanceof Zn)return new Zn(`NUMBER(${r.valueOf()})`);if(r instanceof Ls)return new Ls(r.valueOf(),{...r.opts,...XT(t,nF)});if(r instanceof Zl)return new Ls(r.valueOf(),{...XT(t,nF)});throw new TypeError("Invalid argument to NUMBER")}var iF=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function aF(e,t){let r=e[0];if(r instanceof Zn)return new Zn(`DATETIME(${r.valueOf()})`);if(r instanceof Zl)return new Zl(r.valueOf(),{...r.opts,...XT(t,iF)});if(r instanceof Ls)return new Zl(r.valueOf(),{...XT(t,iF)});throw new TypeError("Invalid argument to DATETIME")}var sF=new Map;function cF(e){let t=Array.isArray(e)?e.join(" "):e,r=sF.get(t);return r===void 0&&(r=new Map,sF.set(t,r)),r}var mb=class{constructor(t,{functions:r,useIsolating:n=!0,transform:i=o=>o}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(t)?t:[t],this._functions={NUMBER:oF,DATETIME:aF,...r},this._useIsolating=n,this._transform=i,this._intls=cF(t)}hasMessage(t){return this._messages.has(t)}getMessage(t){return this._messages.get(t)}addResource(t,{allowOverrides:r=!1}={}){let n=[];for(let i=0;i<t.body.length;i++){let o=t.body[i];if(o.id.startsWith("-")){if(r===!1&&this._terms.has(o.id)){n.push(new Error(`Attempt to override an existing term: "${o.id}"`));continue}this._terms.set(o.id,o)}else{if(r===!1&&this._messages.has(o.id)){n.push(new Error(`Attempt to override an existing message: "${o.id}"`));continue}this._messages.set(o.id,o)}}return n}formatPattern(t,r=null,n=null){if(typeof t=="string")return this._transform(t);let i=new WT(this,n,r);try{return vP(i,t).toString(i)}catch(o){if(i.errors&&o instanceof Error)return i.errors.push(o),new Zn().toString(i);throw o}}};var TP=/^(-?[a-zA-Z][\w-]*) *= */gm,lF=/\.([a-zA-Z][\w-]*) *= */y,NY=/\*?\[/y,wP=/(-?[0-9]+(?:\.([0-9]+))?)/y,RY=/([a-zA-Z][\w-]*)/y,uF=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,kY=/^[A-Z][A-Z0-9_-]*$/,KT=/([^{}\n\r]+)/y,VY=/([^\\"\n\r]*)/y,dF=/\\([\\"])/y,pF=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,FY=/^\n+/,gF=/ +$/,GY=/ *\r?\n/g,BY=/( *)$/,qY=/{\s*/y,fF=/\s*}/y,zY=/\[\s*/y,UY=/\s*] */y,HY=/\s*\(\s*/y,$Y=/\s*->\s*/y,YY=/\s*:\s*/y,WY=/\s*,?\s*/y,XY=/\s+/y,ym=class{constructor(t){this.body=[],TP.lastIndex=0;let r=0;for(;;){let R=TP.exec(t);if(R===null)break;r=TP.lastIndex;try{this.body.push(c(R[1]))}catch(W){if(W instanceof SyntaxError)continue;throw W}}function n(R){return R.lastIndex=r,R.test(t)}function i(R,W){if(t[r]===R)return r++,!0;if(W)throw new W(`Expected ${R}`);return!1}function o(R,W){if(n(R))return r=R.lastIndex,!0;if(W)throw new W(`Expected ${R.toString()}`);return!1}function a(R){R.lastIndex=r;let W=R.exec(t);if(W===null)throw new SyntaxError(`Expected ${R.toString()}`);return r=R.lastIndex,W}function s(R){return a(R)[1]}function c(R){let W=u(),j=l();if(W===null&&Object.keys(j).length===0)throw new SyntaxError("Expected message value or attributes");return{id:R,value:W,attributes:j}}function l(){let R=Object.create(null);for(;n(lF);){let W=s(lF),j=u();if(j===null)throw new SyntaxError("Expected attribute value");R[W]=j}return R}function u(){let R;if(n(KT)&&(R=s(KT)),t[r]==="{"||t[r]==="}")return d(R?[R]:[],1/0);let W=O();return W?R?d([R,W],W.length):(W.value=_(W.value,FY),d([W],W.length)):R?_(R,gF):null}function d(R=[],W){for(;;){if(n(KT)){R.push(s(KT));continue}if(t[r]==="{"){R.push(f());continue}if(t[r]==="}")throw new SyntaxError("Unbalanced closing brace");let ee=O();if(ee){R.push(ee),W=Math.min(W,ee.length);continue}break}let j=R.length-1,Q=R[j];typeof Q=="string"&&(R[j]=_(Q,gF));let ce=[];for(let ee of R)ee instanceof jT&&(ee=ee.value.slice(0,ee.value.length-W)),ee&&ce.push(ee);return ce}function f(){o(qY,SyntaxError);let R=g();if(o(fF))return R;if(o($Y)){let W=b();return o(fF,SyntaxError),{type:"select",selector:R,...W}}throw new SyntaxError("Unclosed placeable")}function g(){if(t[r]==="{")return f();if(n(uF)){let[,R,W,j=null]=a(uF);if(R==="$")return{type:"var",name:W};if(o(HY)){let Q=y();if(R==="-")return{type:"term",name:W,attr:j,args:Q};if(kY.test(W))return{type:"func",name:W,args:Q};throw new SyntaxError("Function names must be all upper-case")}return R==="-"?{type:"term",name:W,attr:j,args:[]}:{type:"mesg",name:W,attr:j}}return E()}function y(){let R=[];for(;;){switch(t[r]){case")":return r++,R;case void 0:throw new SyntaxError("Unclosed argument list")}R.push(x()),o(WY)}}function x(){let R=g();return R.type!=="mesg"?R:o(YY)?{type:"narg",name:R.name,value:E()}:R}function b(){let R=[],W=0,j;for(;n(NY);){i("*")&&(j=W);let Q=w(),ce=u();if(ce===null)throw new SyntaxError("Expected variant value");R[W++]={key:Q,value:ce}}if(W===0)return null;if(j===void 0)throw new SyntaxError("Expected default variant");return{variants:R,star:j}}function w(){o(zY,SyntaxError);let R;return n(wP)?R=I():R={type:"str",value:s(RY)},o(UY,SyntaxError),R}function E(){if(n(wP))return I();if(t[r]==='"')return S();throw new SyntaxError("Invalid expression")}function I(){let[,R,W=""]=a(wP),j=W.length;return{type:"num",value:parseFloat(R),precision:j}}function S(){i('"',SyntaxError);let R="";for(;;){if(R+=s(VY),t[r]==="\\"){R+=D();continue}if(i('"'))return{type:"str",value:R};throw new SyntaxError("Unclosed string literal")}}function D(){if(n(dF))return s(dF);if(n(pF)){let[,R,W]=a(pF),j=parseInt(R||W,16);return j<=55295||57344<=j?String.fromCodePoint(j):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function O(){let R=r;switch(o(XY),t[r]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return A(t.slice(R,r))}return t[r-1]===" "?A(t.slice(R,r)):!1}function _(R,W){return R.replace(W,"")}function A(R){let W=R.replace(GY,`
`),j=BY.exec(R)[1].length;return new jT(W,j)}}},jT=class{constructor(t,r){this.value=t,this.length=r}};var jY=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],ZT=class e{constructor(t,r){this.bundles=t;this.onError=r}static fromSources(t,r,n){let i=[];for(let{lang:o,source:a}of t){let s=o.split("-")[0],c=new mb(o,{...n,useIsolating:jY.indexOf(s)>=0});c.addResource(new ym(a),{allowOverrides:!1}),c.addResource(new ym(`
l10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}
l10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}
l10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}
      `),{allowOverrides:!1}),i.push(c)}return new e(i,r)}format(t,r){for(let n of this.bundles){if(!n.hasMessage(t))continue;let i=n.getMessage(t);if(!(i!=null&&i.value))return;let o=[],a=n.formatPattern(i.value,this.coerceNumericVariables(r),o);for(let s of o)this.onError(`Error formatting ${t} for locale ${n.locales.join(",")}: ${s}`);return a}this.onError(`Couldn't find message for key ${t} for locales ${this.getLocales().join(",")}`)}formatDate(t,r){return r.showYear?this.format("l10n-internal-date-day-month-year",{d:t}):this.format("l10n-internal-date-day-month",{d:t})}formatTime(t){let r=this.format("l10n-internal-time",{d:t});return this.getLocales()[0]==="en"?r==null?void 0:r.toLowerCase():r}hasTranslation(t,r){for(let n of this.bundles)if(n.locales.indexOf(r)>=0)return n.hasMessage(t);return!1}coerceNumericVariables(t){let r={};for(let n in t){let i=t[n];YT(i)?r[n]=i.value:typeof i=="number"?r[n]=`${i}`:r[n]=i}return r}getLocales(){return this.bundles.reduce((t,r)=>t.concat(r.locales),[])}};var ZY={ar:!0,de:!0,en:!0,es:!0,et:!0,fr:!0,"fr-CA":!0,id:!0,it:!0,ja:!0,ko:!0,nl:!0,pl:!0,"pt-BR":!0,ru:!0,"sv-SE":!0,th:!0,tr:!0,vi:!0,"zh-CN":!0,"zh-TW":!0};function mF(e){return!!ZY[e]}var CP="",EP={},hF={},IP={},JY=["ar","hy-AM","hi","tr","xx-XX"];function JT(e){CP=e||""}function PP(e){for(let t in e)delete IP[t],hF[t]=e[t]}function SP(){for(let e in yl)mF(e)||delete yl[e]}function hb(e,t){let r=t!=null?t:CP;return bF(r).hasTranslation(e,r)}function vg(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e=e.split("__"+r+"__").join(t[r]));return e}function rn(e,t,r){return yF(e,t!=null?t:{},r!=null?r:CP)}function yb(e){return function(r,n){return yF(r,n!=null?n:{},e())}}function QY(e){let t={};for(let r in e){let n=e[r];n!==void 0&&(t[r]=n)}return t}function yF(e,t,r){let i=bF(r).format(e,QY(t));return i==null?(Ki.warn(`Could not format string ${e}`),""):i}function bF(e){let t=IP[e];if(!t){EP[e]||(EP[e]=pb([e]));let r=[];for(let i of EP[e]){let o=hF[i];o&&r.push({lang:i,source:o})}let n={};e==="xx-XX"&&(n.transform=i=>i.replace(/[a-z]/gi,"\u2666")),t=IP[e]=ZT.fromSources([...r,{lang:"en",source:eF}],i=>{Ki.warn(i)},n)}return t}function MP(e){return yl.hasOwnProperty(e)||Uu(JY,e)}function bb(e,t){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number")return""+e;let r=e.vars,n;if(r){n={};for(let i in r){if(!r.hasOwnProperty(i))continue;let o=r[i];YT(o)?n[i]=o:n[i]=bb(o,t)}}return rn(e.key,n,t)}var bm=typeof desmosLocaleData=="object"?desmosLocaleData:{};function xb(){for(var e=pb([lb("language"),navigator.userLanguage,navigator.language]),t=0;t<e.length;t++){var r=e[t];if(MP(r))return r}return"en"}async function QT(e){if(bm[e]||e==="en"||e==="xx-XX")return JT(e),!0;if(!MP(e)){let t=e.indexOf("-")!==-1?e.split("-")[0]:e;for(let r in yl)if(t===r.split("-")[0]&&yl[r].useAsRoot){e=r;break}}try{let t=await mg(`/api/v1/calculator/language/${e}.ftl`);return bm[e]=t[e],PP(bm),JT(e),!0}catch(t){throw t.status===404&&Ki.warn(e+" is not an available language."),t}}function xF(e){if(bm[e])return!0;let t=pb([e]);for(let r of t)if(bm[r])return!0;return!1}PP(bm);JT(xb());function e6(e){var r;let t=(r=e==null?void 0:e.responseJSON)==null?void 0:r.errors;return Array.isArray(t)?t:void 0}function vF(e,t,r){let n=e6(e);return n===void 0?[r!=null?r:t("account-shell-error-unexpected-server",{email:"support@desmos.com"})]:n.map(({key:i,message:o})=>i==="connection_failed"?t("account-shell-error-connection-failed"):o)}zd();AT();var vb=class{constructor(t){this._queuedCallbacks=[];this.s=yb(()=>this.language);this.dispatch=t=>{cT("dispatch::frontpage-controller",{type:t.type}),this.dispatcher.dispatch(t);let r;for(;r=this._queuedCallbacks.shift();)r()};tV(),this.modal="none",this.dispatcher=new $T,this.language=xb(),this.setupUserController(),this.displayUpcomingMaintenanceNotice=!!t.displayUpcomingMaintenanceNotice,this.showLanguagePicker=t.showLanguagePicker,this.limitSignupRole=t.limitSignupRole,t.allowAllLanguages||SP(),this.dispatcher.register(r=>{if(this.enqueueEvent("render"),r.type!=="render")switch(r.type){case"close-modal":this.modal="none",this.modalDevice=void 0;break;case"show-modal":this.modal=r.modal,this.modalDevice=r.device,this.modalLocation=r.location,r.modal==="login"?this.logEvent({category:"accounts",action:"open-login-modal"}):r.modal==="signup"&&this.logEvent({category:"accounts",action:"open-signup-modal"});break;case"set-language":this.language=r.language,this.updateUrlForLang(this.language),this.enqueueEvent("changeLang");break;default:return r}})}raw(t,r){return vg(t,r)}hasTranslation(t){return hb(t,this.language)}runAfterDispatch(t){this._queuedCallbacks.push(t)}logEvent(t){eV(t)}enqueueEvent(t){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(t)})}getShowLanguagePicker(){return this.showLanguagePicker}shouldShowUpcomingMaintenanceNotice(){return this.displayUpcomingMaintenanceNotice}getLimitedSignupRole(){return this.limitSignupRole}setupUserController(){this.userController=new HT,this.userController.askServerIfLoggedIn(),rV(!0),this.userController.observeEvent("triggerRender",()=>{this.dispatch({type:"render"})}),PV(this.userController,this.s.bind(this))}updateUrlForLang(t){if(!(window.history&&history.replaceState))return;let{origin:r,pathname:n,search:i,hash:o}=location,a=_T(i,"lang",t),s=`${r}${n}${a}${o}`;history.replaceState(null,"",s)}getLanguage(){return this.language}getModal(){return this.modal}getModalLocation(){return this.modalLocation}wasModalOpenedWithKeyboard(){return this.modalDevice==="keyboard"}getModalStartingError(){return""}allowSignInWithApple(){return!0}parseJSONErrors(t){return vF(t,this.s)}getDispatcher(){return this.dispatcher}shouldShowTopBanner(){return!1}getArtContestStatus(){let t="promoted",r=fg("contest");return r==="open"||r==="closed"||r==="inactive"?r:t}};var ma=ut(ft());var fe=ut(ft());var t0=ut(ft());var e0=class extends t0.Class{template(){return t0.createElement("span",{onMount:this.bindFn(this.addSVGLogo)})}addSVGLogo(t){t.innerHTML=`
    <svg version="1.1" class="dcg-desmos-svg-logo" id="svg-desmos" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 909.3 188.4" xml:space="preserve">
    <title>${rn("frontpage-narration-shared-desmos-logo")}</title>
    <g>
      <path d="M129.6,0c-6.8,0-12.4,5.5-12.4,12.4v48c-27.7-25.4-70.6-24-96.7,3.1c-27.4,28.4-27.4,73.4,0,101.8
        c26.1,27.1,69.1,28.4,96.8,3v8.8c2,6.5,9,10.2,15.5,8.2c3.9-1.2,7-4.3,8.2-8.2V12.4C141.1,5.9,136.1,0.5,129.6,0z M103.9,148.7
        c-17.3,18.2-46.1,18.9-64.3,1.6c-0.6-0.5-1.1-1.1-1.6-1.6c-18.4-19.2-18.4-49.5,0-68.7c17.3-18.2,46.1-18.9,64.3-1.6
        c0.6,0.5,1.1,1.1,1.6,1.6C122.3,99.3,122.3,129.6,103.9,148.7z"/>
      <path d="M298.3,124c2.2-2.3,3.4-5.3,3.5-8.4c-0.1-19-7.6-37.2-20.9-50.7c-26.6-27.6-70.6-28.4-98.2-1.8c-0.6,0.6-1.2,1.2-1.8,1.8
        c-27.4,28.4-27.4,73.4,0,101.8c21.8,22.6,56.2,27.7,83.7,12.4c10-5.6,18.5-13.5,24.8-23.1c3.4-5.5,1.9-12.7-3.3-16.5
        c-5.5-3.3-12.6-1.7-16.4,3.5c-4.2,6.4-9.9,11.6-16.6,15.4c-6.8,3.8-14.4,5.8-22.2,5.8c-12.5,0-24.4-5.1-33.1-14.1
        c-6-6.3-10.3-14-12.4-22.4h104C292.7,127.6,296,126.3,298.3,124z M231.3,67.2c12.4,0.1,24.3,5.2,33,14.1
        c6.1,6.3,10.4,14.1,12.4,22.6h-90.7c2.1-8.5,6.3-16.3,12.4-22.6C207,72.4,218.8,67.3,231.3,67.2z"/>
      <path d="M763.5,63c-26.7-28.1-71.1-29.2-99.2-2.5c-0.8,0.8-1.7,1.6-2.5,2.5c-13.7,13.9-21.3,32.7-20.9,52.2
        c-0.2,19.3,7.2,37.8,20.7,51.6c27.7,28.2,73.1,28.7,101.3,0.9c0.3-0.3,0.6-0.6,0.9-0.9c13.4-13.8,20.9-32.4,20.7-51.7
        c0.2-19.4-7.3-38.2-21.1-51.9 M712.8,66.7c12.4,0,24.2,5.2,32.5,14.4c8.9,9.2,13.8,21.5,13.6,34.3c0.2,12.7-4.6,25-13.5,34.1
        c-8.5,9.2-20.5,14.2-33,13.9c-12.3,0.3-24.2-4.7-32.5-13.8c-8.8-9.1-13.6-21.4-13.3-34.1c-0.3-12.9,4.7-25.4,13.8-34.6
        c8.2-9.3,20-14.6,32.4-14.4"/>
      <path d="M623.8,92.6v81.9c0.3,6.8-4.9,12.7-11.8,13c-6.8,0.3-12.7-4.9-13-11.8V93.1c0-7.5-3-14.6-8.3-19.8
        c-4.3-4.7-10.2-7.6-16.5-8.1h-1.9c-7-0.1-13.6,2.9-18.2,8.2c-4.8,4.9-7.5,11.5-7.7,18.3v2l0,0v81.1c0,6.8-5.5,12.4-12.4,12.4
        c-6.5,0-11.9-4.9-12.4-11.4V91.5c-0.6-4.3-1.8-8.4-3.5-12.4c-1.2-2.3-2.6-4.5-4.3-6.4c-4.7-5.2-11.3-8.3-18.3-8.3
        c-7,0-13.6,3-18.1,8.3c-5.1,5.2-8,12.3-7.9,19.6V176c-0.8,6.3-6.1,11-12.4,10.9c-6.8,0-12.4-5.5-12.4-12.4V52.9
        c-0.7-6.8,4.2-12.9,11-13.6c5.9-0.6,11.4,3,13.1,8.7l2.9-1.9c7.4-3.9,15.6-6,23.9-5.9c12.3-0.1,24.1,4.3,33.3,12.4
        c1.1,0.9,2.1,2,3,3.1c0.9,0.7,1.7,1.5,2.5,2.4l2.2-2.4c0.9-1.1,1.9-2.2,3-3.1c9.2-8.1,21-12.5,33.2-12.4h4.3
        c10.8,0.8,21,5.1,29,12.4c0.9,1,2,1.9,3,2.9C618.9,65.3,624,78.7,623.8,92.6"/>
      <path d="M427.2,145.4c0.1,23.4-18.6,42.5-42,43h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4H384c10-0.2,17.9-8.4,17.8-18.3
        c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4c1.2-22,18.8-39.6,40.8-40.8h50.2
        c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.1c-10,0.8-17.5,9.6-16.7,19.7c0.7,8.9,7.8,15.9,16.7,16.7H385
        c5.9,0,11.8,1.2,17.2,3.7C417.7,112.8,427.2,128.4,427.2,145.4"/>
      <path d="M908.9,145.2c0,23.4-18.3,42.7-41.6,43.3h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4h50.2
        c10-0.2,17.9-8.4,17.8-18.3c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4
        c1.2-22,18.8-39.6,40.8-40.8h49.6c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.6c-10.1,0-18.2,8.2-18.2,18.2c0,0,0,0,0,0
        c0,9.9,8,18,17.8,18.1h24.8c5.9,0,11.8,1.3,17.2,3.7C898.9,112.8,908.9,128.2,908.9,145.2"/>
    </g>
    </svg>
    `}};var Ns=ut(ft()),r0=ut(AF());var _P=/\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/;function OF(e,t){let r=0,n=0,i={},o={},a=s(e);if(!/^<0>/.test(a)||!/<\/0>$/.test(a))throw new Error("Expected template string to start and end with <0> and </0>, but found "+JSON.stringify(a));return a.slice(3,-4).trim();function s(l){if(t.isConst(l))return c6(t.getConstValue(l));if(t.isNamedBinding(l)){let u=c(i,t.getBindingName(l)),d=`{$${u}}`;if(!_P.test(d))throw new Error(`Invalid <Localize> variable: ${d}.`);return t.addBinding&&t.addBinding(u,l),i[u]=!0,d}else if(l!==e&&t.isView(l)){let u=c(o,t.getViewName(l));if(!/[a-zA-Z0-9\-_]/.test(u))throw new Error(`Invalid <Localize> subview identifier: ${u}.`);return t.addView&&t.addView(u,l),o[u]=!0,`<${u}/>`}else if(t.isBinding(l)){let u=c(i,`v${r++}`),d=`{$${u}}`;return t.addBinding&&t.addBinding(u,l),i[u]=!0,d}else{let u=`${n++}`;t.addElement&&t.addElement(u,l);let d=[];return t.forEachChild(l,f=>{d.push(s(f))}),o[u]=!0,d.length>0?`<${u}>${d.join("")}</${u}>`:`<${u}/>`}}function c(l,u){let d=0,f=u;for(;l[f];)f=`${u}-${++d}`;return f}}var s6=!0;function c6(e){return s6?e:e.replace(/\{|\}/g,t=>`{"${t}"}`).replace(/(^|[\s\n]+)(\[|\]|\.)/g,(t,r,n)=>`${r}{"${n}"}`)}function l6(e){return e.__DCGViewLocalizeBindingName}function u6(e){return typeof e=="function"&&e.__DCGViewLocalizeViewName}var ac=class extends Ns.Class{init(){this.viewMap={},this.elementMap={},this.bindingMap={},this.i18n=this.props.i18n(),this.templateString=this.serializeToTemplateString(Ns.createElement("div",null,this.props.children))}template(){return Ns.createElement(Ns.Components.If,{predicate:()=>this.shouldShow()},()=>Ns.createElement(Ns.Components.Switch,{key:()=>AP(this.translatedString())},t=>this.renderDeserializedTemplateNode(this.parseAndValidate(t))))}shouldShow(){let t=this.props.options&&this.props.options();return t&&t.hideUntranslatedView&&this.i18n.hasTranslation?this.i18n.hasTranslation(this.props.key()):!0}translatedString(){let t={};for(let r in this.bindingMap)t[r]=vg(`{$${r}}`);return this.i18n.s(this.props.key(),t)}static variable(t,r){let n=()=>r();return n.__DCGViewLocalizeBindingName=t,n}static subview(t,r){let n=()=>r();return n.__DCGViewLocalizeViewName=t,n}parseAndValidate(t){let r=(0,r0.parse)(t),n={},i={};o(r);for(let a in this.elementMap)if(!i[a])return(0,r0.parse)(AP(this.templateString));for(let a in this.bindingMap)if(!n[a])return(0,r0.parse)(AP(this.templateString));return r;function o(a){if(Array.isArray(a)){for(let s of a)o(s);return}a.name==="token"?n[a.attrs.id]=!0:a.type!=="text"&&(i[a.name]=!0,o(a.children))}}renderDeserializedTemplateNode(t){if(Array.isArray(t))return t.map(r=>this.renderDeserializedTemplateNode(r));if(t.type==="text")return Ns.const(t.content||"");if(t.name==="token"){let r=this.bindingMap[t.attrs.id];return r||(()=>"")}else if(this.elementMap[t.name]){let r=this.elementMap[t.name],n=t.children.map(i=>this.renderDeserializedTemplateNode(i));return NF(r.type,r.attributes,n)}else return this.viewMap[t.name]?this.viewMap[t.name]():NF("span",{},[])}serializeToTemplateString(t){return OF(t,{isView:u6,isConst:LF,isBinding:r=>typeof r=="function",isNamedBinding:l6,getConstValue:r=>r(),getBindingName:r=>r.__DCGViewLocalizeBindingName,getViewName:r=>r.__DCGViewLocalizeViewName,addBinding:(r,n)=>{this.bindingMap[r]=n},addElement:(r,n)=>{this.elementMap[r]={type:n.tagName,attributes:n.attributes}},addView:(r,n)=>{if(this.viewMap[r])throw new Error(`Unexpected duplicate view ${r}.`);this.viewMap[r]=n},forEachChild:(r,n)=>{for(let i of r.children){if(!LF(i)&&typeof i!="function"&&i instanceof Ns.View)throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().");n(i)}}})}};function LF(e){return typeof e=="function"&&e.isDCGViewConst}function NF(e,t,r){return Ns.createElement(e,t,r)}function AP(e){return`<0>${e}</0>`.replace(new RegExp(_P.source,"g"),(r,n)=>`<token id="${n}"/>`)}var Oi=ut(ft());fa();zd();var ale=navigator.userAgent.match(/MSIE 8.0/i)!==null,sle=navigator.userAgent.match(/MSIE 9.0/i)!==null,cle=navigator.userAgent.match(/MSIE/i)!==null||navigator.userAgent.match(/Trident/i)!==null&&navigator.userAgent.match(/rv:11/i)!==null,lle=navigator.userAgent.match(/Edge/i)!==null,d6=navigator.userAgent.match(/iPad/i)!==null,ule=navigator.userAgent.match(/Mobile|Android/i)!==null||zu("forceMobile"),Tb=navigator.userAgent.match(/Android/i)!==null,Tg=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)!==null||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,dle=navigator.userAgent.match(/Chrome/i)!==null,OP=navigator.userAgent.match(/Firefox/i)!==null,ple=navigator.userAgent.match(/^((?!chrome|android).)*safari/i)!==null,LP=navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)!==null,kF=navigator.platform.match(/(Win32)/i)!==null,VF=navigator.userAgent.match(/Touch/i)!==null,gle=navigator.userAgent.match(/Kindle/i)!==null||navigator.userAgent.match(/Silk/i)!==null,fle=navigator.userAgent.match(/KeyWeb/i)!==null,mle=window.parent!==window;var FF=Tg||Tb||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)||zu("forceTouchDevice"),xl=FF,n0=(()=>{let e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||"0",10)]:null})(),hle=(()=>{let e=navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||"0",10)]:null})(),yle=(()=>{let e=navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/);return e?[parseInt(e[2],10),parseInt(e[3],10),parseInt(e[4]||"0",10)]:null})(),i0=!(!("inputMode"in document.createElement("textarea"))||Tg&&n0&&n0[0]<15),ble=(()=>{let e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))})(),xle=window.matchMedia("(prefers-reduced-motion: reduce)").matches||document.location.search.indexOf("prefersReducedMotion")>=0,GF=()=>document.createElement("video"),vle=(()=>{let e=GF();return e.canPlayType&&!!e.canPlayType('video/webm; codecs="vp8, vorbis"')})(),Tle=(async()=>{if(fg("autoplay")!==void 0)return zu("autoplay");let e=GF();e.src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAu1tZGF0AAACrQYF//+p3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE1NSByMjkwMSA3ZDBmZjIyIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxOCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTMgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTEgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD00MCByYz1jcmYgbWJ0cmVlPTEgY3JmPTI4LjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IGlwX3JhdGlvPTEuNDAgYXE9MToxLjAwAIAAAAAwZYiEAD//8m+P5OXfBeLGOfKE3xkODvFZuBflHv/+VwJIta6cbpIo4ABLoKBaYTkTAAAC7m1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAPoAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIYdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAPoAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAACgAAAAWgAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAD6AAAAAAAAQAAAAABkG1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAQAAAAEAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAATttaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAD7c3RibAAAAJdzdHNkAAAAAAAAAAEAAACHYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAACgAFoASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADFhdmNDAWQACv/hABhnZAAKrNlCjfkhAAADAAEAAAMAAg8SJZYBAAZo6+JLIsAAAAAYc3R0cwAAAAAAAAABAAAAAQAAQAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAC5QAAAAEAAAAUc3RjbwAAAAAAAAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTguMTIuMTAw",e.muted=!0,e.playsInline=!0,e.style.display="none";let t=await new Promise(r=>{document.readyState!=="loading"?r(document.body):document.addEventListener("DOMContentLoaded",()=>r(document.body))});t.appendChild(e);try{await e.play()}catch(r){return!1}finally{t.removeChild(e)}return!0})(),RF,wle=(RF=window.matchMedia("(forced-colors: active)"))==null?void 0:RF.matches;var YF=e=>!e.altKey&&!e.shiftKey&&(e.ctrlKey||e.metaKey)&&(e.key=="z"||e.which==90),WF=e=>!e.altKey&&(e.ctrlKey||e.metaKey)&&(e.key==="y"||e.which==89||e.shiftKey&&(e.key==="Z"||e.key==="z"||e.which===90));var NP="Backspace",wb="Tab",XF="Enter",KF="Shift",jF="Control",ZF="Alt",JF="Meta",QF="CapsLock",Yu="Esc",eG="Space",tG="PageUp",rG="PageDown",RP="End",p6="Home",o0="Left",a0="Up",s0="Right",c0="Down",g6="Del",BF={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",46:"Del",91:"Meta",93:"Meta"},qF={Backspace:NP,Tab:wb,Enter:XF,Shift:KF,Control:jF,Alt:ZF,Meta:JF,CapsLock:QF,Escape:Yu," ":eG,PageUp:tG,PageDown:rG,End:RP,Home:p6,ArrowLeft:o0,ArrowUp:a0,ArrowRight:s0,ArrowDown:c0,Delete:g6},l0=e=>{let t=[KF,ZF,jF,QF,JF];return!!e.key&&t.includes(e.key)},Eb=e=>Ai(e)===XF||Ai(e)===eG,zF={UIKeyInputUpArrow:a0,UIKeyInputDownArrow:c0,UIKeyInputLeftArrow:o0,UIKeyInputRightArrow:s0,UIKeyInputEscape:Yu,UIKeyInputPageUp:tG,UIKeyInputPageDown:rG},kP=["0123456789abcdefghijklmnopqrstuvwxyz","\xBA\xA1\u2122\xA3\xA2\u221E\xA7\xB6\u2022\xAA\xE5\u222B\xE7\u2202 \u0192\xA9\u02D9 \u2206\u02DA\xAC\xB5 \xF8\u03C0\u0153\xAE\xDF\u2020 \u221A\u2211\u2248\xA5\u03A9","\u201A\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB0\xB7\xC5\u0131\xC7\xCE\xB4\xCF\u02DD\xD3\u02C6\xD4\uF8FF\xD2\xC2\u02DC\xD8\u220F\u0152\u2030\xCD\u02C7\xA8\u25CA\u201E\u02DB\xC1\xB8"].map(function(e){return e.split("")}),UF=kP[0],HF=kP[1],$F=kP[2],f6={},m6={};for(let e=0;e<UF.length;e++){let t=UF[e];HF[e]!==" "&&(f6[HF[e]]=t.toUpperCase()),$F[e]!==" "&&(m6[$F[e]]=t.toUpperCase())}var Ai=e=>{if(e.key&&qF[e.key])return qF[e.key];if(e.which&&BF[e.which])return BF[e.which];if(e.key&&zF[e.key])return zF[e.key]};var VP=function(e){if(!e)return;let t=e.getBoundingClientRect();return{top:t.top+window.scrollY,left:t.left+window.scrollX}},Xu=function(e,t){Object.assign(e.style,t)};function u0(e){return!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length))}function nG(e){if(document.readyState!=="loading")e();else{var t=function(){document.removeEventListener("DOMContentLoaded",t),e()};document.addEventListener("DOMContentLoaded",t)}}var h6='a, input, button:not([disabled]), textarea, select [role="textbox"], [tabIndex="0"], [role="option"], [role="button"], [role="link"], summary',d0=class{constructor({isOpen:t,closeMenu:r,anchorSelector:n,popoverSelector:i,itemNavigationKey:o}){this.handleKeydown=t=>{switch(this.itemNavigationKey){case"arrow":return this.onKeydownWithArrowTrapping(t);case"tab":return this.onKeydownWithTabTrapping(t)}};this.handleTap=t=>{let r=document.querySelector(this.popoverSelector);if(!r)return;let{target:n}=t,i=this.anchorSelector;i&&n.closest(i)||r.contains(n)||Array.from(document.querySelectorAll(".dcg-keypad,.dcg-show-keypad-container")).some(a=>a.contains(n))||this.closeMenu()};this.isOpen=t,this.closeMenu=r,this.anchorSelector=n,this.popoverSelector=i,this.itemNavigationKey=o}getFocusableItems(){let t=document.querySelector(this.popoverSelector);return t?Array.from(t.querySelectorAll(h6)).filter(n=>n.getAttribute("tabIndex")!=="-1").filter(n=>u0(n)):[]}focusAnchor(){var t;(t=document.querySelector(this.anchorSelector))==null||t.focus()}focusItemAtIdx(t){let r=this.getFocusableItems();return r.length&&r.length>t?(r[t].focus(),!0):!1}focusFirstItem(){this.focusItemAtIdx(0)}focusLastItem(){this.focusItemAtIdx(this.getFocusableItems().length-1)}getFocusedElement(){return this.getFocusableItems().find(t=>t.matches(":focus"))}moveFocusInDirection(t){let r=this.getFocusableItems(),n=r.findIndex(a=>a.matches(":focus"));if(n===-1)return!1;let i=n+t;if(i==-1||i==r.length)return!0;let o=r[i];return o?(o.focus(),!0):!1}isAnchorFocused(){var t;return(t=document.querySelector(this.anchorSelector))==null?void 0:t.matches(":focus")}isFirstItemFocused(){var r;let t=this.getFocusableItems();return t.length>0&&((r=t[0])==null?void 0:r.matches(":focus"))}isLastItemFocused(){var r;let t=this.getFocusableItems();return t.length>0&&((r=t[t.length-1])==null?void 0:r.matches(":focus"))}onKeydownWithArrowTrapping(t){if(this.isOpen())switch(Ai(t)){case a0:this.moveFocusInDirection(-1)&&t.preventDefault();break;case c0:this.moveFocusInDirection(1)&&t.preventDefault();break;case RP:t.preventDefault(),this.focusLastItem();break;case wb:t.preventDefault(),this.closeMenu();break;case Yu:t.preventDefault(),t.stopPropagation(),this.closeMenu();break}}onKeydownWithTabTrapping(t){if(!this.isOpen())return;let r=Ai(t);if(r===Yu){t.preventDefault(),t.stopPropagation(),this.focusAnchor(),this.closeMenu();return}if(r==="Tab"&&!t.altKey&&!t.ctrlKey&&!t.metaKey){if(this.isAnchorFocused()){t.shiftKey?this.focusLastItem():this.focusFirstItem(),t.preventDefault(),t.stopPropagation();return}if(this.isLastItemFocused()&&!t.shiftKey){this.focusAnchor(),t.preventDefault(),t.stopPropagation();return}if(this.isFirstItemFocused()&&t.shiftKey){this.focusAnchor(),t.preventDefault(),t.stopPropagation();return}}}};var{IfDefined:y6,If:b6}=Oi.Components,x6=-7,p0=9,FP=class extends Oi.Class{didMountPopover(t){var n,i,o,a;(i=(n=this.props).didMount)==null||i.call(n,t);let r=(a=(o=this.props).focusHelper)==null?void 0:a.call(o);r&&(document.addEventListener("keydown",r.handleKeydown),r.focusFirstItem())}didUnmountPopover(){var r,n;let t=(n=(r=this.props).focusHelper)==null?void 0:n.call(r);t&&document.removeEventListener("keydown",t.handleKeydown)}isVisible(){return this.props.visible?this.props.visible():!0}getPositionClasses(){let t=this.props.position();return{"dcg-left":t==="left","dcg-right":t==="right","dcg-bottom":t==="bottom-left"||t==="bottom-right","dcg-top":t==="top-left"||t==="top-right"}}template(){return Oi.createElement("div",{class:()=>{var t,r,n,i,o,a;return{"dcg-dropdown-popover":!0,"dcg-dropdown-popover--with-arrow":!((r=(t=this.props).hideArrow)!=null&&r.call(t)),"dcg-dropdown-popover--constrain-height":(i=(n=this.props).constrainHeight)==null?void 0:i.call(n),...this.getPositionClasses(),[((a=(o=this.props).className)==null?void 0:a.call(o))||""]:!!this.props.className}},role:Oi.const("region"),style:()=>{var t,r;return{display:this.isVisible()?void 0:"none",...((r=(t=this.props).style)==null?void 0:r.call(t))||{}}},didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover)},Oi.createElement("div",{class:Oi.const("dcg-dropdown-popover__interior")},y6(()=>{var t,r;return(r=(t=this.props).title)==null?void 0:r.call(t)},t=>Oi.createElement("h2",{class:Oi.const("dcg-unstyled-heading dcg-dropdown-popover__title")},()=>t())),this.props.children),Oi.createElement(b6,{predicate:()=>{var t,r;return!((r=(t=this.props).hideArrow)!=null&&r.call(t))}},()=>Oi.createElement("div",{class:Oi.const("dcg-arrow"),style:()=>{var t,r;return((r=(t=this.props).arrowStyle)==null?void 0:r.call(t))||{}}})))}},xm=class extends Oi.Class{constructor(){super(...arguments),this.showDropdown=!1,this.guid=this.props.guid(),this.dropdownStyle={},this.arrowStyle=void 0,this.debouncedPositionDynamically=zV(this.bindFn(this.positionDynamically),200)}init(){var r,n;let t=(n=(r=this.props).manageFocus)==null?void 0:n.call(r);t&&(this.focusHelper=new d0({anchorSelector:`.dcg-popover-with-anchor__anchor--${this.guid}`,popoverSelector:`.dcg-popover-with-anchor__popover--${this.guid}`,isOpen:()=>this.isDropdownOpen(),closeMenu:()=>this.setDropdownOpen(!1),itemNavigationKey:t.itemNavigationKey}))}isDropdownOpen(){return this.props.controlled?this.props.controlled().isOpen:this.showDropdown}setDropdownOpen(t){var r,n,i,o;(n=(r=this.props).disabled)!=null&&n.call(r)||(this.props.controlled?this.props.controlled().setDropdownOpen(t):(this.showDropdown=t,this.update()),t?(this.resetPosition(),this.positionDynamically(),(i=this.focusHelper)==null||i.focusFirstItem()):(o=this.focusHelper)==null||o.focusAnchor())}didMountWrapper(t){var n,i;this.rootNode=t,window.addEventListener("resize",this.debouncedPositionDynamically);let r=(i=(n=this.props).boundingParentElement)==null?void 0:i.call(n);r&&(this.resizeObserver=new ResizeObserver(this.debouncedPositionDynamically),this.resizeObserver.observe(r)),ze(document.body).on(`dcg-tap.${this.guid}`,o=>{if(!(o.target===t||ze.contains(t,o.target))&&this.isDropdownOpen()){let a=t.querySelector(".dcg-popover-with-anchor__popover");if(ze.contains(a,o.target))return;let s=a.getBoundingClientRect();if(o.clientX!==void 0&&o.clientY!==void 0&&o.clientX>s.left&&o.clientX<s.right&&o.clientY>s.top&&o.clientY<s.bottom)return;this.setDropdownOpen(!1);return}})}didUnmountWrapper(){this.showDropdown=!1,ze(document.body).off(`.${this.guid}`),ze(document).off(`.${this.guid}`),window.removeEventListener("resize",this.debouncedPositionDynamically),this.resizeObserver&&this.resizeObserver.disconnect()}didMountDropdown(t){var n,i,o;this.dropdownNode=t,((n=this.rootNode)==null?void 0:n.querySelector(".dcg-arrow"))&&(this.arrowStyle={}),this.resetPosition(),this.positionDynamically(),(o=(i=this.props.dropdownProps()).didMount)==null||o.call(i,t)}getDropdownOffset(){var t,r;return((r=(t=this.props).dropdownOffset)==null?void 0:r.call(t))||x6}resetPosition(){var i;let t=this.props.dropdownProps().position();this.dropdownStyle={},((i=this.rootNode)==null?void 0:i.querySelector(".dcg-arrow"))?this.arrowStyle={}:this.arrowStyle=void 0;let n=this.getDropdownOffset();switch(t){case"left":case"right":this.dropdownStyle.top=`${n}px`,this.arrowStyle&&(this.arrowStyle.top=`${p0}px`);break;case"top-right":case"bottom-right":this.dropdownStyle.left=`${n}px`,this.arrowStyle&&(this.arrowStyle.left=`${p0}px`);break;case"top-left":case"bottom-left":this.dropdownStyle.right=`${n}px`,this.arrowStyle&&(this.arrowStyle.right=`${p0}px`);break}this.update()}positionDynamically(){var x,b,w,E;let t=this.dropdownNode,r=this.rootNode;if(!r||!t||!this.isDropdownOpen())return;let n=t.getBoundingClientRect(),i=(w=(b=(x=this.props).boundingParentElement)==null?void 0:b.call(x))==null?void 0:w.getBoundingClientRect(),o=i?i.x+i.width:window.innerWidth,a=i?i.y+i.height:window.innerHeight,s=(E=i==null?void 0:i.left)!=null?E:0,c=n.bottom>a,l=n.right>o,u=n.left<s,d=this.props.dropdownProps().position(),f=r.getBoundingClientRect(),g=15,y=p0+this.getDropdownOffset();if((d==="left"||d==="right")&&c){let I=a-f.y-g,S=n.height-I;this.dropdownStyle.top=`${-1*S}px`,this.arrowStyle&&(this.arrowStyle.top=`${S+y}px`)}else if((d==="bottom-right"||d==="top-right")&&l){let I=o-f.x-g,S=n.width-I;this.dropdownStyle.left=`${-1*S}px`,this.arrowStyle&&(this.arrowStyle.left=`${S+y}px`)}else if((d==="bottom-left"||d==="top-left")&&u){let I=f.x+f.width-g-s,S=n.width-I;this.dropdownStyle.right=`${-1*S}px`,this.arrowStyle&&(this.arrowStyle.right=`${S+y}px`)}this.update()}getDropdownClassNames(){var r,n;let t=((n=(r=this.props.dropdownProps()).className)==null?void 0:n.call(r))||"";return`dcg-popover-with-anchor__popover dcg-popover-with-anchor__popover--${this.guid} ${t}`}template(){return Oi.createElement("div",{class:()=>{var t,r;return{"dcg-popover-with-anchor":!0,[((r=(t=this.props).containerClassName)==null?void 0:r.call(t))||""]:!!this.props.containerClassName}},didMount:this.bindFn(this.didMountWrapper),didUnmount:this.bindFn(this.didUnmountWrapper)},Oi.createElement("div",{role:Oi.const("link"),tabIndex:Oi.const(0),"aria-label":()=>{var t,r;return(r=(t=this.props).anchorAriaLabel)==null?void 0:r.call(t)},"aria-expanded":this.bindFn(this.isDropdownOpen),"aria-haspopup":Oi.const("true"),class:()=>({"dcg-popover-with-anchor__anchor":!0,[`dcg-popover-with-anchor__anchor--${this.guid}`]:!0,isOpen:this.isDropdownOpen()}),onTap:()=>{this.setDropdownOpen(!this.isDropdownOpen())}},this.props.anchor()),Oi.createElement(FP,{...this.props.dropdownProps(),className:this.bindFn(this.getDropdownClassNames),visible:this.bindFn(this.isDropdownOpen),focusHelper:()=>this.focusHelper,didMount:t=>this.didMountDropdown(t),arrowStyle:()=>this.arrowStyle,style:()=>this.dropdownStyle},this.props.children))}};var BP=ut(ft());var GP=ut(ft());var v6={start:new Date("2024-08-10T09:00:00.000-04:00"),end:new Date("2024-08-10T11:00:00.000-04:00")};function iG(e,t){let{start:r,end:n}=v6,i=new Intl.DateTimeFormat(e,{year:"numeric",month:"short",day:"numeric",weekday:"short"}),o=new Intl.DateTimeFormat(e,{hour:"numeric",timeZoneName:"short"});return n?t("shared-message-maintenance-window",{localizedStartDate:i.format(r),localizedStartTime:r.toLocaleString(e,{hour:"numeric"}),localizedEndTime:o.format(n)}):t("shared-message-maintenance-starts-at",{localizedStartDate:i.format(r),localizedStartTime:o.format(r)})}var g0=ut(ft()),T6={"2d":"dcg-icon-graphing",scientific:"dcg-icon-scientific",fourFunction:"dcg-icon-four-function",matrix:"dcg-icon-matrix","3d":"dcg-icon-3d",geometry:"dcg-icon-geometry",testMode:"dcg-icon-test-mode"},Ib=class extends g0.Class{template(){return g0.createElement("i",{class:()=>{var t,r;return{"dcg-shared-product-icon":!0,[T6[this.props.name()]]:!0,"dcg-disabled":(r=(t=this.props).disabled)==null?void 0:r.call(t)}},"aria-hidden":()=>{var t,r;return(r=(t=this.props).ariaHidden)==null?void 0:r.call(t)},role:()=>{var t,r;return(r=(t=this.props).role)==null?void 0:r.call(t)},"aria-label":()=>{var t,r;return(r=(t=this.props).ariaLabel)==null?void 0:r.call(t)}})}};var us=ut(ft());var Oc=ut(ft());var bn=ut(ft());fa();var qP=class{constructor(){this.handlers=[],ze(document).on("keydown.delegator",t=>this.handleEvent(t))}push(t){let r=jV("delegator_");return this.handlers.push({token:r,handler:t}),()=>this.handlers=xg(this.handlers,n=>n.token!=r)}handleEvent(t){if(!t.isDefaultPrevented()&&this.handlers.length){let r=!1,n=()=>r=!0;for(let{handler:i}of this.handlers.slice().reverse())if(i(t,n),r)return}}},oG=new qP;fa();function f0(e){return Array.from(e.querySelectorAll('input:enabled, button:enabled, select:enabled, textarea:enabled, [tabindex="0"], a[href]')).filter(t=>!t.matches('[aria-hidden="true"], [aria-hidden="true"] *, [aria-disabled="true"], [aria-disabled="true"] *')&&u0(t))}function aG(e){return function(r){if(Ai(r)==wb&&e){let n=f0(e);if(n.length===0)return;let i=n[0],o=n[n.length-1];r.shiftKey&&document.activeElement===i?(r.preventDefault(),ze(o).trigger("focus")):!r.shiftKey&&document.activeElement===o?(r.preventDefault(),ze(i).trigger("focus")):document.activeElement&&!e.contains(document.activeElement)&&(r.preventDefault(),ze(i).trigger("focus"))}}}var lo=ut(ft());fa();function sG(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}var{IfElse:w6}=lo.Components,E6=500,Jl=5,Cb=2,zP=class extends lo.Class{constructor(){super(...arguments),this.offsetLeft=0}init(){this.uuid=this.props.uuid()}gravity(){var t,r;return((r=(t=this.props).gravity)==null?void 0:r.call(t))||"s"}template(){return lo.createElement("div",{class:()=>{var t,r,n,i;return{"dcg-tooltip-positioning-container":!0,"dcg-tooltip-gravity-n-s":this.gravity()==="n"||this.gravity()==="s","dcg-tooltip-gravity-e-w":this.gravity()==="e"||this.gravity()==="w","dcg-tooltip-theme-light":((r=(t=this.props).theme)==null?void 0:r.call(t))==="light","dcg-tooltip-theme-dark":((i=(n=this.props).theme)==null?void 0:i.call(n))!=="light"}},style:()=>{var t,r,n,i;return{top:`${this.props.hitAreaRect().top+(((r=(t=this.props).offset)==null?void 0:r.call(t).top)||0)}px`,left:`${this.props.hitAreaRect().left+(((i=(n=this.props).offset)==null?void 0:i.call(n).left)||0)}px`,width:`${this.props.hitAreaRect().width}px`,height:`${this.props.hitAreaRect().height}px`}}},lo.createElement("div",{class:lo.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle)},lo.createElement("div",{role:lo.const("tooltip"),id:this.const(this.uuid),class:()=>{var t,r;return{"dcg-tooltip-message":!0,"dcg-text-selectable":(r=(t=this.props).sticky)==null?void 0:r.call(t),"dcg-sticky-not-stuck":this.props.isStickyAndNotStuck()}},onMount:t=>this.tooltipMessage=t,style:()=>({left:`${Math.round(this.offsetLeft)}px`})},w6(()=>!!this.props.customTooltipView,{true:()=>this.props.customTooltipView(),false:()=>lo.createElement("span",null,this.props.tooltip)}))),lo.createElement("div",{class:()=>({"dcg-tooltip-arrow":!0,[this.getTooltipGravityClass()]:!0}),style:()=>{var t,r;return((r=(t=this.props).theme)==null?void 0:r.call(t))==="light"?this.getArrowWithBorderStyle():this.getSolidArrowStyle()}}))}updatePositionIfNecessary(){if(this.gravity()!=="s"&&this.gravity()!=="n")return;let t=this.tooltipMessage.getBoundingClientRect(),r=this.tooltipMessage.closest(".dcg-tap-container");if(!r)return;let n=r.getBoundingClientRect();t.right+Cb>n.right?this.offsetLeft=n.right-t.right-Cb:t.left-Cb<n.left&&(this.offsetLeft=n.left-t.left+Cb),this.offsetLeft!==0&&this.update()}didMount(){this.updatePositionIfNecessary()}getTooltipGravityClass(){switch(this.gravity()){case"n":return"dcg-tooltip-gravity-n";case"s":return"dcg-tooltip-gravity-s";case"e":return"dcg-tooltip-gravity-e";case"w":return"dcg-tooltip-gravity-w"}}getArrowWithBorderStyle(){let t=this.gravity(),r=this.getBackgroundColor(),n="#bbb",i="8px",o={width:i,height:i,border:`1px solid ${n}`,background:r};switch(t){case"s":return{...o,top:"100%",left:"50%","margin-top":"1px","border-right":"0","border-bottom":"0"};case"n":return{...o,bottom:"100%",left:"50%","margin-bottom":"1px","border-left":"0","border-top":"0"};case"e":return{...o,top:"50%",left:"100%","margin-left":"1px","border-right":"0","border-top":"0"};case"w":return{...o,top:"50%",right:"100%","margin-right":"1px","border-left":"0","border-bottom":"0"};default:return t}}getSolidArrowStyle(){let t=this.gravity(),r=this.getBackgroundColor(),n=`transparent transparent ${r} transparent`,i=`${r} transparent transparent transparent`,o=`transparent ${r} transparent transparent`,a=`transparent transparent transparent ${r}`,s=`-${Jl}px`;switch(t){case"s":return{top:"100%",left:"50%",border:`${Jl}px solid transparent`,"border-color":n,"margin-top":s,"margin-left":s};case"n":return{bottom:"100%",left:"50%",border:`${Jl}px solid transparent`,"border-color":i,"margin-bottom":s,"margin-left":s};case"e":return{top:"50%",left:"100%",border:`${Jl}px solid transparent`,"border-color":o,"margin-left":`-${Jl}px`,"margin-top":s};case"w":return{top:"50%",right:"100%",border:`${Jl}px solid transparent`,"border-color":a,"margin-right":s,"margin-top":s};default:return t}}getBackgroundColor(){var t,r;return((r=(t=this.props).theme)==null?void 0:r.call(t))==="light"?"#fff":this.props.isStickyAndNotStuck()?"#666":"#000"}getMessageStyle(){let t=this.props.hitAreaRect(),r=this.gravity(),n=this.props.maxWidth();switch(r){case"s":return{top:"100%",width:`${n}px`,transform:"translate(-50%, 0)",left:`${.5*t.width}px`,"margin-top":`${Jl}px`,"text-align":"center"};case"n":return{bottom:"100%",width:`${n}px`,transform:"translate(-50%, 0)",left:`${.5*t.width}px`,"margin-bottom":`${Jl}px`,"text-align":"center"};case"e":return{transform:"translate(0, -50%)",left:"100%",width:`${n}px`,top:`${.5*t.height}px`,"margin-left":`${Jl}px`,"text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",width:`${n}px`,top:`${.5*t.height}px`,"margin-right":`${Jl}px`,"text-align":"right"};default:return r}}};function I6(){return document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}var Rs=class extends lo.Class{init(){this.uuid=`dcg-tooltip-${sG()}`}template(){return lo.createElement("div",{class:()=>{var t,r,n,i;return{"dcg-tooltip-hit-area-container":!0,[((r=(t=this.props).additionalClass)==null?void 0:r.call(t))||""]:!!this.props.additionalClass,"dcg-display-block":(i=(n=this.props).displayBlock)==null?void 0:i.call(n),"dcg-do-not-blur":!0,"dcg-sticky-tooltip":this.isSticky(),"dcg-tooltip-disabled":this.props.disabled&&this.props.disabled()}},handleEvent:lo.const("true"),didMount:t=>{this.isMounted=!0,this.hitAreaNode=t,this.setupEventListeners(this.hitAreaNode)},tabIndex:()=>this.isSticky()?"0":"-1","aria-label":()=>this.isSticky()?this.props.tooltip():void 0,role:()=>this.isSticky()?"note":void 0,onFocus:()=>{this.isSticky()&&(this.showTooltip(),this.stickTooltip())},onTap:t=>{var r,n,i,o,a;if(this.isSticky())if(t.stopPropagation(),this.isStuck)this.hideTooltipImmediately();else{if((n=(r=this.props).disabled)!=null&&n.call(r))return;this.showTooltip(),this.stickTooltip(),(i=this.hitAreaNode)==null||i.focus()}else if(this.shouldShowOnTapstart()){if((a=(o=this.props).disabled)!=null&&a.call(o))return;this.showTooltip(),this.setUpHideOnExternalMousedown()}else this.hideTooltipImmediately()}},this.props.children)}isSticky(){var t,r,n,i;return!!((r=(t=this.props).sticky)!=null&&r.call(t))&&!((i=(n=this.props).disabled)!=null&&i.call(n))}shouldShowOnTapstart(){var t,r;return!!((r=(t=this.props).showOnTapstart)!=null&&r.call(t))}didUpdate(){this.updateTooltip()}updateTooltip(){if(!this.wrapperRef)return;if(!this.props.tooltip()){this.hideTooltip();return}let t=this.hitAreaNode.getBoundingClientRect(),r=this.wrapperRef.elt.getBoundingClientRect(),{originalTop:n,originalLeft:i}=this.wrapperRef,o=t.top-r.top,a=t.left-r.left;Math.abs(o-n)>3||Math.abs(a-i)>3?this.hideTooltip():this.wrapperRef.view.update()}handleShowEvent(t){var n,i;if((i=(n=this.props).disabled)!=null&&i.call(n))return;let r=this.props.delay?this.props.delay():E6;this.clearTimeouts(),this.showTooltipTimeout=setTimeout(t,r)}hideTooltipImmediately(){this.clearTimeouts(),this.hideTooltip()}handleHideEvent(){this.clearTimeouts(),this.hideTooltipTimeout=setTimeout(this.bindFn(this.hideTooltip),150)}setupEventListeners(t){ze(t).on("tipsyshow",r=>{r.target===t&&this.handleShowEvent(()=>{this.showTooltip()})}).on("tipsyhide",r=>{r.target!==t||this.isStuck||this.handleHideEvent()}).on("keydown",r=>{!l0(r)&&!Eb(r)&&this.isStuck&&this.hideTooltipImmediately()})}willUnmount(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()}setUpHideOnExternalMousedown(){ze(document).on(`mousedown.dcg-tooltip-${this.uuid} touchstart.dcg-tooltip-${this.uuid} pointerdown.dcg-tooltip-${this.uuid}`,t=>{this.wrapperRef&&(this.hitAreaNode.contains(t.target)||this.wrapperRef.elt.contains(t.target)||this.hideTooltip())})}stickTooltip(){this.isMounted&&this.wrapperRef&&(this.isStuck||(this.setUpHideOnExternalMousedown(),this.isStuck=!0,this.updateTooltip()))}clearTimeouts(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)}showTooltip(){var g,y,x;if(!this.isMounted||this.wrapperRef||!this.props.tooltip())return;let t=this.hitAreaNode.getBoundingClientRect(),r=document.createElement("div");r.className="dcg-tooltip-mount-pt";let n=this.hitAreaNode.closest(".dcg-tap-container"),i=I6();(!!i&&i.contains(this.hitAreaNode)&&i.closest(".dcg-tap-container")?i:n).appendChild(r);let a=r.getBoundingClientRect(),s=t.left-a.left,c=t.top-a.top,l=200;if((y=(g=this.props).noWrap)!=null&&y.call(g)){let b=(x=r.closest(".dcg-tap-container"))==null?void 0:x.getBoundingClientRect();b&&(l=b.width-2*Cb)}let u={...this.props,isStickyAndNotStuck:()=>this.isSticky()&&!this.isStuck,maxWidth:()=>l,hitAreaRect:()=>({top:c||0,left:s||0,width:t.width||0,height:t.height||0}),uuid:()=>this.uuid};this.setupEventListeners(r),ze(r).on("dcg-tap",()=>{this.isSticky()&&this.stickTooltip()});let d=lo.mountToNode(zP,r,u);ze(document).on(`keydown.dcg-tooltip-${this.uuid}`,b=>{Ai(b)===Yu&&this.hideTooltip()});let f=()=>this.updateTooltip();window.addEventListener("scroll",f,!0),this.wrapperRef={elt:r,view:d,originalLeft:s,originalTop:c,onScroll:f},this.assignAriaDescribedBy()}hideTooltip(){this.clearTimeouts(),this.wrapperRef&&(this.isStuck=!1,ze(document).off(`.dcg-tooltip-${this.uuid}`),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),this.restoreAriaDescribedBy(),lo.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)}assignAriaDescribedBy(){var r,n;if((n=(r=this.props).sticky)!=null&&n.call(r))return;let t=f0(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy=t.getAttribute("aria-describedby"),t.setAttribute("aria-describedby",this.uuid)}restoreAriaDescribedBy(){var r,n;if((n=(r=this.props).sticky)!=null&&n.call(r))return;let t=f0(this.hitAreaNode)[0]||this.hitAreaNode;this.originalDescribedBy?t.setAttribute("aria-describedby",this.originalDescribedBy):t.removeAttribute("aria-describedby")}};var{If:cG}=bn.Components,za=class extends bn.Class{init(){this.i18n=this.props.i18n(),this.isMounted=!1}template(){return bn.createElement("div",{class:()=>({"dcg-shared-modal-container":!0,[this.props.class?this.props.class():""]:!!this.props.class}),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.didUnmount)},bn.createElement("div",{class:()=>({"dcg-shared-modal-cover":!0,"dcg-shared-has-close-button":this.showX(),"dcg-shared-modal-fullscreen":this.props.size()==="fullscreen","dcg-shared-modal-wide":this.props.size()==="wide","dcg-shared-modal-medium":this.props.size()==="medium","dcg-shared-modal-narrow":this.props.size()==="narrow"})},bn.createElement("div",{class:bn.const("dcg-shared-modal-background"),onTap:this.props.onClose}),bn.createElement("div",{class:bn.const("dcg-shared-modal-transition-container")},bn.createElement("div",{class:bn.const("dcg-shared-modal"),role:bn.const("dialog"),"aria-modal":bn.const("true"),"aria-label":()=>{let t="";return this.props.ariaLabel?t=this.props.ariaLabel():this.props.title&&(t=this.props.title()),t}},bn.createElement(cG,{predicate:()=>this.showX()},()=>bn.createElement("div",{class:bn.const("dcg-shared-close-cross-container")},bn.createElement(Rs,{tooltip:()=>this.i18n.s("shared-button-close-dialog")},bn.createElement("div",{role:bn.const("button"),tabIndex:bn.const("0"),"aria-label":()=>this.i18n.s("shared-button-close-dialog"),class:bn.const("dcg-shared-close-cross"),onTap:this.props.onClose},bn.createElement("i",{class:bn.const("dcg-icon-remove"),"aria-hidden":bn.const("true")}))))),bn.createElement("div",{class:bn.const("dcg-shared-modal-contents-wrapper")},bn.createElement(cG,{predicate:()=>!!this.props.title&&!!this.props.title()},()=>bn.createElement("h1",{class:()=>({"dcg-shared-modal-title":!0,"dcg-shared-left-align-title":this.leftAlignTitle()})},()=>this.props.title())),bn.createElement("div",{class:bn.const("dcg-shared-modal-scrollable-content")},this.props.children))))))}showX(){return!!this.props.showX&&this.props.showX()}leftAlignTitle(){return!!this.props.leftAlignTitle&&this.props.leftAlignTitle()}didMount(){var s,c;if(this.isMounted)return;this.isMounted=!0;let t=this.findRootNode();function r(){let l=t.querySelector(".dcg-shared-close-cross");l&&l.focus()}function n(){let l=t.querySelector(".dcg-shared-modal-scrollable-content");l&&(l.tabIndex>=0||(l.tabIndex=0),l.focus())}let i=t.querySelector(".dcg-shared-modal-scrollable-content"),o=(c=(s=this.props).setFocus)==null?void 0:c.call(s);o==="close"?this.showX()?r():i&&n():o==="content"&&n();let a=aG(t);this.unsub=oG.push((l,u)=>{Ai(l)==Yu&&(this.onClose(),u());let d=l.altKey||l.shiftKey||l.metaKey||l.ctrlKey;this.props.onArrowKey&&Ai(l)===o0&&!d&&this.props.onArrowKey("Left"),this.props.onArrowKey&&Ai(l)===s0&&!d&&this.props.onArrowKey("Right"),a(l)})}onClose(){this.props.onClose&&this.props.onClose()}didUnmount(){this.isMounted&&(this.isMounted=!1,this.unsub())}};var m0=class extends Oc.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Oc.createElement(za,{title:()=>this.i18n.s("shared-title-account-reactivated"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Oc.createElement("div",{class:Oc.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},Oc.createElement("div",{class:Oc.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-account-reactivated")),Oc.createElement("div",{class:Oc.const("dcg-shared-modal-actions-container")},Oc.createElement("button",{class:()=>({"dcg-btn-blue":!0}),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.i18n.s("shared-button-continue-to-desmos")))))}};var gi=ut(ft());fa();var qn=ut(ft());var sc=ut(ft()),{If:C6,For:P6}=sc.Components,Ao=class extends sc.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return sc.createElement(C6,{predicate:()=>!!this.props.errors().length},()=>sc.createElement("span",null,sc.createElement(P6,{each:this.props.errors},t=>sc.createElement("div",{class:sc.const("dcg-shared-account-modal-errors"),role:sc.const("alert")},sc.createElement("span",null,()=>this.i18n.raw(t))))))}};var{If:lG}=qn.Components,S6=0,UP=1,uG=2,h0=class extends qn.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.mode=UP,this.formErrors=[]}template(){return qn.createElement("div",{class:qn.const("dcg-shared-change-password dcg-shared-account-settings-section")},qn.createElement(lG,{predicate:()=>this.mode===UP},()=>qn.createElement("div",{class:qn.const("dcg-shared-reset-by-email")},qn.createElement("div",{class:qn.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-change-password-email-sent",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),qn.createElement(Ao,{controller:this.props.controller,errors:()=>this.formErrors}),qn.createElement("div",{class:qn.const("dcg-shared-modal-actions-container")},qn.createElement("div",{role:qn.const("button"),"aria-disabled":()=>this.emailDisabled,tabIndex:()=>this.emailDisabled?"-1":"0",class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.emailDisabled}),onTap:()=>this.sendResetPasswordEmail()},()=>this.i18n.s("shared-button-send-email"))))),qn.createElement(lG,{predicate:()=>this.mode===uG},()=>qn.createElement("div",{"aria-live":qn.const("assertive"),"aria-atomic":qn.const("true"),class:qn.const("dcg-shared-confirmation-message-container")},qn.createElement("div",{class:qn.const("dcg-shared-confirmation-message")},qn.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":qn.const("true")}),()=>this.i18n.s("shared-message-email-sent")),qn.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-password-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}onEmailSent(){this.mode=uG,this.update(),setTimeout(this.bindIfMounted(()=>{this.mode=S6,this.update()}),5e3),setTimeout(this.bindIfMounted(()=>{this.mode=UP,this.update()}),5200)}onEmailSendingFailed(t){this.formErrors=this.controller.parseJSONErrors(t),this.update()}sendResetPasswordEmail(){this.controller.userController.recoverPassword({email:this.controller.userController.getEmail(),lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onEmailSent),this.bindIfMounted(this.onEmailSendingFailed))}};var De=ut(ft());var xn=ut(ft());var y0=class extends xn.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return xn.createElement("div",{class:xn.const("dcg-shared-delete-account dcg-shared-account-settings-section")},xn.createElement("h1",{class:xn.const("dcg-shared-left-align-title")},()=>this.i18n.s("shared-title-delete-account")),xn.createElement("div",{class:xn.const("dcg-shared-account-paragraph")},xn.createElement(ac,{key:this.const("shared-message-delete-account-notice"),i18n:this.props.controller},xn.const("When you delete your account,"),xn.const(" "),xn.createElement("b",null,xn.const("we will retain your data for 30 days.")),xn.const(" You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please"),xn.const(" "),xn.createElement("a",{href:xn.const("mailto:support@desmos.com"),class:xn.const("dcg-blue-link")},xn.const("let us know.")))),xn.createElement("div",{class:xn.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-delete-account-will-send-email",{email:this.i18n.raw(this.controller.userController.getEmail())})),xn.createElement("form",{onSubmit:this.bindFn(this.onSubmit)},xn.createElement(Ao,{controller:this.props.controller,errors:()=>this.formErrors}),xn.createElement("div",{class:xn.const("dcg-shared-modal-actions-container")},xn.createElement("div",{role:xn.const("link"),tabIndex:xn.const(0),class:xn.const("dcg-gray-link"),onTap:()=>this.props.hideForm()},()=>this.i18n.s("shared-button-cancel")),xn.createElement("button",{class:()=>({"dcg-btn-red":!0,"dcg-disabled":this.disabled}),"aria-disabled":()=>this.disabled,tabIndex:()=>this.disabled?"-1":"0",type:xn.const("submit")},()=>this.i18n.s("shared-button-send-delete-account-email")))))}onAccountDeleted(){this.props.submitForm()}onAccountDeletionFailed(t){this.formErrors=this.controller.parseJSONErrors(t),this.update()}doDeleteAccount(){this.disabled||(this.controller.logEvent({category:"accounts",action:"send-delete-email"}),this.controller.userController.initiateAccountDeletion({lang:this.controller.getLanguage()}).then(this.bindFn(this.onAccountDeleted),this.bindIfMounted(this.onAccountDeletionFailed)))}onSubmit(t){t.preventDefault(),this.doDeleteAccount()}};var Jt=ut(ft());var{If:HP}=Jt.Components,vm=0,dG=1,M6=2,pG=3,b0=class extends Jt.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formStatus=vm,this.emailDisabled=null}template(){return Jt.createElement("div",{class:Jt.const("dcg-shared-email-field-container")},Jt.createElement(HP,{predicate:()=>this.formStatus===vm},()=>Jt.createElement("div",{class:Jt.const("dcg-shared-email-field")},Jt.createElement("div",{class:Jt.const("dcg-shared-profile-info-container")},Jt.createElement("span",{class:Jt.const("dcg-shared-profile-info-title"),role:Jt.const("heading"),"aria-level":Jt.const("1")},()=>this.i18n.s("shared-title-email-settings")),Jt.createElement("div",{class:Jt.const("dcg-shared-profile-info-content")},()=>this.i18n.raw(this.controller.userController.getEmail()),Jt.createElement("div",{class:Jt.const("dcg-shared-message-container")},Jt.createElement("div",{role:Jt.const("link"),tabIndex:Jt.const(0),class:Jt.const("dcg-blue-link"),onTap:()=>this.setFormStatus(dG)},()=>this.i18n.s("shared-button-change-email-address"))))))),Jt.createElement(HP,{predicate:()=>this.formStatus===dG},()=>Jt.createElement("div",{class:Jt.const("dcg-shared-change-email-container")},Jt.createElement("div",{class:Jt.const("dcg-shared-change-email-description")},()=>this.i18n.s("shared-message-email-settings-will-send-email",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),Jt.createElement(Ao,{controller:this.props.controller,errors:()=>this.formErrors}),Jt.createElement("div",{class:Jt.const("dcg-shared-modal-actions-container")},Jt.createElement("span",{role:Jt.const("link"),tabIndex:Jt.const(0),class:Jt.const("dcg-gray-link"),onTap:()=>this.setFormStatus(vm)},()=>this.i18n.s("shared-button-cancel")),Jt.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!!this.emailDisabled}),"aria-disabled":()=>this.disabled,tabIndex:()=>this.disabled?"-1":"0",type:Jt.const("submit"),onTap:()=>this.emailDisabled||this.sendChangeEmail()},()=>this.i18n.s("shared-button-send-email"))))),Jt.createElement(HP,{predicate:()=>this.formStatus===pG},()=>Jt.createElement("div",{"aria-live":Jt.const("assertive"),"aria-atomic":Jt.const("true"),class:Jt.const("dcg-shared-confirmation-message-container")},Jt.createElement("div",{class:Jt.const("dcg-shared-confirmation-message")},Jt.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":Jt.const("true")}),()=>this.i18n.s("shared-message-email-sent")),Jt.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}setToast(t){this._isMounted&&(this.toastMessage||(this.toastMessage=t,this.update(),setTimeout(this.bindIfMounted(()=>{this.toastMessage=null,this.update()}),5e3),this.formStatus===M6&&setTimeout(this.bindIfMounted(()=>{this.setFormStatus(vm),this.update()}),5200)))}setFormStatus(t){this.formStatus=t,this.toastMessage=null,this.formErrors=[],this.update()}onEmailSent(){this.formStatus=pG,this.emailDisabled=null,this.update(),setTimeout(this.bindIfMounted(()=>{this.formStatus=vm,this.update()}),5e3),setTimeout(this.bindIfMounted(()=>{this.formStatus=vm,this.update()}),5200)}onEmailSendingFailed(t){this.formErrors=this.controller.parseJSONErrors(t),this.emailDisabled=null,this.update()}sendChangeEmail(){this.emailDisabled=!0,this.update(),this.controller.userController.initiateEmailChange({lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onEmailSent),this.bindIfMounted(this.onEmailSendingFailed))}};var{If:x0,Input:WP,Switch:D6,SwitchUnion:_6}=De.Components,$P=0,gG=1,YP=2,v0=class extends De.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.deleteAccount=$P}template(){return De.createElement("div",{class:De.const("dcg-shared-profile-info dcg-shared-account-settings-section")},De.createElement(D6,{key:()=>this.deleteAccount},t=>{switch(t){case $P:return De.createElement("div",null,De.createElement("div",{class:De.const("dcg-shared-email-form-container")},De.createElement(XP,{controller:this.props.controller})),De.createElement(b0,{controller:this.props.controller}),De.createElement("button",{class:De.const("dcg-gray-link dcg-shared-delete-link"),onTap:()=>this.confirmDeletion()},()=>this.i18n.s("shared-button-delete-account-question")));case gG:return De.createElement(y0,{hideForm:()=>this.setDeleteAccount($P),submitForm:()=>this.setDeleteAccount(YP),controller:this.props.controller});case YP:return De.createElement("div",{"aria-live":De.const("assertive"),"aria-atomic":De.const("true"),class:De.const("dcg-shared-confirmation-message-container")},De.createElement("div",{class:De.const("dcg-shared-confirmation-message")},De.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":De.const("true")}),()=>this.i18n.s("shared-message-email-sent")),De.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-delete-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))}}))}setDeleteAccount(t){this.deleteAccount=t,t===YP&&setTimeout(()=>{this.controller.userController.logout().then(()=>{this.controller.dispatch({type:"close-modal"})})},5e3),this._isMounted&&this.update()}confirmDeletion(){this.setDeleteAccount(gG)}},XP=class extends De.Class{init(){this.controller=this.props.controller(),this.formErrors=[];let t=this.controller.userController.getNameDetail();t.source=="legacy"?this.state={state:"legacy",name:t.given,previousName:t.given}:t.source=="parsed"?this.state={state:"name-detail",confirm:!0,given:t.given,family:t.family||"",previousGiven:"",previousFamily:""}:this.state={state:"name-detail",confirm:!1,given:t.given,family:t.family||"",previousGiven:t.given,previousFamily:t.family||""}}template(){return _6("state",()=>this.state)({legacy:t=>De.createElement(KP,{state:t,controller:this.props.controller,onSaveName:this.bindFn(this.onSaveName),formErrors:()=>this.formErrors,showSavedNotice:()=>this.showSavedNotice,updateState:r=>{this.state.state=="legacy"&&(this.state={...this.state,...r},this._isMounted&&this.update())}}),"name-detail":t=>De.createElement(jP,{state:t,controller:this.props.controller,showSavedNotice:()=>this.showSavedNotice,onSaveName:this.bindFn(this.onSaveName),formErrors:()=>this.formErrors,updateState:r=>{this.state.state=="name-detail"&&(this.state={...this.state,...r},this._isMounted&&this.update())}})})}onSaveName(){switch(this.state.state){case"legacy":this.controller.userController.setNameLegacy({name:this.state.name,lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onSaved)).catch(this.bindIfMounted(t=>{this.formErrors=this.controller.parseJSONErrors(t),this.update()}));break;case"name-detail":this.controller.userController.setNameDetail({given:this.state.given,family:this.state.family,lang:this.controller.getLanguage()}).then(this.bindIfMounted(this.onSaved)).catch(this.bindIfMounted(t=>{this.formErrors=this.controller.parseJSONErrors(t),this.update()}));break}}onSaved(){switch(this.state.state){case"legacy":this.state.previousName=this.state.name;break;case"name-detail":this.state.previousGiven=this.state.given,this.state.previousFamily=this.state.family,this.state.confirm=!1;break}this.showSavedNotice=!0,this.update(),setTimeout(this.bindIfMounted(()=>{this.showSavedNotice=!1,this.update()}),3e3)}},KP=class extends De.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return De.createElement("form",{class:De.const("dcg-shared-name-field"),onSubmit:this.bindFn(this.onSaveName)},De.createElement("div",{class:De.const("dcg-shared-profile-info-container")},De.createElement("label",{class:De.const("dcg-shared-profile-info-title"),for:De.const("name")},()=>this.i18n.s("shared-label-name")),De.createElement(WP,{type:De.const("text"),name:De.const("name"),class:De.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:this.bindFn(this.onNameInput),"aria-label":()=>this.i18n.s("shared-label-name"),value:()=>this.props.state().name,autocomplete:De.const("off")})),De.createElement("div",{class:De.const("dcg-shared-modal-actions-container")},De.createElement(T0,{showSavedNotice:this.props.showSavedNotice,i18n:this.props.controller}),De.createElement("button",{type:De.const("submit"),disabled:()=>this.nameFieldDisabled()?!0:void 0,class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.nameFieldDisabled()})},()=>this.i18n.s("shared-button-save"))),De.createElement(x0,{predicate:()=>this.props.formErrors().length>0},()=>De.createElement(Ao,{controller:this.props.controller,errors:()=>this.props.formErrors()})))}onNameInput(t){this.props.updateState({name:t})}didMountName(t){xl||t.focus()}onSaveName(t){t.preventDefault(),!this.nameFieldDisabled()&&this.props.onSaveName()}nameFieldDisabled(){let t=this.props.state();return!t.name||t.name===t.previousName}},jP=class extends De.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return De.createElement("form",{class:De.const("dcg-shared-name-field"),onSubmit:this.bindFn(this.onSaveName)},De.createElement("div",{class:()=>({"dcg-shared-confirm-name":this.props.state().confirm})},De.createElement(x0,{predicate:()=>this.props.state().confirm},()=>De.createElement("span",null,()=>this.i18n.s("shared-message-please-review-name"))),De.createElement("div",{class:De.const("dcg-shared-profile-info-container")},De.createElement("div",{class:De.const("dcg-shared-name-input")},De.createElement("label",{class:De.const("dcg-shared-profile-info-title"),for:De.const("given-name")},()=>this.i18n.s("shared-label-given-name-or-nickname")),De.createElement(WP,{type:De.const("text"),name:De.const("given-name"),id:De.const("given-name"),class:De.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:t=>this.props.updateState({given:t}),"aria-label":()=>this.i18n.s("shared-label-given-name-or-nickname"),value:()=>this.props.state().given,autocomplete:De.const("off")})),De.createElement("div",{class:De.const("dcg-shared-name-input")},De.createElement("label",{class:De.const("dcg-shared-profile-info-title"),for:De.const("family-name")},()=>this.i18n.s("shared-label-family-name")),De.createElement(WP,{type:De.const("text"),name:De.const("family-name"),id:De.const("family-name"),class:De.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),onInput:t=>this.props.updateState({family:t}),"aria-label":()=>this.i18n.s("shared-label-family-name"),value:()=>this.props.state().family,autocomplete:De.const("off")}))),De.createElement("div",{class:De.const("dcg-shared-modal-actions-container")},De.createElement(T0,{i18n:this.props.controller,showSavedNotice:this.props.showSavedNotice}),De.createElement("button",{type:De.const("submit"),disabled:()=>this.canSubmit()?void 0:!0,class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.canSubmit()})},()=>this.props.state().confirm?this.i18n.s("shared-button-confirm-name"):this.i18n.s("shared-button-save"))),De.createElement(x0,{predicate:()=>this.props.formErrors().length>0},()=>De.createElement(Ao,{controller:this.props.controller,errors:()=>this.props.formErrors()}))))}didMountName(t){xl||t.focus()}onSaveName(t){t.preventDefault(),this.canSubmit()&&this.props.onSaveName()}canSubmit(){let t=this.props.state();return t.given?t.confirm?!0:!(t.given===t.previousGiven&&t.family===t.previousFamily):!1}},T0=class extends De.Class{template(){return De.createElement(x0,{predicate:()=>this.props.showSavedNotice()},()=>De.createElement("span",{"aria-live":De.const("assertive"),"aria-atomic":De.const("true"),class:De.const("dcg-shared-confirmation-message")},De.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":De.const("true")}),()=>this.props.i18n().s("shared-message-information-saved")))}};var{For:A6,Switch:O6}=gi.Components,w0="profile-info",ZP="change-password",E0=class extends gi.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.settingsView=this.props.initialTab&&this.props.initialTab()||w0,this.breakPoint=660,this.measureWindow()}template(){return gi.createElement(za,{title:()=>this.i18n.s("shared-title-account-settings"),size:this.const("wide"),showX:this.const(!0),leftAlignTitle:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},gi.createElement("div",{class:gi.const("dcg-shared-account-settings-dialog dcg-shared-account-dialog")},gi.createElement("div",{class:gi.const("dcg-shared-navigation-tabs"),role:gi.const("tablist")},gi.createElement(A6,{each:()=>this.getTabs(),key:t=>""+t.key},t=>gi.createElement("div",{role:gi.const("tab"),tabIndex:gi.const("0"),"aria-selected":()=>this.settingsView===t.key,class:()=>({"dcg-shared-tab-gray-underline":!0,[t.class]:!0,"dcg-selected":this.settingsView===t.key}),onTap:()=>this.updateSettingsView(t.key)},t.label))),gi.createElement("div",{class:gi.const("dcg-shared-content-container")},gi.createElement(O6,{key:()=>this.settingsView},t=>t===w0?gi.createElement(v0,{controller:this.props.controller}):t===ZP?gi.createElement(h0,{controller:this.props.controller}):this.props.extraTabs?gi.createElement("div",{class:gi.const("dcg-shared-profile-info dcg-shared-account-settings-section")},this.props.extraTabs().createView(t)):gi.createElement("span",null)))))}getTabs(){let t=[{key:w0,label:this.bindFn(this.profileTitle),class:"profile-view-button"},{key:ZP,label:this.bindFn(this.passwordTitle),class:"change-password-view-button"}];return this.props.extraTabs?[...t,...this.props.extraTabs().tabs.map(({key:r,narrowLabel:n,wideLabel:i,class:o})=>({key:r,label:()=>this.windowWidth>this.breakPoint?n():i(),class:`${o}-button`}))]:t}updateSettingsView(t){this.settingsView=t,this._isMounted&&this.update()}profileTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-profile-information-wide"):this.i18n.s("shared-title-profile-information-narrow")}passwordTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-change-password-wide"):this.i18n.s("shared-title-change-password-narrow")}measureWindow(){return this.windowWidth=ze(window).width()}didMount(){ze(window).on("resize.account-dialog",ub(()=>{this.measureWindow(),this._isMounted&&this.update()},200))}didUnmount(){ze(window).off("resize.account-dialog")}isProfileSelected(){return this.settingsView===w0}isChangePasswordSelected(){return this.settingsView===ZP}};var pn=ut(ft());var Yd="[^@\\s]+@[^@\\s]+\\.[^@\\s]+";var{Input:fG}=pn.Components,I0=class extends pn.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return pn.createElement(za,{title:()=>this.i18n.s("shared-title-change-email-address"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},pn.createElement("div",{class:pn.const("dcg-shared-change-email dcg-shared-account-dialog")},pn.createElement("div",{class:pn.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-set-new-email-address")),pn.createElement("form",{onSubmit:this.bindFn(this.onSubmit),method:pn.const("post"),class:pn.const("dcg-shared-email-form-container")},pn.createElement("label",null,pn.createElement("span",{class:pn.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-new-email-address")),pn.createElement(fG,{type:pn.const("email"),pattern:this.const(Yd),name:pn.const("newEmail"),class:pn.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-new-email-address"),required:pn.const("true"),didMount:t=>{xl||t.focus()},value:()=>this.newEmail,onInput:t=>{this.newEmail=t,this._isMounted&&this.update()}})),pn.createElement("label",{for:pn.const("password")},pn.createElement("span",null,()=>this.i18n.s("shared-label-password")),pn.createElement(fG,{type:pn.const("password"),class:pn.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:pn.const("true"),value:()=>this.password,name:this.const("password"),onInput:t=>{if(this.password=t,this._isMounted)return this.update()}})),pn.createElement(Ao,{controller:this.props.controller,errors:()=>this.formErrors}),pn.createElement("div",{class:pn.const("dcg-shared-sign-in-options")},pn.createElement("button",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabIndex:()=>this.submitEnabled()?"0":"-1",type:pn.const("submit")},()=>this.i18n.s("shared-button-change-email-and-password"))))))}submitEnabled(){return!!(this.password&&this.newEmail)}async onSubmit(t){if(t.preventDefault(),this.submitEnabled())try{await this.controller.userController.setEmail({changeToken:this.getChangeToken(),password:this.password,newEmail:this.newEmail,lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"}),history.replaceState(null,null,document.location.pathname)}catch(r){if(!this._isMounted)return;r.status===409?this.formErrors=["Sorry, someone has already registered with this email address."]:this.formErrors=this.controller.parseJSONErrors(r),this.update()}}getChangeToken(){return this.controller.userController.getEmailChangeToken()||""}};var Me=ut(ft());var Ua=ut(ft());var wg=class extends Ua.Class{template(){return Ua.createElement("div",{class:Ua.const("dcg-shared-cookie-notice")},Ua.createElement(ac,{key:this.const("shared-message-cookie-notice"),i18n:this.props.i18n},Ua.createElement("b",null,Ua.const("Note:")),Ua.const(" Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in."),Ua.const(" "),Ua.createElement("a",{class:Ua.const("dcg-shared-cookie-notice-learn-more dcg-gray-link"),href:Ua.const("/privacy"),target:Ua.const("_blank")},Ua.const("Learn More."))))}};var{If:Pb,Input:mG,IfElse:L6}=Me.Components,C0=class extends Me.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email="",this.password="",this.isSubmittingForm=!1,this.formErrors=[],this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return Me.createElement(za,{title:()=>this.i18n.s("shared-title-login"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Me.createElement("div",{class:Me.const("dcg-shared-login-dialog dcg-shared-account-dialog")},L6(()=>this.canChooseRole(),{true:()=>Me.createElement("div",{class:Me.const("dcg-shared-switch-account-message")},Me.createElement(ac,{key:this.const("shared-prompt-new-to-desmos-teacher-or-student"),i18n:this.props.controller},Me.const("New to Desmos?"),Me.const(" "),Me.createElement("a",{role:Me.const("link"),tabIndex:Me.const("0"),class:Me.const("dcg-gray-link"),onTap:t=>this.controller.dispatch({type:"show-modal",modal:"signup",device:t.device})},Me.const("Sign up!")))),false:()=>Me.createElement("div",{class:Me.const("dcg-shared-switch-account-message")},Me.createElement(ac,{key:this.const("shared-prompt-new-to-desmos-sign-up-here"),i18n:this.props.controller},Me.const("New to Desmos?"),Me.const(" "),Me.createElement("a",{role:Me.const("link"),tabIndex:Me.const("0"),class:Me.const("dcg-gray-link"),onTap:t=>this.controller.dispatch({type:"show-modal",modal:"signup",device:t.device})},Me.const("Sign up")),Me.const(".")))}),Me.createElement("div",{class:Me.const("dcg-shared-account-content-container")},Me.createElement(Pb,{predicate:()=>window.googleAuthConnectionFailed},()=>Me.createElement("div",{class:Me.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),Me.createElement(Pb,{predicate:()=>!window.googleAuthConnectionFailed},()=>Me.createElement("div",{class:Me.const("dcg-btn-gray-outline dcg-shared-google-login"),role:Me.const("button"),tabIndex:Me.const("0"),onTap:()=>this.googleLogin()},Me.createElement("div",{class:Me.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),Me.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-google")))),Me.createElement(Pb,{predicate:()=>this.controller.allowSignInWithApple()},()=>Me.createElement("div",{class:Me.const("dcg-btn-gray-outline dcg-shared-apple-login"),role:Me.const("button"),tabIndex:Me.const("0"),onTap:()=>this.appleLogin()},Me.createElement("div",{class:Me.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),Me.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-apple"))))),Me.createElement("div",{class:Me.const("dcg-shared-bg-line")},Me.createElement("span",null,()=>this.i18n.s("shared-message-or-login-with-desmos"))),Me.createElement(Ao,{controller:this.props.controller,errors:()=>this.formErrors}),Me.createElement("form",{class:Me.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit)},Me.createElement("div",{class:Me.const("dcg-shared-email-form-container")},Me.createElement("label",null,Me.createElement("span",{class:Me.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),Me.createElement(mG,{type:Me.const("email"),pattern:this.const(Yd),name:Me.const("email"),class:Me.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:Me.const(!0),didMount:t=>{xl||t.focus()},value:()=>this.email,onInput:t=>{this.email=t,this._isMounted&&this.update()}})),Me.createElement("div",{class:Me.const("dcg-shared-password-container")},Me.createElement("label",{for:Me.const("password")},Me.createElement("span",null,()=>this.i18n.s("shared-label-password")),Me.createElement(mG,{type:Me.const("password"),class:Me.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:Me.const("true"),value:()=>this.password,name:this.const("password"),onInput:t=>{if(this.password=t,this._isMounted)return this.update()}}),Me.createElement("span",{class:Me.const("dcg-shared-password-recovery-link")},Me.createElement("a",{role:Me.const("link"),tabIndex:Me.const(0),class:Me.const("dcg-shared-action-password"),onTap:t=>this.controller.dispatch({type:"show-modal",modal:"recover-password",device:t.device})},()=>this.i18n.s("shared-prompt-forgot-your-password"))))),Me.createElement("div",{class:Me.const("dcg-shared-sign-in-options")},Me.createElement(Pb,{predicate:()=>this.isSubmittingForm},()=>Me.createElement("div",{class:Me.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},Me.createElement("div",{class:Me.const("dcg-shared-spinner")}))),Me.createElement(Pb,{predicate:()=>!this.isSubmittingForm},()=>Me.createElement("div",{class:Me.const("dcg-shared-submit-container")},Me.createElement("button",{type:Me.const("submit"),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabIndex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-login-capitalized"))))),Me.createElement(wg,{i18n:this.const(this.i18n)})))))}canChooseRole(){return!this.controller.getLimitedSignupRole()}onSubmit(t){t.preventDefault(),this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"login"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"login"})}submitEnabled(){return!!(this.email&&this.password)}async submitForm(){if(this.submitEnabled()){this.isSubmittingForm=!0,this.formErrors=[];try{let t=await this.controller.userController.checkPendingDeletion({email:this.email,lang:this.controller.getLanguage()});this._pendingDeletion=t.pendingDeletion}catch(t){this._pendingDeletion=!1}this._isMounted&&this.update();try{await this.controller.userController.desmosLogin({email:this.email,password:this.password,lang:this.controller.getLanguage()}),this._pendingDeletion?this.controller.dispatch({type:"show-modal",modal:"account-reenabled",device:"mouse"}):this.controller.dispatch({type:"close-modal"})}catch(t){this.formErrors=this.controller.parseJSONErrors(t)}this._isMounted&&(this.isSubmittingForm=!1,this.controller.dispatch({type:"render"}))}}};var Nr=ut(ft());var{If:P0,Input:N6}=Nr.Components,S0=class extends Nr.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email=this.controller.userController.getEmail(),this.formErrors=[],this.isSubmittingForm=!1,this.didSendRecoveryEmail=!1}template(){return Nr.createElement(za,{title:()=>this.i18n.s("shared-title-recover-password"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Nr.createElement("div",{class:Nr.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},Nr.createElement(Ao,{controller:this.props.controller,errors:()=>this.formErrors}),Nr.createElement(P0,{predicate:()=>this.didSendRecoveryEmail},()=>Nr.createElement("div",{role:Nr.const("alert"),class:Nr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-check-email-for-password-recovery-link"),Nr.const(" "),Nr.createElement("a",{href:Nr.const("#"),class:Nr.const("dcg-blue-link"),onTap:t=>(this.didSendRecoveryEmail=!1,this.controller.dispatch({type:"show-modal",modal:"recover-password",device:t.device}))},()=>this.i18n.s("shared-button-try-again")))),Nr.createElement(P0,{predicate:()=>!this.didSendRecoveryEmail},()=>Nr.createElement("form",{class:Nr.const("dcg-shared-email-form-container"),onSubmit:this.bindFn(this.onSubmit)},Nr.createElement("div",{class:Nr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-prompt-enter-email-for-password-recovery-link")),Nr.createElement("label",null,Nr.createElement("span",{class:Nr.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),Nr.createElement(N6,{type:Nr.const("email"),pattern:this.const(Yd),name:Nr.const("email"),class:Nr.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:Nr.const("true"),didMount:t=>{xl&&t.focus()},value:()=>this.email,onInput:t=>{this.email=t,this._isMounted&&this.update()}})),Nr.createElement("div",{class:Nr.const("dcg-shared-sign-in-options")},Nr.createElement(P0,{predicate:()=>this.isSubmittingForm},()=>Nr.createElement("div",{class:Nr.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},Nr.createElement("div",{class:Nr.const("dcg-shared-spinner")}))),Nr.createElement(P0,{predicate:()=>!this.isSubmittingForm},()=>Nr.createElement("button",{class:()=>({"dcg-btn-blue":!0}),type:Nr.const("submit")},()=>this.i18n.s("shared-button-recover-password"))))))))}onSubmit(t){t.preventDefault(),this.submitForm()}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0;try{if(await this.controller.userController.recoverPassword({email:this.email,lang:this.controller.getLanguage()}),!this._isMounted)return;this.didSendRecoveryEmail=!0}catch(t){if(!this._isMounted)return;this.formErrors=this.controller.parseJSONErrors(t)}finally{this._isMounted&&(this.isSubmittingForm=!1,this.update())}}};var de=ut(ft());var cc=ut(ft()),Ku=class extends cc.Class{template(){return cc.createElement("div",{role:cc.const("checkbox"),tabIndex:()=>this.props.disabled&&this.props.disabled()?-1:0,"aria-label":()=>{var t,r;return(r=(t=this.props).ariaLabel)==null?void 0:r.call(t)},"aria-labelledby":()=>{var t,r;return(r=(t=this.props).labelledBy)==null?void 0:r.call(t)},"aria-describedby":()=>{var t,r;return(r=(t=this.props).describedBy)==null?void 0:r.call(t)},"aria-disabled":()=>this.props.disabled&&this.props.disabled()?!0:void 0,"aria-checked":()=>this.props.checked(),"aria-required":()=>this.props.required?this.props.required():void 0,manageFocus:()=>{var t,r;return(r=(t=this.props).manageFocus)==null?void 0:r.call(t)},class:()=>({"dcg-component-checkbox":!0,"dcg-checked":this.props.checked(),"dcg-disabled":this.props.disabled&&this.props.disabled(),"dcg-small":this.props.small&&this.props.small(),[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0}),style:()=>this.props.style?this.props.style():{},onTap:this.bindFn(this.onChange)},cc.createElement("span",{class:cc.const("dcg-checkbox")},cc.createElement("i",{class:cc.const("dcg-icon-check"),"aria-hidden":cc.const("true")})),cc.createElement("span",{class:cc.const("dcg-checkbox-children")},this.props.children))}onChange(t){let r=t.target;r&&r.getAttribute("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())}};fa();var{If:Sb,Input:M0,Switch:R6}=de.Components,D0=0,JP=1,_0=class extends de.Class{template(){return de.createElement("span",{class:de.const("dcg-shared-terms-notice")},de.createElement(ac,{key:this.const("shared-message-privacy-notice"),i18n:this.props.i18n},de.const("I have read, understand, and accept the"),de.const(" "),de.createElement("a",{href:de.const("/terms"),target:de.const("_blank"),class:de.const("dcg-blue-link")},de.const("Terms of Service")),de.const(" "),de.const("and"),de.const(" "),de.createElement("a",{href:de.const("/privacy"),target:de.const("_blank"),class:de.const("dcg-blue-link")},de.const("Privacy Policy")),de.const(".")))}},A0=class extends de.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.selectedView=D0,this.givenName="",this.familyName="",this.email="",this.password="",this.consentChecked=!1,this.isSubmittingForm=!1,this.formErrors=[],this.breakPoint=660,this.measureWindow(),this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return de.createElement(za,{title:()=>this.i18n.s("shared-title-signup"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},de.createElement("div",{class:()=>({"dcg-shared-signup-dialog":!0,"dcg-shared-account-dialog":!0})},de.createElement("div",{class:de.const("dcg-shared-switch-account-message")},()=>this.i18n.s("shared-prompt-already-have-account"),this.const(this.i18n.raw(" ")),de.createElement("a",{role:de.const("link"),tabIndex:de.const("0"),class:de.const("dcg-gray-link"),onTap:t=>this.controller.dispatch({type:"show-modal",modal:"login",device:t.device})},()=>this.i18n.s("shared-button-login")),de.const(".")),de.createElement("div",{class:de.const("dcg-shared-navigation-tabs"),role:de.const("tablist")},de.createElement("div",{role:de.const("tab"),tabIndex:de.const("0"),"aria-selected":this.bindFn(this.isGoogleSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-profile-view-button":!0,"dcg-selected":this.isGoogleSelected()}),onTap:()=>this.updateView(D0)},this.bindFn(this.externalTitle)),de.createElement("div",{role:de.const("tab"),tabIndex:de.const("0"),"aria-selected":this.bindFn(this.isDesmosSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-password-view-button":!0,"dcg-selected":this.isDesmosSelected()}),onTap:()=>this.updateView(JP)},this.bindFn(this.desmosTitle))),de.createElement("div",{class:de.const("dcg-shared-account-content-container")},de.createElement(R6,{key:()=>this.selectedView},t=>t===D0?de.createElement("div",{class:de.const("dcg-shared-notice-checkbox-google")},de.createElement(Ku,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,this._isMounted)return this.update()}},this.bindFn(this.consentText)),de.createElement(Ku,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,this._isMounted)return this.update()}},de.createElement(_0,{i18n:this.const(this.i18n)})),de.createElement(Sb,{predicate:()=>window.googleAuthConnectionFailed},()=>de.createElement("div",{class:de.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),de.createElement(Sb,{predicate:()=>!window.googleAuthConnectionFailed},()=>de.createElement("div",{class:()=>({"dcg-btn-gray-outline":!0,"dcg-shared-google-login":!0,"dcg-disabled":this.hasNotConsented()}),role:de.const("button"),tabIndex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.googleLogin()},de.createElement("div",{class:de.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),de.createElement("span",null,this.bindFn(this.getGoogleLoginText)))),de.createElement(Sb,{predicate:()=>this.controller.allowSignInWithApple()},()=>de.createElement("div",{class:()=>({"dcg-btn-gray-outline":!0,"dcg-shared-apple-login":!0,"dcg-disabled":this.hasNotConsented()}),role:de.const("button"),tabIndex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.appleLogin()},de.createElement("div",{class:de.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),de.createElement("span",null,this.bindFn(this.getAppleLoginText))))):t===JP?de.createElement("div",null,de.createElement(Ao,{controller:this.props.controller,errors:()=>this.formErrors}),de.createElement("form",{class:de.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit),didMount:this.bindFn(this.didMountForm)},de.createElement("div",{class:de.const("dcg-shared-email-form-container")},de.createElement("label",null,de.createElement("span",{class:de.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),de.createElement(M0,{type:de.const("email"),pattern:this.const(Yd),name:de.const("email"),class:de.const("dcg-shared-input-blue-outline"),required:de.const("true"),"aria-describedby":de.const("email-description"),didMount:r=>{xl||r.focus()},value:()=>this.email,onInput:r=>{if(this.email=r,this._isMounted)return this.update()}})),de.createElement("div",{class:de.const("dcg-shared-name-container")},de.createElement("div",{class:de.const("dcg-shared-name-input")},de.createElement("label",null,de.createElement("span",{class:de.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-given-name-or-nickname")),de.createElement(M0,{type:de.const("text"),name:de.const("given-name"),class:de.const("dcg-shared-input-blue-outline"),required:de.const("true"),"aria-describedby":de.const("given-name-description"),value:()=>this.givenName,onInput:r=>{if(this.givenName=r,this._isMounted)return this.update()}}))),de.createElement("div",{class:de.const("dcg-shared-name-input")},de.createElement("label",null,de.createElement("span",{class:de.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-family-name")),de.createElement(M0,{type:de.const("text"),name:de.const("family-name"),class:de.const("dcg-shared-input-blue-outline"),"aria-describedby":de.const("family-name-description"),value:()=>this.familyName,onInput:r=>{if(this.familyName=r,this._isMounted)return this.update()}})))),de.createElement("label",null,de.createElement("span",null,()=>this.i18n.s("shared-label-password")),de.createElement(M0,{type:de.const("password"),class:de.const("dcg-shared-input-blue-outline"),name:de.const("password"),required:de.const("true"),value:()=>this.password,onInput:r=>{if(this.password=r,this._isMounted)return this.update()}})),de.createElement("div",{class:de.const("dcg-shared-notice-checkbox-email")},de.createElement(Ku,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,this._isMounted)return this.update()}},this.bindFn(this.consentText))),de.createElement(Ku,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,this._isMounted)return this.update()}},de.createElement(_0,{i18n:this.const(this.i18n)})),de.createElement("div",{class:de.const("dcg-shared-sign-in-options")},de.createElement(Sb,{predicate:()=>this.isSubmittingForm},()=>de.createElement("div",{class:de.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},de.createElement("div",{class:de.const("dcg-shared-spinner")}))),de.createElement(Sb,{predicate:()=>!this.isSubmittingForm},()=>de.createElement("div",{class:de.const("dcg-shared-submit-container")},de.createElement("button",{type:de.const("submit"),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabIndex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-create-account")))))))):de.createElement("span",null)),de.createElement(wg,{i18n:this.const(this.i18n)}))))}canSwitchRoles(){return!this.controller.getLimitedSignupRole()}didMountForm(t){this.form=t}submitEnabled(){var i,o,a;if(!this.consentChecked||!this.privacyChecked||!this.form)return!1;let t=(i=this.form.querySelector('[name="password"]'))==null?void 0:i.value,r=(o=this.form.querySelector('[name="email"]'))==null?void 0:o.value,n=(a=this.form.querySelector('[name="given-name"]'))==null?void 0:a.value;return!!(t&&r&&n)}onSubmit(t){t.preventDefault(),this.submitEnabled()&&this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"create"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"create"})}getGoogleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-google"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-google")}getAppleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-apple"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-apple")}async submitForm(){this.formErrors=[],this.isSubmittingForm=!0,this._isMounted&&this.update();try{if(await this.controller.userController.createAccount({userProvidedName:{given:this.givenName,family:this.familyName.length?this.familyName:void 0},email:this.email,password:this.password,teacher:!1,lang:this.controller.getLanguage()}),this._isMounted)return this.controller.dispatch({type:"close-modal"})}catch(t){this.formErrors=this.controller.parseJSONErrors(t)}finally{this.isSubmittingForm=!1,this._isMounted&&this.update()}}updateView(t){this.selectedView=t,this._isMounted&&this.update()}externalTitle(){return this.controller.allowSignInWithApple()?this.windowWidth>this.breakPoint?this.i18n.s("shared-button-external-account-wide"):this.i18n.s("shared-button-external-account-narrow"):this.windowWidth>this.breakPoint?this.i18n.s("shared-button-google-account-wide"):this.i18n.s("shared-button-google-account-narrow")}desmosTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-button-email-address-wide"):this.i18n.s("shared-button-email-address-narrow")}measureWindow(){return this.windowWidth=ze(window).width()}didMount(){ze(window).on("resize.create-account",ub(()=>{this.measureWindow(),this.update()},200))}didUnmount(){ze(window).off("resize.create-account")}consentText(){return this.i18n.s("shared-message-consent-text")}isGoogleSelected(){return this.selectedView===D0}isDesmosSelected(){return this.selectedView===JP}hasNotConsented(){return!this.consentChecked||!this.privacyChecked}};var Kt=ut(ft());function hG(e){return ml("/api/v1/partner_email",e)}var{Input:QP,Textarea:k6,IfElse:V6,If:yG}=Kt.Components,Mb=class extends Kt.Class{init(){this.controller=this.props.controller(),this.emailSendStatus="idle",this.controller.userController.isLoggedIn()&&(this.name=this.controller.userController.getFullName(),this.email=this.controller.userController.getEmail())}template(){return Kt.createElement(za,{title:()=>"Contact Us",size:this.const("medium"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},V6(()=>this.emailSendStatus==="success",{true:()=>Kt.createElement("div",{class:Kt.const("dcg-success-container")},Kt.createElement("i",{class:Kt.const("dcg-icon-check dcg-success-icon"),"aria-hidden":Kt.const("true")}),Kt.createElement("div",{"aria-live":Kt.const("assertive"),"aria-atomic":Kt.const("true")},()=>this.controller.s("frontpage-text-partners-email-sent"))),false:()=>Kt.createElement("form",{onSubmit:this.bindFn(this.submitContactUsForm),class:Kt.const("dcg-partner-form")},Kt.createElement("div",{class:Kt.const("dcg-input-container")},Kt.createElement("label",{for:Kt.const("partner-name")},()=>this.controller.s("frontpage-label-partners-your-name")),Kt.createElement(QP,{type:this.const("text"),name:this.const("partner-name"),id:this.const("partner-name"),class:this.const("dcg-shared-input-blue-outline"),autocomplete:this.const("off"),required:this.const(!0),onInput:t=>this.setUserName(t),value:this.bindFn(this.getUserName),didMount:this.bindFn(this.focusInput)})),Kt.createElement("div",{class:Kt.const("dcg-input-container")},Kt.createElement("label",{for:Kt.const("partner-email")},()=>this.controller.s("frontpage-label-partners-your-email")),Kt.createElement(QP,{type:this.const("email"),name:this.const("partner-email"),id:this.const("partner-email"),class:this.const("dcg-shared-input-blue-outline"),required:this.const(!0),onInput:t=>this.setEmail(t),value:this.bindFn(this.getEmail)})),Kt.createElement("div",{class:Kt.const("dcg-input-container")},Kt.createElement("label",{for:Kt.const("partner-company-website")},()=>this.controller.s("frontpage-label-partners-company-website")),Kt.createElement(QP,{type:this.const("text"),name:this.const("partner-company-website"),id:this.const("partner-company-website"),class:this.const("dcg-shared-input-blue-outline"),onInput:t=>this.setCompany(t),value:this.bindFn(this.getCompany)})),Kt.createElement("div",{class:Kt.const("dcg-input-container")},Kt.createElement("label",{for:Kt.const("partner-details")},()=>this.controller.s("frontpage-label-partners-how-work-with-us")),Kt.createElement(k6,{class:this.const("dcg-shared-input-blue-outline"),name:this.const("partner-details"),id:this.const("partner-details"),value:()=>this.getMessage(),onInput:this.bindFn(this.setMessage),required:this.const(!0)})),Kt.createElement("div",{class:Kt.const("dcg-action-buttons")},Kt.createElement("div",null,Kt.createElement(yG,{predicate:()=>this.emailSendStatus==="sending"},()=>Kt.createElement("div",{"aria-live":Kt.const("assertive"),"aria-atomic":Kt.const("true")},()=>this.controller.s("frontpage-label-partners-sending"))),Kt.createElement(yG,{predicate:()=>this.emailSendStatus==="fail"},()=>Kt.createElement("div",{"aria-live":Kt.const("assertive"),"aria-atomic":Kt.const("true")},()=>this.controller.s("frontpage-error-something-went-wrong-try-again-later")))),Kt.createElement("button",{type:Kt.const("submit"),class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isFormSubmissionDisabled()==="disabled"}),"aria-disabled":this.bindFn(this.isFormSubmissionDisabled)},()=>this.controller.s("frontpage-label-partners-send"))))}))}focusInput(t){t.focus()}getUserName(){return this.name||""}setUserName(t){this.name=t,this.update()}getEmail(){return this.email||""}setEmail(t){this.email=t,this.update()}getCompany(){return this.company||""}setCompany(t){this.company=t,this.update()}getMessage(){return this.message||""}setMessage(t){this.message=t,this.update()}isFormSubmissionDisabled(){if(!this.name||!this.email||!this.message||this.emailSendStatus==="sending")return"disabled"}async submitContactUsForm(t){if(t.preventDefault(),this.isFormSubmissionDisabled()==="disabled")return;this.emailSendStatus="sending",this.update();let r={name:this.getUserName(),email:this.getEmail(),website:this.getCompany(),message:this.getMessage()};try{await hG(r),this.emailSendStatus="success"}catch(n){this.emailSendStatus="fail"}finally{this.update()}}};var{SwitchUnion:F6}=us.Components,O0=class extends us.Class{template(){return F6(()=>this.props.controller().getModal(),{login:()=>us.createElement(C0,{controller:this.props.controller}),signup:()=>us.createElement(A0,{controller:this.props.controller}),"account-reenabled":()=>us.createElement(m0,{controller:this.props.controller}),"recover-password":()=>us.createElement(S0,{controller:this.props.controller}),"account-settings":()=>us.createElement(E0,{controller:this.props.controller}),"change-email":()=>us.createElement(I0,{controller:this.props.controller}),"contest-submission":()=>us.createElement("span",null),"contest-submission-delete":()=>us.createElement("span",null),"partner-contact-us":()=>us.createElement(Mb,{controller:this.props.controller}),none:()=>us.createElement("span",null)})}};var Vs=ut(ft());var ks=ut(ft()),{For:G6}=ks.Components,L0=class extends ks.Class{init(){this.i18n=this.props.i18n()}template(){return ks.createElement("div",{class:()=>({"dcg-language-picker":!0,"dcg-two-columns":this.getLanguages().length>7})},ks.createElement("ul",{class:ks.const("dcg-unstyled-list dcg-languages-list"),role:ks.const("menu")},ks.createElement(G6,{each:()=>this.getLanguages()},t=>ks.createElement("li",{class:()=>({"dcg-listitem":!0,"dcg-language-option":!0,"dcg-selected":this.isLanguageSelected(t)}),lang:this.const(this.getLangCode(t)),role:ks.const("menuitem"),tabIndex:ks.const("0"),"aria-current":()=>this.isLanguageSelected(t),onTap:()=>this.updateLang(t)},()=>this.i18n.raw(this.getLanguageDisplayName(t))))))}getCurrentLang(){return this.props.currentLang()}getLanguages(){return Object.keys(this.props.getAllLangs())}getLanguageDisplayName(t){return this.props.getAllLangs()[t].display_name}updateLang(t){let r=this.props.getAllLangs()[t].code;return this.props.onLangChosen(r)}getLangCode(t){return this.props.getAllLangs()[t].code}isLanguageSelected(t){return this.getLangCode(t)===this.getCurrentLang()}};var{If:B6}=Vs.Components,q6=QV(),z6={en:{code:"en",display_name:"English"},de:{code:"de",display_name:"Deutsch"},es:{code:"es",display_name:"Espa\xF1ol (LATAM)"},et:{code:"et",display_name:"Eesti"},fr:{code:"fr",display_name:"Fran\xE7ais"},"fr-CA":{code:"fr-CA",display_name:"Fran\xE7ais (Canada)"},id:{code:"id",display_name:"Bahasa Indonesia"},it:{code:"it",display_name:"Italiano"},ja:{code:"ja",display_name:"\u65E5\u672C\u8A9E"},ko:{code:"ko",display_name:"\uD55C\uAD6D\uC5B4"},nl:{code:"nl",display_name:"Nederlands"},pl:{code:"pl",display_name:"Polski"},"pt-BR":{code:"pt-BR",display_name:"Portugu\xEAs (Brasil)"},ru:{code:"ru",display_name:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"},"sv-SE":{code:"sv-SE",display_name:"Svenska"},th:{code:"th",display_name:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22"},tr:{code:"tr",display_name:"T\xFCrk\xE7e"},vi:{code:"vi",display_name:"Ti\u1EBFng Vi\u1EC7t"},"zh-CN":{code:"zh-CN",display_name:"\u7B80\u4F53\u4E2D\u6587"},"zh-TW":{code:"zh-TW",display_name:"\u7E41\u9AD4\u4E2D\u6587"}},N0=class extends Vs.Class{init(){this.controller=this.props.controller()}template(){return Vs.createElement(B6,{predicate:this.bindFn(this.isDisplayed)},()=>Vs.createElement(xm,{containerClassName:this.const("dcg-language-picker-container"),anchorAriaLabel:()=>rn("shared-calculator-button-language"),controlled:()=>({isOpen:this.isOpen,setDropdownOpen:this.bindFn(this.setOpen)}),dropdownProps:this.const({position:this.const("bottom-left"),className:this.const("dcg-language-picker-dropdown"),title:()=>rn("shared-title-language-menu")}),dropdownOffset:this.const(-3),guid:this.const("language-picker"),anchor:()=>Vs.createElement("div",{class:Vs.const("dcg-language-picker__anchor-container")},Vs.createElement(Rs,{tooltip:()=>rn("shared-calculator-button-language"),gravity:this.const("s")},Vs.createElement("i",{class:this.const("dcg-icon-world"),"aria-hidden":Vs.const("true")})))},Vs.createElement(L0,{i18n:this.props.controller,getAllLangs:()=>{var t,r;return(r=(t=this.props).showAllLanguages)!=null&&r.call(t)?q6:z6},onLangChosen:this.bindFn(this.onLangChosen),currentLang:()=>this.controller.getLanguage()})))}isDisplayed(){return this.controller.getShowLanguagePicker()}setOpen(t){this.isOpen=t,this.update()}onLangChosen(t){QT(t).then(()=>{this.isOpen=!1,this.controller.dispatch({type:"set-language",language:t})})}};var Eg=ut(ft());var Ql=ut(ft());var R0=class extends Ql.Class{template(){return Ql.createElement("div",{class:Ql.const("dcg-icon-button-container")},Ql.createElement(Rs,{tooltip:this.props.label,gravity:this.props.tooltipGravity},Ql.createElement("i",{role:Ql.const("button"),tabIndex:Ql.const("0"),"aria-label":this.props.label,class:this.props.iconClass,onTap:this.props.onTap,"aria-expanded":()=>{var t,r;return(r=(t=this.props).isExpanded)==null?void 0:r.call(t)}})))}};var{If:U6}=Eg.Components,k0=class extends Eg.Class{template(){return Eg.createElement(U6,{predicate:this.props.isDisplayed},()=>Eg.createElement(R0,{label:()=>rn("shared-calculator-button-print"),iconClass:this.const("dcg-icon-print"),tooltipGravity:this.const("s"),onTap:()=>window.print()}))}};var H6=[{href:"/calculator",name:"2d",text:()=>rn("frontpage-link-shared-graphing-calculator")},{href:"/scientific",name:"scientific",text:()=>rn("frontpage-link-shared-scientific-calculator")},{href:"/fourfunction",name:"fourFunction",text:()=>rn("frontpage-link-shared-four-function-calculator")},{href:"/practice",name:"testMode",text:()=>rn("frontpage-link-shared-test-practice")},{href:"/matrix",name:"matrix",text:()=>rn("frontpage-link-shared-matrix-calculator")},{href:"/geometry",name:"geometry",text:()=>rn("frontpage-link-shared-geometry-tool")}],$6=[{href:"/about",text:()=>rn("frontpage-link-shared-about-us")},{href:"/careers",text:()=>rn("frontpage-link-shared-careers")},{href:"https://help.desmos.com",text:()=>rn("frontpage-link-shared-help-center")},{href:"/accessibility",text:()=>rn("shared-calculator-label-accessibility")},{href:"/testing",text:()=>rn("frontpage-link-shared-assessments")},{href:"/partners",text:()=>rn("frontpage-link-shared-partnerships")},{href:"/equity",text:()=>rn("frontpage-link-shared-equity-principles")},{href:"/guiding-principles",text:()=>rn("frontpage-link-shared-guiding-principles")},{href:"//store.desmos.com",text:()=>rn("frontpage-link-shared-store")},{href:"https://blog.desmos.com",text:()=>rn("frontpage-link-shared-blog")}],Db={MATH_TOOLS:{links:H6,title:()=>rn("frontpage-link-header-math-tools")},RESOURCES:{links:$6,title:()=>rn("frontpage-link-header-resources")}};var{If:Tm,Each:bG}=fe.Components,Y6=0,_b=class extends fe.Class{init(){this.id=Y6++}getUniqueName(){return`header-link-${this.id}`}getContainerClassName(){var t,r;return(r=(t=this.props).mathToolsMenu)!=null&&r.call(t)?"dcg-header-link dcg-math-tools":"dcg-header-link"}template(){return fe.createElement(xm,{guid:this.bindFn(this.getUniqueName),anchor:()=>fe.createElement("span",{class:fe.const("dcg-header-link-title-container")},this.props.title,fe.createElement("i",{class:fe.const("dcg-icon-caret-down"),"aria-hidden":fe.const("true")})),anchorAriaLabel:this.props.ariaLabel,containerClassName:this.bindFn(this.getContainerClassName),dropdownProps:this.const({position:this.const("bottom-left")})},this.props.children)}},V0=class extends fe.Class{init(){this.controller=this.props.controller()}template(){return fe.createElement("header",{class:fe.const("dcg-header-container"),didMount:this.bindFn(this.didMountRoot),didUnmount:this.bindFn(this.didUnmountRoot)},fe.createElement(Tm,{predicate:()=>this.controller.shouldShowUpcomingMaintenanceNotice()},()=>fe.createElement("div",{role:fe.const("banner"),class:fe.const("dcg-top-banner")},fe.createElement("i",{class:fe.const("dcg-icon-maintenance"),"aria-hidden":fe.const("true")}),()=>iG(this.controller.getLanguage(),this.controller.s),fe.const(" "),fe.createElement("a",{role:fe.const("link"),tabIndex:fe.const(0),target:fe.const("_blank"),href:fe.const("https://help.desmos.com/hc/en-us/articles/29072368846093-Maintenance-Mode")},()=>this.controller.s("graphing-calculator-link-learn-more")))),fe.createElement(Tm,{predicate:()=>this.controller.shouldShowTopBanner()},()=>fe.createElement("div",{role:fe.const("banner"),class:fe.const("dcg-top-banner")},()=>this.controller.s("frontpage-text-header-terms-update"),fe.createElement("a",{class:fe.const("dcg-primary-link"),target:fe.const("_blank"),href:fe.const("https://blog.desmos.com/articles/desmos-studio-terms-update/")},()=>this.controller.s("frontpage-text-header-terms-update-link")))),fe.createElement("div",{class:fe.const("dcg-main-header-container")},fe.createElement("div",{class:fe.const("dcg-header-left-content")},fe.createElement("a",{class:fe.const("dcg-home-link"),href:fe.const("/")},fe.createElement(e0,null))),fe.createElement("nav",{class:fe.const("dcg-header-center-content")},fe.createElement(_b,{title:Db.MATH_TOOLS.title,mathToolsMenu:()=>!0},fe.createElement("ul",{class:fe.const("dcg-unstyled-list")},bG(()=>Db.MATH_TOOLS.links,{item:({href:t,name:r,text:n})=>fe.createElement("li",null,fe.createElement("a",{href:this.const(t),class:fe.const("dcg-dropdown-link dcg-shared-product-icon-container")},fe.createElement("div",{class:fe.const("dcg-math-tool-icon-container")},fe.createElement(Ib,{name:()=>r,ariaHidden:this.const("true")})),fe.createElement("span",{class:fe.const("dcg-dropdown-text")},n))),key:({href:t})=>t}),fe.createElement("li",null,fe.createElement("a",{href:fe.const("/3d"),class:fe.const("dcg-dropdown-link dcg-shared-product-icon-container")},fe.createElement("div",{class:fe.const("dcg-math-tool-icon-container")},fe.createElement(Ib,{name:this.const("3d"),ariaHidden:this.const("true")})),fe.createElement("span",{class:fe.const("dcg-dropdown-text")},()=>this.controller.s("frontpage-link-shared-3d-calculator")))),fe.createElement("li",{class:fe.const("dcg-app-links")},fe.createElement(ac,{i18n:this.const(this.controller),key:this.const("frontpage-text-header-app-links")},fe.const("Download our apps in the"),fe.const(" "),fe.createElement("a",{class:fe.const("dcg-primary-link"),href:fe.const("https://play.google.com/store/apps/developer?id=Desmos+Inc")},fe.const("Google Play Store")),fe.const(" "),fe.const("and"),fe.const(" "),fe.createElement("a",{class:fe.const("dcg-primary-link"),href:fe.const("https://apps.apple.com/us/developer/desmos/id653517543")},fe.const("iOS App Store")),fe.const("."))))),fe.createElement(_b,{title:Db.RESOURCES.title},fe.createElement("ul",{class:fe.const("dcg-unstyled-list")},bG(()=>Db.RESOURCES.links,{item:({href:t,text:r})=>fe.createElement("li",null,fe.createElement("a",{href:this.const(t),class:fe.const("dcg-dropdown-link")},r)),key:({href:t})=>t})))),fe.createElement("div",{class:fe.const("dcg-header-right-content")},fe.createElement(Tm,{predicate:()=>!this.hideAccounts()},()=>fe.createElement("div",null,fe.createElement(Tm,{predicate:()=>this.controller.userController.getLoginStatus()==="not-checked"},()=>fe.createElement("div",{class:fe.const("dcg-account-container")})),fe.createElement(Tm,{predicate:()=>this.controller.userController.getLoginStatus()==="logged-out"},()=>fe.createElement("div",{class:fe.const("dcg-account-container")},fe.createElement("div",{role:fe.const("link"),tabIndex:fe.const("0"),class:fe.const("dcg-log-in"),onTap:t=>{this.controller.dispatch({type:"show-modal",modal:"login",device:t.device})}},()=>this.controller.s("frontpage-link-shared-log-in")))),fe.createElement(Tm,{predicate:()=>this.controller.userController.getLoginStatus()==="logged-in"},()=>fe.createElement("div",{class:fe.const("dcg-account-dropdown-container")},fe.createElement(_b,{title:()=>this.controller.userController.getFirstName(),ariaLabel:()=>this.controller.s("frontpage-button-account-menu")},fe.createElement("ul",{class:fe.const("dcg-unstyled-list")},fe.createElement("li",{class:fe.const("dcg-user-name")},()=>this.controller.userController.getFullName()),fe.createElement("li",{class:fe.const("dcg-email")},()=>this.controller.userController.getEmail()),fe.createElement("li",null,fe.createElement("div",{onTap:t=>{this.controller.dispatch({type:"show-modal",modal:"account-settings",device:t.device})},role:fe.const("link"),tabIndex:fe.const(0),class:fe.const("dcg-dropdown-link")},()=>this.controller.s("frontpage-link-shared-account-settings"))),fe.createElement("div",{class:fe.const("dcg-line-divider")}),fe.createElement("li",null,fe.createElement("div",{onTap:()=>this.controller.userController.logout(),role:fe.const("link"),tabIndex:fe.const(0),class:fe.const("dcg-dropdown-link")},()=>this.controller.s("frontpage-link-shared-log-out"))))))))),fe.createElement(N0,{controller:this.props.controller,showAllLanguages:this.props.showAllLanguages}),fe.createElement(k0,{isDisplayed:this.bindFn(this.shouldShowPrintIcon)}))),fe.createElement(O0,{controller:this.props.controller}))}didMountRoot(t){this.observer=new IntersectionObserver(([r])=>r.target.classList.toggle("dcg-is-pinned",r.intersectionRatio<1),{threshold:[1]}),this.observer.observe(t)}didUnmountRoot(){this.observer.disconnect()}hideAccounts(){return this.props.hideAccounts&&this.props.hideAccounts()}shouldShowPrintIcon(){var t,r;return!!((r=(t=this.props).showPrintIcon)!=null&&r.call(t))}};var F0=class extends ma.Class{template(){return ma.createElement("div",{id:ma.const("navigation"),role:ma.const("navigation")},ma.createElement(V0,{controller:this.props.controller,showPrintIcon:this.props.showPrintIcon,showAllLanguages:this.const(!0)}),ma.createElement("div",{class:ma.const("dcg-basic-calculator-footer")},ma.createElement("a",{href:ma.const("/terms")},()=>rn("basic-calculator-link-terms-of-service")),ma.const("|"),ma.createElement("a",{href:ma.const("/privacy")},()=>rn("basic-calculator-link-privacy-policy")),ma.const("|"),ma.createElement("a",{href:this.props.helpLink},()=>rn("basic-calculator-link-help"))))}};fa();function tS(e){return Ab(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function Ab(e){return typeof e=="string"&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}function xG(e){if(e=e.replace(/#/,""),e.length===3)var t=parseInt(e.slice(0,1)+e.slice(0,1),16),r=parseInt(e.slice(1,2)+e.slice(1,2),16),n=parseInt(e.slice(2,3)+e.slice(2,3),16);else if(e.length===6)var t=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);else var t=0,r=0,n=0;return{r:t,g:r,b:n}}function ju(e,t){if(t&&t.colorLatexValue){var r=t.colorLatexValue;return Array.isArray(r)?r[0]:r}return e.color}function eS(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function vG(e){let t=xG(e);return[eS(t.r/255),eS(t.g/255),eS(t.b/255)]}var ha={RED:"#c74440",BLUE:"#2d70b3",GREEN:"#388c46",PURPLE:"#6042a6",ORANGE:"#fa7e19",BLACK:"#000000",GRAY:"#aaaaaa",FOCUS_OUTLINE:"#6a93d2"},Mpe={RED:ha.RED,BLUE:ha.BLUE,GREEN:ha.GREEN,ORANGE:ha.ORANGE,PURPLE:ha.PURPLE,GRAY:ha.GRAY};var IC=ut(ft());Bd();fa();var Ope=function(){{var e="_*_";ze.Event.prototype.wasHandled=function(t){t=t||e;var r=this.originalEvent,n=r&&r.handledBy;if(n&&n[t])return!0;if(t!==e)return!1;var i=this.target.closest("[handleEvent]");return i&&i!==this.currentTarget?i.getAttribute("handleEvent")!=="false":!1},ze.Event.prototype.handle=function(t){t=t||e;var r=this.originalEvent;if(r){var n=r.handledBy;n||(n=r.handledBy={}),n[t]=!0}}}}();var Ec=ut(ft());fa();fa();var X6=document.location.href.indexOf("dcgDebugTouchTracking=dcgYES")!==-1,Wd,wm;window._touchtracking_id_counter==null&&(window._touchtracking_id_counter=0);window._touchtracking_id_counter+=1;var Lb="touchtracking_id_"+window._touchtracking_id_counter,fi=function(e){wm&&(wm.value="("+Date.now()+") "+e+`
`+wm.value)};function Nb(e){if(e.classList.add("dcg-tap-container",Lb),X6){Wd&&Wd.remove(),Wd=document.createElement("div"),Xu(Wd,{position:"absolute",bottom:"10px",right:"10px"});let t=document.createElement("textarea");t.setAttribute("rows","30"),t.setAttribute("cols","40"),Wd.append(t);let r=document.createElement("div");r.id="dcg-touchtracking-debug-copy",r.classList.add("dcg-btn-blue"),r.innerText="COPY LOGS",Wd.append(r),wm=Wd.querySelector("textarea"),e.append(Wd),r.addEventListener("mousedown",function(){wm&&(wm.select(),document.execCommand("copy"))},!0),fi("monitor touches")}}var Cm=0,Lc=1,Rb=2,Em=3,Ju=4,Hr=Cm,rS={},vl={},Zu=[],nS=0,Ob=null,B0=null,Ig=!1,G0=null,TG=Ig,Xd=function(e){let t=document.activeElement;e.type.startsWith("key")?l0(e)||(Ig=!0):e.type.startsWith("pointer")&&(Ig=!1);let r=!!(t&&kb(t));t&&!t.closest(".dcg-tap-container."+Lb)&&(t=null),t!==G0?(G0&&G0.classList.remove("dcg-focus-visible"),t&&(Ig||r)&&t.classList.add("dcg-focus-visible")):TG!==Ig&&t&&!r&&(Ig?t.classList.add("dcg-focus-visible"):t.classList.remove("dcg-focus-visible")),TG=Ig,G0=t};document.addEventListener("keydown",Xd,{capture:!0});document.addEventListener("keydown",Xd);document.addEventListener("pointerdown",Xd);document.addEventListener("pointerdown",Xd,{capture:!0});document.addEventListener("focusin",Xd,{capture:!0});document.addEventListener("focusin",Xd);document.addEventListener("focusout",Xd,{capture:!0});document.addEventListener("focusout",Xd);var wG,Fs=[],iS=function(e){if(!(e instanceof Element))return[];let t=e.closest(".dcg-tap-container."+Lb);if(!t)return[];let r=e,n=[];for(;r;){if(n.push(r),r===t)return n;r=r.parentNode}return[]},q0=function(e,t){B0=null,Hr=e,fi("beginMode:"+Hr),Hr===Lc?Zu=iS(t.originalEvent.touches[0].target):Zu=iS(t.target),Zu.forEach(r=>{r.classList.add("dcg-depressed")}),Zu.forEach(function(r){let n=ze(r);n.data({originalScrollTop:n.scrollTop(),originalScrollLeft:n.scrollLeft()})}),vl={}};function kb(e){let t=["text","password","email","number","url","search"];return e.matches("input")&&t.indexOf(e.type)>=0||e.matches('textarea, [role="textbox"], [contenteditable=true]')||e.classList.contains("dcg-mathquill-input-span")}var Pm=function(e){if(!(e instanceof Element))return!1;let t=e.closest(".dcg-tap-container");return t?t.matches(".dcg-tap-container."+Lb):!1},K6=function(e){return Hr!==Em&&!kb(e)&&Pm(e)},Sm=function(e,t){B0=null;let r=!1;fi("endMode:"+Hr),document.querySelectorAll(".dcg-depressed").forEach(i=>{i.classList.remove("dcg-depressed")});let n=document.activeElement;if(!DG(e.target)&&n&&K6(n))try{n.blur()}catch(i){}if(Zu.forEach(function(i){let o=ze(i),a=o.data("originalScrollTop")-o.scrollTop(),s=o.data("originalScrollLeft")-o.scrollLeft();(a||s)&&(vl.scroll=!0)}),vl["dcg-tapstart"]===1&&vl["dcg-tapend"]===1&&!vl["dcg-tapcancel"]&&!vl.scroll){fi("potential dcg-tap");let i=t.changedTouches[0].clientX,o=t.changedTouches[0].clientY;if(e&&!e.device&&i===0&&o===0){fi("event appears to be simulated"),r=!0,Hr=Em;let c=e.target.getBoundingClientRect();i=(c.left+c.right)/2,o=(c.top+c.bottom)/2}fi("potential dcg-tap coords:"+i+":"+o);let a=!1,s=!1;for(let c of Zu){if(a)break;let l;if(typeof c.getBoundingClientRect=="function"&&(l=c.getBoundingClientRect()),typeof c.getAttribute=="function"&&c.getAttribute("tapboundary")==="true"&&(a=!0),!(l&&(i<l.left||o<l.top||i>l.right||o>l.bottom))){B0=c,s=!0,ds("dcg-tap",e,{target:B0,touches:t.touches,changedTouches:t.changedTouches});break}}fi("result of dcg-tap:  did_dispatch="+s+"  did_escape="+a)}Hr===Lc||Hr===Ju?Ob=setTimeout(function(){Ob=null,nS=new Date().getTime()},1e3):r&&(Ob=setTimeout(function(){Ob=null,nS=new Date().getTime()},100)),Zu=[],Hr=Cm},Im=function(){return Ob||new Date().getTime()-nS<500},PG=function(e){return e.identifier!==void 0?e.identifier:e.pointerId},EG=function(e){let t=[];for(let r of e)t.push({identifier:PG(r),x:r.pageX,y:r.pageY,screenX:r.screenX,screenY:r.screenY,pageX:r.pageX,pageY:r.pageY,clientX:r.clientX,clientY:r.clientY});return t},ds=function(e,t,r){let n=PG(t),i=EG(r.touches),o=EG(r.changedTouches);if(fi("dispatchEvent:"+e),e==="dcg-tapstart")rS[n]={type:e,pageX:o[0].pageX,pageY:o[0].pageY};else if(e==="dcg-tapmove"){let l=o[0],u=rS[n];if(u&&l.pageX===u.pageX&&l.pageY===u.pageY||(Hr===Lc||Hr===Ju)&&u&&u.type==="dcg-tapstart"&&Math.abs(u.pageX-l.pageX)+Math.abs(u.pageY-l.pageY)<2)return;rS[n]={type:e,pageX:o[0].pageX,pageY:o[0].pageY}}let a=e.toLowerCase();vl[a]===void 0?vl[a]=1:vl[a]+=1;let s=ze.event.fix(t.originalEvent);s.type=e,s.device=Hr===Lc||Hr===Ju?"touch":Hr===Em?"keyboard":"mouse",s.touches=i,s.changedTouches=o,s.target=r.target?r.target:t.target;let c=s.device!=="keyboard"&&vl["dcg-longhold"]>0;s.wasLongheld=function(){return c},s.preventTap=function(){vl["dcg-tapcancel"]=1},clearTimeout(wG),s.type==="dcg-tapstart"&&s.device!=="keyboard"&&s.touches.length===1&&(wG=setTimeout(function(){ds("dcg-longhold",t,r)},500)),s.target&&s.target.nodeName&&s.target.nodeName.toLowerCase()==="a"&&s.type==="dcg-tap"&&s.device==="keyboard"&&s.target.click&&s.target.click(),fi("trigger event:"+s.type),ze(s.target).trigger(s)},z0=function(e){let t=Zu,r=!!Zu.length,n=document.querySelectorAll(".dcg-tap-container."+Lb+" .dcg-hovered"),i=Array.from(n).filter(Pm),o=[],a=[],s=[];e&&iS(e).forEach(function(c){(!r||t.indexOf(c)!==-1)&&(i.indexOf(c)===-1&&s.push(c),o.push(c))});for(let c of i)o.indexOf(c)===-1&&a.push(c);a.forEach(c=>{c&&c.classList.remove("dcg-hovered"),ze(c).trigger("tipsyhide")}),s.forEach(c=>{c&&c.classList.add("dcg-hovered"),ze(c).trigger("tipsyshow")})},U0=function(e){for(let t of Fs)if(t.pointerId===e)return!0;return!1},oS=function(e){for(let t=0;t<Fs.length;t++)Fs[t].pointerId===e&&Fs.splice(t,1)},SG=function(e){Hr===Cm&&q0(Ju,e),z0(null),Fs.push(e.originalEvent),ds("dcg-tapstart",e,{touches:Fs,changedTouches:[e.originalEvent]})},IG=function(e){oS(e.originalEvent.pointerId);let t={touches:Fs,changedTouches:[e.originalEvent]};ds("dcg-tapcancel",e,t),Fs.length===0&&Sm(e,t)},CG=function(e){oS(e.originalEvent.pointerId);let t={touches:Fs,changedTouches:[e.originalEvent]};ds("dcg-tapend",e,t),Fs.length===0&&Sm(e,t)},H0=function(e){return e.originalEvent.pointerType==="touch"},Mm=function(e,t){e.trim().split(/\s+/).forEach(function(r){let n=j6?{passive:!1}:void 0;document.addEventListener(r,function(i){fi("document.on:"+i.type),t(ze.event.fix(i))},n)})};Mm("pointerdown MSPointerDown",function(e){if(!(Hr===Rb||Hr===Lc||!H0(e))){if(U0(e.originalEvent.pointerId)){fi("exit. pointer id already exists: "+e.originalEvent.pointerId);return}SG(e)}});Mm("pointermove MSPointerMove",function(e){Hr===Rb||Hr===Lc||!H0(e)||(U0(e.originalEvent.pointerId)||(fi("pointer id already exists: "+e.originalEvent.pointerId),SG(e)),oS(e.originalEvent.pointerId),Fs.push(e.originalEvent),ds("dcg-tapmove",e,{touches:Fs,changedTouches:[e.originalEvent]}))});ze(document).on("pointercancel MSPointerCancel",function(e){if(fi("document.on:"+e.type),Hr!==Ju||!H0(e)||!U0(e.originalEvent.pointerId))return;IG(e);let t;for(;t=Fs.pop();){let r=ze.Event(t,{originalEvent:t});IG(r)}});ze(document).on("pointerup MSPointerUp",function(e){if(fi("document.on:"+e.type),Hr!==Ju||!H0(e)||!U0(e.originalEvent.pointerId))return;CG(e);let t;for(;t=Fs.pop();){let r=ze.Event(t,{originalEvent:t});CG(r)}});var j6=function(){let e=!1;try{let t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",function(){},t),window.removeEventListener("test",function(){},t)}catch(t){}return e}();Mm("touchstart",function(e){Hr===Rb||Hr===Ju||(Hr===Cm&&q0(Lc,e),z0(null),ds("dcg-tapstart",e,{touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches}))});Mm("touchmove",function(e){Hr===Lc&&ds("dcg-tapmove",e,{touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches})});Mm("touchcancel",function(e){if(Hr!==Lc)return;let t={touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches};ds("dcg-tapcancel",e,t),e.originalEvent.touches.length===0&&Sm(e,t)});Mm("touchend",function(e){if(Hr!==Lc)return;let t={touches:e.originalEvent.touches,changedTouches:e.originalEvent.changedTouches};ds("dcg-tapend",e,t),e.originalEvent.touches.length===0&&Sm(e,t)});function MG(){return!!(Hr===Lc||Hr===Ju||Im())}ze(document).on("mousedown",function(e){if(fi("document.on:"+e.type),!(e.button===1||e.button===2)){if(MG()){!e.target.matches("input, textarea, select")&&Pm(e.target)&&e.preventDefault(),fi("abort mousedown: "+Hr+":"+Im());return}q0(Rb,e),ds("dcg-tapstart",e,{touches:[e],changedTouches:[e]})}});var DG=function(e){if(!(e instanceof Element))return!1;let t=!!e.closest(".dcg-do-not-blur"),r=!!e.closest(".dcg-do-blur");return!!(t&&!r&&Pm(e))};ze(document).on("mousedown",function(e){if(fi("document.on:"+e.type),!!DG(e.target)){e.preventDefault();try{let t=window.getSelection();if(t.rangeCount===1){let r=t.getRangeAt(0);r.startContainer===r.endContainer&&r.startContainer.closest(".dcg-text-selectable")&&t.removeAllRanges()}}catch(t){}}});ze(document).on("mouseleave",function(e){if(fi("document.on:"+e.type),Hr===Cm){if(Im()){fi("abort mouseleave: "+Hr+":"+Im());return}z0(null)}});ze(document).on("mousemove",function(e){if(fi("document.on:"+e.type),!(e.button===1||e.button===2)&&!(Hr===Lc||Hr===Ju)){if(Im()){fi("abort mousemove: "+Hr+":"+Im());return}z0(e.target),ds("dcg-tapmove",e,{touches:[e],changedTouches:[e]})}});ze(document).on("mouseup",function(e){if(fi("document.on:"+e.type),e.button===1||e.button===2||Hr!==Rb)return;let t={touches:[],changedTouches:[e]};ds("dcg-tapend",e,t),Sm(e,t)});ze(document).on("keydown",function(e){if(fi("document.on:"+e.type),!(!Eb(e)||!Pm(e.target))&&Hr!==Em){if(e.target.matches('a:not([ontap]), button:not([ontap]), input, textarea, select, [role="textbox"], [contenteditable="true"], summary'))return;e.preventDefault(),q0(Em,e),ds("dcg-tapstart",e,{touches:[e],changedTouches:[e]})}});ze(document).on("keyup",function(e){if(fi("document.on:"+e.type),!Eb(e)||!Pm(e.target)||Hr!==Em)return;let t={touches:[],changedTouches:[e]};ds("dcg-tapend",e,t),Sm(e,t)});function Z6(){return Hr!==Cm}var _G={monitor:Nb,isTapActive:Z6,elIsTypeable:kb,shouldIgnoreMouseDown:MG};var Jpe=ut(OG());fa();var LG={real:!0,imag:!0,conj:!0,arg:!0};var NG={segment:!0,line:!0,ray:!0,circle:!0,arc:!0,vector:!0,glider:!0,parallel:!0,perpendicular:!0,center:!0,radius:!0,area:!0,perimeter:!0,start:!0,end:!0,angles:!0,angle:!0,directedangles:!0,directedangle:!0,coterminal:!0,supplement:!0,vertices:!0,segments:!0,intersection:!0,strictintersection:!0,translate:!0,dilate:!0,rotate:!0,reflect:!0,construction:!0,points:!0,lines:!0,circles:!0,arcs:!0,polygons:!0,rays:!0,anglebisector:!0};var J6={"+":!0,"-":!0,"*":!0,"\\cdot":!0,"\\times":!0,"/":!0,"!":!0,"(":!0,")":!0,"\\{":!0,"\\}":!0,"(|":!0,"|)":!0,"[":!0,"]":!0,",":!0,"...":!0,":":!0,"=":!0,">":!0,"<":!0,">=":!0,"<=":!0,"->":!0,"~":!0,"%":!0,".":!0,for:!0,with:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0};var eu={"\\lt":"<","\\gt":">","\\le":"<=","\\ge":">=","\\leq":"<=","\\geq":">=","\\ldots":"...","\\sim":"~","\\to":"->","\\cdot":"\\cdot","\\times":"\\times","\\div":"/","\\ln":"Ln","\\log":"Log","\\int":"Int","\\sum":"Sum","\\prod":"Prod","\\backslash":"Err","\\for":"for","\\with":"with"},Q6=["sin","cos","tan","cot","sec","csc"];for(let e of Q6)eu["\\"+e]="Trig",eu["\\"+e+"h"]="Trig",eu["\\arc"+e]="Trig",eu["\\arc"+e+"h"]="Trig",eu["\\ar"+e+"h"]="Trig";var aS={"+":"+","-":"-","*":"*","/":"/","!":"!","(":"(",")":")","[":"[","]":"]",",":",","...":"...",":":":","=":"=",">=":">=","<=":"<=",">":">","<":"<","~":"~",".":"."},RG={"\\{":"\\{","\\}":"\\}","\\%":"%"},kG={"|":"(|","\\{":"\\{","[":"[","(":"("},VG={"|":"|)","\\}":"\\}","]":"]",")":")"},FG=Object.keys(J6);var GG={segment:!0,triangle:!0,vector:!0,start:!0,end:!0,sphere:!0};var BG=["exp|exponent ln|natural-log log","total length count mean median quantile quartile nCr nPr stats","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent","arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant","arcoth|hyperbolic-ar-co-tangent","polygon","distance midpoint","sort shuffle join unique","erf|error-function","TTest|t-test ttest|t-test TScore|t-score tscore|t-score","iTTest|independent-t-test ittest|independent-t-test IndependentTTest","TScore|t-score Tscore|t-score tscore|t-score","normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution","binomialdist|binomial-distribution","uniformdist|uniform-distribution","pdf cdf random inverseCdf inversecdf","histogram dotplot boxplot","pdf cdf","rgb hsv","for","width height","with"].join(" "),e9=["det|determinant","inv|inverse","transpose","rref|reduced-row-echelon-form","trace"].join(" ");BG+=" "+e9;var t9="alpha beta sqrt theta phi rho pi tau nthroot cbrt sum prod integral percent infinity infty cross";function Y0(e){e||(e={});let t=[t9];return e.disallowAns||t.push("ans"),e.disallowFrac||t.push("frac"),e.additionalCommands&&(t=t.concat(e.additionalCommands)),t.join(" ")}function r9(e){e||(e={});let t=BG;return e.additionalOperators&&e.additionalOperators.length&&(t=`${t} ${e.additionalOperators.join(" ")}`),e.includeGeometryFunctions&&(t+=" "+Object.keys(NG).join(" ")),e.include3DFunctions&&(t+=" "+Object.keys(GG).join(" ")),e.includeComplexFunctions&&(t+=" "+Object.keys(LG).join(" ")),t}function n9(){return"for with"}function i9(){let e="ln log";for(let[t,r]of Object.entries(eu))r=="Trig"&&(e+=" "+t.replace(/^\\/,""));return e}function W0(e){return{autoOperatorNames:r9(e),infixOperatorNames:n9(),prefixOperatorNames:i9()}}var qG=window.MathQuill.noConflict().getInterface(3);qG.config({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>*",autoCommands:Y0(),autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(){if(!i0&&(Tg||Tb)){let t=document.createElement("span");return t.classList.add("dcg-mathquill-input-span"),t.setAttribute("tabindex","0"),t.setAttribute("role","textbox"),Xu(t,{display:"inline-block",height:"1px",width:"1px"}),t}if(kF&&VF){let t=document.createElement("textarea");return t.setAttribute("readonly",""),t.setAttribute("inputmode","none"),t.setAttribute("autocorrect","off"),t.setAttribute("autocapitalize","none"),t.setAttribute("spellcheck","false"),t.setAttribute("autocomplete","off"),ze(t).on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0}),t}let e=document.createElement("textarea");return e.setAttribute("inputmode","none"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","none"),e.setAttribute("spellcheck","false"),e.setAttribute("autocomplete","off"),e},...W0(),quietEmptyDelimiters:"( [",resetCursorOnBlur:!0,enableDigitGrouping:!0,tripleDotsAreEllipsis:!0,disableAutoSubstitutionInSubscripts:!0,interpretTildeAsSim:!0});var Kd=qG;function zG(e){return 48<=e&&e<=57}function a9(e){return 97<=e&&e<=122}function s9(e){return 65<=e&&e<=90}function X0(e){return a9(e)||s9(e)}function K0(e){return e===92}function sS(e){return e===39}function UG(e){if(9<=e&&e<=13||8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}function Ha(e,t,r){return{input:e,start:t,end:r}}function Tl(e,t){return Ha(e,t,t)}function $a(e,t){if(e.input!==t.input)throw new Error("Programming Error: cannot form a span on different inputs");return Ha(e.input,e.start,t.end)}function Jn(e){return e.input.slice(e.start,e.end)}function Zd(e,t){return $a(e.token.span,t.prevSpan)}function jd(e,t,r){return{type:e,span:t,val:r}}function c9(e,t,r,n){return{input:e,prevSpan:t,pos:r,token:n}}function j0(e){return $G(e,0,Tl(e,0))}function $G(e,t,r){for(;UG(e.charCodeAt(t));)t+=1;let n=d9(e,t);return c9(e,r,t,n)}function lc(e){return $G(e.input,e.token.span.end,e.token.span)}function ps(e){return e.token}function tu(e,t){if(ps(e).type!==t)throw`Parse Error: expected ${t}.`;return lc(e)}function YG(e,t){return ps(e).type===t}function Dm(e){return e.pos>=e.input.length}var l9={"\\left":"Left","\\right":"Right","\\sqrt":"Sqrt","\\frac":"Frac","\\operatorname":"OperatorName","\\token":"Token"},u9={"[":"[","]":"]","{":"{","}":"}","^":"^",_:"_"};function d9(e,t){let r=t;if(t>=e.length)return jd("End",Tl(e,t),"");let n=e.charCodeAt(t);if(zG(n)){let i=Ha(e,r,t+1);return jd("Digit",i,e.charAt(r))}else if(X0(n)){let i=Ha(e,r,t+1);return jd("Letter",i,e.charAt(r))}else if(K0(n))if(t+=1,X0(e.charCodeAt(t))){for(;X0(e.charCodeAt(t));)t+=1;let i=Ha(e,r,t),o=Jn(i),a=l9[o]||"Cmd";return jd(a,i,o)}else{t+=1;let i=Ha(e,r,t),o=Jn(i);return jd("EscapedSymbol",i,o)}else if(sS(n)){for(t+=1;sS(e.charCodeAt(t));)t+=1;if(e.charAt(t)==="^"){t+=1;let i=Ha(e,r,t),o=Jn(i);return jd("Primes^",i,o)}else{let i=Ha(e,r,t),o=Jn(i);return jd("Primes",i,o)}}else{let i=Ha(e,r,t+1),o=e.charAt(r),a=u9[o]||"Symbol";return jd(a,i,o)}}function Z0(e){let t=j0(e),r=0;for(;!Dm(t);)r+=1,t=lc(t);return r}var o8=ut(ft());var io=ut(ft());function J0(e,t){return t?Qn(e):e}function Nc(e,t){return e===Rt&&xe(t)||t===vn&&xe(e)||t===nn&&!xe(e)?!0:e===t}function Li(e,t){if(e===void 0)return!1;if(Nc(e,t))return!0;xe(e)&&xe(t)&&t!==Rt&&(e=It(e),t=It(t));let r=t;switch(e){case st:case $e:case ir:case C:case $:return r===C||r===$;default:return!1}}function _m(e,t){return t===C&&e===$||t===ke&&e===Dn?!1:Li(e,t)}function Cg(e,t){if(Nc(e,t))return t;if(Nc(t,e))return e;let r=xe(e);if(r!=xe(t))return;let n=J0($,r);if(e===n&&Li(t,n))return n;if(t===n&&Li(e,n))return n;let i=J0(C,r);if(Li(e,i)&&Li(t,i)){let o=J0(st,r),a=J0($e,r);return e===o&&t===a||e===a&&t===o?void 0:i}}function Jd(e,t){return xe(e)&&ei(t)?Cg(e,Qn(t)):ei(e)&&xe(t)?Cg(Qn(e),t):Cg(e,t)}function L(e,t){return{key:e,vars:t}}var nn=0,C=1,tt=2,z=3,cr=4,nr=5,vn=6,ke=7,vi=8,on=9,Ti=10,Rt=11,wl=12,lr=13,gn=14,uo=15,et=16,ti=17,Ye=18,zn=19,We=20,wi=21,Oe=22,ci=23,Re=24,Ei=25,ot=26,li=27,st=28,Un=29,$e=30,ri=31,xt=32,Oo=33,Ve=34,Ii=35,ir=36,gs=37,$=38,Dn=39,In=50,Lo=51,oe=100,ji=101,Mr=102,Zi=103,Hn=104,Ji=105,$n=106,No=107,Pt=108,Qi=109,Ni=200,Ri=201,po=202,go=203,jo=204,Zo=205,Jo=206,Qo=207,ki=208,fo=209,ea=210,ta=211,p9={Any:nn,Number:C,Bool:tt,Complex:$,ListOfComplex:Dn,Point:z,Point3D:oe,Distribution:cr,Action:nr,ListOfAny:vn,ListOfNumber:ke,ListOfBool:vi,ListOfPoint:on,ListOfPoint3D:ji,ListOfDistribution:Ti,EmptyList:Rt,ErrorType:wl,SeedType:lr,RGBColor:gn,ListOfColor:uo,Polygon:et,ListOfPolygon:ti,Segment:Ye,ListOfSegment:zn,Circle:We,ListOfCircle:wi,Arc:Oe,ListOfArc:ci,Line:Re,ListOfLine:Ei,Ray:ot,ListOfRay:li,Vector:Ve,ListOfVector:Ii,Restriction:ir,ListOfRestriction:gs,AngleMarker:st,ListOfAngleMarker:Un,DirectedAngleMarker:$e,ListOfDirectedAngleMarker:ri,Transformation:xt,ListOfTransformation:Oo,Segment3D:Mr,ListOfSegment3D:Zi,Triangle3D:Hn,ListOfTriangle3D:Ji,Sphere3D:$n,ListOfSphere3D:No,Vector3D:Pt,ListOfVector3D:Qi,Tone:In,ListOfTone:Lo,MapIntervalPoint:Ni,MapIntervalComplex:ki,MapIntervalPoint3D:Ri,MapInterval2ToPoint:po,MapInterval2ToComplex:fo,MapInterval2DPoint3D:go,ListOfMapIntervalPoint:jo,ListOfMapIntervalComplex:ea,ListOfMapIntervalPoint3D:Zo,ListOfMapInterval2ToPoint:Jo,ListOfMapInterval2ToComplex:ta,ListOfMapInterval2DPoint3D:Qo},Fb={[z]:[C,C],[oe]:[C,C,C],[$]:[C,C]},Vi=class e{constructor(t){this.types=t;this.coerceComplexToReal=!0}static of(t){return new e(t)}getTypes(){return this.types}},hge=Object.values(p9),g9=Object.keys(Fb).map(parseFloat),WG=Vi.of(g9);function xr(e){switch(e){case nn:return"Any";case C:return"Number";case tt:return"Bool";case $:return"Complex";case z:return"Point";case oe:return"Point3D";case cr:return"Distribution";case nr:return"Action";case vn:return"ListOfAny";case ke:return"ListOfNumber";case vi:return"ListOfBool";case Dn:return"ListOfComplex";case on:return"ListOfPoint";case ji:return"ListOfPoint3D";case Ti:return"ListOfDistribution";case Rt:return"EmptyList";case wl:return"ErrorType";case lr:return"SeedType";case gn:return"RGBColor";case uo:return"ListOfColor";case et:return"Polygon";case ti:return"ListOfPolygon";case Ye:return"Segment";case zn:return"ListOfSegment";case We:return"Circle";case wi:return"ListOfCircle";case Oe:return"Arc";case ci:return"ListOfArc";case Re:return"Line";case Ei:return"ListOfLine";case ot:return"Ray";case li:return"ListOfRay";case Ve:return"Vector";case Ii:return"ListOfVector";case ir:return"Restriction";case gs:return"ListOfRestriction";case st:return"Angle";case Un:return"ListOfAngle";case $e:return"DirectedAngle";case ri:return"ListOfDirectedAngle";case xt:return"Transformation";case Oo:return"ListOfTransformation";case Mr:return"Segment3D";case Zi:return"ListOfSegment3D";case Pt:return"Vector3D";case Qi:return"ListOfVector3D";case Hn:return"Triangle3D";case Ji:return"ListOfTriangle3D";case $n:return"Sphere3D";case No:return"ListOfSphere3D";case In:return"Tone";case Lo:return"ListOfTone";case Ni:return"MapIntervalPoint";case ki:return"MapIntervalComplex";case Ri:return"MapIntervalPoint3D";case po:return"MapInterval2ToPoint";case fo:return"MapInterval2ToComplex";case go:return"MapInterval2DPoint3D";case jo:return"ListOfMapIntervalPoint";case ea:return"ListOfMapIntervalComplex";case Zo:return"ListOfMapIntervalPoint3D";case Jo:return"ListOfMapInterval2ToPoint";case ta:return"ListOfMapInterval2ToComplex";case Qo:return"ListOfMapInterval2DPoint3D";default:let t=e;throw new Error(`Invalid type: ${t}`)}}function dt(e,t){var n;let r=(n=t==null?void 0:t.specifyPointDimensions)!=null?n:!1;switch(e){case nn:return L("shared-calculator-label-value-type-any");case C:return L("shared-calculator-label-value-type-number");case tt:return L("shared-calculator-label-value-type-bool");case $:return L("shared-calculator-label-value-type-complex");case z:return r?L("shared-calculator-label-value-type-point2d"):L("shared-calculator-label-value-type-point");case oe:return L("shared-calculator-label-value-type-point3d");case cr:return L("shared-calculator-label-value-type-distribution");case nr:return L("shared-calculator-label-value-type-action");case vn:return L("shared-calculator-label-value-type-list-of-any");case ke:return L("shared-calculator-label-value-type-list-of-numbers");case vi:return L("shared-calculator-label-value-type-list-of-bool");case Dn:return L("shared-calculator-label-value-type-list-of-complex");case on:return r?L("shared-calculator-label-value-type-list-of-2d-points"):L("shared-calculator-label-value-type-list-of-points");case ji:return L("shared-calculator-label-value-type-list-of-3d-points");case Ti:return L("shared-calculator-label-value-type-list-of-distributions");case Rt:return L("shared-calculator-label-value-type-empty-list");case wl:return L("shared-calculator-label-value-type-error");case lr:return L("shared-calculator-label-value-type-seed");case gn:return L("shared-calculator-label-value-type-color");case uo:return L("shared-calculator-label-value-type-list-of-colors");case et:return L("shared-calculator-label-value-type-polygon");case ti:return L("shared-calculator-label-value-type-list-of-polygons");case Ye:return L("shared-calculator-label-value-type-segment");case zn:return L("shared-calculator-label-value-type-list-of-segments");case We:return L("shared-calculator-label-value-type-circle");case wi:return L("shared-calculator-label-value-type-list-of-circles");case Oe:return L("shared-calculator-label-value-type-arc");case ci:return L("shared-calculator-label-value-type-list-of-arcs");case Re:return L("shared-calculator-label-value-type-line");case Ei:return L("shared-calculator-label-value-type-list-of-lines");case ot:return L("shared-calculator-label-value-type-ray");case li:return L("shared-calculator-label-value-type-list-of-rays");case Ve:return L("shared-calculator-label-value-type-vector");case Ii:return L("shared-calculator-label-value-type-list-of-vectors");case ir:return L("shared-calculator-label-value-type-restriction");case gs:return L("shared-calculator-label-value-type-list-of-restrictions");case st:return L("shared-calculator-label-value-type-angle");case Un:return L("shared-calculator-label-value-type-list-of-angles");case $e:return L("shared-calculator-label-value-type-directed-angle");case ri:return L("shared-calculator-label-value-type-list-of-directed-angles");case xt:return L("shared-calculator-label-value-type-transformation");case Oo:return L("shared-calculator-label-value-type-list-of-transformations");case Mr:return L("shared-calculator-label-value-type-segment3d");case Zi:return L("shared-calculator-label-value-type-list-of-segment3d");case Pt:return L("shared-calculator-label-value-type-vector3d");case Qi:return L("shared-calculator-label-value-type-list-of-vector3d");case Hn:return L("shared-calculator-label-value-type-triangle3d");case Ji:return L("shared-calculator-label-value-type-list-of-triangle3d");case $n:return L("shared-calculator-label-value-type-sphere3d");case No:return L("shared-calculator-label-value-type-list-of-sphere3d");case In:return L("shared-calculator-label-value-type-tone");case Lo:return L("shared-calculator-label-value-type-list-of-tone");case Ni:case po:return L("shared-calculator-label-value-type-lambda-point");case ki:case fo:return L("shared-calculator-label-value-type-lambda-complex");case Ri:case go:return L("shared-calculator-label-value-type-lambda-point3d");case jo:case Jo:return L("shared-calculator-label-value-type-list-of-lambda-point");case ea:case ta:return L("shared-calculator-label-value-type-list-of-lambda-complex");case Zo:case Qo:return L("shared-calculator-label-value-type-list-of-lambda-point3d");default:let i=e;throw new Error(`Invalid type: ${i}`)}}var f9=[vn,ke,vi,Dn,gs,on,ji,Ti,Rt,uo,ti,zn,wi,ci,Ei,li,Ii,Un,ri,Oo,Zi,Qi,Ji,No,Lo,jo,ea,Zo,Jo,ta,Qo],uc=Vi.of(f9),yge={[vn]:nn,[Rt]:C,[ke]:C,[vi]:tt,[Dn]:$,[gs]:ir,[on]:z,[ji]:oe,[Ti]:cr,[uo]:gn,[ti]:et,[zn]:Ye,[wi]:We,[ci]:Oe,[Ei]:Re,[li]:ot,[Ii]:Ve,[Un]:st,[ri]:$e,[Oo]:xt,[Zi]:Mr,[Qi]:Pt,[Ji]:Hn,[No]:$n,[Lo]:In,[jo]:Ni,[ea]:ki,[Zo]:Ri,[Jo]:po,[ta]:fo,[Qo]:go};function xe(e){switch(e){case void 0:return!1;case vn:case ke:case vi:case Dn:case gs:case on:case ji:case Ti:case uo:case ti:case zn:case wi:case ci:case Ei:case li:case Ii:case Un:case ri:case Oo:case Zi:case Qi:case Ji:case No:case Lo:case jo:case ea:case Zo:case Jo:case ta:case Qo:return!0;case Rt:return!0;case nn:case C:case tt:case $:case ir:case z:case oe:case cr:case wl:case lr:case gn:case nr:case et:case Ye:case We:case Oe:case Re:case ot:case Ve:case st:case $e:case xt:case Mr:case Pt:case Hn:case In:case $n:case Ni:case ki:case Ri:case po:case fo:case go:return!1;default:throw new Error(`Invalid type: ${e}`)}}function It(e){switch(e){case Rt:case ke:return C;case vi:return tt;case Dn:return $;case gs:return ir;case on:return z;case ji:return oe;case Ti:return cr;case uo:return gn;case ti:return et;case Zi:return Mr;case Qi:return Pt;case Ji:return Hn;case No:return $n;case vn:return nn;case zn:return Ye;case wi:return We;case ci:return Oe;case Ei:return Re;case li:return ot;case Ii:return Ve;case Un:return st;case ri:return $e;case Oo:return xt;case Lo:return In;case jo:return Ni;case ea:return ki;case Zo:return Ri;case Jo:return po;case ta:return fo;case Qo:return go;case nn:case C:case tt:case $:case z:case oe:case cr:case wl:case lr:case gn:case nr:case et:case Ye:case We:case Oe:case Re:case ot:case Ve:case ir:case st:case $e:case xt:case Mr:case Pt:case Hn:case $n:case In:case Ni:case ki:case Ri:case po:case fo:case go:throw new Error("Type "+xr(e)+" does not implement elementType.");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function Qn(e){switch(e){case nn:return vn;case C:return ke;case tt:return vi;case $:return Dn;case ir:return gs;case z:return on;case oe:return ji;case cr:return Ti;case gn:return uo;case et:return ti;case Ye:return zn;case We:return wi;case Oe:return ci;case Re:return Ei;case ot:return li;case Ve:return Ii;case st:return Un;case $e:return ri;case xt:return Oo;case Mr:return Zi;case Pt:return Qi;case Hn:return Ji;case $n:return No;case In:return Lo;case Ni:return jo;case ki:return ea;case Ri:return Zo;case po:return Jo;case fo:return ta;case go:return Qo;case Rt:case ke:case vi:case Dn:case gs:case on:case ji:case Ti:case uo:case ti:case zn:case wi:case ci:case Ei:case li:case Ii:case Un:case ri:case Oo:case Zi:case Qi:case Ji:case No:case vn:case Lo:case wl:case lr:case nr:case jo:case ea:case Zo:case Jo:case ta:case Qo:throw new Error("Type "+xr(e)+" does not implement listType.");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function ei(e){switch(e){case nn:case C:case tt:case $:case ir:case z:case oe:case cr:case gn:case et:case Ye:case We:case Oe:case Re:case ot:case Ve:case st:case $e:case xt:case Mr:case Pt:case Hn:case $n:case In:case Ni:case ki:case Ri:case po:case fo:case go:return!0;case Rt:case ke:case vi:case Dn:case gs:case on:case ji:case Ti:case uo:case ti:case zn:case wi:case ci:case Ei:case li:case Ii:case Un:case ri:case Oo:case Zi:case Qi:case Ji:case No:case vn:case Lo:case jo:case ea:case Zo:case Jo:case ta:case Qo:case lr:case nr:case wl:return!1;default:throw new Error(`Invalid type: ${e}`)}}function Am(e){if(e===void 0)return!1;switch(e){case z:case et:case Ye:case We:case Oe:case Re:case ot:case Ve:case st:case $e:case xt:return!0;default:return!1}}function Gb(e){switch(e){case C:case nn:case tt:case $:case ir:case z:case cr:case nr:case vn:case ke:case vi:case Dn:case gs:case on:case Ti:case Rt:case wl:case lr:case gn:case uo:case In:case Lo:return!0;case oe:case ji:case Mr:case Zi:case Pt:case Qi:case Hn:case Ji:case $n:case No:case et:case ti:case Ye:case zn:case We:case wi:case Oe:case ci:case Re:case Ei:case ot:case li:case Ve:case Ii:case st:case Un:case $e:case ri:case xt:case Oo:case Ni:case ki:case Ri:case po:case fo:case go:case jo:case ea:case Zo:case Jo:case ta:case Qo:return!1;default:let t=e;throw new Error(`Invalid type: ${t}`)}}function e1(e,t){for(let r of t)if(e===r)return!0;return!1}var cS=[C,$,z,oe];function Bb(e){return cS.includes(e)}var lS=[C,$];function XG(e){return lS.includes(e)}var uS=Vi.of([Re,ot,Ye,Ve]),KG=Vi.of([Ve,Pt]),jG=Vi.of([st,$e]);function Le(e,t){return e===void 0?!1:e===t?!0:xe(e)?e===Rt?!0:It(e)===t:!1}function Qd(e){return e1(e,[Ni,ki,Ri,po,fo,go,jo,ea,Zo,Jo,ta,Qo])}var ZG={[z]:Ni,[$]:ki,[oe]:Ri},m9={[z]:po,[$]:fo,[oe]:go};function JG(e){return ZG[e]!==void 0}function QG(e,t){let r=t===1?ZG[e]:m9[e];if(r===void 0)throw new Error(`Unexpected return type for map: ${xr(e)}`);return r}function Om(e,t){if(!e1(e,t))throw new Error(`Programming error: expected one of ${t.map(xr)} but found ${e&&xr(e)} instead.`)}var Qu=Symbol("UNKNOWN_RETURN_TYPE");function e2(e){return typeof e=="object"&&e.type==="variadic"}function Pg(e,t){return{type:"variadic",initial:new Array(t).fill(e),rest:e}}var dS=class{constructor(t,r,n){this.argTypes=t;this.returnType=r;this.productContext=n;this.minArity=this.argTypes.length,this.maxArity=this.argTypes.length}argTypeAtIndex(t){if(!(t>this.argTypes.length-1))return this.argTypes[t]}matches(t){return t2(this,t)}satisfiesPolicy(t){return t.is3dProduct()?this.productContext["3d"]:t.isGeometryEnabled()?this.productContext.geometry:this.productContext.graphing}},pS=class{constructor(t,r,n){this.returnType=r;this.productContext=n;this.maxArity=void 0;this.initial=t.initial,this.rest=t.rest,this.minArity=this.initial.length}argTypeAtIndex(t){return t<this.initial.length?this.initial[t]:this.rest}matches(t){return t2(this,t)}satisfiesPolicy(t){return t.is3dProduct()?this.productContext["3d"]:t.isGeometryEnabled()?this.productContext.geometry:this.productContext.graphing}};function t2(e,t){return e.maxArity!==void 0&&e.maxArity<t.length?!1:!!t.every((r,n)=>{if(r===void 0)return!0;let i=e.argTypeAtIndex(n);return i===void 0?!1:hS(r,i)})}var t1=class{constructor(t){this.arg=t;this.coerceComplexToReal=!1}getTypes(){return typeof this.arg=="number"?[this.arg]:this.arg.getTypes()}},vr=new t1(C),Tge=new t1(ke),gS=class{constructor(t){typeof t=="number"?(this.coerceComplexToReal=!0,this.nodeTypes=[Qn(t)]):(this.coerceComplexToReal=t.coerceComplexToReal,this.nodeTypes=t.getTypes().map(Qn))}getTypes(){return this.nodeTypes}};function r2(e){return new gS(e)}var fS=class{constructor(t){if(typeof t=="number")this.coerceComplexToReal=!0,this.nodeTypes=[t,Qn(t)];else{this.coerceComplexToReal=t.coerceComplexToReal,this.nodeTypes=[];for(let r of t.getTypes())this.nodeTypes.push(r,Qn(r))}}getTypes(){return this.nodeTypes}};function mS(e){return typeof e=="number"?ei(e):e instanceof Vi?e.types.every(mS):!1}function dc(e){return new fS(e)}function Dr(e,t,r={}){let n={geometry:!0,"3d":!0,graphing:!0,...r};return e2(e)?new pS(e,t,n):new dS(e,t,n)}function St(e,t,r={}){return e2(e)?Dr({type:"variadic",initial:e.initial.map(dc),rest:dc(e.rest)},t,r):Dr(e.map(dc),t,r)}function hS(e,t){if(typeof t=="number")return Li(e,t);{let r=t.getTypes();return t.coerceComplexToReal?r.some(n=>Li(e,n)):r.some(n=>_m(e,n))}}function Lm(e,t){return typeof t=="number"?Nc(e,t):t.getTypes().some(n=>Nc(e,n))}function r1(e,t){let r=new Set;for(let n of e){let i=n.argTypeAtIndex(t);if(i===void 0)continue;let o=y9(i);for(let a of o)r.add(a)}return[...r]}function y9(e){return typeof e=="number"?[e]:e.getTypes()}var Fze=ut(ft());function b9(e){return!e||e[0].type==="none"&&e[1].type==="none"?"NONE":e[1].type==="none"?"X":e[0].type==="none"?"Y":"XY"}function n1(e,t){var r=b9(t);switch(e){case"NONE":return"NONE";case"AUTO":return r;case"XY":return r;case"X":return r==="X"||r==="XY"?"X":"NONE";case"Y":return r==="Y"||r==="XY"?"Y":"NONE";default:return"NONE"}}function i1(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}var mo={xmin:-5,xmax:5,ymin:-5,ymax:5,zmin:-5,zmax:5};var w9={show:!1,min:"",max:""},E9={breadth:"",axisOffset:"",alignedAxis:"x",showBoxplotOutliers:!0,binAlignment:"center",dotplotXMode:"exact",histogramMode:""},I9={enabled:!1,latex:""};var o2=4e3,bS={polarDomain:{min:"",max:""},parametricDomain:{min:"",max:""},parametricDomain3Du:{min:"",max:""},parametricDomain3Dv:{min:"",max:""},parametricDomain3Dr:{min:"",max:""},parametricDomain3Dphi:{min:"",max:""},cdf:w9,colorLatex:"",description:"",fillOpacity:"",surfaceOpacity:"",lineOpacity:"",pointOpacity:"",pointSize:"",movablePointSize:"",lineWidth:"",resolution:"",labelAngle:"",vizProps:E9,clickableInfo:I9},C9={folderId:"",latex:"",color:"",showLabel:!1,showAngleLabel:!0,label:"",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,dragMode:"AUTO",labelSize:"",labelOrientation:"default",suppressTextOutline:!1,interactiveLabel:!1,editableLabelMode:"NONE",residualVariable:"",isLogModeRegression:!1,pointStyle:"POINT",lineStyle:"SOLID",arrowMode:"DEFAULT",regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},strictIntersection:!1,extendTo3D:!1,...bS,points:void 0,lines:void 0,fill:void 0},P9={hardMin:!1,hardMax:!1,animationPeriod:o2,loopMode:"LOOP_FORWARD_REVERSE",playDirection:1,isPlaying:!1,min:"-10",max:"10",step:""},S9={hardMin:!1,hardMax:!1,animationPeriod:o2,loopMode:"LOOP_FORWARD_REVERSE",playDirection:1,isPlaying:!1,min:`${mo.xmin}`,max:`${mo.xmax}`,step:""};function a2(e,t,r){if(e=Rm(e),r>0){let n=Rm(t);return e<n&&(e+=2*Math.PI),(e-n)/r}else{let n=Rm(t+r);return e<n&&(e+=2*Math.PI),1+(e-n)/r}}function xS(e,t,r){e=Rm(e);let n=Rm(t),i=Rm(t+r);if(r<0){let o=n;n=i,i=o}return n<i?n<=e&&e<=i:n<=e||e<=i}function Rm(e){let t=2*Math.PI;return(e%t+t)%t}function a1(e,t){if(!(isNaN(e)||isNaN(t)))return e>=0?Math.atan(t/e):Math.atan(t/e)+Math.PI}var Gs=Math.hypot;function ru(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function D9(e,t,r,n,i,o){return e*n+t*i+r*o}function El(e,t,r,n,i,o,a,s,c){let l=Gs(a-n,s-i,c-o);return l===0?0:D9((e-n)/l,(t-i)/l,(r-o)/l,(a-n)/l,(s-i)/l,(c-o)/l)}function _9(e,t,r,n,i,o){let a=El(e,t,0,r,n,0,i,o,0);return a<=0?[r,n]:a>=1?[i,o]:[r+a*(i-r),n+a*(o-n)]}function A9(e,t,r,n,i,o,a,s,c){let l=El(e,t,r,n,i,o,a,s,c);return l<=0?[n,i,o]:l>=1?[a,s,c]:[n+l*(a-n),i+l*(s-i),o+l*(c-o)]}function s2(e,t,r,n,i,o){let a=_9(e,t,r,n,i,o);return Gs(e-a[0],t-a[1])}function c2(e,t,r,n,i,o,a,s,c){let l=A9(e,t,r,n,i,o,a,s,c);return Gs(e-l[0],t-l[1],r-l[2])}function Bs(e,t,r=1){if(e===t)return!0;if(!isFinite(e)||!isFinite(t))return!1;if(r>50)throw new Error("Within "+(52-r)+" bits isn't really approximate any more");let n=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),i=r===1?.5:Math.pow(.5,r);return n===n+i*Math.abs(t-e)}function td(e,t=1e6){if(e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};let r,n=0,i=1,o=1,a=0,s,c;for(;r=Math.floor(e),s=r*i+n,c=r*a+o,!(c>t||(n=i,o=a,i=s,a=c,e===r));)e=1/(e-r);return{n:i,d:a}}function ep(e,t=e,r=!1){if(isNaN(e)||!isFinite(e))return{string:"undefined",latex:"undefined",value:e};if(e===0)return{string:"0",latex:"0",value:e};Math.abs(e)>Math.abs(t)&&(t=e);let n=td(e/Math.PI,24),i,o,a,s,c,l,u=r?R9(t):N9(t);if(u&&Bs(n.n/n.d*Math.PI,e,3))return n.n===0?(i="0",s="0"):n.n===1?(i="\u03C0",s="\\pi"):n.n===-1?(i="-\u03C0",s="-\\pi"):(i=n.n.toString()+"\u03C0",s=n.n.toString()+"\\pi"),n.d===1?(o="",c=""):(o="/"+n.d.toString(),c=n.d.toString()),a=i+o,c===""?l=s:s[0]==="-"?l=`-\\frac{${s.slice(1)}}{${c}}`:l=`\\frac{${s}}{${c}}`,{string:a,latex:l,value:n.n/n.d*Math.PI};if(u)return a=L9(l2(e.toFixed(vS(t)))),{string:a,latex:a,value:parseFloat(a)};{let d=TS(e.toExponential(vS(t/e))).split("e"),f=d[0]==="1"&&r?"10":d[0]+"\xD710",g=d[1].replace("+","");return a=TS(e.toExponential(vS(t/e))).replace("+",""),l=`${d[0]}\\times10^{${g}}`,{string:a,latex:l,mantissa:f,superscript:g,value:parseFloat(a)}}}var O9=/\.?0+$/;function l2(e){return e.indexOf(".")===-1?e:e.replace(O9,"")}function TS(e){let t=/\.?0+e/;return e.replace(t,"e")}function L9(e){return e==="-0"?"0":e}function N9(e){return e=Math.abs(e),1e-4<e&&e<1e7}function R9(e){return e=Math.abs(e),.001<e&&e<1e4}var k9=5,V9=5;function vS(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(k9,Math.floor(V9+1.5-Math.log10(e)))}function u2(e){return 1e6/Math.sqrt(Math.abs(e))}function zb(e){let t=u2(e);if(t<1||t>1e12)return!1;let{n:r,d:n}=td(e,t);return n===1?!1:e===e+Math.pow(2,-3)*Math.abs(r/n-e)}function d2(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:"undefined"};if(e===0||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:"decimal",value:"0"};let r=t.smallCutoff||.001,n=t.bigCutoff||1e6,i=t.digits||10,a=TS(e.toExponential(i-2)).match(/([\d\.\-]+)e\+?([\d\-]+)/);if(!a)return{type:"undefined"};let s=parseInt(a[2],10)>=i;if(zb(e)&&t.displayAsFraction){let l=td(e,u2(e));return{type:"fraction",numerator:l.n.toString(),denominator:l.d.toString()}}else{if(Math.abs(e)>n||Math.abs(e)<r||s)return{type:"scientific",mantissa:a[1],exponent:a[2]};{let l=l2(e.toPrecision(i));return e!==Number(l)&&t.addEllipses&&(l+="..."),{type:"decimal",value:l}}}}function p2(e,t){let r=d2(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+" * 10^"+r.exponent;case"fraction":return r.denominator==="1"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function nu(e,t){let r=d2(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+"\\times10^{"+r.exponent+"}";case"fraction":return r.denominator==="1"?r.numerator:r.numerator[0]==="-"?`-\\frac{${r.numerator.slice(1)}}{${r.denominator}}`:`\\frac{${r.numerator}}{${r.denominator}}`;default:return r}}function Ee(e){if(e.startsWith("_base_case")){let[r,n,i]=e.split(":"),o=[];for(let a of i.split(",")){let s=parseFloat(a);isNaN(s)?o.push(Ee(a)):o.push(p2(s))}return`${Ee(n)}(${o.join(",")})`}e=e.replace("\\","");let t={alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03F5",varepsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",vartheta:"\u03D1",iota:"\u03B9",kappa:"\u03BA",varkappa:"\u03F0",lambda:"\u03BB",mu:"\u03BC",xi:"\u03BE",pi:"\u03C0",varpi:"\u03D6",rho:"\u03C1",varrho:"\u03F1",sigma:"\u03C3",varsigma:"\u03C2",tau:"\u03C4",phi:"\u03D5",varphi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",Gamma:"\u0393",Delta:"\u0394",Theta:"\u0398",Lambda:"\u039B",Xi:"\u039E",Pi:"\u03A0",Sigma:"\u03A3",Phi:"\u03A6",Psi:"\u03A8",Omega:"\u03A9",div:"\xF7",cdot:"\u22C5",times:"\xD7",lt:"<",gt:">",le:"\u2264",ge:"\u2265",sim:"\u223C",ldots:"\u2026",prime:"\u2032",approx:"\u2248",to:"\u2192","->":"\u2192"};return t.hasOwnProperty(e)?t[e]:e}function ni(e){let t=e.match(/^\$(\d+)$/);if(t)return`\\token{${t[1]}}`;let r=e.split("_"),n="";return r[0].length>1&&(n+="\\"),n+=r[0],r[1]&&(n+="_{"+r[1]+"}"),n}function Mg(e){let t=e.match(/\\token\{(\d+)\}/);return t?`$${t[1]}`:(e=e.replace(/\\operatorname\{(.*)\}/,"$1"),e.replace(/[{}\\]/g,""))}function Dg(e){return e.replace(/^(\\ |\s|\\space(?![a-zA-Z]))+/,"").replace(/(\\ |\s|\\space(?![a-zA-Z]))+$/,"")}function F9(e,t){let[r,n]=[e[0]!==0?nu(e[0],t):void 0,e[1]!==0||t!=null&&t.alwaysEmitImaginary?nu(Math.abs(e[1]),t):void 0];return r==="undefined"||n==="undefined"?"undefined":r&&n?[r,`${e[1]>=0?"+":"-"}${n!=="1"?`${n}`:""}i`]:n?[`${e[1]>=0?"":"-"}${n!=="1"?`${n}`:""}i`]:[r!=null?r:"0"]}function Ub(e,t){let r=F9(e,t);return r==="undefined"?"undefined":r.join("")}Bd();var $s={};nb($s,{LruCache:()=>nh,RECURSIVE_COMPUTATION_LIMIT:()=>CB,RECURSIVE_DEPTH_LIMIT:()=>Nx,RecursiveFunctionResult:()=>IB,SYMBOL_DIVERGES:()=>EB,TerminationStatus:()=>mA,_complexGCD:()=>zA,acosh:()=>bB,acot:()=>tW,acoth:()=>lW,acsc:()=>rW,acsch:()=>cW,addTangentAngle:()=>qX,addTangentArc:()=>BX,addTangentCircle:()=>GX,addTangentLine:()=>kX,addTangentPolygon:()=>NX,addTangentRay:()=>VX,addTangentSegment:()=>Aw,addTangentSegmentThreeD:()=>RX,addTangentTransformation:()=>zX,addTangentVector:()=>FX,angleMarkerMultiplier:()=>EX,angleMarkerRawDelta:()=>wX,angleStart:()=>bX,angleVertex:()=>yX,anglebisector:()=>nK,arc:()=>gX,arcArcIntersection:()=>ZX,arcCenter:()=>uh,arcCircleIntersection:()=>jX,arcFirstPoint:()=>fX,arcGlider:()=>QB,arcLineIntersection:()=>r3,arcMiddlePoint:()=>mX,arcOmega:()=>dh,arcThirdPoint:()=>hX,arg:()=>RK,argMax:()=>kW,argMin:()=>RW,asec:()=>nW,asech:()=>sW,asinh:()=>xB,atanh:()=>vB,basePointFromVector:()=>oX,basePointFromVectorThreeD:()=>cX,bernoulliTable:()=>MB,binomSample:()=>wW,binomcdf:()=>IW,binompdf:()=>Mw,center:()=>dX,chooseNonIncidentPoint:()=>WX,circle:()=>uX,circleArcIntersection:()=>KX,circleCircleIntersection:()=>Ox,circleGlider:()=>HX,circleLineIntersection:()=>RA,clamp:()=>ui,coerceComplexToReal:()=>JK,coerceRealToComplex:()=>QK,common_log:()=>j7,complex:()=>an,complexAcos:()=>f3,complexAcosh:()=>h3,complexAcot:()=>XK,complexAcoth:()=>ZK,complexAcsc:()=>WK,complexAcsch:()=>jK,complexAsec:()=>YK,complexAsech:()=>KK,complexAsin:()=>qA,complexAsinh:()=>m3,complexAtan:()=>lA,complexAtanh:()=>ww,complexCeil:()=>ej,complexCos:()=>u3,complexCosh:()=>g3,complexCot:()=>zK,complexCoth:()=>$K,complexCsc:()=>qK,complexCsch:()=>HK,complexDivide:()=>rf,complexExp:()=>FK,complexFloor:()=>y3,complexFromPolarRounded:()=>up,complexGCD:()=>dA,complexLCM:()=>pA,complexListGCD:()=>U7,complexListLCM:()=>H7,complexLog:()=>VK,complexMod:()=>tj,complexMultiplyPoints:()=>o3,complexPow:()=>GK,complexPowReal:()=>c3,complexReciprocal:()=>Ka,complexRound:()=>rh,complexSec:()=>BK,complexSech:()=>UK,complexSin:()=>l3,complexSinh:()=>p3,complexSqrt:()=>s3,complexTan:()=>d3,complexTanh:()=>BA,composeTransformation:()=>fK,conj:()=>Jg,corr:()=>_w,cos:()=>Nn,cosh:()=>ch,cot:()=>eW,cotDerivative:()=>DB,coth:()=>aW,cov:()=>FW,covp:()=>$B,csc:()=>Q7,csch:()=>oW,dilation:()=>dK,directedAngleMarker:()=>ZB,directedAngleStart:()=>vX,directedAngleVertex:()=>xX,directedCoterminalAngle:()=>JB,distance:()=>ah,distanceThreeD:()=>zW,elementsAt:()=>CK,erf:()=>SW,erfcx:()=>ld,executeRecursiveFunction:()=>F7,expm1:()=>O7,factorial:()=>uu,frequency:()=>MK,gcd:()=>gw,getArcDetails:()=>ph,getBroadcastTargetElements:()=>R7,getRecursiveDepthLimit:()=>L7,handleRecursionLimitExceeded:()=>SB,hsv:()=>UW,hypot:()=>xa,identity:()=>lX,imag:()=>NK,invBinom:()=>kB,invNorm:()=>wA,invPoisson:()=>RB,invT:()=>VB,invUniform:()=>DW,invertTransformation:()=>mK,isDegenerateArc:()=>_A,itscore:()=>GB,ittest:()=>IA,lcm:()=>fw,line:()=>tX,lineArcIntersection:()=>t3,lineCircleIntersection:()=>NA,lineGlider:()=>OA,lineLineIntersection:()=>e3,listGCD:()=>q7,listLCM:()=>z7,listLength:()=>_W,listMax:()=>qB,listMin:()=>BB,log:()=>K7,log1p:()=>lh,log_base:()=>AB,lowerQuantileIndex:()=>OW,lowerQuartileIndex:()=>NW,mad:()=>VW,mathVector:()=>XB,mathVectorThreeD:()=>KB,md5Spyable:()=>yB,mean:()=>du,median:()=>UB,mod:()=>jg,nCr:()=>lp,nPr:()=>mw,normalSample:()=>vW,normalcdf:()=>bW,normalpdf:()=>yA,nthroot:()=>Z7,parallel:()=>tK,perpendicular:()=>rK,pointDet:()=>a3,pointDot:()=>iK,pointPerp:()=>oK,poissonSample:()=>EW,poissoncdf:()=>CW,poissonpdf:()=>oh,polyGamma:()=>_B,polygon:()=>HW,polygonArea:()=>MA,polygonEdgeByParameter:()=>$X,polygonEdges:()=>KW,polygonGlider:()=>YX,polygonInteriorDirectedAngles:()=>eX,polygonInteriorUndirectedAngles:()=>QW,polygonPerimeter:()=>jW,pow:()=>wB,quad:()=>qW,quantile:()=>zB,quartile:()=>Zg,quartileIndex:()=>Dw,radius:()=>pX,random:()=>xA,randomPerm:()=>vA,rank:()=>sA,rawTransform:()=>aK,rawTransformConj:()=>sK,ray:()=>rX,rayGlider:()=>cA,real:()=>LK,recursionCacheKey:()=>oA,recursionDiverges:()=>PB,recursionMissingCacheEntry:()=>V7,recursionSuccess:()=>k7,reflection:()=>gK,restriction:()=>AK,restrictionToBoolean:()=>OK,rgb:()=>YB,rotation:()=>pK,scaleTangentAngle:()=>LX,scaleTangentArc:()=>OX,scaleTangentCircle:()=>AX,scaleTangentLine:()=>DX,scaleTangentPolygon:()=>MX,scaleTangentRay:()=>_X,scaleTangentSegment:()=>AA,scaleTangentTransformation:()=>SX,sec:()=>J7,sech:()=>iW,segment:()=>DA,segmentGlider:()=>LA,segmentThreeD:()=>$W,segmentThreeDGlider:()=>UX,select:()=>IK,serializeNonNumericSeedPart:()=>bA,shuffle:()=>xW,sign:()=>fA,sin:()=>fn,sinh:()=>ef,sortPerm:()=>tf,spearman:()=>GW,sphere:()=>WW,sqrtxsqm1:()=>B7,sqrtxsqp1:()=>G7,stats:()=>CA,stdev:()=>hw,stdevp:()=>BW,supplementAngle:()=>CX,tSample:()=>TW,tan:()=>hA,tanh:()=>gA,tcdf:()=>dw,testingOnlySetRecursiveDepthLimit:()=>N7,toFraction:()=>TB,tone:()=>SK,total:()=>dW,tpdf:()=>Sw,transformAngleMarker:()=>EK,transformArc:()=>TK,transformCircle:()=>vK,transformLine:()=>yK,transformPoint:()=>Fc,transformPolygon:()=>wK,transformRay:()=>bK,transformScaleFactor:()=>lK,transformSegment:()=>GA,transformVector:()=>xK,transformWithoutTranslation:()=>cK,translation:()=>uK,triangle:()=>YW,tscore:()=>FB,ttest:()=>EA,undirectedAngleMarker:()=>TX,undirectedCoterminalAngle:()=>IX,uniformSample:()=>dp,uniformcdf:()=>PW,uniformpdf:()=>TA,uniquePerm:()=>PK,upperQuantileIndex:()=>AW,upperQuartileIndex:()=>LW,validateRangeLength:()=>PA,validateSampleCount:()=>SA,variance:()=>HB,varp:()=>Rx,vector:()=>nX,vectorDisplacementAsPoint:()=>iX,vectorThreeD:()=>aX,vectorThreeDDisplacementAsPoint:()=>sX,vertices:()=>XW,volume:()=>DK});var f2=function(){"use strict";function e(x,b){var w=(x&65535)+(b&65535),E=(x>>16)+(b>>16)+(w>>16);return E<<16|w&65535}function t(x,b){return x<<b|x>>>32-b}function r(x,b,w,E,I,S){return e(t(e(e(b,x),e(E,S)),I),w)}function n(x,b,w,E,I,S,D){return r(b&w|~b&E,x,b,I,S,D)}function i(x,b,w,E,I,S,D){return r(b&E|w&~E,x,b,I,S,D)}function o(x,b,w,E,I,S,D){return r(b^w^E,x,b,I,S,D)}function a(x,b,w,E,I,S,D){return r(w^(b|~E),x,b,I,S,D)}function s(x,b){x[b>>5]|=128<<b%32,x[(b+64>>>9<<4)+14]=b;var w,E,I,S,D,O=1732584193,_=-271733879,A=-1732584194,R=271733878;for(w=0;w<x.length;w+=16)E=O,I=_,S=A,D=R,O=n(O,_,A,R,x[w],7,-680876936),R=n(R,O,_,A,x[w+1],12,-389564586),A=n(A,R,O,_,x[w+2],17,606105819),_=n(_,A,R,O,x[w+3],22,-1044525330),O=n(O,_,A,R,x[w+4],7,-176418897),R=n(R,O,_,A,x[w+5],12,1200080426),A=n(A,R,O,_,x[w+6],17,-1473231341),_=n(_,A,R,O,x[w+7],22,-45705983),O=n(O,_,A,R,x[w+8],7,1770035416),R=n(R,O,_,A,x[w+9],12,-1958414417),A=n(A,R,O,_,x[w+10],17,-42063),_=n(_,A,R,O,x[w+11],22,-1990404162),O=n(O,_,A,R,x[w+12],7,1804603682),R=n(R,O,_,A,x[w+13],12,-40341101),A=n(A,R,O,_,x[w+14],17,-1502002290),_=n(_,A,R,O,x[w+15],22,1236535329),O=i(O,_,A,R,x[w+1],5,-165796510),R=i(R,O,_,A,x[w+6],9,-1069501632),A=i(A,R,O,_,x[w+11],14,643717713),_=i(_,A,R,O,x[w],20,-373897302),O=i(O,_,A,R,x[w+5],5,-701558691),R=i(R,O,_,A,x[w+10],9,38016083),A=i(A,R,O,_,x[w+15],14,-660478335),_=i(_,A,R,O,x[w+4],20,-405537848),O=i(O,_,A,R,x[w+9],5,568446438),R=i(R,O,_,A,x[w+14],9,-1019803690),A=i(A,R,O,_,x[w+3],14,-187363961),_=i(_,A,R,O,x[w+8],20,1163531501),O=i(O,_,A,R,x[w+13],5,-1444681467),R=i(R,O,_,A,x[w+2],9,-51403784),A=i(A,R,O,_,x[w+7],14,1735328473),_=i(_,A,R,O,x[w+12],20,-1926607734),O=o(O,_,A,R,x[w+5],4,-378558),R=o(R,O,_,A,x[w+8],11,-2022574463),A=o(A,R,O,_,x[w+11],16,1839030562),_=o(_,A,R,O,x[w+14],23,-35309556),O=o(O,_,A,R,x[w+1],4,-1530992060),R=o(R,O,_,A,x[w+4],11,1272893353),A=o(A,R,O,_,x[w+7],16,-155497632),_=o(_,A,R,O,x[w+10],23,-1094730640),O=o(O,_,A,R,x[w+13],4,681279174),R=o(R,O,_,A,x[w],11,-358537222),A=o(A,R,O,_,x[w+3],16,-722521979),_=o(_,A,R,O,x[w+6],23,76029189),O=o(O,_,A,R,x[w+9],4,-640364487),R=o(R,O,_,A,x[w+12],11,-421815835),A=o(A,R,O,_,x[w+15],16,530742520),_=o(_,A,R,O,x[w+2],23,-995338651),O=a(O,_,A,R,x[w],6,-198630844),R=a(R,O,_,A,x[w+7],10,1126891415),A=a(A,R,O,_,x[w+14],15,-1416354905),_=a(_,A,R,O,x[w+5],21,-57434055),O=a(O,_,A,R,x[w+12],6,1700485571),R=a(R,O,_,A,x[w+3],10,-1894986606),A=a(A,R,O,_,x[w+10],15,-1051523),_=a(_,A,R,O,x[w+1],21,-2054922799),O=a(O,_,A,R,x[w+8],6,1873313359),R=a(R,O,_,A,x[w+15],10,-30611744),A=a(A,R,O,_,x[w+6],15,-1560198380),_=a(_,A,R,O,x[w+13],21,1309151649),O=a(O,_,A,R,x[w+4],6,-145523070),R=a(R,O,_,A,x[w+11],10,-1120210379),A=a(A,R,O,_,x[w+2],15,718787259),_=a(_,A,R,O,x[w+9],21,-343485551),O=e(O,E),_=e(_,I),A=e(A,S),R=e(R,D);return[O,_,A,R]}function c(x){var b,w="",E=x.length*32;for(b=0;b<E;b+=8)w+=String.fromCharCode(x[b>>5]>>>b%32&255);return w}function l(x){var b,w=[];for(w[(x.length>>2)-1]=void 0,b=0;b<w.length;b+=1)w[b]=0;var E=x.length*8;for(b=0;b<E;b+=8)w[b>>5]|=(x.charCodeAt(b/8)&255)<<b%32;return w}function u(x){return c(s(l(x),x.length*8))}function d(x){var b="0123456789abcdef",w="",E,I;for(I=0;I<x.length;I+=1)E=x.charCodeAt(I),w+=b.charAt(E>>>4&15)+b.charAt(E&15);return w}function f(x){return unescape(encodeURIComponent(x))}function g(x){return u(f(x))}function y(x){return d(g(x))}return y}();function pc(e,t,r){return e>0==t>0?r===1?t:e+r*(t-e):e*(1-r)+t*r}function Ci(e,t,r){return[pc(e[0],t[0],r),pc(e[1],t[1],r)]}function gc(e,t,r){return[pc(e[0],t[0],r),pc(e[1],t[1],r),pc(e[2],t[2],r)]}function Hb(e,t){return[e[0]+t[0],e[1]+t[1]]}function m2(e,t){return[e[0]-t[0],e[1]-t[1]]}function wS(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]}function ES(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function rd(e,t){return km(wS(e,t))}function s1(e,t,r){return[pc(e[0],t[0],r[0]),pc(e[1],t[1],r[1])]}function h2(e,t){return[e[0]*t,e[1]*t]}function km(e){let[t,r,n]=e;return t*t+r*r+n*n}function Vm(e,t){let r=e[1]*t[2]-e[2]*t[1],n=e[2]*t[0]-e[0]*t[2],i=e[0]*t[1]-e[1]*t[0],o=Math.sqrt(r*r+n*n+i*i);return[r/o,n/o,i/o]}function Fm(e,t,r){e=Math.fround(e),t=Math.fround(t),r=Math.fround(r);let n=Math.fround(e*e+t*t+r*r);return isFinite(n)&&n!=0}function iu([e,t,r]){return isFinite(e)&&isFinite(t)&&isFinite(r)}function Rc(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,o=Math.abs(e)>.01,a=Math.abs(t)>.01;if(o||a)return ru(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let s=n?Math.sqrt(e*t):-Math.sqrt(e*t);return s>=e&&t>=s?s:ru(e,t)}function SS(e,t,r,n,i){if(!(isNaN(t)||isNaN(n)||t<0==n<0))for(;;){let o=Rc(e,r),a=i(o);if(!isFinite(a))return;if(o===e||o===r)return Math.abs(t)<=Math.abs(n)?[e,t]:[r,n];if(a===0)return Yb(e,t,o,a,r,n,i);t<0!=a<0?(r=o,n=a):(e=o,t=a)}}function E2(e,t,r,n,i){if(!(IS(t)||IS(n))&&CS(t,n))for(;;){let o=Rc(e,r),a=i(o);if(IS(a))return;if(o===e||o===r)return o;if(CS(t,a))r=o,n=a;else if(CS(a,n))e=o,t=a;else return}}function IS(e){for(let t of e)if(isNaN(t))return!0;return!1}function CS(e,t){for(let r=0;r<e.length;r++)if(!G9(e[r],t[r]))return!1;return!0}function G9(e,t){return e<=0&&t>=0||e>=0&&t<=0}function Yb(e,t,r,n,i,o,a){let s;if(!isFinite(n))return;isFinite(t)||(s=ya(e,t,r,n,a),s!==void 0&&(e=s,t=a(e))),isFinite(o)||(s=ya(r,n,i,o,a),s!==void 0&&(i=s,o=a(s)));let c,l;t===n?c=[e,t]:c=y2(e,t,r,n,a,n),o===n?l=[i,o]:l=y2(r,n,i,o,a,n);let u;return c&&l&&(u=Rc(c[0],l[0])),u!==void 0?[u,a(u)]:void 0}function ya(e,t,r,n,i){if(isFinite(t)!==isFinite(n))for(;;){let o=Rc(e,r),a=i(o);if(o===e||o===r)return isFinite(t)?e:r;isFinite(a)!==isFinite(t)?(r=o,n=a):(e=o,t=a)}}function c1(e,t,r,n,i){if(iu(t)!==iu(n))for(;;){let o=Rc(e,r),a=i(o);if(o===e||o===r)return iu(t)?e:r;iu(a)!==iu(t)?(r=o,n=a):(e=o,t=a)}}function y2(e,t,r,n,i,o){if(t===o!=(n===o))for(;;){let a=Rc(e,r),s=i(a);if(a===e||a===r)return t===o?[e,t]:[r,n];s===o!=(t===o)?(r=a,n=s):(e=a,t=s)}}function I2(e,t,r,n,i,o,a){if(e<r&&r<i&&isFinite(t)&&isFinite(n)&&isFinite(o)&&t!==n&&n!==o&&n>t==n>o)for(;;){let s=Rc(e,r),c=a(s),l=Rc(r,i),u=a(l);if(!isFinite(c)||!isFinite(u))return;if(s===e||s===r||l===r||l===i)return c>n==n>t?[s,c]:u>n==n>t?[l,u]:[r,n];if(c===n||u===n)return Yb(e,t,r,n,i,o,a);n>t&&c>t&&c>n||n<t&&c<t&&c<n?(i=r,o=n,r=s,n=c):n>t&&u>n&&u>o||n<t&&u<n&&u<o?(e=r,t=n,r=l,n=u):(e=s,t=c,i=l,o=u)}}function b2(e,t,r,n,i,o,a,s){let c=Math.abs(n-t),l=Math.abs(o-n),u=Math.abs(s-o);return c>l&&c>u?[e,r]:u>l&&u>c?[i,a]:[r,i]}function Gm(e,t,r,n,i,o,a,s=0){if(!((r-e)*(i-r)<=0)&&!(!isFinite(e)||!isFinite(r)||!isFinite(i))&&!(!isFinite(t)||!isFinite(o))){if(!isFinite(n)){let c=ya(e,t,r,n,a),l=ya(r,n,i,o,a);return c===void 0||l===void 0?void 0:[c,l]}if(!(Math.abs(n-((i-r)*t+(r-e)*o)/(i-e))<s))for(;;){let c=Rc(e,r),l=a(c),u=Rc(r,i),d=a(u),f=Math.abs(l-ru(t,n)),g=Math.abs(n-ru(l,d)),y=Math.abs(d-ru(n,o));if(f<=s&&g<=s&&y<=s)return;if(!isFinite(l)){let x=ya(e,t,c,l,a),b=ya(c,l,i,o,a);return x===void 0||b===void 0?void 0:[x,b]}if(!isFinite(d)){let x=ya(e,t,u,d,a),b=ya(u,d,i,o,a);return x===void 0||b===void 0?void 0:[x,b]}if((c===e||c===r)&&(u===r||u===i))return Math.abs(n-t)>Math.abs(o-n)?[e,r]:[r,i];if(c===e||c===r)return b2(e,t,r,n,u,d,i,o);if(u===r||u===i)return b2(e,t,c,l,r,n,i,o);f>y&&f>=g?(i=r,o=n,r=c,n=l):y>f&&y>=g?(e=r,t=n,r=u,n=d):(e=c,t=l,i=u,o=d)}}}var nd=(Math.sqrt(5)-1)/2;function $b(e,t){return e>0==t>0?e+nd*(t-e):(1-nd)*e+nd*t}function tp(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,o=Math.abs(e)>.01,a=Math.abs(t)>.01;if(o||a)return $b(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let s=n?Math.sqrt(e*t):-Math.sqrt(e*t);return s>=e&&t>=s?s:$b(e,t)}function C2(e,t,r,n,i,o){if(!isFinite(e)||!isFinite(r)||!isFinite(t)||!isFinite(n))return;e>r&&([e,t,r,n]=[r,n,e,t]);let a=tp(e,r),s=i(a);if(Math.abs(s-$b(t,n))<=o)return;let c=tp(e,a),l=i(c);for(;;){let u=Math.abs(l-$b(t,s)),d=Math.abs(s-$b(n,l));if(u<=o&&d<=o)return;if(u>d){if(r=a,n=s,a=c,s=l,c=tp(e,a),l=i(c),c===e||c===a)return v2(e,t,a,s,r,n);if(!isFinite(l))return x2(e,t,c,l,r,n,i)}else{if(e=c,t=l,c=a,l=s,a=tp(r,a),s=i(a),a===r||a===c)return v2(e,t,c,l,r,n);if(!isFinite(s))return x2(e,t,a,s,r,n,i)}}}function x2(e,t,r,n,i,o,a){let s=ya(e,t,r,n,a),c=ya(r,n,i,o,a);if(!(s===void 0||c===void 0))return[s,c]}function v2(e,t,r,n,i,o){return Math.abs(n-t)>Math.abs(o-n)?[e,r]:[r,i]}function PS(e,t,r){let n=e[0]*(1-nd)+t[0]*nd-r[0],i=e[1]*(1-nd)+t[1]*nd-r[1],o=e[2]*(1-nd)+t[2]*nd-r[2];return n*n+i*i+o*o}function l1(e,t,r,n,i,o,a,s){if(!isFinite(e)||!isFinite(r)||!iu(t)||!iu(n))return;e>r&&([e,t,r,n]=[r,n,e,t]);let c=tp(e,r),l=i(c),u=o*o;if(PS(t,n,l)<=u)return;let d=tp(e,c),f=i(d);for(;;){let g=PS(t,l,f),y=PS(n,f,l);if(g<=u&&y<=u)return r-e<s?d:void 0;if(g>y){if(r=c,n=l,c=d,l=f,d=tp(e,c),f=i(d),d===e||c-d<=a)return w2(e,t,c,l,r,n);if(!iu(f))return T2(e,t,d,f,r,n,i)}else{if(e=d,t=f,d=c,f=l,c=tp(r,c),l=i(c),c===r||c-d<=a)return w2(e,t,d,f,r,n);if(!iu(l))return T2(e,t,c,l,r,n,i)}}}function T2(e,t,r,n,i,o,a){let s=c1(e,t,r,n,a),c=c1(r,n,i,o,a);if(!(s===void 0||c===void 0))return[s,c]}function w2(e,t,r,n,i,o){return rd(n,t)>rd(o,n)?[e,r]:[r,i]}var Wb=class{constructor(t){this.comparator=t;this._data=[]}size(){return this._data.length}queue(t){let r=this._data.length;for(this._data.push(t);r>0;){let n=r-1>>>1;if(this.comparator(this._data[r],this._data[n])<0){let i=this._data[n];this._data[n]=this._data[r],this._data[r]=i,r=n}else break}}dequeue(){let t=this._data[0],r=this._data.pop();if(this._data.length>0&&r!==void 0){this._data[0]=r;let n=0,i=this._data.length-1;for(;;){let o=(n<<1)+1,a=o+1,s=n;if(o<=i&&this.comparator(this._data[o],this._data[s])<0&&(s=o),a<=i&&this.comparator(this._data[a],this._data[s])<0&&(s=a),s!==n){let c=this._data[s];this._data[s]=this._data[n],this._data[n]=c,n=s}else break}}return t}peek(){return this._data[0]}clear(){this._data.length=0}};function q9(e,t){let r=e.start[1]-e.end[1],n=e.end[0]-e.start[0],i=t.start[1]-t.end[1],o=t.end[0]-t.start[0],a=r*e.end[0]+n*e.end[1],s=i*t.end[0]+o*t.end[1],c=r*o-i*n;if(c!==0)return(r*s-i*a)/c}function z9(e,t,r){if(r.xSlope>=t.xSlope)return;if(t.scanlineX===r.scanlineX)return e;let n=t.start[1]>t.end[1]?t.start:t.end,i=r.start[1]>r.end[1]?r.start:r.end,o=n[1];if(i[1]<n[1]){if(o=i[1],MS(o,t)<i[0])return}else if(n[1]<i[1]){let s=MS(o,r);if(n[0]<s)return}else if(n[0]<i[0])return;let a=q9(t,r);if(a!==void 0)return Math.max(Math.min(a,o),e)}function MS(e,t){let r=t.end[0],n=t.start[0],i=t.end[1],o=t.start[1];if(i===e)return r;if(o===e)return n;{let a=(e-i)/(o-i),s=(1-a)*r+a*n;if(r<n){if(s<=r)return r;if(n<=s)return n}else{if(s<=n)return n;if(r<=s)return r}return s}}function DS(e){let t=0,r=0,n=!1,i=0;for(let{scanlineX:o,isClockwise:a}of e)a?i+=1:i-=1,i!==0&&!n?(n=!0,r=o):i===0&&n&&(n=!1,t+=o-r);return t}var Xb=class{constructor(t){this.scanlineY=-1/0;let r=1;this.activeEdges=[],this.events=new Wb(function(n,i){return n.y-i.y}),this.scanlineY=-1/0,this.polygonLength=t.length-1;for(let n=t.length-1;n>=1;n--){let i=t[n],o=t[n-1],a={id:r++,index:n-1,end:i,start:o,scanlineX:0,xSlope:1/0,isClockwise:o[1]>i[1],skipIntersectionWith:{}};o[1]>i[1]?(this.events.queue({type:"+",y:i[1],edge:a}),this.events.queue({type:"-",y:o[1],edge:a}),a.xSlope=(o[0]-i[0])/(o[1]-i[1]),a.scanlineX=i[0]):i[1]>o[1]?(this.events.queue({type:"+",y:o[1],edge:a}),this.events.queue({type:"-",y:i[1],edge:a}),a.xSlope=(i[0]-o[0])/(i[1]-o[1]),a.scanlineX=o[0]):this.events.queue({type:"h",y:o[1],edge:a})}}nextScanline(){var o;let t,r=this.events.peek();if(!r)return;if(r.y<=this.scanlineY)throw new Error("Programming error: expected next event to begin a new scanline");this.scanlineY=r.y,this.updateActiveEdgeScanlineIntersections();let n=DS(this.activeEdges),i=[];for(;t=this.events.dequeue();)if(t.type==="x"?this.swapActiveEdges(t):t.type==="+"?this.insertActiveEdge(t):t.type==="-"&&this.removeActiveEdge(t),i.push(t),((o=this.events.peek())==null?void 0:o.y)!==this.scanlineY)return{y:this.scanlineY,activeEdges:this.activeEdges,lengthBeforeProcessingEvents:n,events:i}}updateActiveEdgeScanlineIntersections(){let t=-1/0;for(let r of this.activeEdges){let n=MS(this.scanlineY,r);n<t?n=t:t=n,r.scanlineX=n}}insertActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,{xSlope:o,scanlineX:a}=n;for(var s=0;s<r.length;s++){let c=r[s];if(a<c.scanlineX||a===c.scanlineX&&o<=c.xSlope)break}r.splice(s,0,n),this.checkIntersection(i,r[s-1],n),this.checkIntersection(i,n,r[s+1])}checkIntersection(t,r,n){if(!r||!n||r.index===(n.index+1)%this.polygonLength||n.index===(r.index+1)%this.polygonLength)return;if(r.id<n.id){if(r.skipIntersectionWith[n.id])return}else if(n.skipIntersectionWith[r.id])return;let i=z9(t,r,n);if(i===void 0)return;r.id<n.id?r.skipIntersectionWith[n.id]=!0:n.skipIntersectionWith[r.id]=!0;let o={type:"x",y:i,edge1:r,edge2:n};this.events.queue(o)}removeActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,o=r.indexOf(n);r.splice(o,1),this.checkIntersection(i,r[o-1],r[o])}swapActiveEdges(t){let r=this.activeEdges,n=t.edge1,i=t.edge2,o=t.y,a=r.indexOf(n),s=a+1;a===-1||r[s]!==i?n.id<i.id?delete n.skipIntersectionWith[i.id]:delete i.skipIntersectionWith[n.id]:(r[a]=i,r[s]=n,this.checkIntersection(o,r[a-1],i),this.checkIntersection(o,n,r[s+1]))}static debugEvent(t){let r=`y=${t.y} `;return r+=t.type==="x"?`[x ${t.edge1.index}/${t.edge2.index}]`:`[${t.type} ${t.edge.index}] (${t.edge.end})-(${t.edge.start})`,r}debugState(){return`y=${this.scanlineY}
${this.activeEdges.map(t=>`[${t.index}] ${t.scanlineX}`)}`}};function S2(e){if(e.length<4||e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])return 0;let t=new Xb(e),r,n=0,i;for(;i=t.nextScanline();){let o=i.lengthBeforeProcessingEvents;r&&(n+=.5*(i.y-r.y)*(o+r.length)),r={y:i.y,length:DS(i.activeEdges)}}return n}function M2(e){if(!e.length)return[];if(e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])throw new Error("Programming error: expected last point to be a duplicate of the first point.");for(let f=0;f<e.length-1;f++)if(e[f][0]===e[f+1][0]&&e[f][1]===e[f+1][1])throw new Error(`Programming error: unexpected duplicate point at ${f+1}`);let t=new Xb(e),r=e.slice(0,-1).map(()=>0),n;for(;n=t.nextScanline();)for(let f of n.events){let g={};if(f.type==="h"){let y=f.edge;g[y.index]={xMin:Math.min(y.end[0],y.start[0]),xMax:Math.max(y.end[0],y.start[0]),dx:y.end[0]-y.start[0]}}else if(f.type==="x"){let y=f.edge1,x=f.edge2,b=P2([y.start,y.end],[x.start,x.end]),w=b>0?-1:b<0?1:0;r[y.index]+=w,r[x.index]-=w}for(let y of n.activeEdges){let x=y.end[1]-y.start[1];for(let b in g){let{xMin:w,xMax:E,dx:I}=g[b];if(w<y.scanlineX&&y.scanlineX<E){let S=I*x,D=S>0?-1:S<0?1:0;r[b]+=D,r[y.index]-=D}}}}let i=e.slice(0,-1).map(()=>0),o=e[0][1],a=0;for(let f=1;f<e.length;f++)e[f][1]<o&&(o=e[f][1],a=f);let s=e.length-1,c=a>0?a-1:s-1,l=(a+1)%s,d=P2([e[c],e[a]],[e[a],e[l]])>0?1:0;i[a]=d>0?-1:1;for(let f=0;f<s-1;f++){let g=(a+f)%s;d+=r[g],i[(g+1)%s]=d>0?-1:1}return i}function P2(e,t){let r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],i=t[1][0]-t[0][0],o=t[1][1]-t[0][1];return r*o-n*i}var U9=Gm,u1=ya,H9=3.154019550531224,D2=Math.pow(2,-13),rp=D2*D2,_2=rp*rp,_S=rp,OS=32,Cl=[],np=[];function $9(e,t){for(var r=OS;r>0;r--){var n=H9/OS*r,i=Math.sinh(n),o=Math.cosh(Math.PI/2*i),a=1/(Math.exp(Math.PI/2*i)*o),s=Math.cosh(n)/(o*o);e.push(a),t.push(s)}}$9(Cl,np);var L2=0;for(d1=0;d1<np.length;d1++)L2+=np[d1];var d1,p1=1/(1+2*L2);function Ya(e,t,r){return .5*(t*(2-r)+e*r)}function Y9(e,t,r){var n=.5*(t+r),i=U9(t,e(t),n,e(n),r,e(r),e);return i?.5*(i[0]+i[1]):n}function Kb(e,t,r,n,i){return{x1:e,x2:t,value:r,error:n,minerror:i}}function A2(e,t,r){var n=Math.abs(e(Ya(t,r,rp))),i=Math.abs(e(Ya(t,r,2*rp))),o=Math.abs(e(Ya(t,r,4*rp)));return n<rp||i<rp?!1:n>1.95*i&&i>1.95*o}function AS(e,t,r){var n=Ya(r,t,Cl[0]),i=Ya(t,r,Cl[0]),o=e(n),a=e(i),s=Ya(t,r,1),c=e(s),l,u;if(isFinite(c)&&!isFinite(o)){if(l=u1(n,o,s,c,e),Math.abs((l-t)/(r-t))>_S)return Kb(t,r,NaN,NaN,NaN);t=l,o=e(t)}if(isFinite(c)&&!isFinite(a)){if(u=u1(s,c,i,a,e),Math.abs((u-r)/(r-t))>_S)return Kb(t,r,NaN,NaN,NaN);r=u,a=e(r)}if(isFinite(o)&&isFinite(a)&&!isFinite(c)){if(l=u1(n,o,s,c,e),u=u1(s,c,i,a,e),Math.abs((u-l)/(r-t))>_S)return Kb(t,r,NaN,NaN,NaN);c=.5*(l+u)}if(A2(e,t,r)||A2(e,r,t))return Kb(t,r,NaN,NaN,NaN);for(var d=c,f=0,g=0,y=0,x=0,b=0,w=0,E=0;E<OS;E+=4)b=e(Ya(t,r,Cl[E])),w=e(Ya(r,t,Cl[E])),x=Math.max(x,Math.abs(b),Math.abs(w)),f+=np[E]*(b+w),b=e(Ya(t,r,Cl[E+1])),w=e(Ya(r,t,Cl[E+1])),x=Math.max(x,Math.abs(b),Math.abs(w)),y+=np[E+1]*(b+w),b=e(Ya(t,r,Cl[E+2])),w=e(Ya(r,t,Cl[E+2])),x=Math.max(x,Math.abs(b),Math.abs(w)),g+=np[E+2]*(b+w),b=e(Ya(t,r,Cl[E+3])),w=e(Ya(r,t,Cl[E+3])),x=Math.max(x,Math.abs(b),Math.abs(w)),y+=np[E+3]*(b+w);var I=d+f,S=I+g,D=S+y,O=Math.abs(g-I),_=Math.abs(y-S),A=p1*(r-t)*D,R=p1*Math.abs(r-t)*x*np[0],W;return O===0?W=p1*Math.abs(r-t)*_:W=p1*Math.abs(r-t)*_*(_/O)*(_/O),W=Math.max(W,R),Kb(t,r,A,W,R)}function O2(e){for(var t=-1/0,r=-1/0,n=-1,i=0,o=0;o<e.length;o++){var a=e[o];i+=a.value,a.error>t&&(t=a.error,n=o),a.minerror>r&&(r=a.minerror)}return{maxerror:t,maxminerror:r,maxindex:n,totalvalue:i}}function jb(e,t,r,n=32){if(isNaN(t)||isNaN(r))return NaN;var i=1;if(t>r){var o=t;t=r,r=o,i=-1}if(t===1/0&&r===1/0)return NaN;if(t===-1/0&&r===-1/0)return NaN;if(t===-1/0&&r===1/0)return i*jb(function(f){return e(f/((1+f)*(1-f)))*(1+f*f)/((1+f)*(1+f)*(1-f)*(1-f))},-1,1,n);if(t===-1/0)return i*jb(function(f){return-e(r-f/(1-f))/((1-f)*(1-f))},1,0,n);if(r===1/0)return i*jb(function(f){return e(t+f/(1-f))/((1-f)*(1-f))},0,1,n);for(var a=[AS(e,t,r)],s=O2(a),c=1;c<n&&!(Math.abs(s.maxerror/s.totalvalue)<=32*_2||s.maxerror<=32*_2||s.maxerror<=32*s.maxminerror||!isFinite(s.maxerror)||!isFinite(s.maxminerror));c++){var l=a[a.length-1];a[a.length-1]=a[s.maxindex],a[s.maxindex]=l;var u=a.pop(),d=Y9(e,Ya(u.x2,u.x1,.125),Ya(u.x1,u.x2,.125));a.push(AS(e,u.x1,d)),a.push(AS(e,d,u.x2)),s=O2(a)}return!isFinite(s.maxerror)||!isFinite(s.maxminerror)?NaN:Math.abs(s.totalvalue)<=10*s.maxminerror?0:i*s.totalvalue}function id(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function ip(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function au(){}var op=.7,Og=1/op,Bm="\\s*([+-]?\\d+)\\s*",Zb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ou="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",X9=/^#([0-9a-f]{3,8})$/,K9=new RegExp(`^rgb\\(${Bm},${Bm},${Bm}\\)$`),j9=new RegExp(`^rgb\\(${ou},${ou},${ou}\\)$`),Z9=new RegExp(`^rgba\\(${Bm},${Bm},${Bm},${Zb}\\)$`),J9=new RegExp(`^rgba\\(${ou},${ou},${ou},${Zb}\\)$`),Q9=new RegExp(`^hsl\\(${Zb},${ou},${ou}\\)$`),e7=new RegExp(`^hsla\\(${Zb},${ou},${ou},${Zb}\\)$`),N2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};id(au,Jb,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:R2,formatHex:R2,formatHex8:t7,formatHsl:r7,formatRgb:k2,toString:k2});function R2(){return this.rgb().formatHex()}function t7(){return this.rgb().formatHex8()}function r7(){return z2(this).formatHsl()}function k2(){return this.rgb().formatRgb()}function Jb(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=X9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?V2(t):r===3?new ho(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?g1(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?g1(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=K9.exec(e))?new ho(t[1],t[2],t[3],1):(t=j9.exec(e))?new ho(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Z9.exec(e))?g1(t[1],t[2],t[3],t[4]):(t=J9.exec(e))?g1(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Q9.exec(e))?B2(t[1],t[2]/100,t[3]/100,1):(t=e7.exec(e))?B2(t[1],t[2]/100,t[3]/100,t[4]):N2.hasOwnProperty(e)?V2(N2[e]):e==="transparent"?new ho(NaN,NaN,NaN,0):null}function V2(e){return new ho(e>>16&255,e>>8&255,e&255,1)}function g1(e,t,r,n){return n<=0&&(e=t=r=NaN),new ho(e,t,r,n)}function Qb(e){return e instanceof au||(e=Jb(e)),e?(e=e.rgb(),new ho(e.r,e.g,e.b,e.opacity)):new ho}function ex(e,t,r,n){return arguments.length===1?Qb(e):new ho(e,t,r,n==null?1:n)}function ho(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}id(ho,ex,ip(au,{brighter(e){return e=e==null?Og:Math.pow(Og,e),new ho(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?op:Math.pow(op,e),new ho(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ho(Ag(this.r),Ag(this.g),Ag(this.b),m1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:F2,formatHex:F2,formatHex8:n7,formatRgb:G2,toString:G2}));function F2(){return`#${_g(this.r)}${_g(this.g)}${_g(this.b)}`}function n7(){return`#${_g(this.r)}${_g(this.g)}${_g(this.b)}${_g((isNaN(this.opacity)?1:this.opacity)*255)}`}function G2(){let e=m1(this.opacity);return`${e===1?"rgb(":"rgba("}${Ag(this.r)}, ${Ag(this.g)}, ${Ag(this.b)}${e===1?")":`, ${e})`}`}function m1(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ag(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function _g(e){return e=Ag(e),(e<16?"0":"")+e.toString(16)}function B2(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Pl(e,t,r,n)}function z2(e){if(e instanceof Pl)return new Pl(e.h,e.s,e.l,e.opacity);if(e instanceof au||(e=Jb(e)),!e)return new Pl;if(e instanceof Pl)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,s=o-i,c=(o+i)/2;return s?(t===o?a=(r-n)/s+(r<n)*6:r===o?a=(n-t)/s+2:a=(t-r)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new Pl(a,s,c,e.opacity)}function h1(e,t,r,n){return arguments.length===1?z2(e):new Pl(e,t,r,n==null?1:n)}function Pl(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}id(Pl,h1,ip(au,{brighter(e){return e=e==null?Og:Math.pow(Og,e),new Pl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?op:Math.pow(op,e),new Pl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ho(LS(e>=240?e-240:e+120,i,n),LS(e,i,n),LS(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Pl(q2(this.h),f1(this.s),f1(this.l),m1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=m1(this.opacity);return`${e===1?"hsl(":"hsla("}${q2(this.h)}, ${f1(this.s)*100}%, ${f1(this.l)*100}%${e===1?")":`, ${e})`}`}}));function q2(e){return e=(e||0)%360,e<0?e+360:e}function f1(e){return Math.max(0,Math.min(1,e||0))}function LS(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var y1=Math.PI/180,b1=180/Math.PI;var x1=18,U2=.96422,H2=1,$2=.82521,Y2=4/29,qm=6/29,W2=3*qm*qm,i7=qm*qm*qm;function X2(e){if(e instanceof su)return new su(e.l,e.a,e.b,e.opacity);if(e instanceof od)return j2(e);e instanceof ho||(e=Qb(e));var t=VS(e.r),r=VS(e.g),n=VS(e.b),i=NS((.2225045*t+.7168786*r+.0606169*n)/H2),o,a;return t===r&&r===n?o=a=i:(o=NS((.4360747*t+.3850649*r+.1430804*n)/U2),a=NS((.0139322*t+.0971045*r+.7141733*n)/$2)),new su(116*i-16,500*(o-i),200*(i-a),e.opacity)}function FS(e,t,r,n){return arguments.length===1?X2(e):new su(e,t,r,n==null?1:n)}function su(e,t,r,n){this.l=+e,this.a=+t,this.b=+r,this.opacity=+n}id(su,FS,ip(au,{brighter(e){return new su(this.l+x1*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new su(this.l-x1*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=U2*RS(t),e=H2*RS(e),r=$2*RS(r),new ho(kS(3.1338561*t-1.6168667*e-.4906146*r),kS(-.9787684*t+1.9161415*e+.033454*r),kS(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function NS(e){return e>i7?Math.pow(e,1/3):e/W2+Y2}function RS(e){return e>qm?e*e*e:W2*(e-Y2)}function kS(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function VS(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function o7(e){if(e instanceof od)return new od(e.h,e.c,e.l,e.opacity);if(e instanceof su||(e=X2(e)),e.a===0&&e.b===0)return new od(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*b1;return new od(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function K2(e,t,r,n){return arguments.length===1?o7(e):new od(e,t,r,n==null?1:n)}function od(e,t,r,n){this.h=+e,this.c=+t,this.l=+r,this.opacity=+n}function j2(e){if(isNaN(e.h))return new su(e.l,0,0,e.opacity);var t=e.h*y1;return new su(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}id(od,K2,ip(au,{brighter(e){return new od(this.h,this.c,this.l+x1*(e==null?1:e),this.opacity)},darker(e){return new od(this.h,this.c,this.l-x1*(e==null?1:e),this.opacity)},rgb(){return j2(this).rgb()}}));var eB=-.14861,GS=1.78277,BS=-.29227,v1=-.90649,tx=1.97294,Z2=tx*v1,J2=tx*GS,Q2=GS*BS-v1*eB;function a7(e){if(e instanceof Lg)return new Lg(e.h,e.s,e.l,e.opacity);e instanceof ho||(e=Qb(e));var t=e.r/255,r=e.g/255,n=e.b/255,i=(Q2*n+Z2*t-J2*r)/(Q2+Z2-J2),o=n-i,a=(tx*(r-i)-BS*o)/v1,s=Math.sqrt(a*a+o*o)/(tx*i*(1-i)),c=s?Math.atan2(a,o)*b1-120:NaN;return new Lg(c<0?c+360:c,s,i,e.opacity)}function qS(e,t,r,n){return arguments.length===1?a7(e):new Lg(e,t,r,n==null?1:n)}function Lg(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}id(Lg,qS,ip(au,{brighter(e){return e=e==null?Og:Math.pow(Og,e),new Lg(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?op:Math.pow(op,e),new Lg(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*y1,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new ho(255*(t+r*(eB*n+GS*i)),255*(t+r*(BS*n+v1*i)),255*(t+r*(tx*n)),this.opacity)}}));function Ng(e,t){if(!isFinite(e)||!isFinite(t))return NaN;if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){let n=t;t=e,e=n}if(t===0)return e;let r=e%t;for(;r>0;)e=t,t=r,r=e%t;return t}function Rg(e,t){if(isNaN(e)&&t===0)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);let r=td(t,100);return Bs(r.n/r.d,t,2)&&r.d%2===1?(r.n%2===0?1:-1)*Math.pow(-e,t):NaN}function _n(e){return Object.keys(e)}function Fi(e){return Object.create(e)}function ap(e){return typeof e!="object"||!e?!1:e.type==="Action"}var $r={};nb($r,{actionMergeFreeVariable:()=>FM,addArgumentsToDefinition:()=>xx,addTypeError:()=>ox,adjacentMixedNumber:()=>F1,adjacentNumbers:()=>cD,andTypeError:()=>oM,ansUndefined:()=>C_,assignmentsUnsupported:()=>Cx,badEqualitySlice:()=>lu,badForInputListDependency:()=>q_,badForIntervalDependency:()=>z_,badImplicitCall:()=>V1,badIntegralBoundDependency:()=>T_,badLogExponent:()=>CD,badProductBoundDependency:()=>p_,badSampleSize:()=>E_,badSumBoundDependency:()=>d_,badSymbolContext:()=>Ug,badTrigExponent:()=>ID,badTupleDimensions:()=>sD,baseCaseCannotDependOnRecursiveParameter:()=>$S,baseCaseTooComplicatedUsePiecewise:()=>ix,baseCasesMustAllHaveSameReturnType:()=>nx,binaryOperatorMissingOperand:()=>hx,blankExpression:()=>bx,boxplotBreadthInvalid:()=>f7,boxplotOffsetInvalid:()=>g7,cannotAssignColor:()=>UD,cannotRedefine:()=>Xm,cannotRestrict:()=>zD,cannotRestrictWithEquality:()=>HD,cannotSubscript:()=>AD,cantCombineSphericalAndCylindrical:()=>W1,cdfMaxInvalid:()=>v7,cdfMaxLessThanMin:()=>T7,cdfMinInvalid:()=>x7,cdfRequiresArguments:()=>jM,cdfTooManyArguments:()=>ZM,clickableObjectAlreadyAssigned:()=>C7,clickableObjectAssignmentNotDefined:()=>I7,clickableObjectAssignmentNotIdentifier:()=>P7,clickableObjectInvalidExpression:()=>S7,colonMissingCondition:()=>MD,colorArity:()=>tD,combineTypeError:()=>L1,comparatorTypeError:()=>iM,complicatedDoubleInequality:()=>Z1,complicatedPolarImplicit:()=>ZD,constantUnsupported:()=>Hg,coordinateAccessTypeError:()=>cM,cycle:()=>rB,deeplyNested:()=>UM,dependsOnDeletedGeoObject:()=>j_,derivativeMissingBody:()=>x_,derivativeTypeError:()=>IM,derivativeTypeErrorRespect:()=>CM,derivativeVariableTypeError:()=>PM,differentialWithSuperscript:()=>m_,distributionAsFunction:()=>Q1,divideTypeError:()=>sx,domainMaxInvalid:()=>y7,domainMaxLessThanMin:()=>b7,domainMinInvalid:()=>h7,dotLHSConstantNumberError:()=>M1,dotLHSTypeError:()=>gM,dotRHSPropertyError:()=>fM,duplicateFunctionParameter:()=>DD,duplicateUpdateRules:()=>NM,eachBaseCaseArgumentMustBeSimple:()=>C1,emptyParen:()=>yx,emptyPipe:()=>ED,emptyRadical:()=>vD,emptyRadicalIndex:()=>TD,emptySquareBracket:()=>wD,emptySubscript:()=>q1,emptySuperscript:()=>mD,equationRequired:()=>J1,equationsUnsupported:()=>Us,eventHandlerTypeError:()=>GM,expectedArgumentToBeButFound:()=>jS,exponentTypeError:()=>cx,featureUnavailable:()=>Cn,fractionEmpty:()=>fD,fractionMissingDenominator:()=>gD,fractionMissingNumerator:()=>pD,fractionsUnavailable:()=>iw,functionDefinitionsUnsupported:()=>$g,functionNameAsParameter:()=>_D,functionNotDefined:()=>Wm,functionRequiresNumberOfArguments:()=>KS,functionTypeError:()=>ra,functionUnsupported:()=>ba,geometryLengthTypeError:()=>dM,getLogInternalErrors:()=>u7,gpuLongProduct:()=>XM,gpuLongSum:()=>WM,gpuMaxListSize:()=>Ym,gpuUnsupportedFunction:()=>$m,gpuUnsupportedIntegral:()=>YM,gpuVariableListLength:()=>sp,gpuVariableProduct:()=>R1,gpuVariableSum:()=>N1,heterogeneousList:()=>px,identifierAsFunction:()=>G1,identifierIsNotFunction:()=>B1,illegalBinWidth:()=>Ex,illegalDotCall:()=>dx,implicitsDisabled:()=>jD,incorrectProductLowerBound:()=>u_,incorrectSumLowerBound:()=>l_,indexTypeError:()=>ux,inequalitiesDisabled:()=>X1,inequalitiesUnsupported:()=>ms,integralArgumentTypeError:()=>EM,integralLowerBoundTypeError:()=>TM,integralMissingBody:()=>b_,integralMissingBound:()=>g_,integralMissingDifferential:()=>f_,integralUpperBoundTypeError:()=>wM,internal:()=>Ie,invalidDependentFirstTableColumn:()=>w7,invalidDoubleEquality3d:()=>QD,invalidDoubleInequality3d:()=>JD,invalidDoubleInequalityVariables:()=>K1,invalidFirstTableColumn:()=>r_,invalidFunctionName:()=>nw,invalidHalfEmptyRange:()=>a_,invalidImplicitVariables:()=>zg,invalidImplicitVariables3d:()=>XD,invalidInequalityVariables:()=>WD,invalidIntervalComprehensionArity:()=>J_,invalidIntervalComprehensionParameter:()=>Jm,invalidIntervalComprehensionReturnType:()=>Z_,invalidLHS:()=>$D,invalidNestedIntervalComprehension:()=>Q_,invalidOperatorName:()=>yD,invalidRegressionParameter:()=>n_,invalidSubscript:()=>hD,invalidTableEntry:()=>vx,invalidTableHeader:()=>t_,listComprehensionIncorrectInput:()=>B_,listComprehensionInputListTypeError:()=>G_,listTypeError:()=>Gg,logScaleBoxPlot:()=>zM,logScaleDotPlot:()=>qM,logScaleHistogram:()=>BM,logScaleTypeError:()=>Hm,logbaseUnsupported:()=>P_,malformedList:()=>aD,malformedPoint:()=>oD,matrixAddDimensions:()=>O_,matrixAssignment:()=>A_,matrixElementTypeError:()=>V_,matrixFractionalPower:()=>R_,matrixInvalidVariable:()=>F_,matrixMultiplyDimensions:()=>N_,matrixPowerDimensions:()=>k_,matrixSubtractDimensions:()=>L_,maxListSize:()=>gx,methodRequiresList:()=>kc,mismatchedBraces:()=>v_,mismatchedDoubleInequality:()=>j1,mixedComparatorChain:()=>rM,mixedRestrictionEquation:()=>$M,multipleEqualityRestrictions:()=>HM,multiplyDefined:()=>$1,multiplyDefinedByTables:()=>OD,multiplyTypeError:()=>Fg,multiplyTypeError2D:()=>eM,multiplyTypeError3D:()=>tM,multiplyTypeErrorCross:()=>QS,negativeTypeError:()=>lx,nonArithmeticRange:()=>wx,nonListDoubleReducer:()=>Tx,nonListParameterizedReducer:()=>o_,nonSquareDeterminant:()=>M_,nonSquareInverse:()=>__,nonSquareTrace:()=>D_,opaque:()=>ZS,optimizationError:()=>i_,orTypeError:()=>aM,parameterAlreadyDefined:()=>H1,parenthesesUnavailable:()=>S_,pdfWrongArity:()=>KM,percentMissingOf:()=>w_,piecewiseBranchTypeError:()=>MM,piecewiseConditionTypeError:()=>A1,piecewiseMissingCondition:()=>PD,piecewisePartMissingCondition:()=>SD,pointTypeError:()=>sM,pointsUnsupported:()=>cd,polygonTwoNumbersError:()=>fx,polygonUnsupportedIn3d:()=>rw,primeVariableTypeError:()=>SM,primeWithoutParen:()=>U1,primedFunctionArity:()=>Bg,productArgumentTypeError:()=>vM,productInfiniteBoundError:()=>_1,productLowerBoundTypeError:()=>bM,productMissingBody:()=>y_,productMissingBound:()=>c_,productUpperBoundTypeError:()=>xM,randomArity:()=>QM,randomFromBroadcastDistribution:()=>eD,recursionCyclicDependency:()=>YS,recursionDoesNotTerminate:()=>WS,recursionInRegression:()=>p7,recursiveDepthExceeded:()=>XS,recursiveFunctionCannotDependOnFreeVariable:()=>HS,recursiveFunctionMissingBaseCase:()=>I1,recursiveFunctionMissingBaseCaseWithMetadata:()=>US,regressionTypeError:()=>AM,regressionsUnsupported:()=>sd,selfReferentialBaseCase:()=>LD,selfReferentialFunctions:()=>qg,setLogInternalErrors:()=>l7,shadowedIndex:()=>Y1,shadowedIntegrationVariable:()=>ew,shadowedListComprehensionInput:()=>aw,singleVariableImplicitEquationsDisabled:()=>KD,singularInverse:()=>ow,sliderLimitReferencesExport:()=>RD,sliderMaxInvalid:()=>VD,sliderMaxLessThanMin:()=>FD,sliderMinInvalid:()=>kD,sliderStepInvalid:()=>GD,substitutionAmbiguousComma:()=>cp,substitutionBodyAction:()=>D7,substitutionBodyDependsOnRegression:()=>W_,substitutionDuplicateSymbol:()=>X_,substitutionFunctionLHS:()=>Dx,substitutionIllegalLHS:()=>Zm,substitutionInvalidAssignments:()=>Sx,substitutionLocalLHS:()=>Mx,substitutionNested:()=>sw,substitutionRecursiveCallLHS:()=>K_,substitutionTypeError:()=>M7,substitutionUnsupportedInterval:()=>cw,subtractTypeError:()=>ax,sumArgumentTypeError:()=>yM,sumInfiniteBoundError:()=>D1,sumLowerBoundTypeError:()=>mM,sumMissingBody:()=>h_,sumMissingBound:()=>s_,sumUpperBoundTypeError:()=>hM,superscriptWithPrime:()=>xD,tableCycleWithoutGlobalDefinition:()=>m7,tableEntryTypeError:()=>_M,tableHeaderTypeError:()=>DM,tdistWrongArity:()=>JM,threeDLengthTypeError:()=>pM,tickerMinStepNonNegativeNumber:()=>ND,tokenWithSubscript:()=>lD,tooManyArguments:()=>k1,tooManyVariables:()=>un,transformationDefinitionTypeError:()=>lM,transformationTypeError:()=>uM,ttestListTooShort:()=>jm,unaryOperatorMissingLeft:()=>uD,unaryOperatorMissingRight:()=>dD,unexpectedEquality:()=>JS,unexpectedInequality:()=>S1,unexpectedPrime:()=>z1,unexpectedSubscript:()=>bD,unexpectedSymbol:()=>Xa,unplottableEqualityChain:()=>e_,unplottableLongInequalityChain:()=>nM,unplottablePolarFunction:()=>YD,unrecognizedSymbol:()=>P1,updateRuleFunctionLHS:()=>VM,updateRuleIllegalLHS:()=>kM,updateRuleLocalLHS:()=>O1,updateRuleNonIdentifierLHS:()=>LM,updateRuleTypeError:()=>OM,updateRuleUndefinedLHS:()=>RM,useRForCylindricalCoordinates:()=>qD,useRhoForSphericalCoordinates:()=>BD,variableAsFunction:()=>Km,variableLengthDistributionList:()=>Px,variableLengthIntegralDependsOnIntegrationVariable:()=>Y_,variableLengthProductBodyDependsOnIndex:()=>$_,variableLengthSumBodyDependsOnIndex:()=>H_,variableLengthTopLevelList:()=>U_,variableSeed:()=>I_,variableUnsupported:()=>E7,variablesUnsupported:()=>Ix,writeIntegral:()=>tw,wrongArity:()=>fc,wrongArityLengthAsCount:()=>rD,wrongDoubleReducerArity:()=>mx,wrongParameterizedReducerArity:()=>nD,zeroArgReducer:()=>iD});var ad=()=>({type:"empty"}),Gi=()=>c7([-1/0,1/0]),cu=()=>zs([-1/0,1/0]),zs=e=>T1(e,!0),c7=e=>T1(e,!1),T1=(e,t)=>isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?ad():{type:"interval",bounds:e,tight:t};function Wa(e){return e.type==="empty"}function qs(e){return Wa(e)||e.tight}var zm=(e,t)=>{if(t===0)return e>0?cu():ad();let r=-e/t,n=t<0?[-1/0,r]:[r,1/0];return zs(n)},ii=(e,t)=>{if(Wa(e)||Wa(t))return ad();let r=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])],n=qs(e)&&qs(t);return T1(r,n)},rx=(e,t)=>{if(Wa(e))return t;if(Wa(t))return e;let r=[Math.min(e.bounds[0],t.bounds[0]),Math.max(e.bounds[1],t.bounds[1])],n;return!qs(e)&&!qs(t)?n=!1:qs(e)&&!qs(t)?n=e.bounds[0]<=t.bounds[0]&&e.bounds[1]>=t.bounds[1]:!qs(e)&&qs(t)?n=t.bounds[0]<=e.bounds[0]&&t.bounds[1]>=e.bounds[1]:n=e.bounds[0]<=t.bounds[1]&&t.bounds[0]<=e.bounds[1],T1(r,n)},tB=(e,t,r)=>{if(Wa(e))return r;let n=ii(e,t);return qs(e)?(e.bounds[0]>-1/0&&(n=rx(n,ii(zs([-1/0,e.bounds[0]]),r))),e.bounds[1]<1/0&&(n=rx(n,ii(zs([e.bounds[1],1/0]),r)))):n=rx(n,ii(r,Gi())),n};var Gr=class{constructor(){this.exportPenalty=0;this._dependencies=[],this._dummyDependencies=[],this._updateSymbols=[],this._substitutionSymbols=[],this._scope={definitions:[],dependencies:[],substitutionDependencies:[],scopes:[]},this._exports=[],this.metaData={extraDepNodes:[]},this.userData={}}getDefaultDragMode(t){return"NONE"}setInputSpan(t){this._inputSpan=t}getInputString(){return this._inputSpan===void 0?"":Jn(this._inputSpan)}getInputSpan(){return this._inputSpan}shouldExportAns(){return!1}getAnsVariable(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty("index")?["ans_"+this.userData.index]:[]}addDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._scope.dependencies.indexOf(t)===-1&&this._scope.dependencies.push(t)}addDependencies(t){for(var r=0;r<t.length;r++)this.addDependency(t[r])}addDummyDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t)}addDummyDependencies(t){for(var r=0;r<t.length;r++)this.addDummyDependency(t[r])}addUpdateSymbol(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._updateSymbols.indexOf(t)===-1&&this._updateSymbols.push(t)}addSubstitutionSymbol(t){this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t),this._substitutionSymbols.indexOf(t)===-1&&this._substitutionSymbols.push(t)}addSubstitutionDependencies(t){for(var r=0;r<t.length;r++){var n=t[r];if(this._dependencies.indexOf(n)===-1)throw new Error("Programming error: substitution dependency "+n+" must also be registered as a regular dependency");this._scope.substitutionDependencies.indexOf(n)===-1&&this._scope.substitutionDependencies.push(n)}}mergeDependencies(...t){for(var r=0;r<t.length;r++){var n=t[r],i;for(i=0;i<n._dependencies.length;i++)this._dependencies.indexOf(n._dependencies[i])===-1&&this._dependencies.push(n._dependencies[i]);for(i=0;i<n._updateSymbols.length;i++)this._updateSymbols.indexOf(n._updateSymbols[i])===-1&&this._updateSymbols.push(n._updateSymbols[i]);for(i=0;i<n._substitutionSymbols.length;i++)this._substitutionSymbols.indexOf(n._substitutionSymbols[i])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[i]);for(i=0;i<n._scope.dependencies.length;i++)this._scope.dependencies.indexOf(n._scope.dependencies[i])===-1&&this._scope.dependencies.push(n._scope.dependencies[i]);for(i=0;i<n._scope.substitutionDependencies.length;i++)this._scope.substitutionDependencies.indexOf(n._scope.substitutionDependencies[i])===-1&&this._scope.substitutionDependencies.push(n._scope.substitutionDependencies[i]);this.addDummyDependencies(n.getDummyDependencies()),Array.prototype.push.apply(this._scope.scopes,n._scope.scopes)}}mergeDependenciesInScope(t,r,n,i){this.addDummyDependencies(r);var o=n.getScope(),a={kind:t,definitions:r,dependencies:o.dependencies,substitutionDependencies:o.substitutionDependencies,scopes:o.scopes,functionDefinitionSymbol:i==null?void 0:i.functionDefinitionSymbol};this._scope.scopes.push(a);for(var s=0;s<n._dependencies.length;s++)this._dependencies.indexOf(n._dependencies[s])===-1&&this._dependencies.push(n._dependencies[s]);for(s=0;s<n._updateSymbols.length;s++)this._updateSymbols.indexOf(n._updateSymbols[s])===-1&&this._updateSymbols.push(n._updateSymbols[s]);for(s=0;s<n._substitutionSymbols.length;s++)this._substitutionSymbols.indexOf(n._substitutionSymbols[s])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[s]);this.addDummyDependencies(n.getDummyDependencies())}getDependencies(){return this._dependencies}graphmodeDependencies(t,r){return this.getDependencies()}getDummyDependencies(){return this._dummyDependencies}getUpdateSymbols(){return this._updateSymbols}getSubstitutionSymbols(){return this._substitutionSymbols}getScope(){return this._scope}dependsOn(t){return this._dependencies.indexOf(t)>-1}getExports(t){var r=this._exports||[];if(this.userData&&"id"in this.userData){var n=this.userData.id;r=r.concat(["idref_"+n])}return t.ansEnabled()&&(r=r.concat(this.getAnsVariable())),r}getLegalExports(t){return this.getExports(t).filter(function(r){return!t.assignmentForbidden(r)})}exportsSymbol(t){return this._exports.indexOf(t)>-1}exportTo(t,r,n){for(var i=this.getLegalExports(t),o=0;o<i.length;o++){var a=i[o];if(n[a])return;n[a]=r.blocksExport?r:this}}getOperator(){return this.operator||"="}isInequality(){return!1}isShadeBetween(){return!1}getAllIds(){return this.userData?[this.userData.id]:[]}getEvaluationInfo(){return!1}shouldPromoteToSlider(t){return!1}getSliderVariables(t,r,n){var i=t.sliderVariables(n!=null?n:r.getDependencies());return r.valueType===z||r.valueType===on||r.valueType===oe||r.valueType===ji?t.is3dPolicy()?i.includes("t")&&!i.includes("u")&&!i.includes("v")?i.filter(o=>o!="t"):!i.includes("t")&&(i.includes("u")||i.includes("v"))?i.filter(o=>o!="u"&&o!="v"):i:i.filter(function(o){return!t.validParametricVariable(o)}):i}getCompiledDerivative(){var t=this.getDependencies(),n=this.takeDerivative(t[0]||"x");return n.getCompiledFunction()}asValue(){}boundDomain(t){return Gi()}getCursorContext(){}polynomialOrder(t){}getPolynomialCoefficients(t){}asTypedValue(){}substitute(t){}getExpressionType(t,r){}tableInfo(t,r){}analyze(t,r,n){throw Ie(`Node ${this.type} does not define analyze.`)}analyzeFourFunction(t,r,n){}analyzeScientific(t,r,n){}analyzeSingleExpressionScientific(t,r,n){}getGraphMode(t,r){}getMoveStrategy(t,r,n,i){}};var q=class extends Gr{constructor(r){super();this.isError=!0;this._msg=r,this.blocksExport=!0}evaluateOnce(r){return this._msg}getError(){return this._msg}setDependencies(r){return this.addDependencies(r),this}setActionValue(r){this.actionValue=r}allowExport(){return this.blocksExport=!1,this}setCursorContext(r){this.cursorContext=r}getCursorContext(){return this.cursorContext}};var E1=!1;function l7(e){E1=e}function u7(){return E1}function d7(...e){E1&&console.error(...e)}function Ie(e){if(E1){let t=e instanceof Error?e:new Error(`${e}`);return d7(t.stack),new q(L("shared-calculator-error-internal-error",{msg:t.message}))}return new q(L("shared-calculator-error-parse-error"))}function I1(e){let t=e.length,r=e[0];return new q(L("shared-calculator-error-recursion-missing-base-case",{count:gb(t),lastSymbol:Ee(r),symbols:e.slice(1).map(n=>Ee(n)).join("', '")}))}function US(e,t){let r=I1(e);return r.recursionMetadata=t,r}function HS(e){return new q(L("shared-calculator-error-recursion-base-case-free-variable",{freeVariable:Ee(e)}))}function $S(e){return new q(L("shared-calculator-error-recursion-base-case-free-variable",{freeVariable:Ee(e)}))}function nx({blockExport:e}){let t=new q(L("shared-calculator-error-recursion-base-case-same-type"));return e||t.allowExport(),t}function ix(){return new q(L("shared-calculator-error-recursion-base-case-too-complicated"))}function C1(){return new q(L("shared-calculator-error-recursion-base-case-argument-non-number"))}function YS(){return new q(L("shared-calculator-error-recursion-does-not-terminate"))}function WS(){return new q(L("shared-calculator-error-recursion-does-not-terminate"))}function XS(){return new q(L("shared-calculator-error-recursion-depth-limit-exceeded"))}function KS(e,t){return new q(L("shared-calculator-error-recursion-wrong-arity",{fnSymbol:Ee(e),count:gb(t)}))}function jS(e,t,r,{blockExport:n}){let i=new q(L("shared-calculator-error-recursion-argument-type",{index:e+1,expectedType:t,foundType:r}));return n||i.allowExport(),i}function ZS(){return new q(L("shared-calculator-error-parse-error"))}function P1(e){return e=Ee(e),new q(L("shared-calculator-error-unrecognized-symbol",{symbol:e}))}function S1(){return new q(L("shared-calculator-error-unexpected-inequality"))}function JS(){return new q(L("shared-calculator-error-unexpected-equality"))}function Xa(e){return e=Ee(e),new q(L("shared-calculator-error-unexpected-symbol",{symbol:e}))}function ox(e,{blockExport:t}){let r=new q(L("shared-calculator-error-add-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function ax(e,{blockExport:t}){let r=new q(L("shared-calculator-error-subtract-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function Fg(e,{blockExport:t}){let r=new q(L("shared-calculator-error-multiply-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function QS(e,{blockExport:t}){let r=new q(L("shared-calculator-error-multiply-type-error-cross",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function eM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-multiply-type-error-2d",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function tM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-multiply-type-error-3d",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function sx(e,{blockExport:t}){let r=new q(L("shared-calculator-error-divide-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function cx(e,{blockExport:t}){let r=new q(L("shared-calculator-error-exponent-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function lx(e,{blockExport:t}){let r=new q(L("shared-calculator-error-negative-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function rM(){return new q(L("shared-calculator-error-mixed-comparator-chain"))}function nM(){return new q(L("shared-calculator-error-unplottable-long-inequality-chain"))}function iM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-comparator-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function oM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-operator-type-error",{symbol:"and",symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function aM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-operator-type-error",{symbol:"or",symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function Gg(e,{blockExport:t}){let r=new q(L("shared-calculator-error-list-type-error",{symbol1:e[0]}));return t||r.allowExport(),r}function sM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-point-type-error",{symbol1:e,symbol2:dt(z)}));return t||r.allowExport(),r}function ux(e,{blockExport:t}){let r=new q(L("shared-calculator-error-index-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function cM(e,t,{blockExport:r}){let n=new q(L("shared-calculator-error-coordinate-access-type-error",{coordinate:t,symbol:e[0]}));return r||n.allowExport(),n}function ra(e,t,{blockExport:r}){let n;switch(t.length){case 1:n=new q(L("shared-calculator-error-function-type-error-1",{fn:Ee(e),arg:t[0]}));break;case 2:n=new q(L("shared-calculator-error-function-type-error-2",{fn:Ee(e),arg1:t[0],arg2:t[1]}));break;default:n=new q(L("shared-calculator-error-function-type-error-many",{fn:Ee(e)}));break}return r||n.allowExport(),n}var zS={translate:"translation",rotate:"rotation",dilate:"dilation",reflect:"reflection"};function lM(e,t,r,{blockExport:n}){let i=[];if(r.maxArity===void 0)return ra(e,t,{blockExport:n});for(let s=1;s<r.argTypes.length;s++){let c=r.argTypes[s];typeof c=="number"?i.push(dt(c)):i.push(dt(c.getTypes()[0]))}let o="";switch(i.length){case 1:o=L(t.length>i.length?"shared-calculator-error-transformation-definition-expected-types-use-fewer-1":"shared-calculator-error-transformation-definition-expected-types-1",{arg:i[0]});break;case 2:o=L(t.length>i.length?"shared-calculator-error-transformation-definition-expected-types-use-fewer-2":"shared-calculator-error-transformation-definition-expected-types-2",{arg1:i[0],arg2:i[1]});break}let a;switch(t.length){case 1:a=new q(L(t.length<i.length?"shared-calculator-error-transformation-definition-type-error-use-more-1":"shared-calculator-error-transformation-definition-type-error-1",{fn:Ee(zS[e]),arg:t[0],expectedTypeMessage:o}));break;case 2:a=new q(L(t.length<i.length?"shared-calculator-error-transformation-definition-type-error-use-more-2":"shared-calculator-error-transformation-definition-type-error-2",{fn:Ee(zS[e]),arg1:t[0],arg2:t[1],expectedTypeMessage:o}));break;default:a=new q(L("shared-calculator-error-transformation-definition-type-error-many",{fn:Ee(zS[e])}));break}return n||a.allowExport(),a}function uM(e,t,{blockExport:r}){let n;switch(t.length){case 1:n=new q(L("shared-calculator-error-transformation-type-error-1",{fn:Ee(e),arg:t[0]}));break;case 2:n=new q(L("shared-calculator-error-transformation-type-error-2",{fn:Ee(e),arg1:t[0],arg2:t[1]}));break;default:n=new q(L("shared-calculator-error-transformation-type-error-many",{fn:Ee(e)}));break}return r||n.allowExport(),n}function dM(e,t,{blockExport:r}){let n=Ee(e),i=Ee("count"),o=new q(L("shared-calculator-error-geometry-length-type-error",{fn:n,alternativeFn:i,arg:t}));return r||o.allowExport(),o}function pM(e,t,{blockExport:r}){let n=Ee(e),i=Ee("count"),o=new q(L("shared-calculator-error-3d-length-type-error",{fn:n,alternativeFn:i,arg:t}));return r||o.allowExport(),o}function dx(e){return new q(L("shared-calculator-error-illegal-dot-call",{symbol:Ee(e)}))}function gM(e,t,{blockExport:r}){let n=new q(L("shared-calculator-error-dot-lhs-type-error",{symbol:Ee(e),type:t}));return r||n.allowExport(),n}function M1(){return new q(L("shared-calculator-error-dot-lhs-constant-number"))}function fM(e){return new q(L("shared-calculator-error-dot-rhs-property-error",{symbol:Ee(e)}))}function mM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-sum-lower-bound-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function hM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-sum-upper-bound-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function D1(){return new q(L("shared-calculator-error-sum-infinite-bound-type-error"))}function yM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-sum-argument-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function bM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-product-lower-bound-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function xM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-product-upper-bound-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function _1(){return new q(L("shared-calculator-error-product-infinite-bound-type-error"))}function vM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-product-argument-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function TM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-integral-lower-bound-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function wM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-integral-upper-bound-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function EM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-integral-argument-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function IM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-derivative-type-error",{symbol:e[0]}));return t||r.allowExport(),r}function CM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-derivative-type-error-respect",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function PM(e,t,{blockExport:r}){let n=new q(L("shared-calculator-error-derivative-variable-type-error",{symbol1:Ee(e),symbol2:t[0]}));return r||n.allowExport(),n}function SM(e,t,{blockExport:r}){let n=new q(L("shared-calculator-error-prime-variable-type-error",{symbol1:Ee(e),symbol2:t[0]}));return r||n.allowExport(),n}function A1(e,{blockExport:t}){let r=new q(L("shared-calculator-error-piecewise-condition-type-error",{symbol1:dt(tt),symbol2:e[0]}));return t||r.allowExport(),r}function MM(e,{blockExport:t}){let r=new q(L("shared-calculator-error-piecewise-branch-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function DM(e){return new q(L("shared-calculator-error-table-header-type-error",{symbol:e[0]}))}function _M(e){return new q(L("shared-calculator-error-table-entry-type-error",{symbol:e[0]}))}function p7(){return new q(L("shared-calculator-error-regression-recursion"))}function AM(e){return new q(L("shared-calculator-error-regression-type-error",{symbol1:e[0],symbol2:e[1]}))}function OM(e){return new q(L("shared-calculator-error-update-rule-type-error",{symbol:e}))}function LM(){return new q(L("shared-calculator-error-update-rule-non-identifier-lhs",{arrow:"\u2192",example:"a"}))}function NM(e){return new q(L("shared-calculator-error-duplicate-update-rules",{symbol:Ee(e)}))}function RM(e){return new q(L("shared-calculator-error-update-rule-undefined-lhs",{symbol:Ee(e)}))}function kM(e){return new q(L("shared-calculator-error-update-rule-illegal-lhs",{symbol:Ee(e)}))}function VM(e){return new q(L("shared-calculator-error-update-rule-function-lhs",{symbol:Ee(e)}))}function O1(e){return new q(L("shared-calculator-error-update-rule-local-lhs",{symbol:Ee(e)}))}function FM(e){let t=e.filter(r=>r.scope==="free").map(r=>r.symbol);return new q(L("shared-calculator-error-action-merge-free-variable",{symbol:Ee(t[0]||"")})).setDependencies(t).allowExport()}function GM(e){return new q(L("shared-calculator-error-event-handler-type-error",{example:"a\u2192a+1"}))}function px({blockExport:e}){let t=new q(L("shared-calculator-error-heterogeneous-list"));return e||t.allowExport(),t}function L1(e,{blockExport:t}){let r=new q(L("shared-calculator-error-combine-type-error",{symbol1:e[0],symbol2:e[1]}));return t||r.allowExport(),r}function Hm(e){return new q(L("shared-calculator-error-log-scale-type-error",{symbol:e})).allowExport()}function BM(){return new q(L("shared-calculator-error-log-scale-histogram"))}function qM(){return new q(L("shared-calculator-error-log-scale-dot-plot"))}function zM(){return new q(L("shared-calculator-error-log-scale-box-plot"))}function UM(){return new q(L("shared-calculator-error-deeply-nested")).allowExport()}function HM(){return new q(L("shared-calculator-error-3d-multiple-equality-restrictions")).allowExport()}function $M(){return new q(L("shared-calculator-error-3d-mixed-restriction-equation")).allowExport()}function lu(){return new q(L("shared-calculator-error-3d-bad-equality-slice")).allowExport()}function sp(e){return new q(L("shared-calculator-error-gpu-variable-list-length",{symbol:Ee(e.filter(t=>t.symbol!=="globalRandomSeed")[0].symbol)}))}function N1(e){return new q(L("shared-calculator-error-gpu-variable-sum",{symbol:Ee(e[0].symbol)}))}function R1(e){return new q(L("shared-calculator-error-gpu-variable-product",{symbol:Ee(e[0].symbol)}))}function $m(e){return new q(L("shared-calculator-error-gpu-function-unsupported",{symbol:Ee(e)}))}function YM(){return new q(L("shared-calculator-error-gpu-integral-unsupported"))}function WM(){return new q(L("shared-calculator-error-gpu-long-sum",{maxTermCount:1e3.toLocaleString()}))}function XM(){return new q(L("shared-calculator-error-gpu-long-product",{maxTermCount:1e3.toLocaleString()}))}function Ym(){return new q(L("shared-calculator-error-gpu-max-list-size",{maxListSize:100 .toLocaleString()}))}function gx(){return new q(L("shared-calculator-error-max-list-size",{maxListSize:1e4.toLocaleString()})).allowExport()}function fx(){return new q(L("shared-calculator-error-two-numbers-error"))}function g7(){return new q(L("shared-calculator-error-boxplot-offset-invalid"))}function f7(){return new q(L("shared-calculator-error-boxplot-breadth-invalid"))}function k1(e,t){return new q(L("shared-calculator-error-too-many-arguments",{symbol:e,max:t}))}function KM(){var e=L("shared-calculator-error-pdf-wrong-arity-recommendation"),t=L("shared-calculator-error-pdf-wrong-arity",{recommendation:e});return new q(t)}function jM(){var e=L("shared-calculator-error-cdf-wrong-arity-recommendation"),t=L("shared-calculator-error-cdf-wrong-arity",{recommendation:e});return new q(t)}function ZM(){var e=L("shared-calculator-error-cdf-too-many-arguments-recommendation"),t=L("shared-calculator-error-cdf-too-many-arguments",{recommendation:e});return new q(t)}function JM(){return new q(L("shared-calculator-error-tdist-wrong-arity"))}function QM(){return new q(L("shared-calculator-error-random-arity"))}function eD(){return new q(L("shared-calculator-error-random-from-broadcast-distribution"))}function tD(e){var t=e==="rgb"?[150,30,100]:[180,.5,.5],r=L("shared-calculator-error-color-arity-recommendation",{recommendation:Ee(e)+"("+t.join(", ")+")"}),n=L("shared-calculator-error-color-arity",{symbol:e,recommendation:r});return new q(n)}function fc(e,t,r,n){e=Ee(e);var i,o;if(t===1)o=n.includeUsageExample?L("shared-calculator-error-wrong-arity-supplement",{recommendation:n.usageExample||e+"(x)"}):"",r>1?i=L("shared-calculator-error-wrong-arity-single-arg-too-many",{dependency:e,supplement:o}):i=L("shared-calculator-error-wrong-arity-single-arg-too-few",{dependency:e,supplement:o});else{var a=[];let c=n.usageExample;if(!c){for(var s=0;s<t;s++)a[s]=s+1;c=Ee(e)+"("+a.join(", ")+")"}o=n.includeUsageExample?L("shared-calculator-error-wrong-arity-supplement",{recommendation:c}):"",i=L("shared-calculator-error-wrong-arity-many-arg",{dependency:e,assignment_arity:t,supplement:o})}return new q(i)}function rD(){let e=L("shared-calculator-error-wrong-arity-supplement",{recommendation:"length(x)"}),t=L("shared-calculator-error-wrong-arity-single-arg-too-few",{dependency:"length",supplement:e});return new q(t)}function nD(e){return new q(L("shared-calculator-error-wrong-two-arg-arity",{symbol:Ee(e),recommendation:Ee(e)+"([1,2,3], 1)"}))}function mx(e){return new q(L("shared-calculator-error-wrong-two-arg-arity",{symbol:Ee(e),recommendation:Ee(e)+"([1,2,3], [3,2,1])"}))}function Bg(){return new q(L("shared-calculator-error-primed-function-arity"))}function iD(e){return new q(L("shared-calculator-error-zero-arg-reducer",{symbol:Ee(e)}))}function oD(){return new q(L("shared-calculator-error-malformed-point"))}function aD(){return new q(L("shared-calculator-error-malformed-list"))}function sD(e){return new q(L("shared-calculator-error-bad-tuple-dimensions",{symbol:e}))}function V1(e){return e=Ee(e),new q(L("shared-calculator-error-bad-implicit-call",{symbol:e}))}function cD(e,t){return new q(L("shared-calculator-error-adjacent-numbers",{left:e,right:t}))}function F1(e){return new q(L("shared-calculator-error-adjacent-mixed-number",{mixedNumber:e}))}function lD(){return new q(L("shared-calculator-error-token-with-subscript"))}function G1(e){return e=Ee(e),new q(L("shared-calculator-error-identifier-as-function",{symbol:e}))}function B1(e){return e=Ee(e),new q(L("shared-calculator-error-identifier-is-not-function",{symbol:e}))}function hx(e){return e=Ee(e),e==="%"&&(e="% of"),new q(L("shared-calculator-error-binary-operator-missing-operand",{symbol:e}))}function uD(e){return e=Ee(e),new q(L("shared-calculator-error-unary-operator-missing-left",{symbol:e}))}function dD(e){return e=Ee(e),new q(L("shared-calculator-error-unary-operator-missing-right",{symbol:e}))}function pD(){return new q(L("shared-calculator-error-fraction-missing-numerator"))}function gD(){return new q(L("shared-calculator-error-fraction-missing-denominator"))}function fD(){return new q(L("shared-calculator-error-fraction-empty"))}function q1(){return new q(L("shared-calculator-error-empty-subscript"))}function mD(){return new q(L("shared-calculator-error-empty-superscript"))}function hD(e){return e=Ee(e),new q(L("shared-calculator-error-invalid-subscript",{symbol:e}))}function yD(){return new q(L("shared-calculator-error-invalid-operator-name"))}function bD(){return new q(L("shared-calculator-error-unexpected-subscript"))}function xD(){return new q(L("shared-calculator-error-superscript-with-prime"))}function z1(){return new q(L("shared-calculator-error-unexpected-prime"))}function U1(){return new q(L("shared-calculator-error-prime-without-paren"))}function vD(){return new q(L("shared-calculator-error-empty-radical"))}function TD(){return new q(L("shared-calculator-error-empty-radical-index"))}function yx(){return new q(L("shared-calculator-error-empty-paren"))}function wD(){return new q(L("shared-calculator-error-empty-square-bracket"))}function ED(){return new q(L("shared-calculator-error-empty-pipe"))}function ID(e){var t=e+"^2",r=e+"^-1";return new q(L("shared-calculator-error-bad-trig-exponent",{form1:t,form2:r}))}function CD(e){var t=e+"^2";return new q(L("shared-calculator-error-bad-log-exponent",{form:t}))}function PD(){return new q(L("shared-calculator-error-piecewise-missing-condition"))}function SD(){return new q(L("shared-calculator-error-piecewise-part-missing-condition"))}function MD(){return new q(L("shared-calculator-error-colon-missing-condition"))}function bx(){let e=new q(L("shared-calculator-error-blank-expression"));return e.silent=!0,e}function Wm(e){return e=Ee(e),new q(L("shared-calculator-error-function-not-defined",{dependency:e}))}function H1(e){return e=Ee(e),new q(L("shared-calculator-error-parameter-already-defined",{dependency:e}))}function DD(e){return e=Ee(e),new q(L("shared-calculator-error-duplicate-function-parameter",{dependency:e}))}function _D(e){return e=Ee(e),new q(L("shared-calculator-error-function-name-as-parameter",{dependency:e}))}function Xm(e,t){return e=Ee(e),t===void 0?new q(L("shared-calculator-error-cannot-redefine",{symbol:e})):new q(L("shared-calculator-error-cannot-redefine-root",{symbol:e,symbolRoot:t}))}function AD(e){return e=Ee(e),new q(L("shared-calculator-error-cannot-subscript",{symbol:e}))}function $1(e){return e=Ee(e),new q(L("shared-calculator-error-multiply-defined",{dependency:e}))}function OD(e){let t=$1(e);return t.isMultiplyDefinedByTables=!0,t}function Y1(e){return e=Ee(e),new q(L("shared-calculator-error-shadowed-index",{symbol:e}))}function rB(e){e=e.map(Ee);var t=e.pop()||"";return new q(L("shared-calculator-error-dependency-cycle",{symbols:e.join("', '"),lastSymbol:t}))}function m7(e){let t=rB(e);return t.isTableCycleWithoutGlobalDefinition=!0,t}function qg(e){let t=e.length,r=e[0];return new q(L("shared-calculator-error-self-referential-functions",{symbols:e.slice(1).map(n=>Ee(n)).join("', '"),lastSymbol:Ee(r),count:gb(t)}))}function LD(e){return new q(L("shared-calculator-error-self-referential-base-case",{symbol:Ee(e)}))}function ND(){return new q(L("shared-calculator-error-ticker-min-step-nonnegative"))}function RD(e){return new q(L("shared-calculator-error-slider-limit-references-export",{symbol:Ee(e)}))}function kD(){return new q(L("shared-calculator-error-slider-min-invalid"))}function VD(){return new q(L("shared-calculator-error-slider-max-invalid"))}function FD(){return new q(L("shared-calculator-error-slider-max-less-than-min"))}function GD(){return new q(L("shared-calculator-error-slider-step-invalid"))}function h7(){return new q(L("shared-calculator-error-domain-min-invalid"))}function y7(){return new q(L("shared-calculator-error-domain-max-invalid"))}function b7(){return new q(L("shared-calculator-error-domain-max-less-than-min"))}function x7(){return new q(L("shared-calculator-error-cdf-min-invalid"))}function v7(){return new q(L("shared-calculator-error-cdf-max-invalid"))}function T7(){return new q(L("shared-calculator-error-cdf-max-less-than-min"))}function BD(){return new q(L("shared-calculator-error-use-rho-for-spherical-coordinates"))}function qD(){return new q(L("shared-calculator-error-use-r-for-cylindrical-coordinates"))}function W1(){return new q(L("shared-calculator-error-cant-combine-spherical-and-cylindrical"))}function un(e){if(e=e.map(Ee),e.length===0)return new q(L("shared-calculator-error-too-many-variables-no-symbols"));var t=e.pop()||"";return e.length>0?new q(L("shared-calculator-error-too-many-variables-many-symbols",{variables:e.join("', '"),lastVariable:t})):new q(L("shared-calculator-error-too-many-variables-one-symbol",{variable:t}))}function zD(e){return new q(L("shared-calculator-error-cannot-restrict",{variable:Ee(e)}))}function UD(e){return new q(L("shared-calculator-error-cannot-assign-color",{variable:Ee(e)}))}function HD(e){return new q(L("shared-calculator-error-cannot-restrict-with-equality",{variable:Ee(e)}))}function xx(e,t,r){e=e.map(Ee),t=Ee(t),r=r.map(Ee);var n=t+"("+r.join(",")+","+e.join(",")+")",i=e.pop()||"",o={symbols:e.join("', '"),lastSymbol:i,newSignature:n};return e.length?new q(L("shared-calculator-error-add-arguments-to-definition-many",o)):new q(L("shared-calculator-error-add-arguments-to-definition-one",o))}function $D(e){return e=Ee(e),new q(L("shared-calculator-error-invalid-lhs",{symbol:e}))}function YD(){return new q(L("shared-calculator-error-unplottable-polar-function"))}function WD(){return new q(L("shared-calculator-error-invalid-inequality-variables"))}function zg(){return new q(L("shared-calculator-error-invalid-implicit-variables"))}function XD(){return new q(L("shared-calculator-error-invalid-implicit-variables-3d"))}function KD(){return new q(L("shared-calculator-error-single-variable-implicit-equations-disabled"))}function jD(){return new q(L("shared-calculator-error-implicits-disabled"))}function X1(){return new q(L("shared-calculator-error-inequalities-disabled"))}function ZD(){return new q(L("shared-calculator-error-complicated-polar-implicit"))}function JD(){return new q(L("shared-calculator-error-invalid-double-inequality-3d"))}function QD(){return new q(L("shared-calculator-error-invalid-double-equality-3d"))}function e_(){return new q(L("shared-calculator-error-unplottable-chained-equality"))}function K1(){return new q(L("shared-calculator-error-invalid-double-inequality-variables"))}function j1(){return new q(L("shared-calculator-error-mismatched-double-inequality",{example:"1 < y < 2"}))}function Z1(){return new q(L("shared-calculator-error-complicated-double-inequality"))}function J1(e){return e?(e=Ee(e),new q(L("shared-calculator-error-equation-required-symbol",{lhs:e+"="}))):new q(L("shared-calculator-error-equation-required"))}function Km(e){return e=Ee(e),new q(L("shared-calculator-error-variable-as-function",{dependency:e}))}function Q1(e){return e=Ee(e),new q(L("shared-calculator-error-distribution-as-function",{symbol:e}))}function t_(e){return new q(L("shared-calculator-error-invalid-table-header",{supplement:e}))}function vx(e){return new q(L("shared-calculator-error-invalid-table-entry",{supplement:e}))}function r_(){return new q(L("shared-calculator-error-invalid-first-table-column",{most:"'y', 'r',",last:"'\u03B8'"}))}function w7(){return new q(L("shared-calculator-error-invalid-dependent-first-table-column"))}function n_(e){return new q(L("shared-calculator-error-invalid-regression-parameter",{symbol:Ee(e)}))}function i_(){return new q(L("shared-calculator-error-optimization-error"))}function Tx(e,{blockExport:t}){let r=new q(L("shared-calculator-error-non-list-double-reducer",{symbol:Ee(e),recommendation:Ee(e)+"([1,2,3], [3,2,1])"}));return t||r.allowExport(),r}function o_(e,{blockExport:t}){let r=new q(L("shared-calculator-error-non-list-parameterized-reducer",{symbol:Ee(e),recommendation:Ee(e)+"([1,2,3], 1)"}));return t||r.allowExport(),r}function kc(e,{blockExport:t}){let r=new q(L("shared-calculator-error-method-requires-list",{symbol:Ee(e),recommendation:Ee(e)+"([1,2,3])"}));return t||r.allowExport(),r}function wx(){return new q(L("shared-calculator-error-non-arithmetic-range")).allowExport()}function a_(){return new q(L("shared-calculator-error-invalid-half-empty-range"))}function s_(){return new q(L("shared-calculator-error-sum-missing-bound"))}function c_(){return new q(L("shared-calculator-error-product-missing-bound"))}function l_(){return new q(L("shared-calculator-error-incorrect-sum-lower-bound"))}function u_(){return new q(L("shared-calculator-error-incorrect-product-lower-bound"))}function d_(e){return new q(L("shared-calculator-error-bad-sum-bound-dependency",{symbol:Ee(e)}))}function p_(e){return new q(L("shared-calculator-error-bad-product-bound-dependency",{symbol:Ee(e)}))}function g_(){return new q(L("shared-calculator-error-integral-missing-bound"))}function f_(){return new q(L("shared-calculator-error-integral-missing-differential"))}function m_(){return new q(L("shared-calculator-error-differential-with-superscript"))}function h_(){return new q(L("shared-calculator-error-sum-missing-body"))}function y_(){return new q(L("shared-calculator-error-product-missing-body"))}function b_(){return new q(L("shared-calculator-error-integral-missing-body"))}function x_(){return new q(L("shared-calculator-error-derivative-missing-body"))}function v_(e,t){return e=Ee(e),t=Ee(t),new q(L("shared-calculator-error-mismatched-braces",{symbol1:e,symbol2:t}))}function ew(e){return new q(L("shared-calculator-error-shadowed-integration-variable",{symbol:Ee(e)}))}function T_(e){return new q(L("shared-calculator-error-bad-integral-bound-dependency",{symbol:Ee(e)}))}function w_(){return new q(L("shared-calculator-error-percent-missing-of"))}function Ex(e){return e=Ee(e),new q(L("shared-calculator-error-illegal-bin-width",{symbol:e}))}function jm(e){return e=Ee(e),new q(L("shared-calculator-error-ttest-list-too-short",{symbol:e}))}function E_(){return new q(L("shared-calculator-error-bad-sample-size"))}function I_(e){return new q(L("shared-calculator-error-variable-seed",{symbol:Ee(e[0].symbol)})).setDependencies(e.filter(t=>t.scope==="free").map(t=>t.symbol)).allowExport()}function Ug(e){return new q(L("shared-calculator-error-bad-symbol-context",{symbol:Ee(e)}))}function tw(){return new q(L("shared-calculator-error-write-integral",{command:"integral",symbol:"\u222B"}))}function C_(){return new q(L("shared-calculator-error-ans-undefined"))}function Ix(e){return new q(L("shared-calculator-error-variables-unsupported",{variable:Ee(e)}))}function rw(){return new q(L("shared-calculator-error-polygon-unsupported-in-3d"))}function ba(e,t=!1){return t&&e==="polygon"?rw():new q(L("shared-calculator-error-function-unsupported",{symbol:Ee(e)}))}function P_(){return new q(L("shared-calculator-error-logbase-unsupported"))}function Hg(e){return new q(L("shared-calculator-error-constant-unsupported",{symbol:Ee(e)}))}function E7(e){return new q(L("shared-calculator-error-variable-unsupported",{symbol:Ee(e)}))}function nw(e){return new q(L("shared-calculator-error-variable-invalid-function-name",{symbol:Ee(e)}))}function Cx(){return new q(L("shared-calculator-error-assignments-unsupported"))}function $g(){return new q(L("shared-calculator-error-function-definition-unsupported"))}function Us(){return new q(L("shared-calculator-error-equations-unsupported"))}function ms(){return new q(L("shared-calculator-error-inequalities-unsupported"))}function sd(){return new q(L("shared-calculator-error-regressions-unsupported"))}function cd(){return new q(L("shared-calculator-error-points-unsupported"))}function Cn(){return new q(L("shared-calculator-error-feature-unavailable"))}function iw(){return new q(L("basic-calculator-error-fractions-unavailable"))}function S_(){return new q(L("basic-calculator-error-parentheses-unavailable"))}function M_(){return new q(L("shared-calculator-error-non-square-determinant"))}function D_(){return new q(L("shared-calculator-error-non-square-trace"))}function __(){return new q(L("shared-calculator-error-non-square-inverse"))}function ow(){return new q(L("shared-calculator-error-non-singular-inverse"))}function I7(e){return new q(L("shared-calculator-error-clickable-object-assignment-not-defined",{symbol:e}))}function C7(e){return new q(L("shared-calculator-error-multiply-defined",{dependency:e}))}function P7(){return new q(L("shared-calculator-error-clickable-object-assignment-not-identifier"))}function S7(){return new q(L("shared-calculator-error-clickable-object-invalid-expression"))}function A_(){return new q(L("shared-calculator-error-matrix-assignment"))}function O_(){return new q(L("shared-calculator-error-matrix-add-dimensions"))}function L_(){return new q(L("shared-calculator-error-matrix-subtract-dimensions"))}function N_(){return new q(L("shared-calculator-error-matrix-multiply-dimensions"))}function R_(){return new q(L("shared-calculator-error-matrix-fractional-power"))}function k_(){return new q(L("shared-calculator-error-matrix-power-dimensions"))}function V_(e){return new q(L("shared-calculator-error-matrix-element-type-error",{arg:e[0]}))}function F_(e){return new q(L("shared-calculator-error-matrix-invalid-variable",{symbol:Ee(e)}))}function G_(e,t,r,{blockExport:n}){let i="[1...10]";r&&!/[\\]/.test(r)&&(i=`[${r}]`);let o=new q(L("shared-calculator-error-list-comprehension-input-type-error",{identifier:e,actual:t,example:i}));return n||o.allowExport(),o}function B_(){return new q(L("shared-calculator-error-incorrect-list-comprehension-input"))}function aw(e){return e=Ee(e),new q(L("shared-calculator-error-shadowed-list-comprehension-input",{symbol:e}))}function q_(e){return e=Ee(e),new q(L("shared-calculator-error-bad-for-input-list-dependency",{symbol:e}))}function z_(e){return e=Ee(e),new q(L("shared-calculator-error-bad-for-interval-dependency",{symbol:e}))}function U_(e){let t=e.filter(r=>r.scope==="free").map(r=>r.symbol);return new q(L("shared-calculator-error-variable-length-top-level-list",{symbol:Ee(t[0]||"")})).setDependencies(t).allowExport()}function Px(e){return new q(L("shared-calculator-error-variable-length-distribution-list",{symbol:e[0].symbol})).setDependencies(e.filter(t=>t.scope==="free").map(t=>t.symbol))}function H_(e){return new q(L("shared-calculator-error-variable-length-sum-body-depends-on-index",{symbol:e}))}function $_(e){return new q(L("shared-calculator-error-variable-length-product-body-depends-on-index",{symbol:e}))}function Y_(e){return new q(L("shared-calculator-error-variable-length-integral-depends-on-integration-var",{symbol:e}))}function M7(e,t){return new q(L("shared-calculator-error-substitution-type-error",{actual:dt(e),expected:dt(t)}))}function Sx(){return new q(L("shared-calculator-error-substitution-invalid-assignments"))}function Mx(e){return new q(L("shared-calculator-error-substitution-local-lhs",{symbol:Ee(e)}))}function Zm(e){return new q(L("shared-calculator-error-substitution-illegal-lhs",{symbol:Ee(e)}))}function Dx(e){return new q(L("shared-calculator-error-substitution-function-lhs",{symbol:Ee(e)}))}function W_(e,t,r){return new q(L("shared-calculator-error-substitution-body-regression-parameter-dependency",{globalVariable:Ee(e),regressionParameter:Ee(t),operator:r}))}function D7(){return new q(L("shared-calculator-error-substitution-body-action"))}function sw(){return new q(L("shared-calculator-error-substitution-nested"))}function cp(e){return new q(L("shared-calculator-error-substitution-ambiguous-comma",{operation:e}))}function X_(e){return new q(L("shared-calculator-error-substitution-duplicate-assignment",{symbol:Ee(e)}))}function K_(e,t,r){return new q(L("shared-calculator-error-substitution-recursive-call-lhs",{operator:e,globalVariable:Ee(t),fnSymbol:Ee(r)}))}function j_(){return new q(L("shared-calculator-error-depends-on-deleted-geo-object"))}function Z_(e){return new q(L("shared-calculator-error-invalid-interval-comprehension-return-type",{type:dt(e)}))}function J_(e,t){return new q(L("shared-calculator-error-bad-interval-comprehension-arity",{type:dt(e),count:gb(t)}))}function Jm(e){return new q(L("shared-calculator-error-invalid-interval-comprehension-invalid-bound",{identifier:e}))}function Q_(){return new q(L("shared-calculator-error-nested-interval-comprehension"))}function cw(){return new q(L("shared-calculator-error-substitution-unsupported-interval"))}var eA=[tt,ir,C,$,z,oe,Mr,Pt,Hn,$n,nr,gn,et,Ye,We,Oe,Re,ot,Ve,st,$e,xt,In],_7=new Set(eA),Yg=Vi.of(eA.filter(e=>ei(e))),Wg=Vi.of(eA.filter(e=>!ei(e)));function Vc(e){return _7.has(e)}function nB(e){return Vc(e)}function na(e){return oB(e,NaN)}function iB(e){return oB(e,0)}function oB(e,t){switch(e){case C:return t;case z:return[t,t];case oe:return[t,t,t];case Mr:case Pt:return[[t,t,t],[t,t,t]];case Hn:return[[t,t,t],[t,t,t],[t,t,t]];case $n:return[[[t,t,t],[t,t,t],[t,t,t]],t];case gn:return[t,t,t];case nr:return{type:"Action",updateRules:{}};case Ye:case ot:case Re:return[[t,t],[t,t]];case Ve:return[[t,t],[t,t]];case We:return[[t,t],t];case Oe:return[[t,t],[t,t],[t,t]];case tt:case ir:return!1;case et:return[];case xt:return[[t,t],[t,t],!1];case st:case $e:return[[t,t],t,t,t];case In:return[t,t];case $:return[t,t];default:let r=e;throw new Error(`${r} does not have a ${t===0?"zero":"NaN"} type.`)}}function aB(e,t){return pi(na(e),t)}var yB={spy:f2},{cosh:ch,sinh:ef,tanh:gA,acosh:bB,asinh:xB,atanh:vB,expm1:O7,log1p:lh,sign:fA,hypot:xa}=Math,TB=td,gw=Ng,wB=Rg,EB=Symbol("DIVERGES"),IB=(r=>(r[r.SUCCESS=0]="SUCCESS",r[r.MISSING_CACHE_ENTRY=1]="MISSING_CACHE_ENTRY",r))(IB||{}),Ew=class Ew{constructor(t=Ew.defaultLimit,r){this.limit=t;this.computeSize=r;this.currentSize=0;this.cache=new Map}get(t){let r=this.cache.get(t);return r&&(this.cache.delete(t),this.cache.set(t,r)),r==null?void 0:r.value}set(t,r){let n=this.computeSize?this.computeSize(r):1;if(this.currentSize+n>=this.limit){let i=this.cache.keys().next().value;this.cache.delete(i)}this.cache.set(t,{size:n,value:r})}};Ew.defaultLimit=1e5;var nh=Ew,Nx=1e4,CB=Nx*2;function L7(){return Nx}function N7(e){Nx=e}var mA=(r=>(r[r.DoesNotTerminate=0]="DoesNotTerminate",r[r.DepthLimitExceeded=1]="DepthLimitExceeded",r))(mA||{});function PB(e,t){if(Vc(t))return e.recursionTerminationStatus=0,na(t);throw WS()}function SB(e,t){if(Vc(t))return e.recursionTerminationStatus=1,na(t);throw XS()}var sB=new WeakMap;function R7(e){let t=sB.get(e);return t||(t=new Set(e),sB.set(e,t)),t}function oA(e){return`${e.fn}:${JSON.stringify(e.args)}`}function k7(e,t){return{status:0,result:[e,t]}}function V7(e){return{status:1,stackFrame:e}}function F7(e,t,r,n){let i=e.recursiveFunctionCache||new nh,o=[];o.push(n);let a=0;for(;o.length>0;){if(o.length>Nx||a++>CB)return SB(e,r);let s=o.pop(),{fn:c,args:l}=s,u=t[c](i,...l);if(u===EB)return PB(e,r);if((u==null?void 0:u.status)===1)o.push({fn:c,args:l}),o.push(u.stackFrame);else{let d=oA(s);i.set(d,u.result)}}return i.get(oA(n))[0]}var G7=function(e){let t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},B7=function(e){let t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)};function ui(e,t,r){return Math.max(t,Math.min(r,e))}function jg(e,t){let r=e%t;return e*t<0&&r!==0?r+t:r}function fw(e,t){if(e=Math.round(e),t=Math.round(t),!isFinite(e)||!isFinite(t))return NaN;if(e===0&&t===0)return 0;let r=gw(e,t);return Math.abs(e/r*t)}function q7(e){if(e.length===0)return NaN;if(e.length===1)return gw(e[0],0);let t=e[0];for(let r=1;r<e.length;r++)t=gw(t,e[r]);return t}function z7(e){if(e.length===0)return NaN;if(e.length===1)return fw(e[0],1);let t=e[0];for(let r=1;r<e.length;r++)t=fw(t,e[r]);return t}function U7(e){if(e.length===0)return[NaN,NaN];if(e.length===1)return dA(e[0],[0,0]);let t=e[0];for(let r=1;r<e.length;r++)t=dA(t,e[r]);return t}function H7(e){if(e.length===0)return[NaN,NaN];if(e.length===1)return pA(e[0],[1,0]);let t=e[0];for(let r=1;r<e.length;r++)t=pA(t,e[r]);return t}function lp(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0||e===t)return 1;if(e===0)return mc(t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&t<0&&e-t<0)return r&&n?0:mc(e-t)*mc(t)/(mc(e)*lp(-e,-t));if(e<0&&t>0&&e-t<0)return r&&n?Math.pow(-1,t)*lp(t-e-1,t):mc(e-t)/mc(e)*lp(-(e-t),t);if(e<0&&t<0&&e-t>0)return r&&n?Math.pow(-1,e-t)*lp(-t-1,e-t):mc(t)/mc(e)*lp(-t,-e);if(e>0&&t<0&&e-t>0){let s=Math.abs(e)>Math.abs(t)?-t:e;return mc(t)/lp(e-t,s)}if(e>0&&t>0&&e-t<0)return mc(e-t)/lp(t,e);if(e<0||t<0||e-t<0||e<15&&t<15&&e-t<15)return mw(e,t)/uu(t);let i=Hs(e)-Hs(t)-Hs(e-t)-(e-t)*lh(-t/e),o=Math.sqrt(e/(2*Math.PI*t*(e-t)))*Math.pow(e/t,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(o):o}function mw(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0)return 1;if(e===0)return 1/uu(-t);if(e===t)return uu(e);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&e-t<0)return r&&n?Math.pow(-1,t)*mw(t-e-1,t):mc(e-t)/mc(e)*mw(-(e-t),t);if(e<0||e-t<0||e<15&&e-t<15)return uu(e)/uu(e-t);let i=Hs(e)-Hs(e-t)-(e-t)*lh(-t/e),o=Math.sqrt(e/(e-t))*Iw(e,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(o):o}function uu(e){if(e===-1/0)return NaN;let t=Math.round(e)===e;if(e<0)return t?1/0:1/(mc(e)*cB(-e));let r=cB(e);return t?Math.round(r):r}function cB(e){return e>171?1/0:e<14?$7(e):X7(e)}function $7(e){let t=4.077131788261185,r=7.024675027156382,n=6.657107767450176,i=3.766266976716022,o=1.2792371666711133,a=.24304596436338005,s=.020049769312165774,c=4.154347453162709,l=7.270007565107539,u=6.97805297331391,d=3.989651532924167,f=1.367176195613119,g=.26175627691546965,y=.021742722739397567,x=1+e*(t+e*(r+e*(n+e*(i+e*(o+e*(a+e*s)))))),b=1+e*(c+e*(l+e*(u+e*(d+e*(f+e*(g+e*y)))))),w=e+1,E=1-(w-e);return Iw(w,e)*Math.sqrt(w+(2*e+1)*E)*(x/b)}var Y7=Math.pow(2,27)+1;function W7(e){let t=Y7*e;return t-(t-e)}var tA=.3678794428706169,rA=-16991745912462731e-25;function Iw(e,t){let r=W7(e),n=e-r,i=e*(tA+rA);if(i===0)return Math.pow(e/Math.E,t);let o=r*tA-i+r*rA+n*tA+n*rA;return Math.pow(i,t)*(1+t*(o/i))}function X7(e){return Iw(e,e)*Math.sqrt(2*Math.PI*e)*Math.exp(LB(e))}var MB=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870];function DB(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e===0)return 1/hA(t);let r=fn(t);if(e===1)return-1/(r*r);let n=Nn(t);if(e===2)return 2*n/(r*r*r);let i=[0,2],o=[];for(let s=3;s<=e;s++){o=[];for(let c=0;c<s;c++){let l=0,u=0;c>0&&(l=(s-c+1)*i[c-1]),c+2<s&&(u=(c+1)*i[c+1]),o.push(-(l+u))}i=o}let a=0;for(let s=e-1;s>=0;s--)a=o[s]+n*a;return a/Math.pow(r,e+1)}function _B(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;let r=e%2===0?-1:1;if(t<0)return-r*_B(e,1-t)-Math.pow(Math.PI,e+1)*DB(e,Math.PI*t);let n=uu(e),i=0,o=Math.pow(t,-(e+1));for(;t<10;)i+=o,t++,o=Math.pow(t,-(e+1));i+=e===0?-Math.log(t):o*t/e,i+=.5*o;let a=MB,s=e+1,c=2,l=o*t*s/c,u=1/(t*t);for(let d=1;d<=14;d++)l*=u,i+=l*a[d-1],s++,c++,l*=s/c,s++,c++,l*=s/c;return n*r*i}function K7(e){let t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t}function AB(e,t){if(t===0)return NaN;let r;return t===Math.E?r=Math.log(e):t===2&&Math.log2?r=Math.log2(e):t===10&&Math.log10?r=Math.log10(e):r=Math.log(e)/Math.log(t),Math.pow(t,Math.round(r))===e?Math.round(r):r}function j7(e){return AB(e,10)}function Z7(e,t){return wB(e,1/t)}var OB=1/Math.PI;function Cw(e){return e>1e12?!1:Math.round(OB*e)*Math.PI===e}function Pw(e){if(e>1e12)return!1;let t=Math.round(2*OB*e);return t%2===1&&t*Math.PI===2*e}function fn(e){return Cw(Math.abs(e))?0:Math.sin(e)}function Nn(e){return Pw(Math.abs(e))?0:Math.cos(e)}function hA(e){let t=Math.abs(e);return Cw(t)?0:Pw(t)?1/0:Math.tan(e)}function J7(e){return Pw(Math.abs(e))?1/0:1/Math.cos(e)}function Q7(e){return Cw(Math.abs(e))?1/0:1/Math.sin(e)}function eW(e){let t=Math.abs(e);return Cw(t)?1/0:Pw(t)?0:1/Math.tan(e)}function tW(e){return e>0?Math.atan(1/e):Math.PI/2-Math.atan(e)}function rW(e){return Math.asin(1/e)}function nW(e){return Math.acos(1/e)}function iW(e){return 1/ch(e)}function oW(e){return 1/ef(e)}function aW(e){return 1/gA(e)}function sW(e){return bB(1/e)}function cW(e){return xB(1/e)}function lW(e){return vB(1/e)}function uW(e){if(e===0||isNaN(e))return e;if(!isFinite(e))return NaN;if(e===Math.floor(e))return e>0?0:-0;let t=Math.round(2*e),r=-.5*t+e,n=t&2?-1:1,i=t&1?Math.cos(Math.PI*r):Math.sin(Math.PI*r);return n*i}function mc(e){return e===1/0||e===-1/0?0:e===0?1:uW(e)/(Math.PI*e)}function du(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function dW(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function aA(e){return e>50?Math.exp(.5*((1-e)*lh(-1/(e-1))-1)+Hs(.5*(e-1))-Hs(.5*(e-2)))*Math.sqrt((1-1/e)/(2*Math.PI)):e/(e+1)*uu((e+1)/2)/(uu(e/2)*Math.sqrt(e*Math.PI))}function ih(e,t,r=e-t){if(Math.abs(r)<.1*(e+t)){let n=r/(e+t),i=r*r/(e+t),o=2*e*n;for(let a=1;a<10;a++){o*=n*n;let s=i+o/(2*a+1);if(s==i)return s;i=s}}return e*Math.log(e/t)+t-e}var pW=[0,.08106146679532726,.0413406959554093,.02767792568499834,.020790672103765093,.016644691189821193,.013876128823070748,.01189670994589177,.010411265261972096,.009255462182712733,.00833056343336287,.007573675487951841,.00694284010720953,.006408994188004207,.0059513701127588475,.005554733551962801];function Hs(e){return e>15?LB(e):e<0?NaN:e===Math.floor(e)?pW[e]:Math.log(uu(e)/(Iw(e,e)*Math.sqrt(2*Math.PI*e)))}function LB(e){let t=.08333333333333333,r=.002777777777777778,n=.0007936507936507937,i=.0005952380952380953,o=.0008417508417508417,a=e*e;return(t-(r-(n-(i-o/a)/a)/a)/a)/e}function Sw(e,t){return t<=0?NaN:aA(t)*Math.pow(1+e*e/t,-((t+1)/2))}function Xg(e,t){if(t>0)return 1-Xg(e,-t);if(t===-1/0)return 0;if(t===0)return .5;if(e>=40&&t>-1)return .5+aA(e)*gW(e,t);if(t/e<-1e3){let n=t*t;return aA(e)*Math.pow(e,.5*(e-1))*Math.pow(Math.abs(t),-e)*(1-e*e*(e+1)*(1/(2+e)+e*(e+3)/(4*(4+e)*n))/(2*n))}let r=Math.sqrt(t*t+e);return fW((t+r)/(2*r),e/2,e/2)}function gW(e,t){let r=t*t/e,n=t,i=n;for(let o=1;o<=15;o++)n*=-(2*o-1)/(2*o+1)*(.5*(e+1)+o-1)/o*r,i+=n;return i}function dw(e,t,r){return r<=0?NaN:e===-1/0?Xg(r,t):e>0&&t>0?Xg(r,-e)-Xg(r,-t):Xg(r,t)-Xg(r,e)}function fW(e,t,r){if(e<0||e>1)throw new RangeError("First argument must be between 0 and 1.");if(t===1&&r===1)return e;if(e===0)return 0;if(e===1)return 1;if(t===0)return 1;if(r===0)return 0;{let n=Hs(t+r)-Hs(t)-Hs(r)-ih(t,(t+r)*e)-ih(r,(t+r)*(1-e),(t+r)*e-t),i=Math.exp(n)*Math.sqrt(t*r/(2*Math.PI*(t+r)));return e<(t+1)/(t+r+2)?i*lB(e,t,r)/t:1-i*lB(1-e,r,t)/r}}function lB(e,t,r){let n=Math.pow(2,-52),i=1e-300,o=t+r,a=t+1,s=t-1,c=1,l=1-o*e/a;Math.abs(l)<i&&(l=i),l=1/l;let u=l;for(let d=1;d<=100;d++){let f=2*d,g=d*(r-d)*e/((s+f)*(t+f));l=1+g*l,Math.abs(l)<i&&(l=i),c=1+g/c,Math.abs(c)<i&&(c=i),l=1/l,u*=l*c,g=-(t+d)*(o+d)*e/((t+f)*(a+f)),l=1+g*l,Math.abs(l)<i&&(l=i),c=1+g/c,Math.abs(c)<i&&(c=i),l=1/l;let y=l*c;if(u*=y,Math.abs(y-1)<=n)return u}return u}function mW(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,o=e,a=i/o,s=i/n,c=1/o,l=2,u=0,d=o,f=-(e-1),g=0;do f-=1,d+=1,c=c*f*t+d,c===0&&(c=n),s=d+f*t/s,s===0&&(s=n),c=1/c,u=s*c,a=a*u,g+=1,d+=1,c=c*g*t+d,c===0&&(c=n),s=d+g*t/s,s===0&&(s=n),c=1/c,u=s*c,a*=u,l+=2;while(l<100&&Math.abs(u-1)>r);return a}function hW(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,o=t+1-e,a=i/o,s=i/n,c=1/o,l=2,u=0,d=o;do{let f=-(l-1)*(l-e-1);d+=2,c=c*f+d,c===0&&(c=n),s=d+f/s,s===0&&(s=n),c=1/c,u=s*c,a*=u,l+=1}while(l<100&&Math.abs(u-1)>r);return a}function yW(e,t){let r=t/e,n=fA(t-e)*Math.sqrt(2*ih(1,r)),i=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8296711340953087e-22,-17665952736826078e-23,6707853543401498e-24,10261809784240309e-24,-4382036018453353e-24,914769958223679e-24,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],o=i.length-2,a=0,s=0,c=0,l=0;for(;o>=0;o--)c=(o+2)*a/e+i[o+1],l=n*l+c,a=s,s=c;if(l=e/(e+a)*l,t<e){let u=Math.exp(-.5*e*n*n)*(.5*ld(-n*Math.sqrt(e/2))-l/Math.sqrt(2*Math.PI*e));return isFinite(u)?1-u:1}else{let u=Math.exp(-.5*e*n*n)*(.5*ld(n*Math.sqrt(e/2))+l/Math.sqrt(2*Math.PI*e));return isFinite(u)?u:0}}function uB(e,t,r){return(e-t)/(Math.SQRT2*Math.abs(r))}function _x(e){return e<0?.5*Math.exp(-e*e)*ld(-e):1-.5*Math.exp(-e*e)*ld(e)}function bW(e,t,r,n){let i=uB(t,r,n);if(e===-1/0)return _x(i);let o=uB(e,r,n);return o>0&&i>0?_x(-o)-_x(-i):_x(i)-_x(o)}function yA(e,t,r){return 1/Math.sqrt(2*Math.PI*r*r)*Math.exp(-(e-t)*(e-t)/(2*r*r))}function bA(e,t){return`t${e}:${Tw(t)}`}function xA(e){let t=yB.spy(e),r=parseInt(t.slice(0,8),16)&2097151,n=parseInt(t.slice(8,16),16);return(r*4294967296+n)/9007199254740992}function NB(e,t){for(let r=t.length-1;r>0;r--){let n=e+"::sc"+r,i=Math.floor(xA(n)*(r+1)),o=t[r];t[r]=t[i],t[i]=o}}function xW(e,t){let r=t.slice();return NB(e,r),r}function vA(e,t){let r=[];for(let n=0;n<t;n++)r.push(n);return NB(e,r),r}function dp(e,t,r){return xA(e)*(r-t)+t}function vW(e,t,r){let n=0,i,o,a,s;do i=e+"::sc"+n,n+=1,o=dp(i,0,1)*2-1,i=e+"::sc"+n,n+=1,a=dp(i,0,1)*2-1,s=o*o+a*a;while(s>=1||s===0);let c=Math.sqrt(-2*Math.log(s)/s);return t+r*o*c}function TW(e,t){if(t<=0)return NaN;let r=0,n,i,o,a;do n=e+"::sc"+r,r+=1,i=dp(n,0,1)*2-1,n=e+"::sc"+r,r+=1,o=dp(n,0,1)*2-1,a=i*i+o*o;while(a>1);let s=i*i/a,c=t*(Math.pow(a,-2/t)-1);return n=e+"::sc"+r,r+=1,(dp(n,0,1)<.5?-1:1)*Math.sqrt(s*c)}function wW(e,t,r){return t=ui(Math.round(t),0,1/0),t===1/0?NaN:(r=ui(r,0,1),kB(dp(e,0,1),t,r))}function EW(e,t){return t<0?NaN:RB(dp(e,0,1),t)}function pw(e,t,r){return e>=t?1:e<0?0:e<Math.floor((t+1)*r)?dB(e,t,r):1-dB(t-e-1,t,1-r)}function dB(e,t,r){let n=(1-r)/r,i=Mw(e,t,r),o=i;for(;e>0&&(i*=e/(t-e+1)*n,o+i!==o);e--)o+=i;return o}function IW(e,t,r,n){return r=ui(Math.round(r),0,1/0),r===1/0?NaN:(n=ui(n,0,1),t<0?0:(e=Math.ceil(e),t=Math.floor(t),e===-1/0?pw(t,r,n):pw(t,r,n)-pw(e-1,r,n)))}function Mw(e,t,r){if(e=Math.round(e),t=ui(Math.round(t),0,1/0),t===1/0)return NaN;if(r=ui(r,0,1),e<0||e>t)return 0;if(r===0)return e===0?1:0;if(r===1)return e===t?1:0;if(e===0)return Math.exp(t*lh(-r));if(e===t)return Math.pow(r,t);let n=Hs(t)-Hs(e)-Hs(t-e)-ih(e,t*r)-ih(t-e,t*(1-r),t*r-e);return Math.exp(n)*Math.sqrt(t/(2*Math.PI*e*(t-e)))}function oh(e,t){return t<0?NaN:(e=Math.round(e),e<0?0:t===0?e===0?1:0:e===0?Math.exp(-t):Math.exp(-Hs(e)-ih(e,t))/Math.sqrt(2*Math.PI*e))}function Ax(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===1/0)return 1;if(e=Math.floor(e),e<0)return 0;if(t===0)return 1;if(e+1>12&&2.35*(e+1)>t&&.3*(e+1)<t)return yW(e+1,t);if(e+1>=t){let r=mW(e+1,t);return isFinite(r)?1-t*oh(e,t)*r:1}else{let r=hW(e+1,t);return isFinite(r)?t*oh(e,t)*r:0}}function CW(e,t,r){return r<0?NaN:(e=Math.ceil(e),t=Math.floor(t),t<0?0:e===-1/0?Ax(t,r):Ax(t,r)-Ax(e-1,r))}function TA(e,t,r){return r<=t?NaN:e<t||e>r?0:1/(r-t)}function pB(e,t,r){return r<=t?NaN:e<t?0:e>r?1:(e-t)/(r-t)}function PW(e,t,r,n){return pB(t,r,n)-pB(e,r,n)}function SW(e){let t=-e*e;return t<-750?e>=0?1:-1:e>=.065?1-Math.exp(t)*ld(e):e<=-.065?Math.exp(t)*ld(-e)-1:e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+t*.005223977625442188))))}function ld(e){let t=.9999999999999999,r=2.224574423459406,n=2.444115549920689,i=1.7057986861852539,o=.8257463703357973,a=.28647031042892007,s=.07124513844341643,c=.012296749268608364,l=.001347817214557592,u=7263959403471071e-20,d=1,f=3.352953590554884,g=5.227518529742423,y=5.003720878235473,x=3.266590890998987,b=1.5255421920765353,w=.5185887413188858,E=.12747319185915415,I=.02185979575963238,S=.0023889438122503674,D=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-ld(-e);if(e>50){let O=.5641895835477563,_=e*e;return e>5e7?O/e:O*(_*(_+4.5)+2)/(e*(_*(_+5)+3.75))}else{let O=t+e*(r+e*(n+e*(i+e*(o+e*(a+e*(s+e*(c+e*(l+e*u)))))))),_=d+e*(f+e*(g+e*(y+e*(x+e*(b+e*(w+e*(E+e*(I+e*(S+e*D)))))))));return O/_}}function wA(e){let t=-39.6968302866538,r=220.946098424521,n=-275.928510446969,i=138.357751867269,o=-30.6647980661472,a=2.50662827745924,s=-54.4760987982241,c=161.585836858041,l=-155.698979859887,u=66.8013118877197,d=-13.2806815528857,f=-.00778489400243029,g=-.322396458041136,y=-2.40075827716184,x=-2.54973253934373,b=4.37466414146497,w=2.93816398269878,E=.00778469570904146,I=.32246712907004,S=2.445134137143,D=3.75440866190742,O=.02425,_,A,R;return e>.5?-wA(1-e):e===.5?0:e<0?NaN:e===0?-1/0:(e<O?(_=Math.sqrt(-2*Math.log(e)),R=(((((f*_+g)*_+y)*_+x)*_+b)*_+w)/((((E*_+I)*_+S)*_+D)*_+1)):(_=e-.5,A=_*_,R=(((((t*A+r)*A+n)*A+i)*A+o)*A+a)*_/(((((s*A+c)*A+l)*A+u)*A+d)*A+1)),R-Math.sqrt(2*Math.PI)*(.5*ld(-R/Math.SQRT2)-Math.exp(.5*R*R)*e))}function RB(e,t){if(t<0||e<0||e>1)return NaN;if(t===0||e===0)return 0;if(e===1)return 1/0;let r=-1,n=Math.ceil(t);for(;Ax(n,t)<e;)n=2*n;let i=Math.floor(r+(n-r)/2);for(;r<i&&i<n;)Ax(i,t)<e?r=i:n=i,i=Math.floor(r+(n-r)/2);return n}function kB(e,t,r){if(t!==Math.round(t))return NaN;if(r<0||r>1)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return t;if(t===0)return 0;if(r===1)return t;if(r===0)return 0;let n=-1,i=t,o=Math.floor(n+(i-n)/2);for(;n<o&&o<i;)pw(o,t,r)<e?n=o:i=o,o=Math.floor(n+(i-n)/2);return i}function VB(e,t){if(isNaN(t)||t<=0||e<0||e>1)return NaN;if(e===0)return-1/0;if(e===1)return 1/0;if(t===1||t===2||t===4)return nA(t,e);let r,n;if(e===.5)return 0;if(e>.5)r=t>1?wA(e):nA(1,e),n=t>1?nA(1,e):Math.pow(Sw(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t);else return-VB(1-e,t);return MW(t,e,r,n)}function nA(e,t){let r=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/r);case 4:let n=Math.cos(Math.acos(Math.sqrt(r))/3)/Math.sqrt(r);return fA(t-.5)*2*Math.sqrt(n-1);default:throw new Error("_invTSimple() must be called with 1, 2, or 4 df.")}}function MW(e,t,r,n){if(!isFinite(r)||!isFinite(n))return NaN;let i=r,o=n;for(;;){let a=Rc(i,o),s=Xg(e,a);if(a===i||a===o)return s>t?i:o;s<t?i=a:o=a}}function DW(e,t,r){return e<0||e>1||r<=t?NaN:e===0?t:e===1?r:t+e*(r-t)}function FB(e,t){let r=hw(e);return(du(e)-t)*Math.sqrt(e.length)/r}function GB(e,t){let r=e.length,n=du(e),i=hw(e),o=t.length,a=du(t),s=hw(t),c=Math.sqrt(((r-1)*i*i+(o-1)*s*s)/(r+o-2));return(n-a)/(c*Math.sqrt(1/r+1/o))}function th(e,t,r){return r<0?dw(-1/0,e,t):r>0?dw(-1/0,-e,t):2*dw(-1/0,-Math.abs(e),t)}function EA(e,t){arguments.length===1&&(t=0);let r=FB(e,t),n=e.length-1;return{lessThan:th(r,n,-1),greaterThan:th(r,n,1),notEqual:th(r,n,0)}}function IA(e,t){let r=GB(e,t),n=e.length+t.length-2;return{lessThan:th(r,n,-1),greaterThan:th(r,n,1),notEqual:th(r,n,0)}}function CA(e){return{min:BB(e),q1:Zg(e,1),median:UB(e),q3:Zg(e,3),max:qB(e)}}function _W(e){return e.length}function BB(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]<t&&(t=e[r])}return t}function qB(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]>=t&&(t=e[r])}return t}function zB(e,t){if(!isFinite(t)||t<0||t>1)return NaN;if(e.some(isNaN))return NaN;if(e.length===0)return NaN;let r=e.length,n=tf(e),i=t*(r-1);return Math.floor(i)===i?e[n[i]]:(Math.ceil(i)-i)*e[n[Math.floor(i)]]+(i-Math.floor(i))*e[n[Math.ceil(i)]]}function Zg(e,t){if(!isFinite(t)||t<0||t>4)return NaN;if(e.some(isNaN))return NaN;let r=tf(e),n=Dw(e,t),i=Math.floor(n),o=Math.ceil(n);return(e[r[i]]+e[r[o]])/2}function tf(e){let t=e.length,r=[];for(let n=0;n<t;n++)r.push(n);return r.sort(function(n,i){return ae(Ro(e[n],e[i]))}),r}function Dw(e,t){t=Math.round(t);let r=e.length,n=r%2===1,i;return r===1?0:(t===0&&(i=0),t===2&&(i=(r-1)/2),t===4&&(i=r-1),t===1&&(i=n?(r+1)/4-1:(r+2)/4-1),t===3&&(i=n?(3*r+3)/4-1:(3*r+2)/4-1),i===void 0?NaN:i)}function AW(e,t){return tf(e)[Math.ceil(t*(e.length-1))]+1}function OW(e,t){return tf(e)[Math.floor(t*(e.length-1))]+1}function LW(e,t){return tf(e)[Math.ceil(Dw(e,t))]+1}function NW(e,t){return tf(e)[Math.floor(Dw(e,t))]+1}function UB(e){return zB(e,.5)}function RW(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return 0;e[n]<t&&(r=n,t=e[n])}return r+1}function kW(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++)if(e[n]>=t){if(isNaN(e[n]))return 0;r=n,t=e[n]}return r+1}function Rx(e){let t=du(e),r=0;for(let n=0;n<e.length;n++){let i=e[n]-t;r+=i*i}return r/e.length}function VW(e){let t=du(e),r=0;for(let n=0;n<e.length;n++)r+=Math.abs(e[n]-t);return r/e.length}function HB(e){let t=e.length;return Rx(e)*t/(t-1)}function $B(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=du(e),i=du(t),o=0;for(let a=0;a<r;a++)o+=(e[a]-n)*(t[a]-i);return o/r}function FW(e,t){let r=Math.min(e.length,t.length);return $B(e,t)*r/(r-1)}function _w(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=du(e),i=du(t),o=0,a=0,s=0;for(let c=0;c<r;c++){let l=e[c]-n,u=t[c]-i;o+=l*l,a+=u*u,s+=l*u}return s/Math.sqrt(o*a)}function PA(e,t,r,n){let i=e[0];for(let a=2;a<e.length;a++){let s=ae(yo(Ro(e[a],i),r));if(!Bs(s,a,10))return 0}let o=ae(n);for(let a=0;a<t.length-1;a++){let s=ae(yo(Ro(t[a],i),r));if(!Bs(s,o-t.length+a,10))return 0}return!isFinite(o)||o<e.length||o<t.length?0:o}function SA(e){return e<0||!isFinite(e)?0:e}function sA(e){let t=e.length;if(t===0)return[];let r=[],n=[];for(let s=0;s<t;s++)n.push([e[s],s]);n.sort(function(s,c){let l=s[0],u=c[0];return l===1/0&&u===1/0||l===-1/0&&u===-1/0?0:l-u});let i=0,o=1,a=1;for(;i<t;){let s=i;for(;s<t-1&&n[s][0]===n[s+1][0];)s+=1;a=s-i+1;let c;for(s=0;s<a;s++)c=n[i+s][1],r[c]=isNaN(e[c])?NaN:o+.5*(a-1);o+=a,i+=a}return r}function GW(e,t){let r=Math.min(e.length,t.length);return e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r)),_w(sA(e),sA(t))}function hw(e){return Math.sqrt(HB(e))}function BW(e){return Math.sqrt(Rx(e))}var qW=jb;function ah(e,t){return xa(t[0]-e[0],t[1]-e[1])}function zW(e,t){return xa(t[0]-e[0],xa(t[1]-e[1],t[2]-e[2]))}function YB(e,t,r){return[ui(Math.round(e),0,255),ui(Math.round(t),0,255),ui(Math.round(r),0,255)]}function UW(e,t,r){isFinite(e)||(e=0),t=ui(t,0,1),r=ui(r,0,1);let n=r*(1-t/2);n===0||n===1?t=0:t=(r-n)/Math.min(n,1-n);let{r:i,g:o,b:a}=h1(e,t,n).rgb();return YB(i,o,a)}function HW(e){return e}function $W(e,t){return[e,t]}function YW(e,t,r){return[e,t,r]}function WW(e,t){return[e,t]}function XW(e){return e}function KW(e){let t=[];if(e.length===0)return[];for(let r=0;r<e.length-1;r++)t.push([e[r],e[r+1]]);return t.push([e[e.length-1],e[0]]),t}function MA(e){if(e.length==0)return 0;let t=[...e,e[0]];return S2(t)}function jW(e){let t=0;for(let r=0;r<e.length-1;r++){let[n,i]=e[r],[o,a]=e[r+1];t+=Gs(o-n,a-i)}if(e.length>1){let[r,n]=e[e.length-1],[i,o]=e[0];t+=Gs(i-r,o-n)}return t}function ZW(e){let t=!1;for(let r=0;r<e.length;r++){let n=(r+1)%e.length;e[r][0]===e[n][0]&&e[r][1]===e[n][1]&&(t=!0)}return t?e.filter((r,n)=>{let i=e[n===0?e.length-1:n-1];return r[0]!==i[0]||r[1]!==i[1]}):e}function JW(e){let[t,r,n,i]=e;return[t,n>=0?r:r+n,n>=0?n:-n,i]}function WB(e,t,r){if(e.length===0)return[];if(e=ZW(e),e.length===0)return[];let n=M2([...e,e[0]]),i=[];for(let o=0;o<e.length;o++){let a=e[o>0?o-1:e.length-1],s=e[o],c=e[o<e.length-1?o+1:0],l=n[o]===1,u=PX(a,s,c,l?"counterclockwise":"clockwise",r);i.push(t?u:JW(u))}return i}function QW(e,t){return WB(e,!1,t)}function eX(e,t){return WB(e,!0,t)}function DA(e,t){return[e,t]}var tX=DA,rX=DA;function nX(e,t){let r=[t[0]-e[0],t[1]-e[1]],n=[e[0],e[1]];return XB(r,n)}function XB(e,t){return[e,t]}function iX(e){return e[0]}function oX(e){return e[1]}function aX(e,t){let r=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],n=[e[0],e[1],e[2]];return KB(r,n)}function KB(e,t){return[e,t]}function sX(e){return e[0]}function cX(e){return e[1]}function lX(e){return e}function uX(e,t){return[e,t]}function dX(e){return e[0]}function pX(e){return e[1]}function gX(e,t,r){return[e,t,r]}function uh([e,t,r]){let[n,i]=e,[o,a]=t,[s,c]=r,l=o*o+a*a,u=(n*n+i*i-l)/2,d=(l-s*s-c*c)/2,f=(n-o)*(a-c)-(o-s)*(i-a);f=1/f;let g=(u*(a-c)-d*(i-a))*f,y=((n-o)*d-(o-s)*u)*f;return[g,y]}function fX(e){return e[0]}function mX(e){return e[1]}function hX(e){return e[2]}function dh(e){let[[t,r],[n,i],[o,a]]=e,s=n-t,c=i-r,l=o-n,u=a-i;return 2*Math.atan2(s*u-l*c,s*l+c*u)}function _A(e){let t=Math.abs(dh(e));return t<1e-9||t>2*Math.PI-1e-9}function yX(e){return e[0]}function bX(e){return e[1]}function xX(e){return e[0]}function vX(e){return e[1]}function jB(e){return Math.abs(e)===Math.PI?Math.PI:jg(e+Math.PI,2*Math.PI)-Math.PI}function ZB(e,t,r,n){return[e,jB(t),r,n]}function TX([e,t,r,n]){return[e,t,r,n]}function wX(e){return e[2]}function EX(e){return e[3]}function JB(e){let[t,r,n,i]=e,o=Math.PI*2,a=n===0?o:n>0?n-o:n+o;return[t,r,a,i]}function IX(e){let[t,r,n,i]=JB(e);return[t,r,n,i]}function CX(e){let[t,r,n,i]=e,o=n>=0?Math.PI-n:-Math.PI-n;return[t,jB(r+n),o,i]}function PX(e,t,r,n,i){let o=e[0]-t[0],a=e[1]-t[1],s=r[0]-t[0],c=r[1]-t[1],l=Math.atan2(a,o),u=Math.atan2(o*c-a*s,o*s+a*c),d=2*Math.PI;return n==="clockwise"?u-=u<0?0:d:n==="counterclockwise"&&(u+=u<0?d:0),ZB(t,l,u,i)}function SX(e,t){let[[r,n],[i,o],a]=e;return[[r*t,n*t],[i*t,o*t],a]}function MX(e,t){let r=new Array(e.length);for(let n=0;n<r.length;n++){let i=e[n];r[n]=[i[0]*t,i[1]*t]}return r}function AA(e,t){let[[r,n],[i,o]]=e;return[[t*r,t*n],[t*i,t*o]]}var DX=AA,_X=AA;function AX(e,t){let[[r,n],i]=e;return[[t*r,t*n],t*i]}function OX(e,t){let[[r,n],[i,o],[a,s]]=e;return[[t*r,t*n],[t*i,t*o],[t*a,t*s]]}function LX(e,t){let[[r,n],i,o,a]=e;return[[t*r,t*n],t*i,t*o,a]}function NX(e,t){if(e.length!==t.length)throw new Error("Polygon tangent must be added to polygon of same length.");let r=new Array(e.length);for(let n=0;n<r.length;n++){let i=e[n],o=t[n];r[n]=[i[0]+o[0],i[1]+o[1]]}return r}function Aw(e,t){let[[r,n],[i,o]]=e,[[a,s],[c,l]]=t;return[[r+a,n+s],[i+c,o+l]]}function RX(e,t){let[[r,n,i],[o,a,s]]=e,[[c,l,u],[d,f,g]]=t;return[[r+c,n+l,i+u],[o+d,a+f,s+g]]}var kX=Aw,VX=Aw,FX=Aw;function GX(e,t){let[[r,n],i]=e,[[o,a],s]=t;return[[r+o,n+a],i+s]}function BX(e,t){let[[r,n],[i,o],[a,s]]=e,[[c,l],[u,d],[f,g]]=t;return[[r+c,n+l],[i+u,o+d],[a+f,s+g]]}function qX(e,t){let[[r,n],i,o,a]=e,[[s,c],l,u]=t;return[[r+s,n+c],i+l,o+u,a]}function zX(e,t){let[[r,n],[i,o],a]=e,[[s,c],[l,u]]=t;return[[r+s,n+c],[i+l,o+u],a]}function OA(e,t){let[[r,n],[i,o]]=e;return[(1-t)*r+t*i,(1-t)*n+t*o]}function LA(e,t){return OA(e,ui(t,0,1))}function UX(e,t){t=ui(t,0,1);let[[r,n,i],[o,a,s]]=e;return[(1-t)*r+t*o,(1-t)*n+t*a,(1-t)*i+t*s]}function cA(e,t){return OA(e,ui(t,0,1/0))}function HX(e,t){let[[r,n],i]=e,o=Math.min(1,Math.max(0,t));return[r+i*Math.cos(2*Math.PI*o),n+i*Math.sin(2*Math.PI*o)]}function QB(e,t){let r=ph(e);if(!r)return[NaN,NaN];if(r.type==="segment")return LA([e[0],e[2]],t);if(r.type==="rays")return t<=0?cA([r.start1,r.end1],-t):t>=1?cA([r.start2,r.end2],t-1):[NaN,NaN];t=Math.min(1,Math.max(0,t));let n=uh(e),i=dh(e),o=Math.atan2(e[0][1]-n[1],e[0][0]-n[0]),a=ah(n,e[0]),s=o+t*i;return[n[0]+a*Math.cos(s),n[1]+a*Math.sin(s)]}function $X(e,t){if(isNaN(t)||e.length===0)return[[NaN,NaN],[NaN,NaN]];if(t<0||t>=e.length)return[e[0],e[0]];let r=Math.floor(t);return[e[r],e[(r+1)%e.length]]}function YX(e,t){if(isNaN(t)||e.length===0)return[NaN,NaN];if(t<0||t>=e.length)return e[0];let r=Math.floor(t);return LA([e[r],e[(r+1)%e.length]],t-r)}function ph(e){let[t,r,n]=e,[[i,o],[a,s],[c,l]]=[t,r,n];if(isNaN(i)||isNaN(o)||isNaN(a)||isNaN(s)||isNaN(c)||isNaN(l))return;let u=uh([t,r,n]),d=ah(u,t);if(isFinite(d)&&!_A([t,r,n])){let f=Math.atan2(t[1]-u[1],t[0]-u[0]),g=f+dh([t,r,n]);return{type:"arc",center:u,radius:d,startAngle:f,endAngle:g}}else{let f=El(a,s,0,i,o,0,c,l,0);return f<0||f>1?{type:"rays",start1:[i,o],end1:[i+(i-c),o+(o-l)],start2:[c,l],end2:[c+(c-i),l+(l-o)]}:{type:"segment",start:[i,o],end:[c,l]}}}function WX(e,t,r){let i=ah(e,t);if(i>1e-9)return t;let o=ah(e,r);return o>1e-9?r:isNaN(i)&&isNaN(o)?[NaN,NaN]:e}function Ox(e,t){let[[r,n],i]=e,[[o,a],s]=t,c=xa(o-r,a-n),l=c*c,u=i*i,d=s*s,[f,g,y]=[c,i,s].sort((D,O)=>O-D),x=f+g+y,b=y-(f-g),w=y+(f-g),E=f+(g-y),I=.01,S;return b<0&&f+I*b===f||w<0&&f+I*w===f||E<0&&f+I*E===f?S=0:S=Math.sqrt(x*b*w*E)/4,[(o+r)/2+(o-r)*(u-d)/(2*l)+-2*(a-n)*S/l,(a+n)/2+(a-n)*(u-d)/(2*l)+2*(o-r)*S/l]}function yw(e,t,r){let[[n,i],o]=e,[[a,s],[c,l]]=t,u=a-n,d=c-n,f=s-i,g=l-i,y=c-a,x=l-s,b=y*y+x*x,w=xa(y,x),E=u*g-d*f,I=o*w,S=I+E,D=I-E,O=.01,_;if(S<0&&I+O*S===I||D<0&&I+O*D===I?_=0:_=S*D,_<0)return[NaN,NaN];let A=Math.sqrt(_);return[n+(E*x+r*y*A)/b,i+(-E*y+r*x*A)/b]}function XX(e,t){let[[r,n],[i,o]]=e,[[a,s],[c,l]]=t,u=o-n,d=r-i,f=l-s,g=a-c,y=u*r+d*n,x=f*a+g*s,b=u*g-f*d,w=b/(xa(u,d)*xa(f,g));return b===0||1+.1*w===1?[NaN,NaN]:[(g*y-d*x)/b,(u*x-f*y)/b]}function NA(e,t,r=0){let n=yw(t,e,-1);if(pp(n,e,r,!0))return n;{let i=yw(t,e,1);return pp(i,e,r,!0)?i:[NaN,NaN]}}function RA(e,t,r=0){let n=yw(e,t,1);if(pp(n,t,r,!1))return n;{let i=yw(e,t,-1);return pp(i,t,r,!1)?i:[NaN,NaN]}}function e3(e,t,r=0){let n=XX(e,t);return!pp(n,e,r,!0)||!pp(n,t,r,!1)?[NaN,NaN]:n}function KX(e,t,r=0){let n=n3(t,e,r,-1);return sh(n,t,r,!1)?n:[NaN,NaN]}function t3(e,t,r=0){let n=i3(t,e,r,-1);return!pp(n,e,r,!0)||!sh(n,t,r,!1)?[NaN,NaN]:n}function jX(e,t,r=0){let n=n3(e,t,r,1);return sh(n,e,r,!0)?n:[NaN,NaN]}function r3(e,t,r=0){let n=i3(e,t,r,1);return!sh(n,e,r,!0)||!pp(n,t,r,!1)?[NaN,NaN]:n}function ZX(e,t,r=0){let n=JX(e,t,r);return!sh(n,e,r,!0)||!sh(n,t,r,!1)?[NaN,NaN]:n}function JX(e,t,r){let n=xw(e);if(vw(n))return t3(n,t,r);let i=xw(t);return vw(i)?r3(e,i,r):kA(()=>Ox(n,i),()=>Ox(i,n),o=>VA(-1,bw(e,o),bw(t,o)))}function n3(e,t,r,n){let i=xw(e);return vw(i)?n>0?RA(t,i,r):NA(i,t,r):kA(()=>Ox(i,t),()=>Ox(t,i),o=>VA(n,bw(e,o),QX(t,o)))}function i3(e,t,r,n){let i=xw(e);return vw(i)?e3(i,t,r):kA(()=>RA(i,t,r),()=>NA(t,i,r),o=>VA(n,bw(e,o),eK(t)))}function kA(e,t,r){let n=e();if(r(n))return n;let i=t();return r(i)?i:[NaN,NaN]}function VA(e,t,r){return e*a3(t,r)>0}function bw(e,[t,r]){let[n,i]=uh(e);return dh(e)>0?[i-r,t-n]:[r-i,n-t]}function QX([[e,t]],[r,n]){return[t-n,r-e]}function eK([[e,t],[r,n]]){return[r-e,n-t]}function xw(e){let t=uh(e),r=ah(t,QB(e,0));return isFinite(r)&&!_A(e)?[t,r]:[e[0],e[2]]}function vw(e){return Array.isArray(e[1])}function sh([e,t],r,n,i){let[o,a]=uh(r);return(i?(n&3)===0:(n&12)===0)||xS(Math.atan2(t-a,e-o),Math.atan2(r[0][1]-a,r[0][0]-o),dh(r))}function pp([e,t],[[r,n],[i,o]],a,s){let c=El(e,t,0,r,n,0,i,o,0),[l,u]=s?[(a&1)===0,(a&2)===0]:[(a&4)===0,(a&8)===0];return!isNaN(c)&&(c>=0||l)&&(c<=1||u)}function tK(e,t){let[[r,n],[i,o]]=e,[a,s]=t;return[[a,s],[a+(i-r),s+(o-n)]]}function rK(e,t){let[[r,n],[i,o]]=e,[a,s]=t;return[[a,s],[a+(o-n),s-(i-r)]]}function nK(e){let[t,r,n]=e,[i,o]=t,a=Nn(r+n/2),s=fn(r+n/2);return[[i,o],[i+a,o+s]]}function o3(e,t){let[r,n]=e,[i,o]=t;return[r*i-n*o,r*o+i*n]}function FA(e,t){let[r,n,i]=e,[o,a]=r,[s,c]=t;return i&&(c=-c),a===0?[o*s,o*c]:[o*s-a*c,o*c+s*a]}function a3(e,t){let[r,n]=e,[i,o]=t;return r*o-i*n}function iK(e,t){let[r,n]=e,[i,o]=t;return r*i+n*o}function oK(e){let[t,r]=e;return[-r,t]}function aK(e,t){return[e,t,!1]}function sK(e,t){return[e,t,!0]}function cK(e){return[e[0],[0,0],e[2]]}function lK(e){return e[0]}function uK(e){return[[1,0],e,!1]}function dK(e,t){let[r,n]=e;return[[t,0],[(1-t)*r,(1-t)*n],!1]}function pK(e,t){let[r,n]=e,i=Math.cos(t),o=Math.sin(t);return[[i,o],[r*(1-i)+n*o,n*(1-i)-r*o],!1]}function gK(e){let[[t,r],[n,i]]=e,o=n-t,a=i-r,s=o*o+a*a,c=(o*o-a*a)/s,l=2*o*a/s;return[[c,l],[(1-c)*t-l*r,(1+c)*r-l*t],!0]}function fK(e,t){let r=e[2],[n,i,o]=t;return[FA(e,n),Fc(e,i),o!==r]}function mK(e){let[[t,r],[n,i],o]=e,a=t*t+r*r,s=t/a,c=-r/a,l=-(t/a*n+r/a*i),u=-(t/a*i-r/a*n);return o&&(c=-c,u=-u),[[s,c],[l,u],o]}function Fc(e,t){let[r,n]=FA(e,t),[i,o]=e[1];return[r+i,n+o]}function hK(e,t){let[r,n,i]=e;return i?-t:t}function GA(e,t){let[r,n]=t;return[Fc(e,r),Fc(e,n)]}var yK=GA,bK=GA;function xK(e,t){let[r,n]=t;return[FA(e,r),Fc(e,n)]}function vK(e,t){let[r,n]=t,[[i,o]]=e;return[Fc(e,r),xa(i,o)*n]}function TK(e,t){let[r,n,i]=t;return[Fc(e,r),Fc(e,n),Fc(e,i)]}function wK(e,t){let r=[];for(let n of t)r.push(Fc(e,n));return r}function EK(e,t){let[r,n,i]=t,o=Fc(e,r),[a,s,c]=e,[l,u]=Fc([a,[0,0],c],[Math.cos(n),Math.sin(n)]),d=Math.atan2(u,l),f=hK(e,i);return[o,d,f,t[3]]}function IK(e,t){let r=[];for(let n=0;n<Math.min(e.length,t.length);n++)t[n]&&r.push(e[n]);return r}function CK(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function PK(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],o=Tw(i);r.hasOwnProperty(o)||(r[o]=!0,t.push(n))}return t}function SK(e,t){return[e,t]}function MK(e){return e[0]}function DK(e){return e[1]}function Tw(e){if(Array.isArray(e))return`[${e.map(Tw).join(",")}]`;switch(typeof e){case"string":return e;case"boolean":case"number":return e.toString();case"object":if(_K(e)){let r=[];for(let n of _n(e.updateRules))r.push(`"${n}": ${Tw(e.updateRules[n].value)}`);return`{${r.join(",")}}`}else return ae(e).toString();default:return e}}function _K(e){return typeof e!="object"||!e?!1:e.type==="Action"}function AK(e){return e}function OK(e){return e}function an(e,t){return isNaN(e)||isNaN(t)?[NaN,NaN]:[e,t]}function up(e,t){return isNaN(e)||isNaN(t)?an(NaN,NaN):e===0?an(0,0):an(e*Nn(t),e*fn(t))}function LK([e,t]){return e}function NK([e,t]){return t}function RK([e,t]){return kx(t,e)}function Jg([e,t]){return[e,-t]}function rf(e,t){let[r,n]=t;return Math.abs(n)<=Math.abs(r)?fB(e,t):Jg(fB(gB(e),gB(t)))}function gB([e,t]){return[t,e]}function fB([e,t],[r,n]){let i=n/r,o=1/(r+n*i);return i===0?an((e+n*(t/r))*o,(t-n*(e/r))*o):an((e+t*i)*o,(t-e*i)*o)}function s3([e,t]){return Qg(e,t)}function Qg(e,t){let r=Math.sqrt(.5*(Math.abs(e)+xa(e,t)));return r===1/0&&(r=2*Math.sqrt(.5*(Math.abs(.25*e)+xa(.25*e,.25*t)))),r===0||!isFinite(t)?an(r,t):e>0?an(r,.5*(t/r)):(t<0&&(r=-r),an(.5*(t/r),r))}function Ka(e){return rf(an(1,0),e)}function Lx(e){return 0+e}function kx(e,t){return Math.atan2(Lx(e),Lx(t))}function kK(e,t){let r=e*e+t*t;if(r===1/0)return Math.log(Math.hypot(.5*e,.5*t))+Math.LN2;if(r===0)return Math.log(Math.hypot(e,t));if(.5<r&&r<3){let n=Math.max(e,t),i=Math.min(e,t);return .5*Math.log1p((n+1)*(n-1)+i*i)}else return .5*Math.log(r)}function VK([e,t]){return an(kK(e,t),kx(t,e))}function FK([e,t]){let r=Math.exp(e);return t===0?an(r,0):up(r,t)}function GK(e,t){let[r,n]=t;if(n===0)return c3(e,r);let[i,o]=e;if(isNaN(i)||isNaN(o)||isNaN(r)||isNaN(n))return an(NaN,NaN);let a=xa(i,o),s=kx(o,i),c=Math.pow(a,r)*Math.exp(-s*n),l=Math.log(a)*n+s*r;return isFinite(c)?up(c,l):up(Math.exp(r*Math.log(a)-s*n),l)}function c3(e,t){let[r,n]=e;if(isNaN(r)||isNaN(n)||isNaN(t))return an(NaN,NaN);switch(t){case-1:return Ka(e);case 0:return an(1,0);case .5:return s3(e);case 1:return e}return n===0?Number.isInteger(t)||r>=0?an(Math.pow(r,t),0):up(Math.pow(-r,t),Math.PI*t):r===0?n>=0?up(Math.pow(n,t),.5*Math.PI*t):up(Math.pow(-n,t),-.5*Math.PI*t):up(Math.pow(Math.hypot(r,n),t),t*kx(n,r))}function l3([e,t]){return an(fn(e)*ch(t),Nn(e)*ef(t))}function u3([e,t]){return an(Nn(e)*ch(t),-fn(e)*ef(t))}function d3([e,t]){let[r,n]=BA([-t,e]);return[n,-r]}function p3([e,t]){return an(ef(e)*Nn(t),ch(e)*fn(t))}function g3([e,t]){return an(ch(e)*Nn(t),ef(e)*fn(t))}function BA([e,t]){let r=hA(t),n=gA(e);if(!isFinite(r))return an(1/n,1/r);let i=r*r,o=1+i,a=ef(e),s=a*a,c=n*n;return an(o*n/(1+i*c),r/(1+o*s))}function BK(e){return Ka(u3(e))}function qK(e){return Ka(l3(e))}function zK(e){return Ka(d3(e))}function UK(e){return Ka(g3(e))}function HK(e){return Ka(p3(e))}function $K(e){return Ka(BA(e))}function qA([e,t]){let r=Qg(1-e,-t),n=Qg(1+e,t);return an(Math.atan(e/Lx(Kg(r,n)[0])),Math.asinh(Kg(Jg(r),n)[1]))}function f3([e,t]){let r=Qg(1-e,-t),n=Qg(1+e,t);return an(2*Math.atan(r[0]/Lx(n[0])),Math.asinh(Kg(Jg(n),r)[1]))}function lA([e,t]){let[r,n]=ww([-t,e]);return[n,-r]}function m3([e,t]){let[r,n]=qA([-t,e]);return[n,-r]}function h3([e,t]){let r=Qg(e-1,t),n=Qg(e+1,t);return an(Math.asinh(Kg(Jg(r),n)[0]),2*Math.atan(r[1]/Lx(n[0])))}function ww([e,t]){if(e<0){let[r,n]=hB(-e,-t);return[-r,-n]}else return hB(e,t)}var mB=Math.sqrt(Number.MAX_VALUE)/4;function hB(e,t){if(e>mB||Math.abs(t)>mB)return an(Ka([e,t])[0],t<=0?-Math.PI/2:Math.PI/2);if(e===1){if(t===0)return an(1/0,0);let r=Math.abs(t),n=Math.log(Math.sqrt(Math.sqrt(4+t*t))/Math.sqrt(r)),i=(Math.PI/2+Math.atan(r/2))/2;return t<0!=i<0&&(i=-i),an(n,i)}else return an(lh(4*e/((1-e)**2+t**2))/4,-kx(-2*t,(1-e)*(1+e)-t**2)/2)}function YK(e){return f3(Ka(e))}function WK(e){return qA(Ka(e))}function XK(e){if(e[0]>0)return lA(Ka(e));let[t,r]=lA(e);return an(Math.PI/2-t,-r)}function KK(e){let[t,r]=e;return t===0&&r===0?an(1/0,0):h3(Ka(e))}function jK(e){let[t,r]=e;return t===0&&r===0?an(1/0,0):m3(Ka(e))}function ZK(e){return e[0]>0?Jg(ww(Jg(Ka(e)))):ww(Ka(e))}function JK(e){return e[1]===0?e[0]:NaN}function QK(e){return isNaN(e)?[NaN,NaN]:[e,0]}function y3([e,t]){let r=Math.floor(e),n=Math.floor(t);if(!isFinite(r)||!isFinite(n))return[r,n];let i=e-r,o=t-n;return i+o<1?[r,n]:i>=o?[r+1,n]:[r,n+1]}function ej([e,t]){let r=y3([-e,-t]);return[-r[0],-r[1]]}function rh(e){return[Math.round(e[0]),Math.round(e[1])]}function tj(e,t){let[r,n]=e,[i,o]=t;if(!isFinite(r)||!isFinite(n)||isNaN(i)||isNaN(o))return[NaN,NaN];if(!isFinite(i)&&!isFinite(o))return e;if(i===1/0)return lw(r,n,o);if(i===-1/0){let[f,g]=lw(-r,-n,-o);return[-f,-g]}else if(o===1/0){let[f,g]=lw(n,-r,-i);return[-g,f]}else if(o===-1/0){let[f,g]=lw(-n,r,i);return[g,-f]}let a=uA(t),s=r*i+n*o,c=n*i-r*o,l=jg(s,a),u=jg(c,a);l+u<a||(l>=u?l-=a:u-=a);let d=rf([l,u],[i,-o]);return Number.isInteger(r)&&Number.isInteger(n)&&Number.isInteger(i)&&Number.isInteger(o)?[Math.round(d[0]),Math.round(d[1])]:d}function lw(e,t,r){return e+t<0?e>=t?an(e-r,1/0):an(1/0,t+r):[e,t]}function uA([e,t]){return e*e+t*t}function dA(e,t){if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];e=rh(e),t=rh(t);let r=zA(e,t);return b3(r)}function zA(e,t){let r=[1,0];for(e=[e[0],e[1]],t=[t[0],t[1]];;){let n=uA(e),i=uA(t);if(n===1||i===1)return r;if(n===0)return Kg(t,r);if(i===0)return Kg(e,r);if(n===i&&nj(e,t))return Kg(e,r);switch(uw(e[0])<<3|uw(e[1])<<2|uw(t[0])<<1|uw(t[1])){case 0:Qm(e),Qm(t),rj(r);break;case 1:case 2:Qm(e);break;case 4:case 8:Qm(t);break;case 3:Qm(e),eh(t),iA(r);break;case 12:eh(e),Qm(t),iA(r);break;case 14:case 13:eh(e);break;case 7:case 11:eh(t);break;case 15:eh(e),eh(t),iA(r);break;case 5:case 10:e=[.5*(e[0]-t[0]),.5*(e[1]-t[1])],t=[e[0]+t[0],e[1]+t[1]];break;case 6:case 9:e=[.5*(e[0]+t[1]),.5*(e[1]-t[0])],t=[e[0]-t[1],e[1]+t[0]];break}}}function rj(e){e[0]*=2,e[1]*=2}function Qm(e){e[0]*=.5,e[1]*=.5}function iA(e){let t=e[0]-e[1];e[1]=e[1]+e[0],e[0]=t}function eh(e){let t=.5*(e[0]+e[1]);e[1]=.5*(e[1]-e[0]),e[0]=t}function uw(e){return e%2==0?0:1}function Kg(e,t){let[r,n]=e,[i,o]=t;return an(r*i-n*o,r*o+i*n)}function nj(e,t){return e[0]==t[0]&&e[1]==t[1]||e[0]==-t[0]&&e[1]==-t[1]||e[0]==-t[1]&&e[1]==t[0]||e[0]==t[1]&&e[1]==-t[0]}function b3(e){let[t,r]=e;return t>=0&&r<0?[-r,t]:t<0&&r<=0?[-t,-r]:t<=0&&r>0?[r,-t]:e}function pA(e,t){if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];if(e[0]===0&&e[1]===0||t[0]===0&&t[1]===0)return[0,0];if(!isFinite(e[0])||!isFinite(e[1])||!isFinite(t[0])||!isFinite(t[1]))return[NaN,NaN];e=rh(e),t=rh(t);let r=zA(e,t),n=rh(rf(e,r)),i=o3(n,t);return b3(i)}function gh(e,t){return{n:e,d:t}}function Zr(e){return typeof e=="object"&&typeof e.n=="number"&&typeof e.d=="number"}var Vx=Math.pow(2,53)-1;function nf(e){let t=e.match(/^(-)?(\d*)?(?:\.(\d*))?$/);if(!t)return NaN;let r=t[1],n=t[2],i=t[3];if(!n&&!i)return NaN;let o=!!r;if(i){let a=i.replace(/0+$/,""),s=a.length,c=Math.pow(10,s),l=parseInt(n||"0",10)*c+parseInt(a||"0",10);return l>Vx||c>Vx?parseFloat(e):Et(o?-l:l,c)}else{let a=parseInt(n,10);return a>Vx?parseFloat(e):Et(o?-a:a,1)}}function ae(e){return Zr(e)?e.n/e.d:+e}function Ys(e){return Zr(e)?!1:isNaN(e)}function Et(e,t){if(!isFinite(e)||!isFinite(t)||t===0||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>Vx||Math.abs(t)>Vx)return e/t;t<0&&(e=-e,t=-t);let r=Ng(e,t);return gh(e/r,t/r)}function ko(e){return Zr(e)?gh(-e.n,e.d):-e}function x3(e){return Zr(e)?gh(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function Fx(e){return Zr(e)?e.n===0?e.d/e.n:gh(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function bo(e,t){if(!Zr(e)||!Zr(t))return ae(e)+ae(t);var r=Ng(e.d,t.d);return Et(e.n*(t.d/r)+t.n*(e.d/r),e.d/r*t.d)}function Pi(e,t){if(!Zr(e)||!Zr(t))return ae(e)*ae(t);var r=Ng(e.n,t.d),n=Ng(t.n,e.d);return Et(e.n/r*(t.n/n),e.d/n*(t.d/r))}function Ro(e,t){return bo(e,ko(t))}function yo(e,t){return!Zr(e)||!Zr(t)?ae(e)/ae(t):Pi(e,Fx(t))}function ij(e,t){let r=e,n=t;if(t.n<0&&(n=ko(t),r=Fx(e)),!Zr(r)||!Zr(n))return Rg(ae(e),ae(t));if(e=r,t=n,t.d===1)return Et(Math.pow(e.n,t.n),Math.pow(e.d,t.n));let i=e.n<0;if(i&&t.d%2!==1)return NaN;let a=(i?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),s=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(a,t.d)!==e.n||Math.pow(s,t.d)!==e.d?Rg(ae(e),ae(t)):Et(Math.pow(a,t.n),Math.pow(s,t.n))}function Gx(e,t){if(!Zr(e)||!Zr(t))return Rg(ae(e),ae(t));let r=ij(e,t);return Zr(r)?r:Rg(ae(e),ae(t))}function Ow(e){if(!Zr(e))return Math.sqrt(e);let t=Math.round(Math.sqrt(e.n)),r=Math.round(Math.sqrt(e.d));return t*t!==e.n||r*r!==e.d?Math.sqrt(ae(e)):Et(t,r)}function Lw(e,t){return Gx(e,Fx(t))}function v3(e,t){if(!Zr(e)||!Zr(t)){let n=ae(e),i=ae(t);jg(n,i)}let r=Ro(e,Pi(t,gh(Math.floor(ae(yo(e,t))),1)));return Zr(r)?r:jg(ae(e),ae(t))}function T3(e){let t=gh(0,1);for(let r of e)t=bo(t,r);return t}var Pe=class extends Gr{constructor(t,r){if(!Array.isArray(t))throw new TypeError("Argument to expression constructor must be an Array.");super(),this.args=t,(!r||!r.skipRegisterDependencies)&&this.registerDependencies()}shouldExportAns(){return!0}registerDependencies(){for(var t=0;t<this.args.length;t++)this.mergeDependencies(this.args[t])}copyWithArgs(t){throw new Error(`Programming Error: copyWithArgs not implemented for ${this.constructor.name}`)}};var Yr=class extends Pe{constructor(r){super([]);this.isConstant=!0;typeof r=="number"&&(r=Et(r,1)),this._constantValue=r}asValue(){let r=this._constantValue;return typeof r=="boolean"?r:ae(r)}asCompilerValue(){return this._constantValue}scalarExprString(){return this.asValue()>0?String(this.asValue()):"("+String(this.asValue())+")"}getEvaluationInfo(){return[{val:this.asValue()}]}isNaN(){let r=this.asValue();return typeof r=="number"&&isNaN(r)}};function fh(e){if(e.length===0)return Rt;if(e.includes($))return Dn;let t=e[0];if(t!==C&&Li(t,C))for(let r of e){let n=Cg(t,r);n!==void 0&&(t=n)}return ei(t)?Qn(t):vn}function Nw(e){let t=[];for(let r of e)r!==Rt&&(xe(r)?t.push(It(r)):t.push(r));return fh(t)}function oj(e){switch(e){case"default":case"trig":case"inverseTrig":case"trig2":case"never-broadcast":return[C];case"reducer":return[ke];case"doubleReducer":return[ke,ke];case"parameterizedReducer":return[ke,C];case"color":return[C,C,C]}}function aj(e){switch(e){case"default":case"trig":case"inverseTrig":case"trig2":case"doubleReducer":case"color":case"never-broadcast":return!1;case"reducer":case"parameterizedReducer":return!0}}function sj(e,t,r){return e==="reducer"?1/0:t+r}function H(e,t,r){var g,y,x,b,w;r===void 0&&(r={});let n=(g=r.tag)!=null?g:"default",i=(y=r.argumentTypes)!=null?y:oj(n),o=r.defaultArguments?r.defaultArguments.length:0,a=i.length-o,s=sj(n,a,o),c=(x=r.allowDotCall)!=null?x:aj(n),l=(b=r.noPeel)!=null?b:!1,{defaultArguments:u,minArityExampleArgs:d,maxArityExampleArgs:f}=r;return{module:e,symbol:t,argumentTypes:i,defaultArguments:u,returnType:(w=r.returnType)!=null?w:C,tag:n,minArity:a,maxArity:s,allowDotCall:c,noPeel:l,minArityExampleArgs:d,maxArityExampleArgs:f}}function YA(e){if(!Zr(e))throw new Error("Programming Error: numeric constants should be rational");return{type:1,valueType:C,value:e}}var of=YA(Et(0,1)),hh=YA(Et(1,1)),kw=YA(Et(1,2));function fp(e){let t;return e in Xn&&(t=Xn[e].tag),t==="trig"||t==="trig2"||t==="inverseTrig"?!0:e==="angle"||e==="angles"||e==="directedangle"||e==="directedangles"||e==="rotate"}var Xn={sin:H("BuiltIn","sin",{tag:"trig"}),cos:H("BuiltIn","cos",{tag:"trig"}),tan:H("BuiltIn","tan",{tag:"trig"}),cot:H("BuiltIn","cot",{tag:"trig"}),sec:H("BuiltIn","sec",{tag:"trig"}),csc:H("BuiltIn","csc",{tag:"trig"}),arcsin:H("Math","asin",{tag:"inverseTrig"}),arccos:H("Math","acos",{tag:"inverseTrig"}),arctan:H("Math","atan2",{argumentTypes:[C,C],tag:"inverseTrig"}),arccot:H("BuiltIn","acot",{tag:"inverseTrig"}),arcsec:H("BuiltIn","asec",{tag:"inverseTrig"}),arccsc:H("BuiltIn","acsc",{tag:"inverseTrig"}),sinh:H("BuiltIn","sinh"),cosh:H("BuiltIn","cosh"),tanh:H("BuiltIn","tanh"),coth:H("BuiltIn","coth"),sech:H("BuiltIn","sech"),csch:H("BuiltIn","csch"),arcsinh:H("BuiltIn","asinh"),arccosh:H("BuiltIn","acosh"),arctanh:H("BuiltIn","atanh"),arccoth:H("BuiltIn","acoth"),arcsech:H("BuiltIn","asech"),arccsch:H("BuiltIn","acsch"),sqrt:H("Math","sqrt"),rtxsqpone:H("BuiltIn","sqrtxsqp1"),rtxsqmone:H("BuiltIn","sqrtxsqm1"),nthroot:H("BuiltIn","nthroot",{argumentTypes:[C,C]}),hypot:H("BuiltIn","hypot",{argumentTypes:[C,C]}),log:H("BuiltIn","common_log"),logbase:H("BuiltIn","log_base",{argumentTypes:[C,C]}),ln:H("BuiltIn","log"),exp:H("Math","exp"),floor:H("Math","floor"),complexFloor:H("BuiltIn","complexFloor",{argumentTypes:[$],returnType:$}),ceil:H("Math","ceil"),complexCeil:H("BuiltIn","complexCeil",{argumentTypes:[$],returnType:$}),round:H("Math","round"),complexRound:H("BuiltIn","complexRound",{argumentTypes:[$],returnType:$}),abs:H("Math","abs"),sign:H("BuiltIn","sign"),mod:H("BuiltIn","mod",{argumentTypes:[C,C]}),complexMod:H("BuiltIn","complexMod",{argumentTypes:[$,$],returnType:$}),nCr:H("BuiltIn","nCr",{argumentTypes:[C,C]}),nPr:H("BuiltIn","nPr",{argumentTypes:[C,C]}),factorial:H("BuiltIn","factorial"),polyGamma:H("BuiltIn","polyGamma",{argumentTypes:[C,C]}),lcm:H("BuiltIn","listLCM",{tag:"reducer"}),complexLCM:H("BuiltIn","complexListLCM",{argumentTypes:[Dn],returnType:$,tag:"reducer"}),gcd:H("BuiltIn","listGCD",{tag:"reducer"}),complexGCD:H("BuiltIn","complexListGCD",{argumentTypes:[Dn],returnType:$,tag:"reducer"}),distance:H("BuiltIn","distance",{argumentTypes:[z,z]}),polygon:H("BuiltIn","polygon",{tag:"reducer",argumentTypes:[on],returnType:et}),area:H("BuiltIn","polygonArea",{argumentTypes:[et]}),perimeter:H("BuiltIn","polygonPerimeter",{argumentTypes:[et]}),pointDet:H("BuiltIn","pointDet",{argumentTypes:[z,z]}),pointDot:H("BuiltIn","pointDot",{argumentTypes:[z,z]}),pointPerp:H("BuiltIn","pointPerp",{argumentTypes:[z],returnType:z}),complexMultiplyPoints:H("BuiltIn","complexMultiplyPoints",{argumentTypes:[z,z],returnType:z}),segment:H("BuiltIn","segment",{argumentTypes:[z,z],returnType:Ye}),line:H("BuiltIn","line",{argumentTypes:[z,z],returnType:Re}),ray:H("BuiltIn","ray",{argumentTypes:[z,z],returnType:ot}),vector:H("BuiltIn","vector",{argumentTypes:[z,z],returnType:Ve}),vectorThreeD:H("BuiltIn","vectorThreeD",{argumentTypes:[oe,oe],returnType:Pt}),mathVector:H("BuiltIn","mathVector",{argumentTypes:[z,z],returnType:Ve}),mathVectorThreeD:H("BuiltIn","mathVectorThreeD",{argumentTypes:[oe,oe],returnType:Pt}),vectorDisplacementAsPoint:H("BuiltIn","vectorDisplacementAsPoint",{argumentTypes:[Ve],returnType:z}),vectorThreeDDisplacementAsPoint:H("BuiltIn","vectorThreeDDisplacementAsPoint",{argumentTypes:[Pt],returnType:oe}),basePointFromVector:H("BuiltIn","basePointFromVector",{argumentTypes:[Ve],returnType:z}),basePointFromVectorThreeD:H("BuiltIn","basePointFromVectorThreeD",{argumentTypes:[Pt],returnType:oe}),circle:H("BuiltIn","circle",{argumentTypes:[z,C],returnType:We}),center:H("BuiltIn","center",{argumentTypes:[We],returnType:z,allowDotCall:!0}),radius:H("BuiltIn","radius",{argumentTypes:[We],returnType:C,allowDotCall:!0}),arc:H("BuiltIn","arc",{argumentTypes:[z,z,z],returnType:Oe}),arcCenter:H("BuiltIn","arcCenter",{argumentTypes:[Oe],returnType:z}),arcFirstPoint:H("BuiltIn","arcFirstPoint",{argumentTypes:[Oe],returnType:z}),arcMiddlePoint:H("BuiltIn","arcMiddlePoint",{argumentTypes:[Oe],returnType:z}),arcThirdPoint:H("BuiltIn","arcThirdPoint",{argumentTypes:[Oe],returnType:z}),arcOmega:H("BuiltIn","arcOmega",{argumentTypes:[Oe],returnType:C}),undirectedAngleMarker:H("BuiltIn","undirectedAngleMarker",{argumentTypes:[$e],returnType:st}),directedAngleMarker:H("BuiltIn","directedAngleMarker",{argumentTypes:[z,C,C,C],returnType:$e}),directedCoterminalAngle:H("BuiltIn","directedCoterminalAngle",{argumentTypes:[$e],returnType:$e}),undirectedCoterminalAngle:H("BuiltIn","undirectedCoterminalAngle",{argumentTypes:[st],returnType:st}),supplement:H("BuiltIn","supplementAngle",{argumentTypes:[$e],returnType:$e}),directedAngleMarkerRawDelta:H("BuiltIn","angleMarkerRawDelta",{argumentTypes:[$e],returnType:C}),undirectedAngleMarkerRawDelta:H("BuiltIn","angleMarkerRawDelta",{argumentTypes:[st],returnType:C}),directedAngleMarkerMultiplier:H("BuiltIn","angleMarkerMultiplier",{argumentTypes:[$e],returnType:C}),undirectedAngleMarkerMultiplier:H("BuiltIn","angleMarkerMultiplier",{argumentTypes:[st],returnType:C}),polygonInteriorUndirectedAngles:H("BuiltIn","polygonInteriorUndirectedAngles",{argumentTypes:[et,C],returnType:Un,allowDotCall:!0,tag:"never-broadcast"}),polygonInteriorDirectedAngles:H("BuiltIn","polygonInteriorDirectedAngles",{argumentTypes:[et,C],returnType:ri,allowDotCall:!0,tag:"never-broadcast"}),vertices:H("BuiltIn","vertices",{argumentTypes:[et],returnType:on,allowDotCall:!0,tag:"never-broadcast"}),segments:H("BuiltIn","polygonEdges",{argumentTypes:[et],returnType:zn,allowDotCall:!0,tag:"never-broadcast"}),scaleTangentTransformation:H("BuiltIn","scaleTangentTransformation",{argumentTypes:[xt,C],returnType:et}),scaleTangentPolygon:H("BuiltIn","scaleTangentPolygon",{argumentTypes:[et,C],returnType:et}),scaleTangentSegment:H("BuiltIn","scaleTangentSegment",{argumentTypes:[Ye,C],returnType:Ye}),scaleTangentLine:H("BuiltIn","scaleTangentLine",{argumentTypes:[Re,C],returnType:Re}),scaleTangentRay:H("BuiltIn","scaleTangentRay",{argumentTypes:[ot,C],returnType:ot}),scaleTangentCircle:H("BuiltIn","scaleTangentCircle",{argumentTypes:[We,C],returnType:We}),scaleTangentArc:H("BuiltIn","scaleTangentArc",{argumentTypes:[Oe,C],returnType:We}),scaleTangentDirectedAngleMarker:H("BuiltIn","scaleTangentAngle",{argumentTypes:[$e,C],returnType:$e}),scaleTangentUndirectedAngleMarker:H("BuiltIn","scaleTangentAngle",{argumentTypes:[st,C],returnType:st}),addTangentPolygon:H("BuiltIn","addTangentPolygon",{argumentTypes:[et,et],returnType:et}),addTangentSegment:H("BuiltIn","addTangentSegment",{argumentTypes:[Ye,Ye],returnType:Ye}),addTangentSegmentThreeD:H("BuiltIn","addTangentSegmentThreeD",{argumentTypes:[Mr,Mr],returnType:Mr}),addTangentLine:H("BuiltIn","addTangentLine",{argumentTypes:[Re,Re],returnType:Re}),addTangentRay:H("BuiltIn","addTangentRay",{argumentTypes:[ot,ot],returnType:ot}),addTangentVector:H("BuiltIn","addTangentVector",{argumentTypes:[Ve,Ve],returnType:Ve}),addTangentCircle:H("BuiltIn","addTangentCircle",{argumentTypes:[We,We],returnType:We}),addTangentArc:H("BuiltIn","addTangentArc",{argumentTypes:[Oe,Oe],returnType:Oe}),addTangentTransformation:H("BuiltIn","addTangentTransformation",{argumentTypes:[xt,xt],returnType:xt}),addTangentDirectedAngleMarker:H("BuiltIn","addTangentAngle",{argumentTypes:[$e,$e],returnType:$e}),addTangentUndirectedAngleMarker:H("BuiltIn","addTangentAngle",{argumentTypes:[st,st],returnType:st}),segmentGlider:H("BuiltIn","segmentGlider",{argumentTypes:[Ye,C],returnType:z}),segmentThreeDGlider:H("BuiltIn","segmentThreeDGlider",{argumentTypes:[Mr,C],returnType:oe}),lineGlider:H("BuiltIn","lineGlider",{argumentTypes:[Re,C],returnType:z}),rayGlider:H("BuiltIn","rayGlider",{argumentTypes:[ot,C],returnType:z}),circleGlider:H("BuiltIn","circleGlider",{argumentTypes:[We,C],returnType:z}),arcGlider:H("BuiltIn","arcGlider",{argumentTypes:[Oe,C],returnType:z}),polygonEdgeByParameter:H("BuiltIn","polygonEdgeByParameter",{argumentTypes:[et,C],returnType:Ye}),polygonGlider:H("BuiltIn","polygonGlider",{argumentTypes:[et,C],returnType:z}),chooseNonIncidentPoint:H("BuiltIn","chooseNonIncidentPoint",{argumentTypes:[z,z,z],returnType:z}),circleCircleIntersection:H("BuiltIn","circleCircleIntersection",{argumentTypes:[We,We,C],returnType:z}),circleArcIntersection:H("BuiltIn","circleArcIntersection",{argumentTypes:[We,Oe,C],returnType:z}),circleLineIntersection:H("BuiltIn","circleLineIntersection",{argumentTypes:[We,Re,C],returnType:z}),arcCircleIntersection:H("BuiltIn","arcCircleIntersection",{argumentTypes:[Oe,We,C],returnType:z}),arcArcIntersection:H("BuiltIn","arcArcIntersection",{argumentTypes:[Oe,Oe,C],returnType:z}),arcLineIntersection:H("BuiltIn","arcLineIntersection",{argumentTypes:[Oe,Re,C],returnType:z}),lineCircleIntersection:H("BuiltIn","lineCircleIntersection",{argumentTypes:[Re,We,C],returnType:z}),lineArcIntersection:H("BuiltIn","lineArcIntersection",{argumentTypes:[Re,Oe,C],returnType:z}),lineLineIntersection:H("BuiltIn","lineLineIntersection",{argumentTypes:[Re,Re,C],returnType:z}),lineFromSegment:H("BuiltIn","identity",{argumentTypes:[Ye],returnType:Re}),lineFromRay:H("BuiltIn","identity",{argumentTypes:[ot],returnType:Re}),parallel:H("BuiltIn","parallel",{argumentTypes:[Re,z],returnType:Re}),perpendicular:H("BuiltIn","perpendicular",{argumentTypes:[Re,z],returnType:Re}),anglebisector:H("BuiltIn","anglebisector",{argumentTypes:[st],returnType:ot}),directedanglebisector:H("BuiltIn","anglebisector",{argumentTypes:[$e],returnType:ot}),rawTransform:H("BuiltIn","rawTransform",{argumentTypes:[z,z],returnType:xt}),rawTransformConj:H("BuiltIn","rawTransformConj",{argumentTypes:[z,z],returnType:xt}),transformWithoutTranslation:H("BuiltIn","transformWithoutTranslation",{argumentTypes:[xt],returnType:xt}),transformScaleFactor:H("BuiltIn","transformScaleFactor",{argumentTypes:[xt],returnType:z}),translation:H("BuiltIn","translation",{argumentTypes:[z],returnType:xt}),dilation:H("BuiltIn","dilation",{argumentTypes:[z,C],returnType:xt}),rotation:H("BuiltIn","rotation",{tag:"trig2",argumentTypes:[z,C],returnType:xt}),reflection:H("BuiltIn","reflection",{argumentTypes:[Re],returnType:xt}),compose:H("BuiltIn","composeTransformation",{argumentTypes:[xt,xt],returnType:xt}),inverse:H("BuiltIn","invertTransformation",{argumentTypes:[xt],returnType:xt}),transformPoint:H("BuiltIn","transformPoint",{argumentTypes:[xt,z],returnType:z}),transformSegment:H("BuiltIn","transformSegment",{argumentTypes:[xt,Ye],returnType:Ye}),transformLine:H("BuiltIn","transformLine",{argumentTypes:[xt,Re],returnType:Re}),transformRay:H("BuiltIn","transformRay",{argumentTypes:[xt,ot],returnType:ot}),transformVector:H("BuiltIn","transformVector",{argumentTypes:[xt,Ve],returnType:Ve}),transformCircle:H("BuiltIn","transformCircle",{argumentTypes:[xt,We],returnType:We}),transformArc:H("BuiltIn","transformArc",{argumentTypes:[xt,Oe],returnType:Oe}),transformPolygon:H("BuiltIn","transformPolygon",{argumentTypes:[xt,et],returnType:et}),transformAngleMarker:H("BuiltIn","transformAngleMarker",{argumentTypes:[xt,st],returnType:st}),transformDirectedAngleMarker:H("BuiltIn","transformAngleMarker",{argumentTypes:[xt,$e],returnType:$e}),distanceThreeD:H("BuiltIn","distanceThreeD",{argumentTypes:[oe,oe]}),segmentThreeD:H("BuiltIn","segmentThreeD",{argumentTypes:[oe,oe],returnType:Mr}),triangle:H("BuiltIn","triangle",{argumentTypes:[oe,oe,oe],returnType:Hn}),sphere:H("BuiltIn","sphere",{argumentTypes:[oe,C],returnType:$n}),mean:H("BuiltIn","mean",{tag:"reducer"}),total:H("BuiltIn","total",{tag:"reducer"}),stdev:H("BuiltIn","stdev",{tag:"reducer"}),stdevp:H("BuiltIn","stdevp",{tag:"reducer"}),mad:H("BuiltIn","mad",{tag:"reducer"}),count:H("BuiltIn","listLength",{tag:"reducer",argumentTypes:[vn],noPeel:!0}),min:H("BuiltIn","listMin",{tag:"reducer"}),max:H("BuiltIn","listMax",{tag:"reducer"}),argmin:H("BuiltIn","argMin",{tag:"reducer",noPeel:!0}),argmax:H("BuiltIn","argMax",{tag:"reducer",noPeel:!0}),median:H("BuiltIn","median",{tag:"reducer"}),var:H("BuiltIn","variance",{tag:"reducer"}),varp:H("BuiltIn","varp",{tag:"reducer"}),cov:H("BuiltIn","cov",{tag:"doubleReducer"}),covp:H("BuiltIn","covp",{tag:"doubleReducer"}),corr:H("BuiltIn","corr",{tag:"doubleReducer"}),spearman:H("BuiltIn","spearman",{tag:"doubleReducer"}),quantile:H("BuiltIn","quantile",{tag:"parameterizedReducer"}),quartile:H("BuiltIn","quartile",{tag:"parameterizedReducer"}),upperQuantileIndex:H("BuiltIn","upperQuantileIndex",{tag:"parameterizedReducer"}),lowerQuantileIndex:H("BuiltIn","lowerQuantileIndex",{tag:"parameterizedReducer"}),quartileIndex:H("BuiltIn","quartileIndex",{tag:"parameterizedReducer"}),upperQuartileIndex:H("BuiltIn","upperQuartileIndex",{tag:"parameterizedReducer"}),lowerQuartileIndex:H("BuiltIn","lowerQuartileIndex",{tag:"parameterizedReducer"}),normalcdf:H("BuiltIn","normalcdf",{argumentTypes:[C,C,C,C],defaultArguments:[of,hh]}),normalpdf:H("BuiltIn","normalpdf",{argumentTypes:[C,C,C],defaultArguments:[of,hh]}),binomcdf:H("BuiltIn","binomcdf",{argumentTypes:[C,C,C,C],defaultArguments:[kw]}),binompdf:H("BuiltIn","binompdf",{argumentTypes:[C,C,C],defaultArguments:[kw]}),poissoncdf:H("BuiltIn","poissoncdf",{argumentTypes:[C,C,C]}),poissonpdf:H("BuiltIn","poissonpdf",{argumentTypes:[C,C,C]}),uniformcdf:H("BuiltIn","uniformcdf",{argumentTypes:[C,C,C,C],defaultArguments:[of,hh]}),uniformpdf:H("BuiltIn","uniformpdf",{argumentTypes:[C,C,C],defaultArguments:[of,hh]}),invT:H("BuiltIn","invT",{argumentTypes:[C,C]}),invPoisson:H("BuiltIn","invPoisson",{argumentTypes:[C,C]}),invBinom:H("BuiltIn","invBinom",{argumentTypes:[C,C,C]}),invUniform:H("BuiltIn","invUniform",{argumentTypes:[C,C,C]}),tpdf:H("BuiltIn","tpdf",{argumentTypes:[C,C]}),tcdf:H("BuiltIn","tcdf",{argumentTypes:[C,C,C]}),erf:H("BuiltIn","erf"),invNorm:H("BuiltIn","invNorm"),tscore:H("BuiltIn","tscore",{tag:"parameterizedReducer",defaultArguments:[of]}),normalSample:H("BuiltIn","normalSample",{argumentTypes:[lr,C,C]}),uniformSample:H("BuiltIn","uniformSample",{argumentTypes:[lr,C,C]}),tSample:H("BuiltIn","tSample",{argumentTypes:[lr,C]}),poissonSample:H("BuiltIn","poissonSample",{argumentTypes:[lr,C]}),binomSample:H("BuiltIn","binomSample",{argumentTypes:[lr,C,C]}),rgb:H("BuiltIn","rgb",{returnType:gn,tag:"color"}),hsv:H("BuiltIn","hsv",{returnType:gn,tag:"color"}),tone:H("BuiltIn","tone",{argumentTypes:[C,C],returnType:In,defaultArguments:[kw],minArityExampleArgs:"(440)",maxArityExampleArgs:"(440, 0.5)"}),validateRangeLength:H("BuiltIn","validateRangeLength",{returnType:C,argumentTypes:[ke,ke,C,C],tag:"never-broadcast",noPeel:!0}),validateSampleCount:H("BuiltIn","validateSampleCount",{returnType:C,argumentTypes:[C]}),select:H("BuiltIn","select",{argumentTypes:[vn,vi],returnType:e=>e[0],tag:"never-broadcast",noPeel:!0}),shuffle:H("BuiltIn","shuffle",{argumentTypes:[lr,vn],returnType:e=>e[1],tag:"never-broadcast"}),sortPerm:H("BuiltIn","sortPerm",{argumentTypes:[ke],returnType:ke,tag:"never-broadcast",noPeel:!0}),elementsAt:H("BuiltIn","elementsAt",{argumentTypes:[vn,ke],returnType:e=>e[0],tag:"never-broadcast",noPeel:!0}),uniquePerm:H("BuiltIn","uniquePerm",{argumentTypes:[vn],returnType:ke,tag:"never-broadcast",noPeel:!0}),restriction:H("BuiltIn","restriction",{argumentTypes:[tt],returnType:ir}),restrictionToBoolean:H("BuiltIn","restrictionToBoolean",{argumentTypes:[ir],returnType:tt}),complex:H("BuiltIn","complex",{argumentTypes:[C,C],returnType:$}),arg:H("BuiltIn","arg",{argumentTypes:[$],returnType:C}),complexDivide:H("BuiltIn","complexDivide",{argumentTypes:[$,$],returnType:$}),coerceComplexToReal:H("BuiltIn","coerceComplexToReal",{argumentTypes:[$],returnType:C}),coerceRealToComplex:H("BuiltIn","coerceRealToComplex",{argumentTypes:[C],returnType:$}),complexSqrt:H("BuiltIn","complexSqrt",{argumentTypes:[$],returnType:$}),complexLn:H("BuiltIn","complexLog",{argumentTypes:[$],returnType:$}),complexExp:H("BuiltIn","complexExp",{argumentTypes:[$],returnType:$}),complexPow:H("BuiltIn","complexPow",{argumentTypes:[$,$],returnType:$}),complexSin:H("BuiltIn","complexSin",{argumentTypes:[$],returnType:$}),complexCos:H("BuiltIn","complexCos",{argumentTypes:[$],returnType:$}),complexTan:H("BuiltIn","complexTan",{argumentTypes:[$],returnType:$}),complexSinh:H("BuiltIn","complexSinh",{argumentTypes:[$],returnType:$}),complexCosh:H("BuiltIn","complexCosh",{argumentTypes:[$],returnType:$}),complexTanh:H("BuiltIn","complexTanh",{argumentTypes:[$],returnType:$}),complexSec:H("BuiltIn","complexSec",{argumentTypes:[$],returnType:$}),complexCsc:H("BuiltIn","complexCsc",{argumentTypes:[$],returnType:$}),complexCot:H("BuiltIn","complexCot",{argumentTypes:[$],returnType:$}),complexSech:H("BuiltIn","complexSech",{argumentTypes:[$],returnType:$}),complexCsch:H("BuiltIn","complexCsch",{argumentTypes:[$],returnType:$}),complexCoth:H("BuiltIn","complexCoth",{argumentTypes:[$],returnType:$}),complexArcsin:H("BuiltIn","complexAsin",{argumentTypes:[$],returnType:$}),complexArccos:H("BuiltIn","complexAcos",{argumentTypes:[$],returnType:$}),complexArctan:H("BuiltIn","complexAtan",{argumentTypes:[$],returnType:$}),complexArcsec:H("BuiltIn","complexAsec",{argumentTypes:[$],returnType:$}),complexArccsc:H("BuiltIn","complexAcsc",{argumentTypes:[$],returnType:$}),complexArccot:H("BuiltIn","complexAcot",{argumentTypes:[$],returnType:$}),complexArcsinh:H("BuiltIn","complexAsinh",{argumentTypes:[$],returnType:$}),complexArccosh:H("BuiltIn","complexAcosh",{argumentTypes:[$],returnType:$}),complexArctanh:H("BuiltIn","complexAtanh",{argumentTypes:[$],returnType:$}),complexArcsech:H("BuiltIn","complexAsech",{argumentTypes:[$],returnType:$}),complexArccsch:H("BuiltIn","complexAcsch",{argumentTypes:[$],returnType:$}),complexArccoth:H("BuiltIn","complexAcoth",{argumentTypes:[$],returnType:$}),angleVertex:H("BuiltIn","angleVertex",{argumentTypes:[st],returnType:z}),angleStart:H("BuiltIn","angleStart",{argumentTypes:[st],returnType:C}),directedAngleVertex:H("BuiltIn","angleVertex",{argumentTypes:[$e],returnType:z}),directedAngleStart:H("BuiltIn","angleStart",{argumentTypes:[$e],returnType:C})},Bx={sqrt:"complexSqrt",ln:"complexLn",exp:"complexExp",sin:"complexSin",cos:"complexCos",tan:"complexTan",sinh:"complexSinh",cosh:"complexCosh",tanh:"complexTanh",sec:"complexSec",csc:"complexCsc",cot:"complexCot",sech:"complexSech",csch:"complexCsch",coth:"complexCoth",arcsin:"complexArcsin",arccos:"complexArccos",arctan:"complexArctan",arcsec:"complexArcsec",arccsc:"complexArccsc",arccot:"complexArccot",arcsinh:"complexArcsinh",arccosh:"complexArccosh",arctanh:"complexArctanh",arcsech:"complexArcsech",arccsch:"complexArccsch",arccoth:"complexArccoth",floor:"complexFloor",ceil:"complexCeil",mod:"complexMod"},w3={sqrt:!0,ln:!0,arcsin:!0,arccos:!0,arcsec:!0,arccsc:!0,arccosh:!0,arctanh:!0,arcsech:!0,arccoth:!0};function ur(e,t){return e.map(r=>St(r,t))}function gp(e,t){return e.map(r=>Dr(r,t))}function Ge(e,t){var g,y,x,b,w;let r=t==null?void 0:t.defaultArguments,n=1/0,i=0,o=(g=r==null?void 0:r.length)!=null?g:0;for(let E of e){let I=E.minArity-o;I<n&&(n=I);let S=(y=E.maxArity)!=null?y:1/0;S>i&&(i=S)}let a=(x=t==null?void 0:t.fallthroughUnlessDistribution)!=null?x:!1,s=(b=t==null?void 0:t.allowDotCall)!=null?b:!1,c=(w=t==null?void 0:t.isSeeded)!=null?w:!1,l=t==null?void 0:t.minArityExampleArgs,u=t==null?void 0:t.maxArityExampleArgs,d=t==null?void 0:t.dotMinArityExampleArgs,f=t==null?void 0:t.dotMaxArityExampleArgs;return{minArity:n,getSignatures:E=>e.filter(I=>I.satisfiesPolicy(E)),maxArity:i,defaultArguments:r,fallthroughUnlessDistribution:a,minArityExampleArgs:l,maxArityExampleArgs:u,dotMinArityExampleArgs:d,dotMaxArityExampleArgs:f,allowDotCall:s,isSeeded:c}}function Sl(){return Ge(ur([{type:"variadic",initial:[],rest:nn}],Qu),{})}var Rw=Vi.of([Ye,We,Re,ot,Oe]),UA=Vi.of([Ye,Re,ot,Ve]),mh=Vi.of([z,Ye,We,Re,ot,Ve,Oe,et,st,$e,xt]),HA=Vi.of([...uc.types.filter(e=>e!==Ti),cr]),$A=Vi.of([nn,vn]),pu={midpoint:Ge([...ur([[z,z],[Ye]],z),...ur([[oe,oe],[Mr]],oe)],{allowDotCall:!0}),segment:Ge([St([z,z],Ye),St([oe,oe],Mr)]),vector:Ge([St([z,z],Ve),St([oe,oe],Pt)]),sphere:Ge([St([z,C],$n),St([oe,C],$n)]),distance:Ge(ur([[z,z],[oe,oe]],C)),glider:Ge(ur([[Vi.of([Ye,We,Re,ot,Oe,et]),C]],z)),circle:Ge(ur([[z,Ye],[z,z],[z,C]],We),{}),center:Ge(ur([[We],[Oe]],z),{allowDotCall:!0}),radius:Ge(ur([[We],[Oe]],C),{allowDotCall:!0}),intersection:Ge(ur([[Rw,Rw]],z)),strictintersection:Ge(ur([[Rw,Rw]],z)),parallel:Ge(ur([[UA,z]],Re)),perpendicular:Ge(ur([[UA,z]],Re)),anglebisector:Ge(ur([[jG]],ot)),start:Ge([St([Ve],z),St([Pt],oe)],{allowDotCall:!0}),end:Ge([St([Ve],z),St([Pt],oe)],{allowDotCall:!0}),length:Ge([Dr([uc],C,{geometry:!1,"3d":!1}),St([Mr],C),St([Pt],C),St([Ye],C),St([Ve],C),St([Oe],C),Dr({type:"variadic",initial:[nn],rest:nn},C,{geometry:!1,"3d":!1})],{allowDotCall:!0}),translate:Ge(ur([[mh,Ve],[mh,z,z]],e=>e[0])),dilate:Ge(ur([[mh,z,C]],e=>e[0])),rotate:Ge(ur([[mh,z,C]],e=>e[0])),reflect:Ge(ur([[mh,UA]],e=>e[0])),apply:Ge(ur([[xt,mh]],e=>e[1])),points:Ge([]),lines:Ge([]),circles:Ge([]),arcs:Ge([]),polygons:Ge([]),rays:Ge([]),vectors:Ge([]),angle:Ge(ur([[z,z,z]],st)),directedangle:Ge(ur([[z,z,z]],$e)),angles:Ge(gp([[et]],Un),{allowDotCall:!0}),directedangles:Ge(gp([[et]],Un),{allowDotCall:!0}),coterminal:Ge(ur([[st],[$e]],e=>e[0])),round:Ge([...ur([[vr],[vr,C]],C),...ur([[$],[$,C]],$)]),mod:Ge([...ur([[vr,vr]],C),...ur([[$,$]],$)]),floor:Ge([...ur([[vr]],C),...ur([[$]],$)]),ceil:Ge([...ur([[vr]],C),...ur([[$]],$)]),abs:Ge([...ur([[vr]],C),...ur([[$]],C)]),real:Ge([St([$],C)],{allowDotCall:!0}),imag:Ge([St([$],C)],{allowDotCall:!0}),conj:Ge([...ur([[vr]],C),...ur([[$]],C)]),exp:Ge([St([vr],C),St([$],$)]),sin:Ge([St([vr],C),St([$],$)]),cos:Ge([St([vr],C),St([$],$)]),tan:Ge([St([vr],C),St([$],$)]),sinh:Ge([St([vr],C),St([$],$)]),cosh:Ge([St([vr],C),St([$],$)]),tanh:Ge([St([vr],C),St([$],$)]),sec:Ge([St([vr],C),St([$],$)]),csc:Ge([St([vr],C),St([$],$)]),cot:Ge([St([vr],C),St([$],$)]),sech:Ge([St([vr],C),St([$],$)]),csch:Ge([St([vr],C),St([$],$)]),coth:Ge([St([vr],C),St([$],$)]),arctan:Ge([St([vr],C),St([$],$),...ur([[C,C]],C)]),arcsinh:Ge([St([vr],C),St([$],$)]),arccot:Ge([St([vr],C),St([$],$)]),arccsch:Ge([St([vr],C),St([$],$)]),sort:Ge(gp([[ke],[uc,ke]],e=>e[0]),{minArityExampleArgs:"([3,2,1])",maxArityExampleArgs:"([1,2,3],[3,2,1])",dotMaxArityExampleArgs:"([3,4])",allowDotCall:!0}),shuffle:Ge(gp([[lr,uc],[lr,uc,C]],e=>e[1]),{minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3],2)",dotMaxArityExampleArgs:"(2)",allowDotCall:!0,isSeeded:!0}),join:Ge(gp([{type:"variadic",initial:[$A,$A],rest:$A}],Nw),{minArityExampleArgs:"([1,2],[3,4])",dotMinArityExampleArgs:"([3,4])",allowDotCall:!0}),unique:Ge(gp([[Vi.of(uc.types.filter(e=>e!==Ti&&e!==vn))]],e=>e[0]),{minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3])",allowDotCall:!0}),normaldist:Ge(ur([[C,C]],cr),{defaultArguments:[of,hh]}),tdist:Ge(ur([[C]],cr)),binomialdist:Ge(ur([[C,C]],cr),{defaultArguments:[kw]}),poissondist:Ge(ur([[C]],cr)),uniformdist:Ge(ur([[C,C]],cr),{defaultArguments:[of,hh]}),pdf:Ge(ur([[cr,C]],C),{allowDotCall:!0}),cdf:Ge(ur([[cr,C],[cr,C,C]],C),{allowDotCall:!0}),median:Ge([...ur([[cr]],C),...va(C,C)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:Ge([...ur([[cr]],C),...va(C,C)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),var:Ge([...ur([[cr]],C),...va(C,C)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),quantile:Ge([...ur([[cr,C]],C),Dr([ke,dc(C)],C)],{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:"([1,2,3], 1)",maxArityExampleArgs:"([1,2,3], 1)",dotMinArityExampleArgs:"(x)",dotMaxArityExampleArgs:"(x)"}),random:Ge([Dr([lr],C),...gp([[lr,C],[lr,C,C],[lr,HA],[lr,HA,C],[lr,HA,C,C]],ke)],{allowDotCall:!0,isSeeded:!0}),polygon:Ge([Dr([],et),...va(z,et),...gp([[ke,ke],[C,ke],[ke,C]],et)]),total:Ge([...va(vr,C),...va($,$),...va(z,z),...va(oe,oe)],{allowDotCall:!0}),mean:Ge([St([cr],C),...va(vr,C),...va($,$),...va(z,z),...va(oe,oe)],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),lcm:Ge([...va(vr,C),...va($,$)],{allowDotCall:!0}),gcd:Ge([...va(vr,C),...va($,$)],{allowDotCall:!0}),histogram:Sl(),dotplot:Sl(),boxplot:Sl(),ttest:Sl(),ittest:Sl(),stats:Sl(),det:Sl(),inv:Sl(),transpose:Sl(),rref:Sl(),trace:Sl()};function bh(e){return!!pu[e]}function yh(e){return!!Xn[e]}function qx(e,t){let r=bh(t)?pu[t]:void 0;if(!r&&!yh(t))return;let n=[];return r&&(n=[...r.getSignatures(e)]),yh(t)&&!r&&n.push(...WA(t)),n}function va(e,t){return[Dr([r2(e)],t),Dr([e],t),St({type:"variadic",initial:[e,e],rest:e},t)]}function WA(e){var i;let t=[],r=Xn[e],n=(i=r.returnType)!=null?i:C;switch(r.tag){case"reducer":{if(Array.isArray(r.argumentTypes)&&typeof r.argumentTypes[0]=="number"&&xe(r.argumentTypes[0])&&typeof n=="number"&&ei(n)){let o=r.argumentTypes[0],a=It(o);t.push(...va(a,n))}else throw new Error(`Programming error: declared argumentTypes for built-in function ${e} is not consistent with "reducer"`);break}case"parameterizedReducer":{if(t.push(Dr(r.argumentTypes,n)),Array.isArray(r.argumentTypes)&&r.argumentTypes.length===2){let o=r.argumentTypes[1];t.push(Dr([r.argumentTypes[0],typeof o=="number"&&ei(o)?dc(o):o],n))}break}case"doubleReducer":case"never-broadcast":{t.push(Dr(r.argumentTypes,n));break}default:{t.push(Dr(r.argumentTypes.map(o=>mS(o)?dc(o):o),n));break}}return t}var Ut=class extends Pe{constructor(t){super([]),this._symbol=Mg(t),this._errorSymbol=this._symbol,this.addDependency(this._symbol)}setInputSpan(t){super.setInputSpan(t),this._errorSymbol=Mg(this.getInputString())}getInputSpan(){return this._inputSpan===void 0?Ha(this._symbol,0,this._symbol.length):this._inputSpan}};var Tn=class extends Pe{constructor(t,r){super(r,{skipRegisterDependencies:!0}),typeof t=="string"&&(t=new Ut(t)),this._identifier=t,this._symbol=t._symbol,this._errorSymbol=t._errorSymbol==="logbase"?"log":t._errorSymbol,this.registerDependencies()}registerDependencies(){this.addDependency(this._symbol),super.registerDependencies(),fp(this._symbol)&&this.addDependency("trigAngleMultiplier")}};var Gc=class extends Pe{slot(t){return this.args[t]}};var XA={pi:new Yr(Math.PI),tau:new Yr(2*Math.PI),e:new Yr(Math.E),trigAngleMultiplier:new Yr(Et(1,1)),infty:new Yr(1/0),identityTransformation:new Tn("translation",[new Gc([new Yr(0),new Yr(0)])])};var Vw=class extends Gr{constructor(){super(...arguments);this.isFunction=!0}},af,An={};for(af of _n(XA))An[af]=XA[af];for(af of _n(Xn))An[af]=new Vw;for(af of _n(pu))An[af]=new Vw;function E3(e){let t=function(...i){return new e(...i)};t.prototype=e.prototype;var r=Object.getOwnPropertyNames(e);for(var n of r){let i=e[n];if(typeof i=="function")try{t[n]=i}catch(o){}}return t}var xh=class extends Pe{};var Fw=class extends Ut{};var Vo={"<":{inclusive:!1,direction:-1},"!=":{inclusive:!1,direction:0},">":{inclusive:!1,direction:1},"<=":{inclusive:!0,direction:-1},"=":{inclusive:!0,direction:0},">=":{inclusive:!0,direction:1}};function sf(e,t){switch(t){case-1:return e?"<=":"<";case 0:return e?"=":"!=";case 1:return e?">=":">";default:throw"Programming error.  Comparators must have a direction of -1, 0, or 1"}}var Ta=class extends Pe{};var Bc=class e extends Pe{constructor(r,n){super(n);this.operator=r;this._difference=Vo[this.operator].direction===-1?new Ta([n[1],n[0]]):new Ta([n[0],n[1]])}static create(r){class n extends e{constructor(o){super(r,o)}}return n}asComparator(){return this}isInequality(){return Vo[this.operator].direction!==0}};var ja={"<":Bc.create("<"),">":Bc.create(">"),"<=":Bc.create("<="),">=":Bc.create(">="),"=":Bc.create("=")};var ud=class extends Gr{constructor(t,r){super(),this.mergeDependencies(t,r),this._lhs=t,this._rhs=r,this._difference=new Ta([this._lhs,this._rhs])}asComparator(){return new ja["="]([this._lhs,this._rhs])}};var dd=class extends Gr{constructor(t,r){super(),t instanceof Ut?this._symbol=t._symbol:this._symbol=t,this.mergeDependencies(r),this._expression=r,this._exports=this.computeExports()}shouldExportAns(){return!0}computeExports(){for(var t=this._symbol,r=this.getDependencies(),n=0;n<r.length;n++)if(r[n]===t)return[];return[t]}isEquation(t,r){let n=this._symbol,i=n==="x"||n==="y",o=n==="r"||n==="z",a=n==="rho",s=r.getDependencies(),c=this.graphmodeDependencies(t,r);return a||o||i&&s.includes("z")?c.includes(n):s.includes(n)}asEquation(){var t=new ud(new Ut(this._symbol),this._expression);return t.userData=this.userData,t.metaData=this.metaData,t}shouldPromoteToSlider(t){if(!this._expression.isConstant||this._expression.is_mixed_number)return!1;let r=this._expression.asValue();return typeof r!="number"||!isFinite(r)?!1:t.isValidSlider(this._symbol)}};var vh=class extends Pe{constructor(t){super(t),this._symbol=t[0]._symbol,this._lhs=t[0],this._rhs=t[1]}};var mp=class extends Pe{};var Th=class extends Pe{constructor(t){super(t),this._symbol="boxplot"}};var wa=class extends Pe{};function lj(e,t){let r=Vo[e[0]].direction===-1?new Ta([t[1],t[0]]):new Ta([t[0],t[1]]);switch(e.length){case 0:throw new Error("Programming Error: ComparatorChain must have at least one comparator");case 1:return r;case 2:return new wa([new ja[e[1]](t.slice(1)),r,new Yr(NaN)]);default:return new wa([new hp(e.slice(1),t.slice(1)),r,new Yr(NaN)])}}var hp=class extends Pe{constructor(r,n){super(n);this.symbols=r;if(r.length<1)throw"Programming Error: ComparatorChain must have at least one comparator.";if(n.length!==r.length+1)throw"Programming Error: ComparatorChain must have one more arg than symbols";if(r.includes("=")&&!r.every(i=>i==="="))throw rM();this._difference=lj(r,n)}isInequality(){return!this.symbols.includes("=")}};var cf=class extends Pe{constructor(r){var n=r.map(function(i){return new Ut("\\idref_{"+i+"}")});super(n);this.constructedObjectIds=r;this._exports.push("construction")}};var wh=class extends Pe{};var lf=class extends Pe{constructor(t,r){super(r),t instanceof Ut?this._symbol=t._symbol:this._symbol=new Ut(t)._symbol,this.addDependency(this._symbol)}};var Eh=class extends Pe{};var Ea=class extends Pe{registerDependencies(){if(super.registerDependencies(),this.args[1].type==="Identifier"){var t=this.args[1]._symbol;fp(t)&&this.addDependency("trigAngleMultiplier")}}};var yp=class extends Pe{};var Ih=class extends Pe{constructor(t){super(t),this._symbol="dotplot"}};var Bw=class extends Gr{constructor(t){super();let[r,n,i,o,a]=t;this.args=t,this._symbol=i._symbol,this._operators=[n,o],this._expressions=[r,a];var s=sf(Vo[n].inclusive&&Vo[t[3]].inclusive,Vo[t[1]].direction);this._indicator=new ja[s]([t[0],t[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])}isInequality(){return!0}isShadeBetween(){return!0}};var bp=class extends Pe{};var uf=class extends Pe{constructor(t,r){super(r),this.seed=r[0],this.userSeed=r[1],this.tag=t}asValue(){return this.seed.asValue()+"::"+this.tag+this.userSeed.asValue()}};var hs=class extends Gr{constructor(r,n,i,o){super();this.recursionInfo=o;this.externalBaseCases=[];this.isFunction=!0;this._symbol=r._symbol,this._argSymbols=n.map(function(a){return a._symbol});for(let a of this._argSymbols)if(a===this._symbol)throw _D(a);this._exports=[this._symbol],this._expression=i,this.mergeDependenciesInScope(this.type,[this._symbol].concat(this._argSymbols),this._expression,{functionDefinitionSymbol:this._symbol}),this.combinedDependencies=super.getDependencies()}getDependencies(){return this.combinedDependencies}setExternalBaseCases(r){this.externalBaseCases=[...r],this.combinedDependencies=[...super.getDependencies()];for(let n of r){let i=n.getRef();i&&this.combinedDependencies.push(i)}}getExternalBaseCases(){return this.externalBaseCases}getSliderVariables(r,n){var i=this._argSymbols;return super.getSliderVariables(r,n).filter(function(o){return i.indexOf(o)===-1})}asEquation(){var r=this._argSymbols.map(function(i){return new Ut(i)}),n=new ud(new Tn(new Ut(this._symbol),r),this._expression);return n.userData=this.userData,n.metaData=this.metaData,n}};var xp=class extends Pe{registerDependencies(){if(super.registerDependencies(),this.args[0].type==="Identifier"){var t=this.args[0]._symbol;fp(t)&&this.addDependency("trigAngleMultiplier")}}};var vp=class extends Pe{registerDependencies(){if(this.addDependency("factorial"),super.registerDependencies(),this.args[0].type==="Identifier"){var t=this.args[0]._symbol;fp(t)&&this.addDependency("trigAngleMultiplier")}}};var Ch=class extends Pe{constructor(t){super(t),this._symbol="histogram"}};var qw=class extends Gr{constructor(r,n){super();this.isImage=!0;this.center=r.center,this.radianAngle=r.radianAngle,this.width=r.width,this.height=r.height,this.opacity=r.opacity,this.moveStrategy=n,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}};var Ph=class extends Pe{constructor(t){super(t),this._symbol="ittest"}};var Sh=class extends Pe{constructor(t){super(t,{skipRegisterDependencies:!0}),this._differential=t[0],this.registerDependencies()}registerDependencies(){for(let t=1;t<=3;t++)this.mergeDependenciesInScope(this.type,[this._differential._symbol],this.args[t])}};function wn(e,t){let r=e.getInstruction(t);switch(r.type){case 1:return Ml(r.value);default:throw new Error(`Unexpected opcode ${r.type}.`)}}function Ml(e){if(Array.isArray(e))return e.map(Ml);switch(typeof e){case"boolean":case"number":case"string":return e;case"object":if(ap(e)){let t={};for(let r of _n(e.updateRules)){let n=e.updateRules[r];t[r]={value:Ml(n.value),valueType:n.valueType}}return{type:"Action",updateRules:t}}else return ae(e);default:throw new Error("Unexpected value: "+e)}}function pt(e){return e.type<=4}function I3(e){return!pt(e)}function Fo(e){switch(e.type){case 21:case 23:case 19:case 50:case 53:return!0;default:return!1}}function ia(e){switch(e.type){case 20:case 22:case 24:case 51:case 54:return!0;default:return!1}}function zw(e){switch(e.type){case 20:case 22:case 24:case 51:return!0;default:return!1}}function xo(e,t){let r=new Array(t);for(let i=0;i<t;i++)r[i]=!1;r[t]=!0;let n=t;for(;n>0;){n=0;for(let i=t;i>=0;i--){if(!r[i])continue;let o=e.getInstruction(i);if(!pt(o))for(let a of e.getDirectDependencies(o))a>i&&!r[a]&&a>n&&(n=a),r[a]=!0}}return r}function C3(e,t){let r=new Array(t);for(let i=0;i<t;i++)r[i]=!1;r[t]=!0;let n=t;for(;n>0;){n=0;for(let i=t;i>=0;i--){if(!r[i])continue;let o=e.getInstruction(i);if(!pt(o))if(o.type===33)r[o.args[1]]=!0,r[o.args[2]]=!0;else for(let a of e.getDirectDependencies(o))a>i&&!r[a]&&(n=a),r[a]=!0}}return r}function oa(e,t){var i;let r=[],n=[];for(let o=0;o<t;o++)n.push(!1);n.push(!0);for(let o=t;o>=0;o--){if(!n[o])continue;let a=e.getInstruction(o);if(a.type===2)r.push({symbol:e.argNames[o],scope:"free"});else if(Fo(a))switch(a.type){case 21:r.push({symbol:a.callData.indexSymbol,scope:"integral"});break;case 19:r.push({symbol:a.callData.indexSymbol,scope:a.callData.type});break;case 23:if(((i=a.context)==null?void 0:i.type)==="list-comprehension")for(let c of a.context.callData.inputListSymbols)r.push({symbol:c,scope:"comprehension"});break;case 50:for(let c of a.callData.parameterSymbols)r.push({symbol:c,scope:"map"});break;case 53:{let c=e.getInstruction(a.args[0]);for(let l of c.parameterSymbols)r.push({symbol:l,scope:"recursive-function"});break}default:let s=a;throw new Error(`Programming Error: unexpected loop instruction ${s.type}`)}else a.type===3&&a.symbol&&r.push({symbol:a.symbol,scope:"symbolic-var"});if(!pt(a))for(let s of e.getDirectDependencies(a))n[s]=!0}return r.reverse()}function wp(e,t){return df(e,[t],0,e.instructionsLength()-1)}function df(e,t,r,n){let i=[];for(let a=r;a<=n;a++)i[a]=!1;for(let a of t)i[a]=!0;let o=Math.min(...t);for(let a=0;a<=1;a++){let s=!1;for(let c=o+1;c<e.instructionsLength();c++){let l=e.getInstruction(c);if(pt(l)||i[c])continue;let u=!1;for(let d of e.getDirectDependencies(l))if(i[d]){u=!0;break}if(i[c]=u,u&&l.type===20&&!i[l.args[0]]){let d=l.args[0],f=l.args.length-1;for(let g=0;g<f;g++){let y=l.args[1+g],x=d+1+g;i[y]&&(i[x]=!0,s=!0)}}}if(!s)break}return i}function P3(e){if(e.isConstant())return;let t=[];for(let o=0;o<e.getReturnIndex();o++)e.getInstruction(o).type===44&&t.push(o);if(t.length===0)return;let r=xo(e,e.getReturnIndex()),n=[];for(let o=0;o<e.argNames.length;o++)r[o]&&n.push(o);let i=df(e,n,0,e.getReturnIndex());for(let o of t)if(r[o]&&i[o])throw I_(oa(e,o))}function aa(e){if(!pf(e))throw new Error("Programming error: expected an array but found "+typeof e)}function pf(e){return Array.isArray(e)}function S3(e){delete e.fn}function Uw(e,t,r,n){let o=`var fn = (function(${e.join(",")}){"use strict"; ${t}});
fn.__meta = __meta;
return fn;
`;return new Function("BuiltIn","ErrorMsg","_C","__meta",o)($s,$r,r,n)}function _3(e,t,r){let n="",i=(e.instructionsLength()-1).toString().length,o=0,a=!1,s=xo(e,t);for(let c=0;c<e.instructionsLength();c++){let l=e.getInstruction(c),u=r.comments[c]||"";if(ia(l)&&(o-=1),!s[c]&&!r.printUnreferencedInstructions||l.type===0)a||(n+=`${D3(c,i)}: ${jA(2*o)}...
`),a=!0;else{a=!1;let d=`${D3(c,i)}: ${jA(2*o)}${gf(e,c)}`;u&&(d+=" ".repeat(Math.max(0,36-d.length)),d+=`	# ${u}`),n+=d+`
`}Fo(l)&&(o+=1)}return n}function gf(e,t){let r=e.getInstruction(t);switch(r.type){case 0:return Go(r.type);case 2:return`${Go(r.type)} ${xr(r.valueType)} ${e.argNames[t]}`;case 3:return`${Go(r.type)} ${xr(r.valueType)}`;case 1:return`${Go(r.type)} ${xr(r.valueType)} ${KA(r.value)}`;case 37:case 42:return`${Go(r.type)} ${xr(r.valueType)} ${r.symbol} ${r.args.join(" ")}`;case 44:return`${Go(r.type)} ${xr(r.valueType)} ${r.tag} ${r.args.join(" ")}`;case 48:return`${Go(r.type)} ${xr(r.valueType)} ${r.args.join(" ")}`;case 16:return`${Go(r.type)} ${xr(r.valueType)} (${r.index}) ${r.args.join(" ")}`;case 50:return`${Go(r.type)} ${xr(r.valueType)} ${r.args.join(" ")} (${r.callData.parameterSymbols.join(",")})`;case 4:{let i=r.signature.argTypes.map(o=>xr(o)).join(", ");return`${Go(r.type)} ${xr(r.valueType)} ${r.symbol}(${i}) [group ${r.recursionGroup.join(" ")}]`}case 8:case 9:case 10:case 11:case 13:case 12:case 14:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 32:case 31:case 33:case 38:case 39:case 40:case 41:case 47:case 49:case 51:case 53:case 54:case 55:case 15:return`${Go(r.type)} ${xr(r.valueType)} ${r.args.join(" ")}`;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}function Go(e){switch(e){case 0:return"Noop";case 1:return"Constant";case 8:return"Add";case 9:return"Subtract";case 10:return"Multiply";case 11:return"Divide";case 12:return"Exponent";case 13:return"RawExponent";case 14:return"Negative";case 19:return"BeginLoop";case 20:return"EndLoop";case 21:return"BeginIntegral";case 22:return"EndIntegral";case 23:return"BeginBroadcast";case 24:return"EndBroadcast";case 25:return"Equal";case 26:return"Less";case 27:return"Greater";case 28:return"LessEqual";case 29:return"GreaterEqual";case 31:return"Or";case 32:return"And";case 33:return"Piecewise";case 38:return"List";case 39:return"ListAccess";case 40:return"DeferredListAccess";case 41:return"InboundsListAccess";case 37:return"NativeFunction";case 42:return"Distribution";case 2:return"LoadArg";case 47:return"BlockVar";case 48:return"BroadcastResult";case 3:return"SymbolicVar";case 44:return"ExtendSeed";case 49:return"Action";case 50:return"BeginMap";case 51:return"EndMap";case 4:return"FunctionHeader";case 53:return"BeginFunction";case 54:return"EndFunction";case 55:return"FunctionCall";case 15:return"Tuple";case 16:return"Slot";default:let t=e;throw new Error(`Unexpected opcode ${t.type}`)}}function KA(e){if(Array.isArray(e))return`[${e.map(KA).join(",")}]`;switch(typeof e){case"string":return e;case"boolean":case"number":return e.toString();case"object":if(ap(e)){let t=[];for(let r of _n(e.updateRules))t.push(`"${r}": ${KA(e.updateRules[r].value)}`);return`{${t.join(", ")}}`}else return`${e.n}/${e.d}`;default:throw new Error("Unexpected value: "+e)}}function D3(e,t){let r=e.toString();return jA(t-r.length)+r}function jA(e){let t="";for(let r=0;r<e;r++)t+=" ";return t}function mn(e){return`_${e}`}function Mh(e){return`_${e}_thunk_computed`}function Dh(e){return`_${e}_thunk_function`}function Hw(e){return`_${e}_next`}function A3(e){return`_${e}_next1`}function ZA(e,t){return`_${e}_${t}`}function JA(e){return`_${e}_inner`}function O3(e){return`_${e}_cache`}function L3(e){return`_${e}_key`}function $w(e){return`_${e}_computationMetrics`}function N3(e){return`_${e}_out`}function R3(e){return`_${e}_computationMetrics`}function k3(e){return`_${e}_cacheEntry`}function V3(e){return`_${e}_args`}function zx(e,t){return`_${e}_prev_${t}`}function F3(e){return`_${e}_computationDepth`}function G3(e){return`_${e}_computationCount`}function kt(e){return e.type===1}function B3(e){if(!kt(e))throw new Error(`Programming error: expected constant instruction but found ${Go(e.type)} instead.`)}var eO=class{constructor(t,r){this.chunk=t;this.recursiveFunctionGroup=r;this.referencesFrom={};this.referencesTo={};this.baseCases={};for(let l of Object.values(r))this.referencesFrom[l]=[],this.referencesTo[l]=[],this.baseCases[l]=[];let{dependsOnRecursiveCall:n,iterationParameterIndex:i,recursiveReferences:o}=fj(this.chunk,this.recursiveFunctionGroup);for(let l of o)this.referencesFrom[l.from].push(l),this.referencesTo[l.to].push(l);this.iterationParameterIndex=i;let{baseCases:a,isEveryBranchRecursiveOrBaseCase:s,isUnconditionallyRecursive:c}=gj(t,r,n,i);this.isEveryBranchRecursiveOrBaseCase=s,this.isUnconditionallyRecursive=c;for(let l of a)this.baseCases[l.fn].push(l)}hasRecursiveReferences(){for(let t of Object.values(this.referencesFrom))if(t.length>0)return!0;return!1}getBaseCasesForFunction(t){return this.baseCases[t]}getReferencesFrom(t){return this.referencesFrom[t]}getReferencesTo(t){return this.referencesTo[t]}getAllReferences(){let t=[];for(let r of Object.values(this.referencesFrom))t.push(...r);return t}};function pj(e,t,r){if(t===void 0)return;let n=e.getInstruction(r),i=e.getInstruction(n.args[0]);if(i.type!==25)return;let[o,a]=i.args,s;if(o===t)s=a;else if(a===t)s=o;else return;let c=e.getInstruction(s);if(kt(c)&&c.valueType===C)return c.value}function gj(e,t,r,n){let i=[],o=!0,a=!0;for(let s in t){let c=t[s],u=e.getInstruction(c).endIndex,f=e.getInstruction(u).args[0],g=n!==void 0?f+n+1:void 0,y={[u]:!0};for(let x=u;x>f;x--){if(!y[x])continue;let b=e.getInstruction(x);if(!pt(b)){if(b.type===33){let w=b.args[1],E=b.args[2];if(!r[w]||!r[E]){o=!1;let S=pj(e,g,x);S!==void 0&&!r[w]?i.push({fn:c,argValue:S}):a=!1}}for(let w of b.args)y[w]=!0}}}return i.sort((s,c)=>ae(s.argValue)-ae(c.argValue)),{baseCases:i,isUnconditionallyRecursive:o,isEveryBranchRecursiveOrBaseCase:a}}var QA=Symbol("NON_ITERATIVE");function fj(e,t){let r=new Set(Object.values(t)),n={},i=[],o;for(let a in t){let s=t[a],l=e.getInstruction(s).endIndex,d=e.getInstruction(l).args[0],f=xo(e,l);for(let g=d;g<l;g++){let y=e.getInstruction(g);if(!pt(y)&&f[g]){if(y.type===55&&r.has(y.args[0])){n[g]=!0;let x=tO(e,d,y);x?(x.iterationParameterIndex!==void 0&&(o!==void 0&&o!==x.iterationParameterIndex?o=QA:o=x.iterationParameterIndex),i.push(x.ref)):o=QA}for(let x of e.getDirectDependencies(y))if(n[x]){n[g]=!0;break}}}}return o===void 0&&Object.values(t).every(a=>e.getInstruction(a).signature.argTypes.length===1)&&(o=0),{dependsOnRecursiveCall:n,iterationParameterIndex:o===QA?void 0:o,recursiveReferences:i}}function tO(e,t,r){let n=e.getInstruction(t),i,o;for(let a=1;a<r.args.length;a++){let s=r.args[a],c=e.getInstruction(s),l,u;if(c.type===9&&i===void 0){let g=e.getInstruction(c.args[1]);if(!(g.type===1&&g.valueType===C))return;u=ae(g.value),l=c.args[0]}else u=0,l=s;let d=e.getInstruction(l);if(!(d.type===47&&d.args[0]===t&&a===l-t)||u!==Math.floor(u)||u<0)return;if(i===void 0)o=u,u!==0&&(i=a-1);else if(u!==0)return}if(o!==void 0)return{ref:{from:n.args[0],to:r.args[0],iterationParameterOffset:o},iterationParameterIndex:i}}function q3(e,t){var l,u;let r=new eO(e,t),n={};for(let d in r.recursiveFunctionGroup){let f=r.recursiveFunctionGroup[d],g=r.getBaseCasesForFunction(f);if(g.length===0)continue;let y=ae(g[0].argValue),x=1;for(;x<g.length&&ae(g[x].argValue)===ae(g[x-1].argValue)+1;)x++;let b=g.slice(x).map(w=>ae(w.argValue));n[d]={min:y,consecutiveCount:x,additional:b}}let i={},o=-1/0,a=1/0;if(r.iterationParameterIndex!==void 0&&r.isEveryBranchRecursiveOrBaseCase){let d=new Map;for(let f of Object.values(r.recursiveFunctionGroup)){let g=e.getInstruction(f).symbol,y=-1/0;for(let x of r.getReferencesTo(f))y=Math.max(y,x.iterationParameterOffset);if(isFinite(y)&&(i[g]=y),y>0){let x=n[e.getInstruction(f).symbol],b=(l=x==null?void 0:x.min)!=null?l:-1/0;d.set(f,{min:b+y,max:b+((u=x==null?void 0:x.consecutiveCount)!=null?u:0)})}}for(let{min:f,max:g}of d.values())o=Math.max(o,f),a=Math.min(a,g)}let s={};for(let d in r.recursiveFunctionGroup){let f=r.recursiveFunctionGroup[d],g=e.getInstruction(f);s[d]=g.parameterSymbols}let c={};for(let d in r.recursiveFunctionGroup){let f=r.recursiveFunctionGroup[d],g=e.getInstruction(f);c[d]=g.signature.argTypes.map((y,x)=>x===r.iterationParameterIndex&&r.isEveryBranchRecursiveOrBaseCase&&!r.isUnconditionallyRecursive?1:0)}if(r.iterationParameterIndex!==void 0&&isFinite(o)&&o<=a){let d=mj(r);return{canIterate:!0,parameterSymbols:s,baseCaseInfo:n,maxRecursiveCallOffsets:i,iterationParameterIndex:r.iterationParameterIndex,domainInfo:c,loopStart:o,order:d}}else return{canIterate:!1,parameterSymbols:s,baseCaseInfo:n,maxRecursiveCallOffsets:i,iterationParameterIndex:r.iterationParameterIndex,domainInfo:c}}function mj(e){if(e.iterationParameterIndex===void 0)throw Ie("Programming error: no recursive parameter");let r=Object.values(e.recursiveFunctionGroup),n=new Map,i=new Map,o=c=>{let l=new Set;for(let u of e.getReferencesTo(c))u.iterationParameterOffset===0&&l.add(u.from);return[...l]};r.forEach(c=>{let l=o(c);n.set(c,l);for(let u of l)i.set(u,(i.get(u)||0)+1);i.has(c)||i.set(c,0)});let a=[];i.forEach((c,l)=>{c===0&&a.push(l)});let s=[];for(;a.length>0;){let c=a.shift();s.push(c),(n.get(c)||[]).forEach(u=>{let d=u,f=i.get(d)-1;i.set(d,f),f===0&&a.push(d)})}if(s.length!==r.length)throw YS();return s}function Yw(e,t){let r;for(let a=t,s=0;a>0;a--){let c=e.getInstruction(a);if(c.type===53&&s===0){r=a;break}c.type===54&&s++,c.type===53&&s--}if(r===void 0)return!1;let n=e.getInstruction(t),i=e.getInstruction(n.args[0]),o=e.getInstruction(r).args[0];return i.recursionGroup.includes(o)}function Ww(e){for(let t=0;t<e.argCoeffs.length;t++)if(ae(e.argCoeffs[t])!==0)return!1;return!0}var Xw=Et(0,1),z3=Et(1,1);function Kw(e){if(e.op==="&&")return{op:"||",values:e.values.map(Kw)};if(e.op==="||")return{op:"&&",values:e.values.map(Kw)};switch(e.condition){case">0":return{op:"comparator",value:Ia._neg(e.value),condition:">=0"};case">=0":return{op:"comparator",value:Ia._neg(e.value),condition:">0"};case"=0":return{op:"comparator",value:e.value,condition:"!=0"};case"!=0":return{op:"comparator",value:e.value,condition:"=0"}}}function rO(e,t){let r=[];return e.op==="&&"?r.push(...e.values):r.push(e),t.op==="&&"?r.push(...t.values):r.push(t),{op:"&&",values:r}}var Ia;(l=>{function e(u,d){if(!(u===void 0||d===void 0))return t(u,d)}l.add=e;function t(u,d){let f=[];for(let g=0;g<u.argCoeffs.length;g++)f.push(bo(u.argCoeffs[g],d.argCoeffs[g]));return{argCoeffs:f,constantCoeff:bo(u.constantCoeff,d.constantCoeff)}}l._add=t;function r(u,d){if(!(u===void 0||d===void 0))return n(u,d)}l.sub=r;function n(u,d){let f=[];for(let g=0;g<u.argCoeffs.length;g++)f.push(Ro(u.argCoeffs[g],d.argCoeffs[g]));return{argCoeffs:f,constantCoeff:Ro(u.constantCoeff,d.constantCoeff)}}l._sub=n;function i(u){if(u!==void 0)return o(u)}l.neg=i;function o(u){let d=[];for(let f=0;f<u.argCoeffs.length;f++)d.push(ko(u.argCoeffs[f]));return{argCoeffs:d,constantCoeff:ko(u.constantCoeff)}}l._neg=o;function a(u,d){if(u===void 0||d===void 0)return;let f=Ww(u),g=Ww(d);if(!f&&!g)return;g||([u,d]=[d,u]);let y=[];for(let x=0;x<u.argCoeffs.length;x++)y.push(Pi(u.argCoeffs[x],d.constantCoeff));return{argCoeffs:y,constantCoeff:Pi(u.constantCoeff,d.constantCoeff)}}l.mul=a;function s(u,d){if(u===void 0||d===void 0||!Ww(d))return;let g=[];for(let y=0;y<u.argCoeffs.length;y++)g.push(yo(u.argCoeffs[y],d.constantCoeff));return{argCoeffs:g,constantCoeff:yo(u.constantCoeff,d.constantCoeff)}}l.div=s;function c(u,d){if(!(u===void 0||d===void 0||!Ww(d)))return ae(d.constantCoeff)===0?{argCoeffs:new Array(u.argCoeffs.length).fill(Xw),constantCoeff:z3}:ae(d.constantCoeff)===1?u:void 0}l.pow=c})(Ia||(Ia={}));var jw=class{constructor(t,r,n,i){this.chunk=t;this.coefficientTable=[];this.conditionTable=[];this.ZERO_COEFFS=new Array(r.length).fill(Xw),this.mask=df(t,r,n,i);for(let o=0;o<r.length;o++){let a=[];for(let s=0;s<r.length;s++)a.push(o===s?z3:Xw);this.coefficientTable[r[o]]={argCoeffs:a,constantCoeff:Xw}}}coeffs(t){let r=this.coefficientTable[t];if(r!==void 0)return r;let n,i=this.chunk.getInstruction(t);return i.type===1&&i.valueType===C?n={argCoeffs:this.ZERO_COEFFS,constantCoeff:i.value}:this.mask[t]?n=this._coeffs(t):n=void 0,this.coefficientTable[t]=n,n}_coeffs(t){let r=this.chunk.getInstruction(t);switch(r.type){case 8:{let[i,o]=r.args;return Ia.add(this.coeffs(i),this.coeffs(o))}case 9:{let[i,o]=r.args;return Ia.sub(this.coeffs(i),this.coeffs(o))}case 14:{let i=r.args[0];return Ia.neg(this.coeffs(i))}case 10:{let[i,o]=r.args;return Ia.mul(this.coeffs(i),this.coeffs(o))}case 11:{let[i,o]=r.args;return Ia.div(this.coeffs(i),this.coeffs(o))}case 12:case 13:{let[i,o]=r.args;return Ia.pow(this.coeffs(i),this.coeffs(o))}case 26:case 28:case 27:case 29:case 33:case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 16:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:return;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}condition(t){let r=this.conditionTable[t];if(r!==void 0)return r;let n;return this.mask[t]?n=this._condition(t):n=void 0,this.conditionTable[t]=n,n}_condition(t){let r=this.chunk.getInstruction(t);switch(r.type){case 26:{let[i,o]=r.args,a=Ia.sub(this.coeffs(o),this.coeffs(i));return a===void 0?void 0:{op:"comparator",value:a,condition:">0"}}case 28:{let[i,o]=r.args,a=Ia.sub(this.coeffs(o),this.coeffs(i));return a===void 0?void 0:{op:"comparator",value:a,condition:">=0"}}case 27:{let[i,o]=r.args,a=Ia.sub(this.coeffs(i),this.coeffs(o));return a===void 0?void 0:{op:"comparator",value:a,condition:">0"}}case 29:{let[i,o]=r.args,a=Ia.sub(this.coeffs(i),this.coeffs(o));return a===void 0?void 0:{op:"comparator",value:a,condition:">=0"}}case 25:{let[i,o]=r.args,a=Ia.sub(this.coeffs(i),this.coeffs(o));return a===void 0?void 0:{op:"comparator",value:a,condition:"=0"}}case 32:{let i=r.args.map(o=>this.condition(o));return i.some(o=>o===void 0)?void 0:{op:"&&",values:i}}case 31:{let i=r.args.map(o=>this.condition(o));return i.some(o=>o===void 0)?void 0:{op:"||",values:i}}case 8:case 9:case 14:case 10:case 11:case 12:case 13:case 33:case 0:case 23:case 2:case 1:case 15:case 16:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:return;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}};function H3(e,t,r,n){let i=t.reachConditions[r];if(i!==void 0)return $3(e,t,n,i)}function $3(e,t,r,n){let i=t.argBlockvars;if(n.op==="||"||n.op==="&&"){let o=[];for(let a of n.values){let s=$3(e,t,r,a);if(s===void 0)return;o.push(s)}return o.length===0?n.op==="&&"?"true":"false":`(${o.join(n.op)})`}switch(n.condition){case">0":case">=0":{let a=`(${U3(e,n.value,i)}${n.condition})`,s=nO(e,n.value,i,r);return`(${a}&&${s})`}case"!=0":{let o=U3(e,n.value,i),a=`(${o}>0)`,s=nO(e,n.value,i,r),c=`(${o}<0)`,l=nO(e,Ia._neg(n.value),i,r);return`((${a}&&${s})||(${c}&&${l}))`}case"=0":return}}function nO(e,t,r,n){let i=[];for(let o=0;o<r.length;o++){let a=ae(t.argCoeffs[o]),s=e.referenceArg(r[o]),c=e.referenceArg(n[o]);a>0?i.push(`${c}>=${s}`):a<0&&i.push(`${c}<=${s}`)}return i.length===0?!0:`(${i.join("&&")})`}function U3(e,t,r){let n="";for(let i=0;i<r.length;i++){let o=e.printValue(t.argCoeffs[i],C),a=e.referenceArg(r[i]);n+=`${o}*${a}+`}return n+=e.printValue(t.constantCoeff,C),`(${n})`}var Xr;(n=>(n.Noop=0,n.Inline=1,n.Block=2))(Xr||(Xr={}));function iO(e){switch(e.type){case Xr.Noop:return"";case Xr.Inline:return e.source+`;
`;case Xr.Block:return e.source}}function Y3(e,t,r){if(e.glsl)throw Ie("GLSL function not implemented");let{chunk:n,referenced:i}=e,o=t.args[0],a=n.getInstruction(o),s=a.signature.argTypes;if(e.isTailFunction[o])return{type:Xr.Noop,nextIdx:a.endIndex+1};e.enterFunction(t,r,0);let c="";for(let l=0;l<s.length;l++){let u=r+l+1;i[u]&&(c+=`${mn(u)}=${ZA(o,l)};
`)}return{type:Xr.Block,source:hj(e,t,r,c),nextIdx:r+1}}function hj(e,t,r,n){let{chunk:i}=e,o=t.args[0],a=i.getInstruction(o),s=a.signature.argTypes,c="";for(let g=0;g<s.length;g++)g>0&&(c+=","),c+=ZA(o,g);let l=JA(o),u=O3(o),d=L3(o),f=$w(o);return`
    const ${d}=${s.length===1&&a.signature.argTypes[0]===C?"({fn, args}) => `${fn}:${args[0]}`":"({fn, args}) => `${fn}:${JSON.stringify(args)}`"};

    const ${l}=((${u}, ${c}) => {
      ${_h(e,r+1,a.endIndex-1)}
      const ${f} = {depth: 0, count: 0};
      const cache = ${u};
      ${n}
    `}function W3(e,t,r){let n=r+1,i=t.args[0],a=e.chunk.getInstruction(i).args[0];if(e.isTailFunction[a])throw Ie("Unexpected tail recursive function");let s=yj(e,t),{referenced:c}=e;return c[r]&&(s+=`${mn(r)}=${e.referenceArg(t.args[0])};
`),e.exitFunction(),{type:Xr.Block,source:s,nextIdx:n}}function yj(e,t){let r=t.args[0],n=e.chunk.getInstruction(r),i=n.args[0],o=N3(i),a=$w(i),s=n.valueType;return`
${a}.count++;
${a}.depth++;
let ${o};
if ((${a}.depth > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${a}.count > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {
  ${o}=BuiltIn.handleRecursionLimitExceeded(__meta, ${s});
} else {
  ${o}=${e.referenceArg(t.args[1])};
}
return BuiltIn.recursionSuccess(${o},${a});
});
`}function Ux(e,t){return`{ fn: ${e}, args: ${t} }`}function X3(e,t,r){let n=r+1,{chunk:i}=e,o=t.args[0],a=i.getInstruction(o),c=i.getInstruction(a.endIndex).args[0],l=t.args.slice(1).map(b=>e.referenceArg(b)),u=mn(r),d=V3(r),f=R3(r),g=k3(r),y=i.getInstruction(c),x=i.getInstruction(y.args[0]);if(Yw(i,r)){if(e.recursiveFunctionInfo.length<1)throw Ie("Expected recursive function info");let b=e.recursiveFunctionInfo[e.recursiveFunctionInfo.length-1],w="",E=H3(e,b,r,t.args.slice(1));if(e.isTailFunction[o]){let O=y.valueType;E&&(w=`
if (${E}) {
            return BuiltIn.recursionDiverges(__meta, ${O});
          }`);let _=x.signature.argTypes,A=w+`
`;A+="looping=true";for(let R=0;R<_.length;R++){let W=Hw(c+R+1);A+=`,
${W}=${l[R]}`}return w?{type:Xr.Block,source:A+`;
`,nextIdx:n}:{type:Xr.Inline,source:A,nextIdx:n}}else if(b.executionMode===1){let O=i.getInstruction(i.getInstruction(b.fn).endIndex),_=tO(i,O.args[0],t);if(!_)throw Ie("Expected valid iteration reference");let A=zx(_.ref.to,_.ref.iterationParameterOffset);return{type:Xr.Inline,source:`${u}=${A}`,nextIdx:n}}E&&(w=`
if (${E}) {
          return BuiltIn.SYMBOL_DIVERGES;
        }`);let I=$w(b.fn),S=Ux(o,d),D=`
      const ${d} = ([${l.join(",")}]);
      ${w}
      const ${g} = cache.get(BuiltIn.recursionCacheKey(${S}));
      if (${g} === undefined) {
        return BuiltIn.recursionMissingCacheEntry(${S});
      }
      ${u} = ${g}[0];
      const ${f} = ${g}[1];
      if (${f}.count > ${I}.count) {
        ${I}.count = ${f}.count;
      }
      if (${f}.depth > ${I}.depth) {
        ${I}.depth = ${f}.depth;
      }
    `;return{type:Xr.Block,source:D,nextIdx:n}}else{let b=`{${x.recursionGroup.map(S=>`${S}: ${JA(S)}`).join(",")}}`,w=e.chunk.getRecursionStructure(y.args[0]);if(e.isTailFunction[o])return bj(e,t,r);if(w.canIterate)return xj(e,t,r,w,{innerFunctionsMap:b});let E=Ux(o,`[${l.join(",")}]`),I=`${u}=BuiltIn.executeRecursiveFunction(
      __meta,
      ${b},
      ${y.valueType},
      ${E}
    )`;return{type:Xr.Inline,source:I,nextIdx:n}}}var K3=Symbol("UPDATED_IN_BODY");function j3(e){let t="";for(let r of e){let n="declare"in r?`let ${r.declare}`:mn(r.reference),i=r.initializeRHS;t+=`${n}=${i};
`}return t}function Z3(e){let t="",r="";for(let n of e){let i="declare"in n?n.declare:mn(n.reference);n.updateRHS!==K3&&(t&&(t+=",",r+=","),t+=`${i}`,r+=`${n.updateRHS}`)}return`[${t}]=[${r}]`}function bj(e,t,r){let n=t.args[0],i=e.chunk.getInstruction(n),o=e.chunk.getInstruction(i.endIndex),a=o.args[0],s=e.chunk.getInstruction(a),c=s.valueType,l=mn(r),u=[];e.enterFunction(s,a,2);let d=Zw(e,a,i.endIndex).source;e.exitFunction();let f=F3(r),g=G3(r);u.push({declare:f,initializeRHS:"0",updateRHS:`${f}+1`},{declare:g,initializeRHS:"0",updateRHS:`${g}+1`});for(let x=1;x<t.args.length;x++){let b=a+x;if(!e.referenced[b])continue;let w=Hw(b);u.push({reference:b,initializeRHS:e.referenceArg(t.args[x]),updateRHS:w},{declare:w,initializeRHS:void 0,updateRHS:K3})}let y=`${l}=(() => {
    ${_h(e,a+1,i.endIndex-1)}

    let looping = true;
    ${j3(u)}
    while (looping) {
      looping = false;

      ${d}

      if (looping) {
        ${Z3(u)}
      }

      if ((${f} > BuiltIn.RECURSIVE_DEPTH_LIMIT) || (${g} > BuiltIn.RECURSIVE_COMPUTATION_LIMIT)) {
        return BuiltIn.handleRecursionLimitExceeded(__meta, ${c});
      };
    }

    return ${e.referenceArg(o.args[1])}
  })()`;return{type:Xr.Inline,source:y,nextIdx:r+1}}function xj(e,t,r,n,i){let o=t.args[0],a=e.chunk.getInstruction(o),s=e.chunk.getInstruction(a.endIndex),c=s.args[0],l=mn(r),u=[],d="",f,{iterationParameterIndex:g,loopStart:y,order:x}=n,b=n.maxRecursiveCallOffsets,w=c+g+1,E=mn(w),I=t.args[g+1],S=`(${y})`,D=e.chunk.getInstruction(I),O=(D.type===39||D.type===41)&&e.chunk.getInstruction(D.args[1]).type===23?D.args[0]:void 0,_=`(${e.referenceArg(I)})-${S}`,A,R;if(O!==void 0){let ce=e.referenceArg(O);A=`BuiltIn.listMax(
      (${ce}).filter(
        x => isFinite(x) &&
        Math.floor(x - ${S}) === (x - ${S})
      )
    )`,R=`BuiltIn.getBroadcastTargetElements(${ce}).has(${E})`}else A=`(${e.referenceArg(I)})`,R="false";u.push({reference:w,initializeRHS:`(${S})`,updateRHS:`${E}+1`}),f="";for(let ce of x){let ee=e.chunk.getInstruction(ce),pe=ee.endIndex,re=e.chunk.getInstruction(pe),k=re.args[0],Ke=e.chunk.getInstruction(k);for(let Ze=1;Ze<t.args.length;Ze++){let Te=k+Ze;if(!e.referenced[Te])continue;let Vt=mn(Te);Ze===g+1?f+=`${Vt}=${e.referenceArg(w)};
`:d+=`${Vt}=${e.referenceArg(t.args[Ze])};
`}d+=_h(e,k+1,ee.endIndex-1);let ht=b[ee.symbol];if(ht!==void 0)for(let Ze=1;Ze<=ht;Ze++){let Te=zx(ce,Ze),Vt=Ze===1?e.referenceArg(re.args[1]):zx(ce,Ze-1),yt=t.args.slice(1).map((he,ie)=>ie===g?y-Ze:e.referenceArg(he)),qe=Ux(ce,`[${yt.join(",")}]`),at=`BuiltIn.executeRecursiveFunction(
            __meta,
            ${i.innerFunctionsMap},
            ${Ke.valueType},
            ${qe}
          )`,Ne=`(
          broadcastOutputMap
            ? (broadcastOutputMap[BuiltIn.recursionCacheKey(${qe})] = ${at})
            : ${at}
        )`;u.push({declare:Te,initializeRHS:Ne,updateRHS:Vt})}e.enterFunction(Ke,k,1),f+=Zw(e,k,ee.endIndex).source,e.exitFunction(),f+=`const ${zx(ce,0)}=${e.referenceArg(re.args[1])};
`}let W=t.args.slice(1).map(ce=>e.referenceArg(ce)),j=t.args.slice(1).map((ce,ee)=>ee===g?E:e.referenceArg(ce)),Q=`${l}=(() => {
    ${d}
    const broadcastOutputMap = ${O!==void 0?"__meta.iterativeRecursionOutputs":"undefined"};

    ${j3(u)}

    const outerStackFrame = ${Ux(o,`[${W.join(",")}]`)};

    if (broadcastOutputMap) {
        const cacheEntry = broadcastOutputMap[BuiltIn.recursionCacheKey(outerStackFrame)];
        if (cacheEntry !== undefined) {
          return cacheEntry;
        }
      }


    const targetLoopSteps = ${_}
    if (targetLoopSteps < 0 || Math.floor(targetLoopSteps) !== targetLoopSteps) {
      return BuiltIn.executeRecursiveFunction(
        __meta,
        ${i.innerFunctionsMap},
        ${a.valueType},
        outerStackFrame
      );
    }

    const loopEnd = ${A};

    let result;
    while (true) {
      ${f}

      result = ${e.referenceArg(s.args[1])};

      if (broadcastOutputMap && ${R}) {
        const key = BuiltIn.recursionCacheKey(${Ux(o,`[${j.join(",")}]`)});
        broadcastOutputMap[key] = result;
      }

      if (${E} < loopEnd) {
        ${Z3(u)}
      } else {
        break;
      }
    }

    ${O===void 0?"return result;":`const cached = broadcastOutputMap[BuiltIn.recursionCacheKey(outerStackFrame)];
          if (cached === undefined) {
            return BuiltIn.recursionDiverges(__meta, ${a.valueType});
          }
          return cached;
          `}
  })()`;return{type:Xr.Inline,source:Q,nextIdx:r+1}}function Jw(e){let{chunk:t}=e,r=_h(e,t.argNames.length,t.instructionsLength()-1),n=0;for(;n<t.instructionsLength();){let i=t.getInstruction(n),o=oO(e,i,n);r+=iO(o),n=o.nextIdx}return r+=`return ${e.referenceArg(t.getReturnIndex())};`,r}function vj(e,t){let{chunk:r}=e,n=[],i=e.thunkName(t),o=e.thunkEnd(i),a=Mh(i),s=Dh(i),c="",l=!1,u=!1;e.wantToInlineThunk(i)||(u=!0);let d=t;for(;d<=o;){let f=r.getInstruction(d),g=d===t?J3(e,f,d):oO(e,f,d);switch(g.type){case Xr.Noop:break;case Xr.Inline:l&&(c+=`,
`),c+=g.source,l=!0;break;case Xr.Block:l&&(c+=`;
`),l=!1,c+=g.source,u=!0;break}n.push(c),d=g.nextIdx}if(c===""&&(c="0",u=!1),u){let f=`${a}=false;${s}=()=>{
${a}=true;

      ${c}${l?";":""}
    };
`;return{type:Xr.Block,source:f,nextIdx:d}}else return e.inlineThunk(i,c),{type:Xr.Noop,nextIdx:d}}function oO(e,t,r){return e.isThunkBegin(r)?vj(e,r):J3(e,t,r)}function J3(e,t,r){let n=r+1;if(!e.referenced[r])return{type:Xr.Noop,nextIdx:n};switch(t.type){case 0:case 47:case 48:case 22:case 49:case 4:return{type:Xr.Noop,nextIdx:n};case 21:if(e.glsl)throw YM();return wj(e,t,r);case 2:return e.inlineSource(r,e.chunk.argNames[r]),{type:Xr.Noop,nextIdx:n};case 23:return{type:Xr.Block,source:Ej(e,t,r),nextIdx:n};case 24:return{type:Xr.Block,source:Ij(e,t,r),nextIdx:n};case 19:return{type:Xr.Block,source:Cj(e,t,r),nextIdx:n};case 20:return{type:Xr.Block,source:Pj(e,t,r),nextIdx:n};case 50:return{type:Xr.Block,source:Sj(e,t,r),nextIdx:n};case 51:return{type:Xr.Block,source:Mj(e,t,r),nextIdx:n};case 53:return Y3(e,t,r);case 54:return W3(e,t,r);case 33:{let i=e.referenceArg(t.args[0]),o=e.referencePiecewiseBranch(t.args[1]),a=e.referencePiecewiseBranch(t.args[2]);if(!(o.thunkDependencies.some(d=>e.isEarlyReturningThunk(d))||a.thunkDependencies.some(d=>e.isEarlyReturningThunk(d)))){let d=e.emitTernary(i,o.expression,a.expression,t);return e.shouldInline(r)?(e.inlineSource(r,`(${d})`),{type:Xr.Noop,nextIdx:n}):{type:Xr.Inline,source:`${mn(r)}=${d}`,nextIdx:n}}let c=mn(r),l=d=>{if(d.length===0)return"";let f="";for(let g of d){let y=e.inlinedThunks[g];if(y!==void 0){let x=`(${y},void 0)`;f!==""?f=`(${f}||${x})`:f=x}else{let x=Mh(g),b=Dh(g);f!==""&&(f+="||"),f+=`(${x} ? undefined : ${b}())`}}return f="const earlyReturn ="+f,f+=`;
if (earlyReturn !== undefined) return earlyReturn;
`,f},u=`if (${i}) {
          ${l(o.thunkDependencies)}${c} = ${o.rawExpression};
        } else {
          ${l(a.thunkDependencies)}${c} = ${a.rawExpression};
        }`;return{type:Xr.Block,source:u,nextIdx:n}}case 55:return X3(e,t,r);default:{let i=Dj(e,t);return e.shouldInline(r)?(e.inlineSource(r,`(${i})`),{type:Xr.Noop,nextIdx:n}):{type:Xr.Inline,source:`${mn(r)}=${i}`,nextIdx:n}}}}function Zw(e,t,r){let{chunk:n,referenced:i}=e,o="",a=t+1;for(;a<r;){if(!i[a]){a=a+1;continue}let s=n.getInstruction(a),c=oO(e,s,a);o+=iO(c),a=c.nextIdx}return{type:Xr.Block,source:o,nextIdx:a}}function Tj(e,t,r){let{endIndex:n}=t,{chunk:i}=e,o=`function(${mn(r)}) {
`,a=r+1,s=n-1;o+=_h(e,a,s),o+=Zw(e,r,n).source;let c=i.getInstruction(n);return o+=`return ${e.referenceArg(c.args[1])};
}`,o}function wj(e,t,r){let n="BuiltIn.quad(";n+=Tj(e,t,r),n+=`,${e.referenceArg(t.args[0])},${e.referenceArg(t.args[1])})`;let{endIndex:i}=t,o=i+1;return e.shouldInline(o)?(e.inlineSource(o,n),{type:Xr.Noop,nextIdx:t.endIndex}):{type:Xr.Inline,source:`${mn(i+1)}=${n}`,nextIdx:t.endIndex}}function _h(e,t,r){let{chunk:n,referenced:i}=e,o="",a=!1;for(let s=t;s<=r;s++){if(!e.glsl&&e.isThunkBegin(s)){let l=e.thunkName(s);o+=`${a?",":"var "}${Mh(l)}`,o+=`,${Dh(l)}`,a=!0}let c=n.getInstruction(s);if(!(c.type===0||c.type===24||c.type===20||!i[s])){if(c.type===21){let{endIndex:l}=c;s=l,e.shouldInline(l+1)&&s++;continue}if(!e.shouldInline(s)&&(o+=e.emitVarDeclaration(s,a),a=!0,c.type===53)){let{endIndex:l}=c;s=l-1;continue}}}return a&&(o+=`;
`),o}function Ej(e,t,r){let{glsl:n,chunk:i,referenced:o}=e,a=mn(r),s=i.getInstruction(t.endIndex),c=e.referenceArg(t.args[0]),l="";for(let d=1;d<s.args.length;d++){let f=t.endIndex+d;if(!o[f]||i.getInstruction(f).type!==48)continue;let y=mn(f);n||(l+=`${y}=[];
`)}return n||(l+=`if(${c}>${1e4}) throw ErrorMsg.maxListSize();
`),l+=`for(${a}=1${n?".0":""};${a}<=${c};${a}++){
`,l}function Ij(e,t,r){let{glsl:n,chunk:i,referenced:o}=e,a="";for(let s=1;s<t.args.length;s++){let c=r+s;if(c>=i.instructionsLength()||!o[c]||i.getInstruction(c).type!==48)continue;let l=mn(r+s),u=e.referenceArg(t.args[s]);if(n){let d=e.referenceArg(t.args[0]);a+=`${l}[int(${d})-1]=${u};
`}else a+=`${l}.push(${u});
`}return a+=`}
`,a}function Cj(e,t,r){let{chunk:n,referenced:i}=e,o=mn(r);e.beforeBeginLoop(t);let a=`${e.referenceArg(t.args[0])}`,s=`${e.referenceArg(t.args[1])}`,c=`if(${a}>${s}){
`;for(let l=2;l<t.args.length;l++){let u=t.endIndex+l-1;if(u>=n.instructionsLength()||!i[u]||n.getInstruction(u).type!==47)continue;let d=mn(u);c+=`${d}=${e.referenceArg(t.args[l])};
`}c+=e.checkFiniteBounds(t,a,s),c+=`}else{
`;for(let l=2;l<t.args.length;l++){let u=r+l-1;if(!i[u]||n.getInstruction(u).type!==47)continue;let d=mn(u);c+=`${d}=${e.referenceArg(t.args[l])};
`}return c+=`${o}=${a};
`,c+="while (true) {",c}function Pj(e,t,r){let{chunk:n,referenced:i}=e,o=n.getInstruction(t.args[0]),a=`${e.referenceArg(o.args[1])}`,s=mn(t.args[0]),c=`${s}++;`;c+=`if (${s}<=${a}) {
`;let l=new Map,u=[];for(let d=1;d<t.args.length;d++){let f=t.args[0]+d;if(!i[f]||n.getInstruction(f).type!==47)continue;let g=t.args[d];l.set(f,e.referenceArg(g)),u[g]=e.isDirectlyReferencedByName(g)}for(let[d,f]of l.entries())if(u[d]){let g=A3(d);c+=e.emitImmediateAssignment(d,g,f),l.set(d,g)}for(let[d,f]of l.entries())c+=`${mn(d)}=${f};
`;c+=`} else {
`;for(let d=1;d<t.args.length;d++){let f=r+d;if(f>=n.instructionsLength()||!i[f]||n.getInstruction(f).type!==47)continue;let g=mn(f);c+=`${g}=${e.referenceArg(t.args[d])};
`}return c+=`break;
`,c+=`}
}
`,c+=`}
`,c}function Sj(e,t,r){let{glsl:n}=e;if(n)throw Ie("GLSL map not implemented yet");let i=mn(t.endIndex+1),o=[];for(let s=0;s<t.callData.parameterSymbols.length;s++){let c=mn(r+s+1);o.push(c)}let a=o.join(",");return`${i}=(${a}) => {
`}function Mj(e,t,r){let n=`return ${e.referenceArg(t.args[1])}`;return n+=`}
`,n}function Dj(e,t){switch(t.type){case 1:return e.emitConstant(t);case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:return e.emitBinary(t,e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 14:{let n=e.referenceArg(t.args[0]);return e.emitNeg(n)}case 15:{let n=t.valueType;switch(n){case z:case $:return e.emitVec2(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case oe:return e.emitVec3(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.referenceArg(t.args[2]));default:let i=n;throw new Error(`Unexpected tuple type ${i}`)}}case 16:{let n=e.chunk.getInstruction(t.args[0]).valueType;switch(n){case z:case oe:case $:return e.emitVecAccess(e.referenceArg(t.args[0]),t.index);default:let i=n;throw new Error(`Unexpected tuple type ${i}`)}}case 38:return e.emitList(t.args.map(n=>e.referenceArg(n)),t);case 40:case 42:case 3:throw new Error(`Programming Error: expect ${Go(t.type)} to be removed before emitting code.`);case 39:{let n=t.valueType;return e.emitListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]),e.printValue(na(n),n),t)}case 41:return e.emitInboundsListAccess(e.referenceArg(t.args[0]),e.referenceArg(t.args[1]));case 37:return e.emitNativeFunction(t.args.map(n=>e.referenceArg(n)),t);case 44:return e.emitExtendSeed(e.referenceArg(t.args[0]),e.chunk.getInstruction(t.args[1]).valueType,e.referenceArg(t.args[1]),t.tag);case 2:case 0:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 48:case 49:case 50:case 51:case 53:case 54:case 33:case 55:case 4:throw new Error(`Unexpected opcode ${t.type}`);default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function Q3(e,t,r,n){let i=e.getInstruction(r.args[0]);if(i.recursionGroup.length>1)return[];let o=i.endIndex,a=e.getInstruction(o),s=new jw(e,n,t,o),c=[];for(let u=1;u<a.args.length;u++)c[a.args[u]]={op:"&&",values:[]};for(let u=o-1;u>t;u--){let d=c[u];if(d===void 0)continue;let f=e.getInstruction(u);if(!pt(f))if(f.type===33){c[f.args[0]]=d;let g=s.condition(f.args[0]);g!==void 0&&(c[f.args[1]]=rO(d,g),c[f.args[2]]=rO(d,Kw(g)))}else for(let g of f.args)c[g]=d}let l=[];e:for(let u=o-1;u>=t;u--){let d=e.getInstruction(u);if(d.type!==55)continue;let f=e.getInstruction(d.args[0]);if(u>f.endIndex)continue;let g=d.args.slice(1);if(g.length!==f.signature.argTypes.length)throw new Error("Programming error: Non-matching arg length");let y=c[u];if(y!==void 0){if(y.op==="&&"&&y.values.length===0)throw new Error("Programming error: Recursive call unconditionally executed");for(let x=0;x<g.length;x++){if(e.getInstruction(g[x]).valueType!==C)continue e;let b=s.coeffs(g[x]);if(b===void 0||!_j(b,x)||ae(b.argCoeffs[x])<-1)continue e}l[u]=y}}return l}function _j(e,t){for(let r=0;r<e.argCoeffs.length;r++)if(r!==t&&ae(e.argCoeffs[r])!==0)return!1;return!0}function eq(e,t){let r=e.getReturnIndex(),n=new Array(r),i=new Array(r).fill(!1);for(let a=0;a<=r;a++){let s=e.getInstruction(a);Fo(s)||ia(s)||s.type===48||s.type===47&&e.getInstruction(s.args[0]).type!==22||s.type===0||s.type===55?n[a]=2:n[a]=0}n[r]===0&&(n[r]=1,i[r]=!0);let o=0;for(let a=r;a>=0;a--){if(!t[a])continue;let s=e.getInstruction(a);if(s.type===54?o++:s.type===53&&o--,pt(s))continue;if(s.type===19||s.type===20||s.type===24||s.type===54||s.type===39||s.type===55)for(let l of s.args){let u=e.getInstruction(l);n[l]===0&&u.type===1&&u.valueType===C?(n[l]=1,i[l]=!0):(n[l]=2,i[l]=!1)}else{for(let l of s.args)switch(n[l]){case 0:n[l]=1,i[l]=!0;break;case 1:case 2:n[l]=2,i[l]=!1;break}o>0&&s.type===33&&(n[a]=2,i[a]=!1)}}return i}function tq(e,t){if(t.recursionGroup.length>1)return!1;let r=t.endIndex,n=e.getInstruction(r);if(n.type!==54)throw new Error("Programming Error: end of BeginFunction is not EndFunction");let[i,...o]=n.args;if(o.length!==1)return!1;let a=e.getInstruction(i);if(a.type!==53)throw new Error("Programming Error: start of EndFunction is not BeginFunction");let s=a.args[0],c={};c[o[0]]=!0;for(let l=r-1;l>=i;l--){let u=e.getInstruction(l);switch(u.type){case 55:if(!c[l])return!1;if(u.args[0]!==s)throw new Error("recursionGroup.length == 1 contradicted");break;case 33:c[l]&&(c[u.args[1]]=!0,c[u.args[2]]=!0);break;default:break}}return!0}function Aj(e,t){if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}var Qw=class{constructor(t,r,n){this.chunk=t;this.referenced=r;this.shouldInline=n;this.thunkSets=[];this.thunkStarts=[];this.thunkEnds=[];this._isThunkEnd=[];this.piecewiseReferencedCount=[];this.dependencyThunkNames=[];this.parentFunctionStart=[];let i=t.getReturnIndex();for(let s=0;s<=t.instructionsLength();s++)this.thunkSets[s]=new Set;let o=t.argNames.length,a;for(let s=o;s<=t.getReturnIndex();s++){let c=t.getInstruction(s);this.parentFunctionStart[s]=a,c.type===53?a=s:c.type===54&&(a=void 0)}this.markThunkSets(o,i,[i],"always"),this.markThunks(o,i)}isThunkBegin(t){return this.thunkStarts[t]===t}isThunkEnd(t){return!!this._isThunkEnd[t]}containingThunkName(t){return this.thunkStarts[t]}thunkEnd(t){return this.thunkEnds[t]}isEarlyReturningThunk(t){let r=this.parentFunctionStart[t];return this.isThunkBegin(t)&&r!==void 0}dependencyThunkNamesForPiecewiseBranch(t){return this.dependencyThunkNames[t]}wantToInlineThunk(t){let r=this.thunkSets[t];if(r!=="always"&&r.size===1){for(let n of r)if(this.piecewiseReferencedCount[n]!==1)return!1;return!0}return!1}printChunkWithThunkInfo(){for(let t=0;t<=this.chunk.getReturnIndex();t++){let r=this.thunkSets[t],n=r==="always"?"always":`{${[...r].sort().join(",")}}`;if(this.isThunkBegin(t)&&(n+=" beginThunk"),this.isThunkEnd(t))n+=" endThunk";else{let i=this.containingThunkName(t);i!==void 0&&(n+=` start:${i}`)}this.shouldInline[t]&&(n+="	[inline]"),this.chunk.comments[t]=n}return this.chunk.print(this.chunk.getReturnIndex())}markThunkSets(t,r,n,i){let{chunk:o,referenced:a,thunkSets:s,piecewiseReferencedCount:c}=this;for(let u of n)s[u]="always";function l(u,d){let f=s[u];if(f!=="always"){if(d==="always"){s[u]=d;return}for(let g of d)f.add(g)}}for(let u=r;u>=t;u--){if(!a[u])continue;let d=o.getInstruction(u);if(pt(d))continue;let f=s[u];if(ia(d)){let g=d.args[0];this.markThunkSets(g+1,u-1,d.args.slice(1),f),u=g+1;continue}for(let g=0;g<d.args.length;g++){let y=d.args[g];if(y<t)l(y,i);else if(g>0&&d.type===33){let x=s[y];x!=="always"&&x.add(y);let b=c[y];c[y]=(b!=null?b:0)+1}else l(y,f)}}}markThunks(t,r){var s,c;let{chunk:n,thunkSets:i}=this,o,a;for(let l=t;l<=r;l=a){let u=n.getInstruction(l),d=Oj(this.chunk,u),f,g;if(d){let y=l+1,x=d.innerEndIndex-1;this.markThunks(y,x),g=i[d.innerEndIndex],a=d.outerEndIndex+1,f=this.thunkDecision(o,l,this.referenced[d.innerEndIndex],u.type===21&&this.shouldInline[d.outerEndIndex],g)}else g=i[l],a=l+1,f=this.thunkDecision(o,l,this.referenced[l],this.shouldInline[l],g);if(o!==void 0&&f.shouldEndThunk&&(this.markEndThunk(l-1,o),o=void 0),f.shouldStartThunk&&g!=="always"){for(let y of g)(c=(s=this.dependencyThunkNames)[y])!=null||(s[y]=[]),this.dependencyThunkNames[y].push(l);o={start:l,set:g}}if(o!==void 0&&(this.thunkStarts[l]=o.start,d))for(let y=d.innerEndIndex;y<=d.outerEndIndex;y++)this.thunkStarts[y]=o.start}o!==void 0&&this.markEndThunk(r,o)}thunkDecision(t,r,n,i,o){let a=this.chunk.getInstruction(r);if(a.type===33&&(i=!1),i||!n)return{shouldEndThunk:!1,shouldStartThunk:!1};if(o==="always")return{shouldEndThunk:t!==void 0,shouldStartThunk:!1};let s=a.type===1||a.type===47,c=o.size>0&&!s,l=t!==void 0&&!Aj(o,t.set);return{shouldEndThunk:l,shouldStartThunk:(l||t===void 0)&&c}}markEndThunk(t,r){let{referenced:n}=this;for(;t>=0&&!n[t];)t--;this._isThunkEnd[t]=!0,this.thunkEnds[r.start]=t}};function Oj(e,t){if(Fo(t)){let r=t.endIndex,n=e.getInstruction(r);if(n===void 0)return;if(zw(n))return{outerEndIndex:r+n.args.length-1,innerEndIndex:r};if(n.type===54)return{outerEndIndex:r,innerEndIndex:r}}}var Ah=class{constructor(t,r){this.chunk=t;this.glsl=r;this.inlinedSource=[];this.inlinedThunks=[];this.recursiveFunctionInfo=[];this.isTailFunction=[];let n=t.getReturnIndex();this.referenced=xo(t,n),this._shouldInline=eq(t,this.referenced),!this.glsl&&t.computeNeedsThunking()&&(this.thunks=new Qw(t,this.referenced,this._shouldInline));for(let i=0;i<=n;i++){let o=t.getInstruction(i);if(o.type===4){if(!this.referenced[i])continue;this.isTailFunction[i]=tq(t,o),o.recursionGroup=o.recursionGroup.filter(a=>this.referenced[a])}}}isThunkBegin(t){return!!this.thunks&&this.thunks.isThunkBegin(t)}isThunkEnd(t){return!!this.thunks&&this.thunks.isThunkEnd(t)}isEarlyReturningThunk(t){return!!this.thunks&&this.thunks.isEarlyReturningThunk(t)&&this.inlinedThunks[t]===void 0}thunkName(t){var r;return(r=this.thunks)==null?void 0:r.containingThunkName(t)}thunkEnd(t){return this.thunks.thunkEnd(t)}shouldInline(t){return this._shouldInline[t]}inlineSource(t,r){this.inlinedSource[t]=r}wantToInlineThunk(t){return!!this.thunks&&this.thunks.wantToInlineThunk(t)}inlineThunk(t,r){this.inlinedThunks[t]=r}referenceArg(t){let r=this.inlinedSource[t];return r!==void 0?r:mn(t)}isDirectlyReferencedByName(t){return this.inlinedSource[t]===void 0}referencePiecewiseBranch(t){var a;let r=this.referenceArg(t),n=(a=this.thunks)==null?void 0:a.dependencyThunkNamesForPiecewiseBranch(t);if(!n||n.length===0)return{expression:r,rawExpression:r,thunkDependencies:[]};let i=[],o="";for(let s of n){let c=this.inlinedThunks[s];if(c!==void 0)o&&(o+=","),o+=c;else{let l=Mh(s),u=Dh(s),d=`${l}||${u}()`;o&&(o+=","),o+=`${d}`}i.push(s)}return{expression:"("+o+","+r+")",rawExpression:r,thunkDependencies:i}}enterFunction(t,r,n){let i=t.args[0],o=this.chunk.getInstruction(i),a=[];for(let c=0;c<o.signature.argTypes.length;c++)a.push(r+c+1);let s=Q3(this.chunk,r,t,a);this.recursiveFunctionInfo.push({fn:i,argBlockvars:a,reachConditions:s,returnType:t.valueType,executionMode:n})}exitFunction(){this.recursiveFunctionInfo.pop()}};function eE(e){let t=new aO(e),r=Jw(t);return t.finish(r)}var aO=class extends Ah{constructor(r){super(r,!1);this.constants=[]}finish(r){return{source:r,constants:this.constants}}printValue(r){return rq(r)}beforeBeginLoop(){}checkFiniteBounds(r,n,i){let o=`}else if(!isFinite(${i}-${n})){
`;for(let a=2;a<r.args.length;a++){let s=r.endIndex+a-1;if(s>=this.chunk.instructionsLength()||!this.referenced[s])continue;let c=this.chunk.getInstruction(s);if(c.type!==47)continue;let l=mn(s);Vc(c.valueType)?o+=`${l}=${this.printValue(na(c.valueType))};
`:o+=`throw new Error('Cannot set ${l} of type ${xr(c.valueType)} to NaN value');
`}return o}emitConstant(r){return r.valueType===C||r.valueType===tt||r.valueType===z||r.valueType===oe?this.printValue(r.value):(this.constants.push(Ml(r.value)),`_C[${this.constants.length-1}]`)}emitNeg(r){return`-${r}`}emitTernary(r,n,i){return`${r}?${n}:${i}`}emitVec2(r,n){return`[${r},${n}]`}emitVec3(r,n,i){return`[${r},${n},${i}]`}emitVecAccess(r,n){return`${r}[${n}]`}emitBinary(r,n,i){switch(r.type){case 8:return`${n}+${i}`;case 9:return`${n}-${i}`;case 10:return`${n}*${i}`;case 11:return`${n}/${i}`;case 12:return`BuiltIn.pow(${n},${i})`;case 13:return`Math.pow(${n},${i})`;case 25:return`${n}===${i}`;case 26:return`${n}<${i}`;case 28:return`${n}<=${i}`;case 27:return`${n}>${i}`;case 29:return`${n}>=${i}`;case 31:return`${n}||${i}`;case 32:return`${n}&&${i}`;default:throw new Error("Programming Error: invalid binary opcode.")}}emitList(r){return`[${r.join(",")}]`}emitListAccess(r,n,i){let o=`${r}.length`,a=`Math.floor(${n})`;return`(${a}>=1&&${a}<=${o})?${r}[${a}-1]:${i}`}emitInboundsListAccess(r,n){return`${r}[${n}-1]`}emitNativeFunction(r,n){let i=Xn[n.symbol];return`${i.module}.${i.symbol}(${r.join(",")})`}emitExtendSeed(r,n,i,o){let a=n===C?i:`BuiltIn.serializeNonNumericSeedPart(${n},${i})`;return`${r}+'::${o}'+${a}`}emitVarDeclaration(r,n){let i=n?",":"var ";return i+=mn(r),i}emitImmediateAssignment(r,n,i){return`var ${n}=${i};`}emitFunctionCall(r,n,i,o){return`${r}(${n}, ${i}, ${o.join(",")})`}};function rq(e){if(Array.isArray(e))return`[${e.map(rq).join(",")}]`;switch(typeof e){case"boolean":case"number":return e.toString();case"string":return`${JSON.stringify(e)}`;case"object":if(ap(e))throw new Error("Action values cannot be compiled");return ae(e).toString();default:throw new Error("Unexpected value: "+e)}}function nq(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==47)throw new Error(`Expected BlockVar, got ${t.type}`);let r=e.getInstruction(t.args[0]);if(r.type!==51)throw new Error(`Expected EndMap, got ${r.type}`);let n=xe(t.valueType)?It(t.valueType):t.valueType,i=e.getInstruction(r.args[0]);if(i.type!==50)throw new Error(`Expected BeginMap, got ${i.type}`);let o=[];for(let d of i.args){let f=e.getInstruction(d);if(!kt(f)||f.valueType!==C)throw Ie("Programming error: interval bounds must be constant numbers");o.push(ae(f.value))}let a,s;n===Ni||n===ki||n===Ri?(a=["t"],s={type:"1d",min:o[0],max:o[1]}):(a=["u","v"],s={type:"2d",uMin:o[0],uMax:o[1],vMin:o[2],vMax:o[3]});let c=eE(e),l=`
  const mapFn = (function() {
    "use strict";
    ${c.source}
  })();
  return mapFn(${a.join(",")});
`,u={};return{args:a,source:l,constants:c.constants,executionMetadata:u,fn:Uw(a,l,c.constants,u),domain:s}}function Lj(e){for(var t=0;t<this.length;t++)e(this.elementAt(t),t)}function Nj(e){for(var t=[],r=0;r<this.length;r++)t.push(e(this.elementAt(r),r));return t}var dn=class e extends Gr{constructor(r){super();this.isError=!1;this.eachElement=Lj;this.mapElements=Nj;if(r.getError())throw new Error("Programming error: IRExpression should not be constructed with an error chunk");if(this._chunk=r,this.valueType=r.getReturnType(),this.addDependencies(r.getLiveArgNames()),this.isList=xe(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),this.length===void 0))throw U_(r.getListLengthDependencies());P3(r);var n=r.isConstant();this.isConstant=n&&(this.valueType===C||this.valueType===tt),this.isTypedConstant=n,this.isEmptyAction=n&&this.valueType===nr&&Object.keys(r.asValue().updateRules).length===0}shouldExportAns(){return!0}getCompiledFunction(r){return Qd(this.valueType)?nq(this._chunk):this._chunk.getCompiledFunction(r)}getRestrictedFunctionForGLSL(r,n){return this._chunk.getRestrictedFunctionForGLSL(r,n)}polynomialOrder(r){return this._chunk.polynomialOrder(r,{allowRestriction:!0,allowClosedBlockReferences:!1})}getPolynomialCoefficients(r){for(var n=this._chunk.getPolynomialCoefficients(r),i=n.chunk,o=n.coefficients,a=[],s=0;s<o.length;s++){var c=i.copy();c.setReturnIndex(o[s]),c.fuseBroadcast(),a.push(new e(c))}return a}takeDerivative(r){var n=this._chunk.copy().takeDerivative(r).fuseBroadcast();return new e(n)}gradient(r){var n=this._chunk.copy().gradient(r).fuseBroadcast();return new e(n)}toImplicitBool(){let r=this._chunk.copy();return r.GreaterEqual([r.getReturnIndex(),r.Constant(0)]),r.fuseBroadcast(),new e(r)}interpretWithParameters(r){let n,i=this._chunk.argNames;if(r.length===i.length)n=r;else{n=[];let o=this.getDependencies();for(let a=0,s=0;a<i.length;a++)o[s]===i[a]?(n.push(r[s]),s+=1):n.push(void 0)}return this._chunk.interpretWithParameters(n)}substituteConstantArguments(r){return new e(this._chunk.substituteConstantArguments(r))}boundDomain(r){return this._chunk.boundDomain(r)}asValue(){if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){for(var r=[],n=Ml(na(It(this.valueType))),i=0;i<this.length;i++)r.push(n);return r}else return Ml(na(this.valueType))}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return this._chunk.asCompilerValue()}isNaN(){return typeof this.asValue()=="number"&&isNaN(this.asValue())}getEvaluationInfo(){return this._chunk.isConstant()&&this.getDependencies().length===0&&(Le(this.valueType,C)||Le(this.valueType,tt)||Le(this.valueType,$))?[{val:this.asValue()}]:!1}findLinearSubset(r){return this._chunk.findLinearSubset(r)}deriveRegressionRestrictions(){var r=this._chunk.deriveRegressionRestrictions();return r===this._chunk?this:new e(r)}getCursorContext(){return this._chunk.getCursorContext()}getRecursiveFunctionMetadata(){let r=this._chunk.getInstruction(this._chunk.getReturnIndex());if(r.type===55)return this._chunk.getRecursiveFunctionMetadata(r.args[0])}coerceToNumericIfPossible(){if(Le(this.valueType,st)||Le(this.valueType,$e)||Le(this.valueType,$)){let r=this._chunk.copy(),n=r.getReturnIndex();return r.coerceToNumericIfPossible()===n?this:new e(r)}else return this}slot(r){let n=this._chunk.copy();return n.setReturnIndex(n.Slot(r,[n.getReturnIndex()])),new e(n)}};function Rj(e){for(var t=1/0,r=0;r<e.length;r++)(e[r].isList||e[r].isBroadcast)&&(t=Math.min(t,e[r].length));return t}var Hx=class Hx extends Pe{constructor(r){super(r);this.isList=!0;this.length=r.length}asValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asValue());return r}asCompilerValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asCompilerValue());return r}getEvaluationInfo(){if(this.args.every(function(r){return r.isConstant}))return[{val:this.args.map(function(r){return r.asValue()})}]}};Hx.eachArgs=function(r,n){var i=Rj(r);if(!isFinite(i)){n(r);return}for(var o=0;o<i;o++){for(var a=[],s=0;s<r.length;s++)a.push(r[s].isList||xe(r[s].valueType)?r[s].elementAt(o):r[s]);n(a,o)}},Hx.wrap=function(r){return r.isList||xe(r.valueType)?r:new Hx([r])};var gu=Hx;var Dl=class extends Pe{constructor(t){super(t),this.list=t[0],this.index=t[1]}};var pd=class extends Pe{constructor(r,n,i,o,a=[]){super([r,n].concat(i),{skipRegisterDependencies:!0});this.shouldCoerceToList=o;this.parameters=a;this._index=r,this._body=n,this._inputLists=i,this.registerDependencies()}registerDependencies(){var r=[];r.push(this._index._symbol);for(let n of this._inputLists){let i=n._symbol;this.addSubstitutionSymbol(i),r.push(i)}for(let n of this.parameters){let i=n.identifier._symbol;r.push(i),this.addDependency(i)}for(let n of this._inputLists)this.mergeDependenciesInScope(this.type,r,n.args[1]);for(let n of this.parameters)this.mergeDependenciesInScope(this.type,r,n.bounds[0]),this.mergeDependenciesInScope(this.type,r,n.bounds[1]);this.mergeDependenciesInScope(this.type,r,this._body)}};var tE=class extends Yr{constructor(){super(...arguments);this.is_mixed_number=!0}};var rE=class extends Gc{constructor(r,n,i){super(r);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=n,this.defaultDragMode=i,this.valueType=z}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var Oh=class extends Pe{};var Lh=class extends Pe{};var Nh=class extends Pe{};var Rh=class extends Gr{constructor(t,r,n,i,o){super(),this.parameters=t,this.residuals=r,this.statistics=n,this.model=i,this.isModelValid=o.isModelValid,this.residualVariable=o.residualVariable,this.residualSuggestionId=o.residualSuggestionId,this.shouldSuggestLogMode=o.shouldSuggestLogMode,this.isLinear=o.isLinear,this.parameterWarning=o.parameterWarning,this._exports=[this.residualVariable];for(let a of _n(t))this._exports.push(a);this.mergeDependencies(i)}getCompiledFunction(){return this.model.getCompiledFunction.apply(this.model,arguments)}getCompiledDerivative(){return this.model.getCompiledDerivative.apply(this.model,arguments)}};var kh=class extends Pe{};var Vh=class extends Pe{};var ff=class extends Pe{constructor(t,r){super(r),this.order=t}};var Ep=class extends Pe{constructor(t){super(t,{skipRegisterDependencies:!0}),this._index=t[0],this.registerDependencies()}registerDependencies(){for(let t=1;t<=3;t++)this.mergeDependenciesInScope(this.type,[this._index._symbol],this.args[t])}};var Fh=class extends Ep{constructor(){super(...arguments);this.in_place_operator="*=";this.starting_value=1}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:Math.pow(r[2],n)}update(r,n){return r*n}};var Gh=class extends Pe{constructor(t){super(t),this.beginning=t[0],this.end=t[1]}isHalfEmpty(){return this.end&&this.end.args&&this.end.args.length===0}};var nE=class extends bp{};function sO(e){return e.type==="FunctionDefinition"}function iE(e){return e.type==="Identifier"}function oE(e){return e.type==="Table"}function iq(e){return e.type==="Image"}function mf(e){return e.type==="Error"}var aE=class extends Gr{constructor(r,n){super();this.isRegression=!0;this._lhs=r,this.isLhsSimple=r instanceof Ut,this._logLhs=new Tn("ln",[r]),this._rhs=n,this._difference=new Ta([r,n]),this._logDifference=new Ta([new Tn("ln",[r]),new Tn("ln",[n])]),this.mergeDependencies(r,n)}getExportsFromConcrete(r,n){if(mf(n))return[];let i=[];for(let o of _n(n.parameters))r.assignmentForbidden(o)||i.push(o);return r.assignmentForbidden(n.residualVariable)||i.push(n.residualVariable),i}exportTo(r,n,i){if(!n.isError){if(!(n instanceof Rh))throw Ie(`Expected optimized regression but got ${n.type}.`);for(let o of _n(n.parameters))r.assignmentForbidden(o)||(i[o]=i[o]?$1(o):n.parameters[o]);r.assignmentForbidden(n.residualVariable)||(i[n.residualVariable]=n.residuals)}}getSliderVariables(){return[]}analyzeRegression(r,n,i,o,a){throw Ie(`Node ${this.type} does not define analyzeRegression.`)}};var hf=class extends Pe{constructor(r){let n=new Yr(r);super([n]);this.value=r;this._constantNode=n}asValue(){return this._constantNode.asValue()}asCompilerValue(){return this._constantNode.asCompilerValue()}};var Bh=class extends Pe{};var yf=class extends Pe{constructor(r){typeof r!="string"&&(r=""+r);super([]);this.isString=!0;this._stringValue=r}asValue(){return this._stringValue}};var Ip=class extends Tn{constructor(t,r){super(t,r),this.seed=r[0]}};var sE=class extends dd{constructor(r,n){super(new Ut(r._symbol),r._expression);this.isSlider=!0;this.setInputSpan(r._inputSpan),this.sliderAssignment=r,this.sliderMin=n.sliderMin,this.sliderMax=n.sliderMax,this.sliderSoftMin=n.sliderSoftMin,this.sliderSoftMax=n.sliderSoftMax,this.sliderStep=n.sliderStep,this.sliderIsPlayingOnce=n.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)}shouldPromoteToSlider(r){return!1}asAssignment(){return new dd(this._symbol,this._expression)}};var cE=class extends Gr{constructor(t,r,n,i){super(),this._symbol=t,this._expression=r,this.otherVariableSolutionData=n,this.mergeDependencies(r),this.branchMultiplier=i}};var qh=class extends Pe{constructor(t){super(t),this._symbol="stats"}};var bf=class extends Pe{constructor(t,r){super([t].concat(r),{skipRegisterDependencies:!0}),this._body=t,this._assignments=r,this.registerDependencies()}registerDependencies(){for(var t=[],r=0;r<this._assignments.length;r++){var n=this._assignments[r],i=n._symbol;this.addSubstitutionSymbol(i),t.push(i);var o=n.args[1];this.mergeDependencies(o),this.addSubstitutionDependencies(o.getDependencies())}this.mergeDependenciesInScope(this.type,t,this._body)}};var zh=class extends Ep{constructor(){super(...arguments);this.in_place_operator="+=";this.starting_value=0}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:n*r[2]}update(r,n){return r+n}};var lE=class extends Gr{constructor(r){super();this.exportPenalty=1;this.isTable=!0;this.columns=r,this.mergeDependencies.apply(this,r)}getExports(r){let n=[];for(var i=0;i<this.columns.length;i++)Array.prototype.push.apply(n,this.columns[i].getExports(r));return n}exportTo(r,n,i){for(var o=0;o<this.columns.length;o++){var a=this.columns[o].getExports(r);if(a.length){var s=a[0];r.assignmentForbidden(s)||i[s]||(n.isError?i[s]=n:this.columns[o].exportTo(r,n.columns[o],i))}}}getAllIds(){return this.columns.map(function(r){return r.header.userData.id})}};var xf=class extends Gr{constructor(t,r){super(),this.header=t,this.values=r,this.registerDependencies(),this._exports=this.computeExports()}registerDependencies(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)}computeExports(){return this.header instanceof Ut?[this.header._symbol]:[]}_exportSymbolsTo(t,r,n){for(let i of t)n[i]=r}exportTo(t,r,n){var i=this.getLegalExports(t);this._exportSymbolsTo(i,r,n)}exportToLocal(t,r,n){this._exportSymbolsTo(this.getExports(t),r,n)}};var uE=class extends Gr{constructor(t){super(),this.handler=t.handler,this.minStep=t.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}};var Uh=class extends Pe{constructor(t){super(t),this._symbol="ttest"}};var Hh=class extends Pe{constructor(t){super(t,{skipRegisterDependencies:!0}),this._symbol=t[0]._symbol,this._expression=t[1],this.registerDependencies()}registerDependencies(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}};var $h=class extends Gr{constructor(t,r){super(),this._symbol=t._symbol,this.mergeDependencies(t,r),this._lhs=t,this._rhs=r}asComparator(){return new ja["="]([this._lhs,this._rhs])}};var Za="i",vf=class extends Pe{constructor(){super([])}};var Tf=class extends Pe{constructor(r,n,i){super(r);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=n,this.defaultDragMode=i,this.valueType=$}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}getEvaluationInfo(){return[{val:this.asValue()}]}};var _l=class extends Pe{constructor(t,r){super(r),this.symbol=t}};var Yh=class e extends Gr{constructor(r,n,i,o,a){super();this.specifiedArg=i;this.rhs=o;this.originalNode=a;if(this._symbol=r,this._argSymbols=n.map(function(s){return s._symbol}),this._expression=o,this.userData=a.userData,this.metaData=a.metaData,this._inputSpan=a._inputSpan,this.mergeDependenciesInScope("FunctionDefinition",this._argSymbols,this._expression,{functionDefinitionSymbol:this._symbol}),i.valid){let s=i.functionDefArgSymbols.slice();s[i.argIndex]=i.argValue.toString(),this.ref=`_base_case:${r}:${s.join(",")}`,this._exports=[this.ref]}else{let s=this._exports.find(c=>c.indexOf("idref")!==-1);s&&(this.ref=s)}}static fromCallAssignment(r,n){let i=n._lhs;if(!(i instanceof Tn))return;let o=r[i._symbol];if(!o||!(o instanceof hs))return;if(i.args.length!==o._argSymbols.length)return new e(o._symbol,[],{valid:!1,error:KS(o._symbol,o._argSymbols.length)},n._rhs,n);let a,s=[];for(let c=0;c<i.args.length;c++){let l=i.args[c];if(l instanceof Yr){if(a){a={valid:!1,error:ix()};break}a={valid:!0,argIndex:c,functionDefArgSymbols:o._argSymbols,argValue:l.asValue(),argSymbol:o._argSymbols[c]}}else if(l instanceof Ut)if(l._symbol!==o._argSymbols[c]){a={valid:!1,error:C1()};break}else s.push(l);else{a={valid:!1,error:C1()};break}}if(a)return new e(o._symbol,s,a,n._rhs,n)}getRef(){return this.ref}};function kj(e){return e.isConstant?new Yr(e.asCompilerValue()):new Yr(NaN)}var Cp=class extends gu{constructor(r,n){super(r.map(kj));this.rawArgs=r;this.headerSymbol=n;this.isIndependent=n!==void 0}};function Xe(e,t){let r=E3(e);return r.prototype.type=t,r}var Vj={Base:Xe(Gr,"Base"),Expression:Xe(Pe,"Expression"),Error:Xe(q,"Error"),Constant:Xe(Yr,"Constant"),MixedNumber:Xe(tE,"MixedNumber"),Identifier:Xe(Ut,"Identifier"),Ans:Xe(Fw,"Ans"),ImaginaryUnit:Xe(vf,"ImaginaryUnit"),List:Xe(gu,"List"),TableColumnValue:Xe(Cp,"TableColumnValue"),Range:Xe(Gh,"Range"),ListAccess:Xe(Dl,"ListAccess"),DotAccess:Xe(Ea,"DotAccess"),Construction:Xe(cf,"Construction"),ParenSeq:Xe(Gc,"ParenSeq"),MovableComplexNumber:Xe(Tf,"MovableComplexNumber"),MovablePoint:Xe(rE,"MovablePoint"),NamedCoordinateAccess:Xe(_l,"NamedCoordinateAccess"),BareSeq:Xe(mp,"BareSeq"),Norm:Xe(Nh,"Norm"),BaseComparator:Xe(Bc,"BaseComparator"),ComparatorChain:Xe(hp,"ComparatorChain"),DoubleInequality:Xe(Bw,"DoubleInequality"),RepeatedOperator:Xe(Ep,"RepeatedOperator"),Sum:Xe(zh,"Sum"),Product:Xe(Fh,"Product"),Integral:Xe(Sh,"Integral"),AssignmentExpression:Xe(vh,"AssignmentExpression"),ListComprehension:Xe(pd,"ListComprehension"),FunctionCall:Xe(Tn,"FunctionCall"),RecursiveFunctionBaseCase:Xe(Yh,"RecursiveFunctionBaseCase"),SeededFunctionCall:Xe(Ip,"SeededFunctionCall"),FunctionExponent:Xe(xp,"FunctionExponent"),FunctionFactorial:Xe(vp,"FunctionFactorial"),Prime:Xe(ff,"Prime"),Piecewise:Xe(wa,"Piecewise"),Restriction:Xe(Bh,"Restriction"),Derivative:Xe(lf,"Derivative"),UpdateRule:Xe(Hh,"UpdateRule"),Substitution:Xe(bf,"Substitution"),Histogram:Xe(Ch,"Histogram"),DotPlot:Xe(Ih,"DotPlot"),BoxPlot:Xe(Th,"BoxPlot"),TTest:Xe(Uh,"TTest"),IndependentTTest:Xe(Ph,"IndependentTTest"),Stats:Xe(qh,"Stats"),Assignment:Xe(dd,"Assignment"),FunctionDefinition:Xe(hs,"FunctionDefinition"),CallAssignment:Xe($h,"CallAssignment"),Equation:Xe(ud,"Equation"),Regression:Xe(aE,"Regression"),Image:Xe(qw,"Image"),Ticker:Xe(uE,"Ticker"),Slider:Xe(sE,"Slider"),RegressionParameter:Xe(hf,"RegressionParameter"),Table:Xe(lE,"Table"),TableColumn:Xe(xf,"TableColumn"),SolvedEquation:Xe(cE,"SolvedEquation"),OptimizedRegression:Xe(Rh,"OptimizedRegression"),Seed:Xe(yf,"Seed"),ExtendSeed:Xe(uf,"ExtendSeed"),IRExpression:Xe(dn,"IRExpression"),Add:Xe(xh,"Add"),Subtract:Xe(Ta,"Subtract"),Multiply:Xe(Oh,"Multiply"),DotMultiply:Xe(yp,"DotMultiply"),CrossMultiply:Xe(wh,"CrossMultiply"),Divide:Xe(Eh,"Divide"),Exponent:Xe(bp,"Exponent"),Negative:Xe(Lh,"Negative"),Or:Xe(kh,"Or"),PercentOf:Xe(Vh,"PercentOf"),RawExponent:Xe(nE,"RawExponent"),Comparator:{"<":Xe(ja["<"],"Comparator['<']"),">":Xe(ja[">"],"Comparator['>']"),"<=":Xe(ja["<="],"Comparator['<=']"),">=":Xe(ja[">="],"Comparator['>=']"),"=":Xe(ja["="],"Comparator['=']")}},N=Vj;function cO(e,t){let r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<t?r:e}function dE(e){let{target:t,hardMin:r,hardMax:n,step:i}=e,o=1e-10;if(r!==void 0&&n!==void 0&&(o=Math.min(o,Math.abs(n-r)/1e3)),i&&(o=Math.min(o,i/10)),r!==void 0&&(r=cO(r,o)),n!==void 0&&(n=cO(n,o)),e.forceSliderToMax&&n!==void 0&&(t=n),r>n||t<=r)return r;if(t>=n)return n;if(i){let c=r!==void 0?r:0;var a=Math.round((t-c)/i);t=i*a+c}let s=cO(t,o);return(i||r===s||n===s)&&(t=s),t<=r?r:t>=n?n:t}function lO(e){let{storedMax:t,sliderValue:r,hardMin:n,step:i}=e,o=e.is3d?mo.xmax:10;if(t>o&&(o=t),r>o&&(o=r),n>o&&(o=n),i){let a=dE({target:o,hardMin:n,hardMax:void 0,step:i});a>=o?o=a:o=a+i}return o}var fu={coerceToNumber:"all"},dO=N.Constant,Fj=N.Identifier;N.Base.prototype.tryGetConcreteTree=function(e,t,r={}){var n;try{n=this.getConcreteTree(e,t,r)}catch(i){i instanceof N.Base?n=i:n=Ie(i)}return n};N.Base.prototype.getConcreteTree=function(e,t,r={}){var n=this.buildIRExpression(e,t,{coerceToNumber:r.coerceToNumber});if(n.isError)throw n;return n};N.DoubleInequality.prototype.getConcreteTree=function(e,t){return new this.constructor([new N.Piecewise([this._indicator,this._expressions[0],new dO(NaN)]).getConcreteTree(e,t),this._operators[0],new Fj(this._symbol),this._operators[1],new N.Piecewise([this._indicator,this._expressions[1],new dO(NaN)]).getConcreteTree(e,t)])};N.Error.prototype.getConcreteTree=function(e,t){return this};function $x(e,t){return e.isError?e:t.indexOf(e.valueType)===-1?ZS():e}N.Image.prototype.getConcreteTree=function(e,t){var r=this.center.tryGetConcreteTree(e,t),n=this.radianAngle.tryGetConcreteTree(e,t,fu),i=this.width.tryGetConcreteTree(e,t,fu),o=this.height.tryGetConcreteTree(e,t,fu),a=this.opacity.tryGetConcreteTree(e,t,fu),s=[z,on,Rt],c=[C,ke,Rt];return r=$x(r,s),n=$x(n,c),i=$x(i,c),o=$x(o,c),a=$x(a,c),new N.Image({center:r,radianAngle:n,width:i,height:o,opacity:a},this.moveStrategy)};N.Ticker.prototype.getConcreteTree=function(e,t){var r=this.handler.tryGetConcreteTree(e,t);!r.isError&&r.valueType!==nr&&(r=GM(dt(r.valueType)));var n=r.getDependencies().filter(function(i){return!(e.graphingEnabled()&&e.validActionVariable(i))});return n.length&&(r=un(e.sliderVariables(n)).setDependencies(n)),new N.Ticker({handler:r,minStep:this.minStep.tryGetConcreteTree(e,t,fu)})};function uO(e,t,r){if(!t){r.valids[e]=!0;return}var n=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(n.length>0){r.errors[e]=!0;for(var i=0;i<n.length;i++)n[i]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(n[i])}else r.values[e]=+t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}function pE(e){return e&&e.valueType===ke&&e.length===1&&e.args?e.args[0]:e}N.Slider.prototype.getConcreteTree=function(e,t){var r=this._expression.getConcreteTree(e,t),n=pE(this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,t,fu)),i=pE(this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,t,fu)),o=pE(this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,t,fu)),a={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(uO("min",n,a),uO("max",i,a),uO("step",o,a),o&&a.valids.step&&(a.values.step===0?delete a.values.step:a.values.step=Math.abs(a.values.step)),a.errors.cycle?r=RD(a.exportedSymbol):(a.errors.min||!a.valids.min?a.errMsg=kD():a.errors.max||!a.valids.max?a.errMsg=VD():(a.errors.step||!a.valids.step)&&(a.errMsg=GD()),a.values.min>a.values.max&&(a.valids.min=!1,a.valids.max=!1,a.errMsg||(a.errMsg=FD()))),r.isConstant){var s=t.initialEvaluation&&t.initialEvaluation.asValue(),c=s&&this.sliderIsPlayingOnce,l=a.values.max,u=+r.asValue(),d=a.values.min,f=a.values.step;if(c&&!isFinite(l)){var g=pE(this.sliderSoftMax&&this.sliderSoftMax.tryGetConcreteTree(e,t,fu));g&&(l=lO({storedMax:+g.asValue(),sliderValue:u,step:f,hardMin:d,is3d:e.is3dProduct()}))}var y=dE({target:u,hardMin:d,hardMax:l,step:f,forceSliderToMax:!!c}),x=nf(y.toString()),b=isFinite(ae(x))?x:y;r=new dO(b).getConcreteTree(e,t)}return r.sliderInfo=a,r};function aq(e,t){if(!t[this._symbol])throw ba(this._symbol);var r=this.args.map(function(i){return i.getConcreteTree(e,t)});if(r.length>0){if(r.length===1&&r.push(new N.Constant(1).getConcreteTree(e,t)),r[1].getDependencies().length)throw Ex(this._symbol).setDependencies(r[1].getDependencies());if(r[1].valueType!==C)throw Ex(this._symbol);var n=r[1].asValue();if(!isFinite(n)||n<=0)throw Ex(this._symbol)}return this.typeCheck(e,r),new this.constructor(r)}N.Histogram.prototype.getConcreteTree=aq;N.DotPlot.prototype.getConcreteTree=aq;N.BoxPlot.prototype.getConcreteTree=function(e,t){if(!t[this._symbol])throw ba(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),r.length===1&&(r[0].valueType===ke||r[0].valueType===Rt)?new this.constructor(r):Ie("Failed to copmile BoxPlot")};function pO(e,t){if(!t[this._symbol])throw ba(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),new this.constructor(r)}N.TTest.prototype.getConcreteTree=pO;N.IndependentTTest.prototype.getConcreteTree=pO;N.Stats.prototype.getConcreteTree=pO;N.Table.prototype.getConcreteTree=function(e,t){for(var r=[],n=Fi(t),i=0;i<this.columns.length;i++){var o=this.columns[i].getConcreteTree(e,n);o.isIndependent&&this.columns[i].exportToLocal(e,o,n),r.push(o)}return new this.constructor(r)};N.TableColumn.prototype.getConcreteTree=function(e,t){var s;var r=this.header.getConcreteTree(e,t,fu),n,i=this.header instanceof N.Identifier&&!t[this.header._symbol];if(i){n=[];for(var o=0;o<this.values.length;o++){if(this.values[o].tableError()){n.push(vx(this.values[o].tableError()));continue}var a=this.values[o].tryGetConcreteTree(e,t);a.isError?n.push(a):a.tableError()?n.push(vx(a.tableError())):a.valueType===C?n.push(a):n.push(_M([dt(a.valueType)]))}for(let c=0;c<n.length;c++){if(n[c].isError)continue;let l=this.values[c]&&this.values[c].tableError();if(l){n[c]=vx(l);continue}let u=n[c].getDependencies();u.length&&(n[c]=un(u).setDependencies(u))}return new Cp(n,this.header._symbol)}else return!r.isError&&r.valueType!==C&&r.valueType!==ke&&r.valueType!==Rt?DM([dt((s=r.valueType)!=null?s:nn)]):r};var Pp;function sq(){Pp&&(Pp.cacheHits+=1)}function cq(){Pp&&(Pp.cacheMisses+=1)}function lq(){Pp&&(Pp.cacheWrites+=1)}function uq(){Pp&&(Pp.cacheReads+=1)}var dq={segment:!0,ray:!0,vector:!0,line:!0,circle:!0,arc:!0,polygon:!0,glider:!0,midpoint:!0,intersection:!0,strictintersection:!0,perpendicular:!0,parallel:!0,translate:!0,rotate:!0,dilate:!0,reflect:!0,apply:!0,segments:!0,vertices:!0,angle:!0,angles:!0,directedangle:!0,directedangles:!0,clockwise:!0,counterclockwise:!0,reflex:!0,start:!0,end:!0,anglebisector:!0};function mu(e){switch(e.type){case"simple":return;case"list-access":return e.listIndex;case"polygon-edge":return mu(e.polygon);case"arbitrary-expression":return;default:throw new Error(`Unexpected parent type: ${e.type}`)}}function ys(e){switch(e.type){case"simple":case"list-access":return e.identifier;case"polygon-edge":return ys(e.polygon);default:throw new Error(`Unexpected parent type: ${e.type}`)}}var Wh={simple:e=>({type:"simple",identifier:e}),listAccess:(e,t)=>({type:"list-access",identifier:e,listIndex:t}),polygonEdge:(e,t)=>({type:"polygon-edge",polygon:{type:"simple",identifier:e},edgeIndex:t}),polygonListItemEdge:(e,t)=>({type:"polygon-edge",polygon:{type:"list-access",identifier:e,listIndex:t.listIndex},edgeIndex:t.edgeIndex}),arbitraryExpression:e=>({type:"arbitrary-expression",latex:e.getInputString()})};function Gj(e){return e!==void 0&&e in dq}function Sp(e){return Gj(e)?e==="rotate"||e==="dilate"||e==="translate"||e==="reflect"?!0:!1:!1}function gE(e){if(e instanceof Dl&&e.list instanceof Ut&&e.index instanceof Yr)return Wh.listAccess(e.list._symbol,e.index.asValue());if(e instanceof Dl&&e.list instanceof Ea&&e.index instanceof Yr){let t=e.list.args[0],r=e.list.args[1];if(t instanceof Ut&&r instanceof Ut&&r._symbol==="segments")return Wh.polygonEdge(t._symbol,e.index.asValue());if(t instanceof Dl&&t.list instanceof Ut&&t.index instanceof Yr)return Wh.polygonListItemEdge(t.list._symbol,{listIndex:t.index.asValue(),edgeIndex:e.index.asValue()})}return e.type==="Identifier"?Wh.simple(e._symbol):Wh.arbitraryExpression(e)}function fE(e){let t={},r=e;if((r instanceof dd||r instanceof hs)&&(t.identifier=r._symbol,r=r._expression),r instanceof Dl&&r.index instanceof Yr&&(t.listAccess=r.index.asValue(),r=r.list),r instanceof Tn){let n=r._symbol,i=r.args[0]instanceof Ut?r.args[0]._symbol:void 0;if(Sp(n)&&e instanceof hs&&i&&e._argSymbols.some(o=>o===i))t.tree={symbol:n,parents:r.args.slice(1).map(gE)};else if(dq[n])t.tree={symbol:n,parents:r.args.map(gE)};else{let o=Wh.simple(r._symbol);t.tree={symbol:"apply",parents:[o,...r.args.map(gE)]}}}else if(r instanceof Ea){let n=r.args.map(gE);n.length===2&&n[1]&&n[1].type==="simple"&&n[1].identifier==="segments"?t.tree={symbol:"segments",parents:[n[0]]}:n.length===2&&n[1]&&n[1].type==="simple"&&n[1].identifier==="start"?t.tree={symbol:"start",parents:[n[0]]}:n.length===2&&n[1]&&n[1].type==="simple"&&n[1].identifier==="end"&&(t.tree={symbol:"end",parents:[n[0]]})}return t}function fq(e,t,r,n,i){let o=Le(r,We)||Le(r,Oe),a=Le(i,We)||Le(i,Oe);if(!o&&!a)return;let s=gq(e,t,r),c=gq(e,n,i),l=s.filter(u=>{let d=ys(u);return d?c.some(f=>pi(u,f))&&!!e.lookup(d):!1});for(let u of s)pq(e,u,n)&&l.every(d=>!pi(u,d))&&l.push(u);for(let u of c)pq(e,u,t)&&l.every(d=>!pi(u,d))&&l.push(u);if(l.length===1)return l[0]}function pq(e,t,r){let n=ys(t),i=n!==void 0?e.lookup(n):void 0,o=i&&e.getGeometryTree(i);return((o==null?void 0:o.symbol)==="glider"||(o==null?void 0:o.symbol)==="intersection"||(o==null?void 0:o.symbol)==="strictintersection"||(o==null?void 0:o.symbol)==="midpoint")&&(o==null?void 0:o.parents.some(a=>{if(a.type==="arbitrary-expression")return!1;let s=ys(a);return s&&e.resolvesTo(s,r)&&(mu(t)===void 0||mu(a)===void 0||mu(a)===mu(t))}))}function gq(e,t,r){var o;let n=[],i=((o=e.getGeometryTree(t))==null?void 0:o.parents)||[];for(let a=0;a<i.length;a++){let s=i[a];if(Le(r,We)&&a===0||s.type==="arbitrary-expression"||s.type==="polygon-edge")continue;let c=ys(s);if(!c)continue;let l=e.lookup(c);l&&e.isPointOrListOfPoints(l)&&n.push(s)}return n}function mE(e,t){if(xe(e)){let r=It(e);for(let n=0;n<t.length;n++)if(vo(r,t[n]))return!0;return!1}return vo(e,t)}function vo(e,t){switch(e){case C:return Ys(t);case ir:return t;case $:case z:{let[r,n]=t;return Ys(r)||Ys(n)}case oe:{let[r,n,i]=t;return Ys(r)||Ys(n)||Ys(i)}case gn:{let[r,n,i]=t;return Ys(r)||Ys(n)||Ys(i)}case et:{for(let r of t)if(vo(z,r))return!0;return!1}case $n:{let[r,n]=t;return vo(oe,r)||vo(C,n)}case Hn:{let[r,n,i]=t;return vo(oe,r)||vo(oe,n)||vo(oe,i)}case Mr:case Pt:{let[r,n]=t;return vo(oe,r)||vo(oe,n)}case Ye:case Re:case ot:case Ve:{let[r,n]=t;return vo(z,r)||vo(z,n)}case We:{let[r,n]=t;return vo(z,r)||vo(C,n)}case Oe:{let[r,n,i]=t;return vo(z,r)||vo(z,n)||vo(z,i)}case st:case $e:{let[r,n,i]=t;return vo(z,r)||vo(C,n)||vo(C,i)}case nr:return Object.keys(t.updateRules).length===0;case tt:case cr:case lr:case xt:case Ni:case ki:case Ri:case po:case fo:case go:return!1;case In:{let[r,n]=t;return Ys(r)||Ys(n)}default:throw new Error("Type cannot contain a NaN value: "+dt(e)+".")}}function qc(e,t){return e.pushLeafInstruction(t)}function Yn(e,t,r){switch(t.type){case 8:return e.Add(r);case 9:return e.Subtract(r);case 10:return e.Multiply(r);case 11:return e.Divide(r);case 12:return e.Exponent(r);case 13:return e.RawExponent(r);case 14:return e.Negative(r);case 25:return e.Equal(r);case 26:return e.Less(r);case 27:return e.Greater(r);case 28:return e.LessEqual(r);case 29:return e.GreaterEqual(r);case 31:return e.Or(r);case 32:return e.And(r);case 33:return e.Piecewise(r);case 47:return e.BlockVar(t.valueType,r);case 48:return e.BroadcastResult(t.valueType,r);case 15:return e.TupleOfType(t.valueType,r);case 16:return e.Slot(t.index,r);case 37:return e.NativeFunction(t.symbol,r);case 42:return e.Distribution(t.symbol,r);case 21:return e.BeginIntegral(t.callData,r);case 22:return e.EndIntegral(r);case 23:return e.BeginBroadcast(r,t.context);case 24:return e.EndBroadcast(r);case 19:return e.BeginLoop(t.callData,r);case 20:return e.EndLoop(r);case 38:return e.List(r);case 39:return e.ListAccess(r);case 40:return e.DeferredListAccess(r);case 41:return e.InboundsListAccess(r);case 44:return e.ExtendSeed(t.tag,r);case 49:return e.Action(t.symbols,r);case 50:return e.BeginMap(t.callData,r);case 51:return e.EndMap(r);case 53:return e.BeginFunction(r);case 54:return e.EndFunction(r);case 55:return e.FunctionCall(r);default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function mq(e,t,r){let n=e.argNames.indexOf(t);if(n===-1)return 0;let i=Bo(e,n,r);return Fr(i,e.getReturnIndex())}function Bo(e,t,{allowRestriction:r,allowClosedBlockReferences:n}){return{chunk:e,argIndex:t,orderTable:[],mask:wp(e,t),allowRestriction:r,allowClosedBlockReferences:n}}function Fr(e,t){let r=e.orderTable[t];if(r!==void 0)return r;let n=qj(e,t);return e.orderTable[t]=n,n}function Bj(e,t){let[r]=t.args;switch(t.symbol){case"complex":return 1/0;case"coerceComplexToReal":let n=e.chunk.getInstruction(r);return n.type===37&&n.symbol==="complex"?Fr(e,n.args[0]):Fr(e,r);case"coerceRealToComplex":return Fr(e,r);default:return 1/0}}function qj(e,t){let{chunk:r,mask:n,argIndex:i,allowRestriction:o,allowClosedBlockReferences:a}=e;if(!a&&r.isInClosedBlock(t))return 1/0;if(t===i)return 1;if(!n[t])return 0;let s=r.getInstruction(t);if(Fo(s)||ia(s))return 1/0;switch(s.type){case 8:case 9:case 26:case 28:case 27:case 29:{let[l,u]=s.args;return Math.max(Fr(e,l),Fr(e,u))}case 10:{let[l,u]=s.args;return Fr(e,l)+Fr(e,u)}case 14:return Fr(e,s.args[0]);case 11:{let[l,u]=s.args;return Fr(e,u)>0?1/0:Fr(e,l)}case 12:case 13:{let[l,u]=s.args,d=r.getInstruction(u);if(Fr(e,l)===0&&Fr(e,u)===0)return 0;if(d.type===1){let f=ae(d.value);return f===Math.round(f)&&f>0?Fr(e,l)*f:1/0}else return 1/0}case 33:{let l=r.getInstruction(s.args[2]);return o&&l.type===1&&isNaN(ae(l.value))?Fr(e,s.args[1]):1/0}case 37:return Bj(e,s);case 16:{let[l]=s.args,u=r.getInstruction(l);return u.valueType===$?u.type===37&&u.symbol==="complex"?Fr(e,u.args[s.index]):Fr(e,l):1/0}case 2:case 0:case 1:case 25:case 32:case 31:case 15:case 38:case 39:case 40:case 41:case 42:case 48:case 47:case 3:case 44:case 49:case 4:case 55:return 1/0;default:let c=s;throw new Error(`Unexpected opcode ${c.type}`)}}function hq(e,t){let r=e.argNames.indexOf(t),n=e.getReturnIndex(),i=zc(Bo(e,r,{allowRestriction:!0,allowClosedBlockReferences:!1}),n);if(Fr(i.orderCtx,n)>2)throw new Error("Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2");let o=kn(i,n),a=!1;for(let s=0;s<e.instructionsLength();s++)e.getInstruction(s).type===33&&i.mask[s]&&(a=!0);return{chunk:i.newChunk,coefficients:o,mappedArgIndex:i.valueMap[r],mappedReturnIndex:i.valueMap[n],isRestrictedPolynomial:a}}function zc(e,t){let{chunk:r,argIndex:n}=e,i=xo(r,t);if(r.isInClosedBlock(n))throw new Error("Programming Error: cannot find polynomial coefficients of an instruction in a closed block");let o,a;n>=0&&n<r.argNames.length?(o=r.argNames.slice(),a=r.argTypes.slice(),o.splice(n,1),a.splice(n,1)):(o=r.argNames,a=r.argTypes);let s=new hu({argNames:o,argTypes:a}),c=[];for(let g=0;g<r.instructionsLength();g++){if(!i[g])continue;let y=r.getInstruction(g);if(y.type===2)g<n||n<0?c[g]=g:g===n?c[g]=s.SymbolicVar(r.argTypes[g]):c[g]=g-1;else if(pt(y))c[g]=qc(s,y);else{let x=[];for(let b of y.args)x.push(c[b]);c[g]=Yn(s,y,x)}}let l=[],u=s.Constant(0),d=s.Constant(1),f=s.Constant(NaN);return{chunk:r,newChunk:s,orderCtx:e,coefficientTable:l,mask:e.mask,valueMap:c,argIndex:n,zero:u,one:d,nan:f}}function kn(e,t){let{newChunk:r,orderCtx:n,coefficientTable:i,mask:o,valueMap:a,argIndex:s,zero:c,one:l,nan:u}=e,d=i[t];if(d!==void 0)return d;let f;for(o[t]?t===s?f=[c,l]:Fr(n,t)>2?f=[u]:f=Uj(e,t):f=[a[t]];f.length>1;){let g=r.getInstruction(f[f.length-1]);if(g.type===1&&ae(g.value)===0)f.pop();else break}if(f.length===0)throw new Error("Programming Error: coefficients cannot be empty");return i[t]=f,f}function zj(e,t){let[r,n]=t.args;switch(t.symbol){case"coerceComplexToReal":let i=e.chunk.getInstruction(r);return i.type===37&&i.symbol==="complex"?kn(e,i.args[0]):kn(e,r);case"coerceRealToComplex":return kn(e,r)}throw new Error(`Polynomial coefficients not defined for native function ${t.symbol}`)}function Uj(e,t){let r=e.chunk.getInstruction(t),{newChunk:n}=e;switch(r.type){case 8:{let[o,a]=r.args,s=kn(e,o),c=kn(e,a),l=s.length-1,u=c.length-1,d=[];for(let f=0;f<=Math.max(l,u);f++)l>=f&&u>=f?d.push(n.Add([s[f],c[f]])):d.push(l>u?s[f]:c[f]);return d}case 9:case 26:case 28:case 27:case 29:{let[o,a]=r.args;(r.type===26||r.type==28)&&([o,a]=[a,o]);let s=kn(e,o),c=kn(e,a),l=s.length-1,u=c.length-1,d=[];for(let f=0;f<=Math.max(l,u);f++)l>=f&&u>=f?d.push(n.Subtract([s[f],c[f]])):d.push(l>u?s[f]:n.Negative([c[f]]));return d}case 14:{let o=r.args[0],a=kn(e,o),s=[];for(let c=0;c<a.length;c++)s.push(n.Negative([a[c]]));return s}case 10:{let[o,a]=r.args,s=kn(e,o),c=kn(e,a),l=s.length-1,u=c.length-1,d=[];for(let f=0;f<=l;f++)for(let g=0;g<=u;g++){if(f+g>2)continue;let y=n.Multiply([s[f],c[g]]),x=d[f+g];x===void 0?d[f+g]=y:d[f+g]=n.Add([x,y])}return d}case 11:{let[o,a]=r.args,s=kn(e,o),c=kn(e,a),l=[];for(let u=0;u<s.length;u++)l.push(n.Divide([s[u],c[0]]));return l}case 12:case 13:{let[o,a]=r.args,s=kn(e,o),c=kn(e,a);if(s.length-1===0)return[n.RawExponent([s[0],c[0]])];let u=n.getInstruction(c[0]);switch(ae(u.value)){case 0:return[n.Constant(1)];case 1:return s;case 2:return[n.Multiply([s[0],s[0]]),n.Multiply([n.Constant(2),n.Multiply([s[0],s[1]])]),n.Multiply([s[1],s[1]])]}}case 33:return kn(e,r.args[1]);case 37:return zj(e,r);case 16:{let[o]=r.args,a=e.chunk.getInstruction(o);if(a.valueType===$)return a.type===37&&a.symbol==="complex"?kn(e,a.args[r.index]):kn(e,o);throw new Error(`Cannot find polynomial coefficients of opcode ${r.type} that depends on symbol.`)}case 0:case 23:case 2:case 1:case 25:case 32:case 31:case 15:case 38:case 39:case 40:case 41:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:case 50:case 51:case 4:case 53:case 54:case 55:throw new Error(`Cannot find polynomial coefficients of opcode ${r.type} that depends on symbol.`);default:let i=r;throw new Error(`Unexpected opcode ${i.type}`)}}function yq(e,t,r){let n=e.argNames.indexOf(t);if(n===-1){let a=e.getInstruction(r);return a.type===1?fO(a.valueType,a.value):Gi()}let i=Bo(e,n,{allowRestriction:!0,allowClosedBlockReferences:!1}),o=Hj(i,r);return Ca(o,r)}function Hj(e,t){let{chunk:r,mask:n}=e;return{chunk:r,mask:n,orderCtx:e,domainTable:[],index:t}}function Ca(e,t){let{domainTable:r}=e,n=r[t];if(n!==void 0)return n;let i=$j(e,t);return r[t]=i,i}function $j(e,t){let{chunk:r,mask:n,orderCtx:i}=e,o=r.getInstruction(t);switch(o.type){case 1:return fO(o.valueType,o.value);case 3:case 2:return o.valueType===C?cu():Gi();case 0:return Gi();case 31:return rx(Ca(e,o.args[0]),Ca(e,o.args[1]));case 32:case 8:case 9:case 10:return ii(Ca(e,o.args[0]),Ca(e,o.args[1]));case 11:{let a=ii(Ca(e,o.args[0]),Ca(e,o.args[1])),s=r.getInstruction(o.args[1]);return s.type===1&&s.valueType===C&&ae(s.value)!==0?a:ii(Gi(),a)}case 14:return Ca(e,o.args[0]);case 15:{let a=o.valueType;switch(a){case z:case oe:return Yj(e,o.args);case $:return gO(e,o.args);default:let s=a;throw new Error(`Unexpected tuple type ${s}`)}}case 12:case 13:case 47:case 48:case 16:case 42:case 21:case 22:case 23:case 24:case 19:case 20:case 39:case 40:case 41:case 44:case 50:case 51:case 54:case 55:return gO(e,o.args);case 4:case 53:return Gi();case 49:return Gi();case 38:return o.args.length===1?Ca(e,o.args[0]):Gi();case 25:return Gi();case 33:return tB(Ca(e,o.args[0]),Ca(e,o.args[1]),Ca(e,o.args[2]));case 26:case 27:case 28:case 29:{if(!n[t])return cu();let a=ii(Ca(e,o.args[0]),Ca(e,o.args[1]));if(Fr(i,t)>1)return ii(Gi(),a);let s=e.coefficientCtx;s===void 0&&(s=zc(i,e.index),e.coefficientCtx=s);let c=s.newChunk,l=kn(s,t),[u,d]=l;if(!kt(c.getInstruction(u)))return ii(Gi(),a);let f=wn(c,u);if(isNaN(f))return ad();if(d===void 0)return o.type===28||o.type===29?f>=0?a:ad():f>0?a:ad();{let g=wn(c,d);return ii(a,zm(f,g))}}case 37:switch(o.symbol){case"restriction":case"restrictionToBoolean":return Ca(e,o.args[0]);case"count":return cu();default:return Xn[o.symbol].noPeel?Gi():gO(e,o.args)}}}function Yj(e,t){let r=cu();for(let n of t)r=ii(r,Ca(e,n));return r}function gO(e,t){let r=Gi();for(let n of t)r=ii(r,Ca(e,n));return r}function fO(e,t){if(xe(e))return t.length===1?fO(It(e),t[0]):Gi();switch(e){case C:case z:case oe:return mE(e,t)?ad():cu();case tt:return t?cu():ad();default:return Gi()}}var wf=[dc(C),dc(C)],Wj=[Dr([uc,dc(Vi.of([tt,C]))],e=>It(e[0]))],mO=e=>Le(e[0],ir)||Le(e[0],C)?e[1]:e[0],hO={Negative:hc([[C],[z],[Ve],[Pt],[oe],[$]],e=>e[0]),Add:hc([[C,C],[z,z],[Ve,Ve],[Pt,Pt],[oe,oe],[$,$],[$,C],[C,$]],e=>e[0]),Subtract:hc([[C,C],[z,z],[Ve,Ve],[Pt,Pt],[oe,oe],[$,$],[$,C],[C,$]],e=>e[0]),Multiply:[...hc([[C,C],[z,C],[C,z],[C,Ve],[C,Pt],[Ve,C],[Pt,C],[oe,C],[C,oe],[ir,Yg],[Yg,ir],[$,$],[$,C],[C,$]],mO),Dr([ir,Wg],e=>e[1]),Dr([Wg,ir],e=>e[0])],DotMultiply:[...hc([[Ve,Ve],[Pt,Pt],[oe,oe]],C),...hc([[C,C],[z,C],[C,z],[C,Ve],[Ve,C],[C,Pt],[Pt,C],[oe,C],[C,oe],[ir,Yg],[Yg,ir],[$,$],[$,C],[C,$]],mO),Dr([ir,Wg],e=>e[1]),Dr([Wg,ir],e=>e[0])],CrossMultiply:[...hc([[Pt,Pt],[oe,oe]],e=>e[0]),...hc([[C,C],[z,C],[C,z],[Ve,C],[C,Ve],[Pt,C],[C,Pt],[ir,Yg],[Yg,ir],[$,$],[$,C],[C,$]],mO),Dr([ir,Wg],e=>e[1]),Dr([Wg,ir],e=>e[0])],Divide:hc([[C,C],[z,C],[Ve,C],[Pt,C],[oe,C],[$,$],[$,C],[C,$]],e=>e[0]),Exponent:[Dr(wf,C)],"Comparator['=']":[Dr(wf,tt)],"Comparator['>']":[Dr(wf,tt)],"Comparator['<']":[Dr(wf,tt)],"Comparator['>=']":[Dr(wf,tt)],"Comparator['<=']":[Dr(wf,tt)],ComparatorChain:hc([{type:"variadic",initial:[C,C],rest:C}],tt),PercentOf:[Dr(wf,C)],Norm:hc([[C],[z],[oe],[Ve],[Pt]],C),ListAccess:Wj};function hc(e,t){return e.map(r=>St(r,t))}function hE(e,t,r){if(t instanceof gu){let n=r.filter(o=>o!==void 0);if(n.length===0)return;let i=fh(n);return xe(i)&&i!==vn?Mp([Dr({type:"variadic",initial:[],rest:It(i)},i)],r):[]}else if(t instanceof Tn||t instanceof Ip||t instanceof Ea){let n=t instanceof Ea?t.args[1]._symbol:t._symbol;if(!n)return;let i=qx(e,n);return i?Mp(i,r):void 0}else if(t instanceof wa){let[n,i,o]=r,a=i!==void 0&&o!==void 0?Jd(i,o):void 0;!a&&o===C&&t.args[2]instanceof Yr&&t.args[2].isNaN()&&(o=void 0);let s;if(a!==void 0)s=a;else if(i!==void 0)s=i;else if(o!==void 0)s=o;else return;xe(s)&&(s=It(s));let c=ei(s)?dc(s):s;return Mp([Dr([dc(tt),c,c],s)],[r[0],i,o])}else if(e.is3dProduct()&&t instanceof yp){let n=[...hO.DotMultiply,St([z,z],C)];return Mp(n,r)}else if(t instanceof Gc){let n=[Dr({type:"variadic",initial:[nr],rest:nr},nr),St([C,C],z)];return e.is3dProduct()&&n.push(St([C,C,C],oe)),Mp(n,r)}else if(t instanceof mp){let n=[Dr({type:"variadic",initial:[nr],rest:nr},nr)],i=r.filter(o=>o!==void 0&&o!==C);if(i.length>0){let o=fh(i);xe(o)&&o!==vn&&n.push(Dr({type:"variadic",initial:[],rest:It(o)},o))}return Mp(n,r)}else if(t instanceof _l){let n=t.symbol,i;switch(n){case"x":case"y":i=hc([[z],[oe]],C);break;case"z":{i=hc([[oe]],C);break}default:{let o=n;throw new Error(`Programming Error: unexpected named coordinate: '${o}'.`)}}return Mp(i,r)}else if(t.type in hO&&r.some(n=>n!==void 0)){let n=hO[t.type];return n?Mp(n,r):void 0}}function Mp(e,t){return e.filter(r=>r.matches(t))}function xq(e,t,r,n,i,o){var E,I,S,D;if(!bh(r)&&!yh(r)||Sp(r))return;let a,s=!1,c=!1,l=0,u=[],d=[],f=i.map(O=>e.getInstruction(O).valueType),g=bh(r)?pu[r]:void 0;if(g&&(s=g.isSeeded,a=void 0,u.push(...g.getSignatures(t)),l=(I=(E=g.defaultArguments)==null?void 0:E.length)!=null?I:0,d=yE(u,f,l),c=g.allowDotCall),d.length===0&&(g!=null&&g.fallthroughUnlessDistribution)&&f.length>0&&Le(f[0],cr))u=u.filter(O=>{let _=O.argTypeAtIndex(0);return _===void 0?!1:Lm(cr,_)}),d=[];else if(yh(r)&&d.length===0){let O=Xn[r];a=O.tag,u.push(...WA(r)),l=(D=(S=O.defaultArguments)==null?void 0:S.length)!=null?D:0,d=yE(u,f,l),c=c||O.allowDotCall}let y=Math.min(...u.map(O=>O.minArity)),x=Math.max(...u.map(O=>{var _;return(_=O.maxArity)!=null?_:1/0})),b=i,w=i;if(s&&(w=b=i.slice(1),y-=1,x-=1),o){if(!c)throw dx(n);let O=e.getInstruction(b[0]).valueType;if(!xe(O)&&O!==Mr&&O!==Pt&&O!==cr&&O!==In&&(O===z||!Am(O))&&r!=="real"&&r!=="imag")throw gM(n,dt(O),{blockExport:e.areAllArgsConstant([b[0]])});n="."+n,w=b.slice(1),y-=1,x-=1}if((t.isGeometryEnabled()||t.is3dPolicy())&&r==="length"&&w.length===1&&xe(e.getInstruction(w[0]).valueType)){let O=t.is3dPolicy()?pM:dM;if(d.length===0)throw O(n,yu(e,w)[0],{blockExport:e.areAllArgsConstant(w)});if(w.length===1&&e.getInstruction(w[0]).valueType===Rt)throw O(n,yu(e,w)[0],{blockExport:e.areAllArgsConstant(w)})}if(!(d.length>0))throw yO(e,{symbol:r,errorSymbol:n,providedArgs:w,argsWithoutSeed:b,isDotCall:o,minArity:y,maxArity:x,defaultArgumentCount:l,builtInTag:a,signatures:u})}function yO(e,{symbol:t,errorSymbol:r,providedArgs:n,argsWithoutSeed:i,isDotCall:o,minArity:a,maxArity:s,defaultArgumentCount:c,builtInTag:l,signatures:u}){if(l==="doubleReducer"&&n.length===2){if(!xe(e.getInstruction(n[0]).valueType)||!xe(e.getInstruction(n[1]).valueType))throw Tx(t,{blockExport:e.areAllArgsConstant(n)})}else if(l==="parameterizedReducer"&&!o&&n.length===2&&!xe(e.getInstruction(n[0]).valueType))throw o_(t,{blockExport:e.areAllArgsConstant([n[0]])});if(t==="logbase"&&n.length!==2)return fc("log",1,n.length-1,{includeUsageExample:!0});if(t==="random")return QM();if(n.length<a||n.length>s){let{dotMinArityExampleArgs:x,dotMaxArityExampleArgs:b,minArityExampleArgs:w,maxArityExampleArgs:E}=Xj(t),I,S;if(n.length<a?(S=a-c,o&&x?I=r+x:w&&(I=r+w)):(S=s,o&&b?I=r+b:E&&(I=r+E)),o&&(l==="parameterizedReducer"||t==="pdf"||t==="cdf"))return fc(r,S,n.length,{includeUsageExample:!0,usageExample:I});if(l==="reducer"&&n.length===0)return iD(r);if(l==="doubleReducer")return mx(r);if(l==="parameterizedReducer")return nD(r);if(l==="color")return tD(r);if(bh(t))switch(t){case"pdf":return KM();case"cdf":return n.length<a?jM():ZM();case"tdist":return JM();case"length":case"round":case"floor":case"ceil":case"abs":case"mod":case"gcd":case"lcm":case"midpoint":case"segment":case"vector":case"sphere":case"distance":case"circle":case"center":case"radius":case"glider":case"intersection":case"strictintersection":case"parallel":case"perpendicular":case"anglebisector":case"start":case"end":case"angle":case"directedangle":case"angles":case"directedangles":case"apply":case"translate":case"reflect":case"dilate":case"rotate":case"normaldist":case"poissondist":case"binomialdist":case"uniformdist":case"total":case"mean":case"median":case"stdev":case"var":case"quantile":case"sort":case"shuffle":case"join":case"unique":case"polygon":case"coterminal":case"real":case"imag":case"conj":case"exp":case"sin":case"cos":case"tan":case"sinh":case"cosh":case"tanh":case"sec":case"csc":case"cot":case"sech":case"csch":case"coth":case"arccot":case"arcsinh":case"arccsch":case"arctan":return bq(r,S,u,n.map(O=>e.getInstruction(O).valueType),I);case"points":case"lines":case"circles":case"polygons":case"rays":case"vectors":case"arcs":throw Xa(r);case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":throw Ie(`Unexpected arity error for ${t}`);default:let D=t;throw new Error(`Unexpected compiler function ${D}`)}return bq(r,S,u,n.map(D=>e.getInstruction(D).valueType),I)}if(t==="polygon"&&n.length===2&&e.getInstruction(n[0]).valueType===C&&e.getInstruction(n[1]).valueType===C)return fx();let d=[],f=[];for(let x=0;x<i.length;x++){let b=i[x],w=l!==void 0&&l!=="doubleReducer"&&l!=="never-broadcast"&&!(l==="parameterizedReducer"&&x===0)&&t!=="polygon",E=e.getInstruction(b).valueType;xe(E)&&w&&(E=It(E)),d.push(E),f.push(dt(E))}let g=e.areAllArgsConstant(i),y=vq(t);if(y&&!Tq(t,u,d)){let x=new q(y);return g?x:x.allowExport()}return ra(r,f,{blockExport:g})}function bq(e,t,r,n,i){let o=vq(e);return o&&!Tq(e,r,n)?new q(o):fc(e,t,n.length,{includeUsageExample:!o,usageExample:i})}function Xj(e){return bh(e)?pu[e]:yh(e)?Xn[e]:{}}function yE(e,t,r){return e.filter(n=>n.matches(t)&&t.length+r>=n.minArity)}function vq(e){switch(e){case"midpoint":return L("shared-calculator-error-required-arguments-midpoint");case"intersection":return L("shared-calculator-error-required-arguments-intersection");case"segment":case"line":case"ray":case"distance":return L("shared-calculator-error-required-arguments-points",{symbol:e,count:2});case"parallel":case"perpendicular":return L("shared-calculator-error-required-arguments-perpendicular",{symbol:e});case"circle":return L("shared-calculator-error-required-arguments-circle");case"arc":case"angle":case"directedangle":return L("shared-calculator-error-required-arguments-points",{symbol:e,count:3});case"triangle":return L("shared-calculator-error-required-arguments-triangle");case"polygon":return L("shared-calculator-error-required-arguments-polygon");case"glider":return L("shared-calculator-error-required-arguments-glider");case"vector":return L("shared-calculator-error-required-arguments-vector");case"length":return L("shared-calculator-error-required-arguments-length");case"area":case"perimeter":case"vertices":case"angles":case"directedangles":case"segments":return L("shared-calculator-error-required-arguments-area",{symbol:e});case"radius":case"center":return L("shared-calculator-error-required-arguments-radius",{symbol:e});case"anglebisector":case"coterminal":return L("shared-calculator-error-required-arguments-coterminal",{symbol:e});case"supplement":return L("shared-calculator-error-required-arguments-supplement");case"start":case"end":return L("shared-calculator-error-required-arguments-start",{symbol:e});case"dilate":case"rotate":return L("shared-calculator-error-required-arguments-dilate",{symbol:e});case"reflect":return L("shared-calculator-error-required-arguments-reflect");case"translate":return L("shared-calculator-error-required-arguments-translate");case"sphere":return L("shared-calculator-error-required-arguments-sphere")}}function Tq(e,t,r){return e==="polygon"&&(t=t.filter(i=>i.maxArity!==1)),t.some(i=>i.maxArity===0||r.length<i.minArity?!1:r.every((o,a)=>{let s=i.argTypeAtIndex(a);return s===void 0?!0:hS(o,s)}))}function yu(e,t){let r=[];for(let n of t)r.push(dt(e.getInstruction(n).valueType));return r}function Dp(e,t){let r=[];for(let n of t){let i=e.getInstruction(n).valueType,o=xe(i)?It(i):i;r.push(dt(o))}return r}function Pr(e,t,r){return Le(e.getInstruction(t).valueType,r)}function _p(e,t,r,n){var d,f;let i=r.type;if(i==="FunctionCall"||i==="SeededFunctionCall"||i==="DotAccess"){let g,y;if(r instanceof Ea&&(r.args[1]instanceof Ut||r.args[1]instanceof Tn))g=r.args[1]._symbol,y=(d=r.args[1]._errorSymbol)!=null?d:g;else if(r instanceof Tn||r instanceof Ip)g=r._symbol,y=(f=r._errorSymbol)!=null?f:g;else return;if(g==="polygon"&&t.polygonUnsupportedPreferTriangle())throw rw();if(g==="length"&&!t.isGeometryEnabled()&&!t.is3dPolicy()&&n.length===0)throw rD();xq(e,t,g,y,n,r instanceof Ea);return}let o=n.map(g=>e.getInstruction(g).valueType),a=hE(t,r,o);if(!a)return;let s=Math.min(...a.map(g=>g.minArity));if(a.length>0&&n.length>=s)return;let c=r instanceof _l&&r.symbol==="z",l=Kj(i,o,{specifyPointDimensions:c}),u=e.areAllArgsConstant(n);switch(i){case"Add":throw ox(l,{blockExport:u});case"Subtract":throw ax(l,{blockExport:u});case"CrossMultiply":throw t.is3dProduct()&&o.length===2&&(Le(o[0],z)&&Le(o[1],z)||Le(o[0],C)&&Le(o[1],oe)||Le(o[0],oe)&&Le(o[1],C))?QS(l,{blockExport:u}):Fg(l,{blockExport:u});case"DotMultiply":throw Fg(l,{blockExport:u});case"Multiply":{if(t.is3dProduct()&&o.length===2){if(Le(o[0],oe)&&Le(o[1],oe))throw tM(l,{blockExport:u});if(Le(o[0],z)&&Le(o[1],z))throw eM(l,{blockExport:u})}throw Fg(l,{blockExport:u})}case"Divide":throw sx(l,{blockExport:u});case"Exponent":throw cx(l,{blockExport:u});case"Negative":throw lx(l,{blockExport:u});case"Comparator['=']":case"Comparator['>']":case"Comparator['<']":case"Comparator['>=']":case"Comparator['<=']":case"ComparatorChain":throw iM(l,{blockExport:u});case"Or":throw aM(l,{blockExport:u});case"Piecewise":throw Le(o[0],tt)?MM([dt(e.getInstruction(n[1]).valueType),dt(e.getInstruction(n[2]).valueType)],{blockExport:e.areAllArgsConstant([n[1],n[2]])}):A1(l,{blockExport:e.areAllArgsConstant([n[0]])});case"Restriction":throw A1(l,{blockExport:u});case"List":case"TableColumnValue":{wq(e,n);break}case"ListAccess":throw ux(l,{blockExport:u});case"Norm":throw ra("abs",l,{blockExport:u});case"ParenSeq":{let g=o.indexOf(nr)!==-1,y=o.some(b=>b!==nr);if(g&&y)throw L1([dt(o[0]),dt(o[1])],{blockExport:u});if(o.length!==2&&(!t.is3dProduct()||o.length!==3)){let b=t.is3dPolicy()?3:2;throw sD(b)}let x=o.find(b=>!Le(b,C));throw x!==void 0?sM(dt(x),{blockExport:u}):Ie("Unexpected error type checking ParenSeq")}case"BareSeq":{if(o.length===0)throw yx();if(o.length===1)throw Ie("Length-1 BareSeq is impossible");let g=o[0],y=o.find(x=>x!==g);if(y)throw L1([dt(g),dt(y)],{blockExport:u});if(g===C)throw n.length===2?oD():aD();wq(e,n);break}case"NamedCoordinateAccess":throw cM(l,"."+r.symbol,{blockExport:u});case"Ans":case"Constant":case"ImaginaryUnit":case"Assignment":case"RecursiveFunctionBaseCase":case"MixedNumber":case"Identifier":case"Construction":case"Range":case"Sum":case"Product":case"Integral":case"ListComprehension":case"FunctionExponent":case"FunctionFactorial":case"Prime":case"Derivative":case"UpdateRule":case"Substitution":case"FunctionDefinition":case"Slider":case"RegressionParameter":case"Seed":case"ExtendSeed":case"PercentOf":return;default:{let g=i;throw new Error(`Unexpected node type: ${g}`)}}}function wq(e,t){if(t.length===0)return;let r=e.getInstruction(t[0]).valueType;if(!ei(r))throw Gg([dt(r)],{blockExport:kt(e.getInstruction(t[0]))});let n=e.areAllArgsConstant(t);for(let i of t){let o=e.getInstruction(i).valueType;if(!ei(o))throw Gg([dt(o)],{blockExport:n});if(o!==r)throw px({blockExport:n})}}function Kj(e,t,r){switch(e){case"Add":case"Subtract":case"Multiply":case"Divide":case"Exponent":case"Negative":case"Comparator['<']":case"Comparator['>']":case"Comparator['=']":case"Comparator['<=']":case"Comparator['>=']":case"NamedCoordinateAccess":return t.map(n=>dt(n,r));case"ComparatorChain":{for(let n=0;n<t.length;n++)if(!Li(t[n],C)&&!Li(t[n],ke))return n===0?[dt(t[n]),dt(t[n+1])]:[dt(t[n-1]),dt(t[n])];return t.map(n=>dt(n))}case"ListAccess":case"Constant":case"ImaginaryUnit":case"MixedNumber":case"Identifier":case"Ans":case"List":case"TableColumnValue":case"Range":case"Construction":case"ParenSeq":case"BareSeq":case"Norm":case"Sum":case"Product":case"Integral":case"ListComprehension":case"FunctionExponent":case"FunctionFactorial":case"Prime":case"Piecewise":case"Restriction":case"Derivative":case"UpdateRule":case"Substitution":case"Assignment":case"RecursiveFunctionBaseCase":case"FunctionDefinition":case"Slider":case"RegressionParameter":case"Seed":case"ExtendSeed":case"DotMultiply":case"CrossMultiply":case"Or":case"PercentOf":return t.map(n=>dt(n));default:{let n=e;throw new Error(`Unexpected node type: ${n}`)}}}function Eq(e,t){let r=e.getInstruction(t);if(pt(r))return;let n=Dr(bO(e,r).expectedTypes,Qu);if(r.type===49){for(let c of r.args){let l=e.getInstruction(c).valueType;if(!Le(l,C)&&!Le(l,z)&&!Le(l,oe)&&!Le(l,gn)&&!Le(l,et)&&!Le(l,Ye)&&!Le(l,Re)&&!Le(l,ot)&&!Le(l,Ve)&&!Le(l,We)&&!Le(l,Oe)&&!Le(l,st)&&!Le(l,In)&&!Le(l,$e))throw OM(dt(l))}let s={};for(let c of r.symbols){if(s[c])throw NM(c);s[c]=!0}return}let i=[];for(let s=0;s<r.args.length;s++){let c=e.getInstruction(r.args[s]).valueType,l=n.argTypeAtIndex(s);(l===void 0||!Lm(c,l))&&i.push(r.args[s])}if(i.length===0)return;let o=yu(e,r.args),a=e.areAllArgsConstant(r.args);switch(r.type){case 32:throw oM(o,{blockExport:a});case 21:{let s=e.getInstruction(r.args[0]).valueType,c=e.getInstruction(r.args[1]).valueType;if(s!==C)throw TM([dt(s)],{blockExport:a});if(c!==C)throw wM([dt(c)],{blockExport:a});return}case 22:{let s=e.getInstruction(r.args[1]).valueType;throw EM([dt(s)],{blockExport:a})}case 44:case 31:case 15:case 16:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 25:case 26:case 27:case 28:case 29:case 38:case 39:case 40:case 41:case 37:case 42:case 33:case 48:case 47:case 23:case 24:case 19:case 20:case 50:case 51:case 53:case 54:case 55:throw Ie(`Invalid argument types for opcode ${r.type}`);default:{let s=r;throw new Error(`Unexpected opcode: ${s.type}`)}}}function bO(e,t,r=!1){switch(t.type){case 8:case 9:case 10:case 11:return r&&t.args.length>0&&e.getInstruction(t.args[0]).valueType===z?{expectedTypes:[z,z]}:{expectedTypes:[C,C]};case 12:case 13:case 25:case 26:case 27:case 28:case 29:return{expectedTypes:[C,C]};case 14:return{expectedTypes:[C]};case 31:return{expectedTypes:[tt,tt]};case 32:return{expectedTypes:[tt,tt]};case 33:return{expectedTypes:[tt,t.valueType,t.valueType]};case 15:return{expectedTypes:Fb[t.valueType]};case 21:return{expectedTypes:[C,C]};case 22:{let n=e.getInstruction(t.args[1]).valueType;return Bb(n)?{expectedTypes:[C,n]}:{expectedTypes:[C,C]}}case 38:{let n=t.valueType,i=It(n);return{expectedTypes:{type:"variadic",initial:[],rest:i}}}case 39:case 40:case 41:return{expectedTypes:[vn,C]};case 37:{let n=t.symbol,i=Xn[n],o=i.argumentTypes;return i.tag==="reducer"&&!jj(e,t.args)&&Array.isArray(o)&&typeof o[0]=="number"&&xe(o[0])?{isReducerWithNoListArgs:!0,expectedTypes:{type:"variadic",initial:[],rest:It(o[0])}}:{expectedTypes:o}}case 44:{let n=e.getInstruction(t.args[1]).valueType;return{expectedTypes:[lr,n]}}case 47:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 23:return{expectedTypes:[C]};case 19:return{expectedTypes:t.args.map(n=>{let i=e.getInstruction(n).valueType;return i===tt||(t.callData.type==="sum"?Bb(i):XG(i))?i:C})};case 50:{let n=t.callData.parameterSymbols.length,i=[];for(let o=0;o<n;o++)i.push(C,C);return{expectedTypes:i}}case 24:case 20:case 51:{let n=[C];for(let i=1;i<t.args.length;i++)n.push(e.getInstruction(t.args[i]).valueType);return{expectedTypes:n}}case 42:return{expectedTypes:t.args.map(()=>C)};case 48:case 49:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 53:return{expectedTypes:[t.valueType]};case 54:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 55:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 16:return{expectedTypes:[WG]};default:{let n=t;throw new Error(`Unexpected opcode: ${n.type}`)}}}function jj(e,t){for(let r of t)if(xe(e.getInstruction(r).valueType))return!0;return!1}function Iq(e){let t=e.getReturnIndex(),r=e.getInstruction(t);if(pt(r))return t;let n=bO(e,r),i=Dr(n.expectedTypes,Qu),o=xO(e,r.args,[i]);if(n.isReducerWithNoListArgs){let a=Jj(e,o.didCoerce?o.args:r.args),s=Qn(n.expectedTypes.rest);if(Nc(a,s)){o.didCoerce?e.replaceInstructionWithNoop(t):e.popInstruction();let c=e.List(r.args);return e.copyInstructionWithArgs(r,[c])}}else o.didCoerce&&(e.replaceInstructionWithNoop(t),e.copyInstructionWithArgs(r,o.args));return e.getReturnIndex()}function xO(e,t,r){let n=!1,i=[];for(let o=0;o<t.length;o++){let a=r1(r,o),s=t[o],c=e.getInstruction(s).valueType,l=s;a.every(u=>!Nc(c,u))&&(Le(a[0],C)?l=bu(e,s):Le(a[0],$)&&(l=Zj(e,s))),l!==s&&(n=!0),i.push(l)}return n?{didCoerce:n,args:i}:{didCoerce:!1}}function bu(e,t){let r=e.getInstruction(t);return r.valueType===Rt?t:Le(r.valueType,st)?Pq(e,t):Le(r.valueType,$e)?Cq(e,t):Le(r.valueType,ir)?e.Piecewise([e.NativeFunction("restrictionToBoolean",[t]),e.Constant(1),e.Constant(NaN)]):Le(r.valueType,$)?e.NativeFunction("coerceComplexToReal",[t]):t}function Ef(e,t){let r=e.getInstruction(t);return r.valueType===Rt||Le(r.valueType,$)?t:bu(e,t)}function Zj(e,t){let r=e.getInstruction(t);if(r.valueType===Rt)return t;if(Le(r.valueType,C))return e.NativeFunction("coerceRealToComplex",[t]);if(Le(r.valueType,$))return t;if(Li(r.valueType,C)||Li(r.valueType,ke)){let n=bu(e,t);return e.NativeFunction("coerceRealToComplex",[n])}return t}function Jj(e,t){let r=e.getInstruction(t[0]).valueType;if(!ei(r))return vn;for(let n of t)if(e.getInstruction(n).valueType!==r)return vn;return Qn(r)}function bE(e,t,r){let n=e.getInstruction(r);if(!pt(n)){for(let a of n.args)if(!kt(e.getInstruction(a)))return!0}if(t<r)return!kt(e.getInstruction(t));let i=[!0];for(let a=r+1;a<=t;a++)i.push(!1);let o=[t];for(;o.length;){let a=o.pop();if(i[a-r])continue;i[a-r]=!0;let s=e.getInstruction(a);if(!pt(s))for(let c of s.args){let l=e.getInstruction(c);if(c<r){let u=e.getInstruction(c);if(u.type===4)continue;if(!kt(u))return!0}else{if(e.getInstruction(c).type===50)return!0;if(l.type===3)return!0;i[c-r]||o.push(c)}}}return!1}function Al(e,t,r){let n=di(e,t);if(n===void 0)throw new Error(`${r}
Non-constant instruction: "${gf(e,qo(e,t))}"`);return n}function di(e,t){let r=If(e,t,void 0,void 0);if(!(r<0))return r}function If(e,t,r,n){var s;let i=r&&r[t];if(i)return i;let o=e.getInstruction(t),a;switch(o.type){case 38:a=o.args.length;break;case 1:a=o.value.length;break;case 48:{a=(s=o.constantLength)!=null?s:-1;break}}return a===void 0&&(r=r||{},a=Qj(e,o,r,n||new Set)),r&&(r[t]=a),a}function Qj(e,t,r,n){switch(t.type){case 33:{let i=If(e,t.args[1],r,n),o=If(e,t.args[2],r,n);return i===o?i:-1}case 37:switch(t.symbol){case"elementsAt":return If(e,t.args[1],r,n);case"sortPerm":return If(e,t.args[0],r,n);case"shuffle":return If(e,t.args[1],r,n);default:return-1}case 55:{if(n&&n.has(t.args[0]))return-1;n.add(t.args[0]);let i=e.dereferenceFunctionHeader(t.args[0]);if(i!==void 0){let o=e.getInstruction(i);return If(e,o.args[1],r,n)}return-1}default:{if(xe(t.valueType))return-1;throw new Error(`Programming Error: cannot find the list length of ${Go(t.type)} ${dt(t.valueType)}.`)}}}function qo(e,t){let r=e.getInstruction(t);if(!xe(r.valueType))throw new Error(`Programming Error: cannot find the list length of ${e.printInstruction(t)}`);switch(r.type){case 38:return e.Constant(r.args.length);case 1:return e.Constant(r.value.length);case 48:{let n=e.getInstruction(r.args[0]);return e.getInstruction(n.args[0]).args[0]}case 37:switch(r.symbol){case"elementsAt":return qo(e,r.args[1]);case"sortPerm":return qo(e,r.args[0]);case"shuffle":return qo(e,r.args[1])}}return e.NativeFunction("count",[t])}function Xh(e,t){let r=[];for(let a of t)xe(e.getInstruction(a).valueType)&&r.push(a);if(r.length===0)return;if(r.length===1)return qo(e,r[0]);let n=[];for(let a of r)n.push(di(e,a));let i,o=1/0;for(let a=0;a<n.length;a++){let s=r[a],c=n[a];if(c===void 0)return e.NativeFunction("min",[e.List(r.map(l=>qo(e,l)))]);c<o&&(i=s,o=c)}return i!==void 0?qo(e,i):e.Constant(o)}function Yx(e,t,r){let n=e.getInstruction(t);if(xe(n.valueType)){let i=di(e,t);if(r=Math.floor(r),isNaN(r)||r<0||i!==void 0&&r>=i){let o=It(n.valueType);return e.NanOfType(o)}return n.type===38?n.args[r]:n.type===1&&xe(n.valueType)?e.ConstantOfType(It(n.valueType),n.value[r]):i!==void 0?e.InboundsListAccess([t,e.Constant(r+1)]):e.ListAccess([t,e.Constant(r+1)])}else throw new Error(`Cannot access elements of ${dt(n.valueType)}`)}function xE(e,t,r){let n=e.getInstruction(t);if(r.length===0)return e.ConstantOfType(n.valueType,[]);if(n.type===1&&xe(n.valueType)){let i=[],o=It(n.valueType);for(let a of r){let s=Math.floor(a);isNaN(s)||s<0||s>=Al(e,t,"Programming error: expected Constant list instruction to have constant length.")?i.push(na(o)):i.push(n.value[s])}return e.ConstantOfType(n.valueType,i)}else if(n.type===38){let i=[];for(let o of r){let a=Math.floor(o);if(isNaN(a)||a<0||a>=Al(e,t,"Programming error: expected List instruction to have constant length.")){let s=It(n.valueType);i.push(e.NanOfType(s))}else i.push(n.args[a])}return e.List(i)}else{let i=[],o=!0,a=di(e,t);for(let c of r){let l=Math.floor(c);i.push(e.Constant(l+1)),(isNaN(l)||l<0||a===void 0||l>=a)&&(o=!1)}let s=[t,e.List(i)];return o?e.InboundsListAccess(s):e.ListAccess(s)}}function To(e,t){let r=e.getInstruction(t);if(r.type!==48)return t;let n=r.args[0],i=e.getInstruction(n),o=i.args[0],a=!1;for(let c=o+1;c<n;c++){let l=e.getInstruction(c);if(l.type===40&&l.args[1]===o){a=!0;break}}if(!a)return t;let s=[];for(let c=o;c<=n+i.args.length-1;c++){let l=e.getInstruction(c);if(pt(l))s.push(e.copyInstruction(l));else{let u=[];for(let d of l.args)u.push(d>=o?s[d-o]:d);l.type===40?s.push(e.InboundsListAccess(u)):s.push(e.copyInstructionWithArgs(l,u))}}return e.getReturnIndex()}function vO(e,t){return!Zr(e)&&isNaN(e)||!Zr(t)&&isNaN(t)?[NaN,NaN]:[e,t]}function vE(e){return an(ae(e[0]),ae(e[1]))}function Sq([e,t]){return Zr(e)&&Zr(t)}function Mq(e,t){if(!Sq(e)||!Sq(t))return rf(vE(e),vE(t));let[r,n]=e,[i,o]=t,a=bo(Pi(i,i),Pi(o,o)),s=bo(Pi(r,i),Pi(n,o)),c=Ro(Pi(n,i),Pi(r,o)),l=yo(s,a),u=yo(c,a);return!Zr(l)||!Zr(u)?rf(vE(e),vE(t)):vO(l,u)}function TO(e,t,r){let n;return TE(t)?n=EO(t,r):n=_q(t,r),e.ConstantOfType(t,n)}function wO(e){return TE(e)||Dq(e)}function TE(e){switch(e){case Rt:case ke:case vi:case Dn:case gs:case on:case zn:case wi:case ci:case li:case Ii:case Ei:case ti:case Un:case ri:case ji:case Qi:case Ji:case No:case Zi:case uo:case Lo:case Oo:return!0;default:return!1}}function Dq(e){switch(e){case C:case tt:case $:case ir:case z:case Ye:case We:case Oe:case ot:case Ve:case Re:case et:case st:case $e:case oe:case Pt:case Hn:case $n:case Mr:case gn:case In:case xt:case nr:case lr:return!0;default:return!1}}function EO(e,t){if(e===Rt)return[];let r=It(e);if(!Dq(r))throw new Error(`Programming error: unexpected element type ${xr(r)} for list type ${xr(e)}.`);let n=[];for(let i=0;i<t.length;i++){let o=_q(r,t[i]);n.push(o)}return n}function _q(e,t){if(e===C)return Et(t,1);if(e===z||e===$){let[r,n]=t;return[Et(r,1),Et(n,1)]}else if(e===oe){let[r,n,i]=t;return[Et(r,1),Et(n,1),Et(i,1)]}else return t}function IO(e,t){return bo(e,t)}function CO(e,t){return Ro(e,t)}function PO(e,t){return Pi(e,t)}function SO(e,t){return yo(e,t)}function Wx(e,t){return ae(e)===Math.E?Math.exp(ae(t)):Gx(e,t)}var tZ=Wx;function MO(e){return ko(e)}function rZ(e,t){return t[e]}function DO(e,t){return ae(e)===ae(t)}function _O(e,t){return ae(e)<ae(t)}function AO(e,t){return ae(e)>ae(t)}function OO(e,t){return ae(e)<=ae(t)}function LO(e,t){return ae(e)>=ae(t)}function Oq(e,t){return e||t}function Lq(e,t){return e&&t}function nZ(e,t,r){let n=Math.floor(ae(r))-1;return!isFinite(n)||n<0||n>=t.length?na(e):t[n]}function NO(e,t,r,n){Zr(n)&&(n=ae(n));let i=r===C||r===lr?n:bA(r,n);return`${t}::${e}${i}`}function RO(e,t){switch(e){case"mod":return v3(t[0],t[1]);case"abs":return x3(t[0]);case"sqrt":return Ow(t[0]);case"nthroot":return Lw(t[0],t[1]);case"total":return T3(t[0]);case"count":return t[0].length;case"validateRangeLength":{let r=t[0],n=t[1],i=t[2],o=t[3],a=PA(r,n,i,o);if(a===0)throw wx();return a}case"validateSampleCount":{let r=Ml(t[0]),n=SA(r);if(n===0&&r!==0)throw E_();return n}case"select":case"elementsAt":case"uniquePerm":case"sortPerm":{let r=Xn[e];return $s[r.symbol].apply(null,t)}case"complex":return vO(t[0],t[1]);case"complexDivide":return Mq(t[0],t[1]);default:{let r=Xn[e];return(r.module==="Math"?Math:$s)[r.symbol].apply(null,Ml(t))}}}function Nq(e,t){let r=Array(t+1);return yr(e,t,r)}function Rq(e,t,r){let n=Array(t+1);for(let i=0;i<r.length;i++)n[i]=r[i];return yr(e,t,n)}function kq(e,t,r){if(t.constantLength)return t.constantLength;let n=t.args[0],o=e.getInstruction(n).args[0],a=e.getInstruction(o);return ae(yr(e,a.args[0],r))}function Vq(e,t,r,n){let i=e.getInstruction(t),o=kq(e,i,n);if(!isFinite(r)||r<0||r>=o)return na(It(i.valueType));let a=i.args[0],s=t-a,c=e.getInstruction(a),l=c.args[0],u=c.args[s];n[l]=r+1;let d=yr(e,u,n);for(let f=l;f<=a;f++)n[f]=void 0;return d}function iZ(e,t,r){let n=e.getInstruction(t),i=n.args[0],o=e.getInstruction(i).args[0];if(aZ(e,o+1,i-1)&&TE(n.valueType)){let c=e.copy(),l=Kh(c);return EO(n.valueType,l)}let a=kq(e,n,r),s=[];for(let c=a-1;c>=0;c--)s[c]=Vq(e,t,c,r);return s}function Fq(e,t,r){let n=yr(e,t.args[1],r),i=t.args[0],o=e.getInstruction(i);if(o.type===48)return Vq(e,i,ae(n)-1,r);if(o.type===33){let a=yr(e,o.args[0],r);return Fq(e,{...t,args:[a?o.args[1]:o.args[2],t.args[1]]},r)}else{let a=yr(e,t.args[0],r);return nZ(t.valueType,a,n)}}function yr(e,t,r){let n=r[t];if(n!==void 0)return n;let i=oZ(e,t,r);return typeof i=="number"&&i===Math.floor(i)&&(i=Et(i,1)),r[t]=i,i}function oZ(e,t,r){let n=e.getInstruction(t);switch(n.type){case 1:return n.value;case 8:return IO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 9:return CO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 10:return PO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 11:return SO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 12:return Wx(yr(e,n.args[0],r),yr(e,n.args[1],r));case 13:return tZ(yr(e,n.args[0],r),yr(e,n.args[1],r));case 14:return MO(yr(e,n.args[0],r));case 15:return n.args.map(o=>yr(e,o,r));case 16:return rZ(n.index,yr(e,n.args[0],r));case 25:return DO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 26:return _O(yr(e,n.args[0],r),yr(e,n.args[1],r));case 27:return AO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 28:return OO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 29:return LO(yr(e,n.args[0],r),yr(e,n.args[1],r));case 31:return yr(e,n.args[0],r)||yr(e,n.args[1],r);case 32:return yr(e,n.args[0],r)&&yr(e,n.args[1],r);case 44:return NO(n.tag,yr(e,n.args[0],r),e.getInstruction(n.args[1]).valueType,yr(e,n.args[1],r));case 33:return yr(e,n.args[0],r)?yr(e,n.args[1],r):yr(e,n.args[2],r);case 37:{let o=[];for(let a of n.args)o.push(yr(e,a,r));return RO(n.symbol,o)}case 38:{let o=[];for(let a of n.args)o.push(yr(e,a,r));return o}case 39:case 40:case 41:return Fq(e,n,r);case 48:return iZ(e,t,r);case 47:{let o=n.args[0],a=t-o,c=e.getInstruction(o).args[a],l=Aq(e,{endIndex:o,returnIndex:c,resultIndex:t},r);return Kh(l)}case 55:{let o=n.args[0],s=e.getInstruction(o).endIndex,l=e.getInstruction(s).args[0],u=Aq(e,{endIndex:s,returnIndex:l,resultIndex:t},r);return Kh(u)}case 19:case 20:case 21:case 22:case 23:case 24:case 42:case 0:case 2:case 3:case 49:case 50:case 51:case 4:case 53:case 54:throw new Error(`Programming Error: cannot interpret opcode ${n.type}`);default:let i=n;throw new Error(`Programming Error: unexpected opcode ${i.type}`)}}function Aq(e,t,r){let n=t.endIndex,i=t.returnIndex,o=t.resultIndex,a=e.getInstruction(n).args[0],s=[];s[i]=!0;let c=i;e.getInstruction(o).type===55&&(s[o]=!0,c=o);for(let g=c;g>=a;g--){if(!s[g])continue;let y=e.getInstruction(g);if(!pt(y))for(let x of y.args)x<a||x>n?yr(e,x,r):s[x]=!0}let u=e.copy();u.truncate(a);for(let g=0;g<a;g++){let y=r[g],x=e.getInstruction(g);if(y!==void 0){let b=x.valueType;u.replaceInstructionWithConstant(g,{type:1,valueType:b,value:y})}}u.reopenAllBlocks();let d=[];for(let g=a;g<o;g++){let y=e.getInstruction(g);if(pt(y))d.push(u.copyInstruction(y));else{let x=[];for(let b of y.args)x.push(b<a?b:d[b-a]);y.type===40?d.push(u.InboundsListAccess(x)):d.push(u.copyInstructionWithArgs(y,x))}}u.Noop();let f=e.getInstruction(o);if(f.type===47)u.replaceInstructionWithBlockVarOrFunctionCall(u.getReturnIndex(),{type:47,valueType:f.valueType,args:[n<a?n:d[n-a]]});else if(f.type===55)u.replaceInstructionWithBlockVarOrFunctionCall(u.getReturnIndex(),{type:55,valueType:f.valueType,args:f.args.map(g=>g<a?g:d[g-a])});else throw new Error(`Programming error: unexpected opcode ${Go(f.type)}`);return u}function aZ(e,t,r){let n=[];for(let o=0;o<=t;o++)n.push(!1);let i=[];for(let o=t+1;o<=r;o++)i.push(o);for(;i.length;){let o=i.pop();if(n[o])continue;n[o]=!0;let a=e.getInstruction(o);if(a.type===55)return!0;if(!pt(a))for(let s of a.args)n[s]||i.push(s)}return!1}function Kh(e){let t=e.getCompiledFunction();return t.executionMetadata.recursiveFunctionCache=new nh,t.executionMetadata.iterativeRecursionOutputs={},t.fn()}function qq(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be constant collapsed");let t=e.getInstruction(e.getReturnIndex());if(pt(t))return e.getReturnIndex();switch(t.type){case 8:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(IO(n.value,i.value))):n.type===1&&ae(n.value)===0?(e.popInstruction(),t.args[1]):i.type===1&&ae(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 9:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(CO(n.value,i.value))):n.type===1&&ae(n.value)===0?(e.popInstruction(),e.Negative([t.args[1]])):i.type===1&&ae(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 10:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(PO(n.value,i.value))):n.type===1&&ae(n.value)===1?(e.popInstruction(),t.args[1]):i.type===1&&ae(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 11:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(SO(n.value,i.value))):i.type===1&&ae(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 12:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);if(n.type===1&&i.type===1)return e.popInstruction(),e.Constant(Wx(n.value,i.value));if(n.type===1&&n.valueType===C){let o=ae(n.value);if(o===Math.E)return e.popInstruction(),e.NativeFunction("exp",[t.args[1]]);if(o>0)return e.popInstruction(),e.RawExponent(t.args)}if(i.type===1&&i.valueType===C){let o=ae(i.value);if(o===1)return e.popInstruction(),t.args[0];if(o===Math.floor(o))return e.popInstruction(),e.RawExponent(t.args);if(Zr(i.value)){let{n:a,d:s}=i.value;if(s%2===1){e.popInstruction();let c=e.RawExponent([e.NativeFunction("abs",[t.args[0]]),t.args[1]]);return a%2===0?c:e.Multiply([e.NativeFunction("sign",[t.args[0]]),c])}}}return e.getReturnIndex()}case 13:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(Wx(n.value,i.value))):i.type===1&&ae(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 14:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),e.Constant(MO(n.value))):e.getReturnIndex()}case 25:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(tt,DO(n.value,i.value))):e.getReturnIndex()}case 26:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(tt,_O(n.value,i.value))):e.getReturnIndex()}case 27:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(tt,AO(n.value,i.value))):e.getReturnIndex()}case 28:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(tt,OO(n.value,i.value))):e.getReturnIndex()}case 29:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(tt,LO(n.value,i.value))):e.getReturnIndex()}case 31:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(tt,Oq(n.value,i.value))):n.type===1?(e.popInstruction(),n.value?t.args[0]:t.args[1]):i.type===1?(e.popInstruction(),i.value?t.args[1]:t.args[0]):e.getReturnIndex()}case 32:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(tt,Lq(n.value,i.value))):n.type===1?(e.popInstruction(),n.value?t.args[1]:t.args[0]):i.type===1?(e.popInstruction(),i.value?t.args[0]:t.args[1]):e.getReturnIndex()}case 33:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),n.value?t.args[1]:t.args[2]):e.getReturnIndex()}case 16:{let n=e.getInstruction(t.args[0]),i=t.index;return n.type===15?(e.popInstruction(),n.args[i]):n.type===1?(e.popInstruction(),e.ConstantOfType(t.valueType,n.value[i])):e.getReturnIndex()}case 38:case 15:{if(Gq(e,t.args)){e.popInstruction();let n=[];for(let i of t.args)n.push(e.getInstruction(i).value);return e.ConstantOfType(t.valueType,n)}return e.getReturnIndex()}case 39:case 41:{let n=t.args[0],i=e.getInstruction(n),o=e.getInstruction(t.args[1]),a=di(e,n);if(a===0)return e.popInstruction(),e.NanOfType(t.valueType);if(i.type===33&&o.type===1){let s=t.type===39?e.ListAccess([i.args[1],t.args[1]]):e.InboundsListAccess([i.args[1],t.args[1]]),c=t.type===39?e.ListAccess([i.args[2],t.args[1]]):e.InboundsListAccess([i.args[2],t.args[1]]);return e.Piecewise([i.args[0],s,c])}if(i.type===48){e.popInstruction();let s=i.args[0],c=n-s,l=e.getInstruction(s),u=l.args[0],d,f;if(t.type===41)d=t.args[1];else if(o.type===1&&o.valueType===C&&a!==void 0){let y=ae(o.value),x=Math.floor(y);if(x<1||x>a)return e.NanOfType(t.valueType);d=y===x?t.args[1]:e.Constant(x)}else{let y=e.Constant(1),b=e.getInstruction(u).args[0],w=e.NativeFunction("floor",[t.args[1]]),E=e.GreaterEqual([w,y]),I=e.LessEqual([w,b]);d=e.Piecewise([E,e.Piecewise([I,w,b]),y]),f={one:y,lengthIndex:b,roundedIndex:w,greaterEqualIndex:E,lessEqualIndex:I}}if(l.args[c]<u)return l.args[c];let g=[d];for(let y=u+1;y<=l.args[c];y++){let x=e.getInstruction(y);if(pt(x))g.push(e.copyInstruction(x));else{let b=[];for(let w of x.args)b.push(w>=u?g[w-u]:w);x.type===40?g.push(e.InboundsListAccess(b)):g.push(e.copyInstructionWithArgs(x,b))}}if(f){let{greaterEqualIndex:y,lessEqualIndex:x,lengthIndex:b,one:w}=f,E=It(i.valueType),I=e.NanOfType(E),S=g[g.length-1],D=e.And([e.And([y,x]),e.GreaterEqual([b,w])]);return e.Piecewise([D,S,I])}else return g[g.length-1]}else if(o.type===1&&o.valueType===C)if(i.type===38){e.popInstruction();let s=Math.floor(ae(o.value))-1;return isNaN(s)||s<0||s>=i.args.length?e.NanOfType(t.valueType):i.args[s]}else if(i.type===1){e.popInstruction();let s=Math.floor(ae(o.value))-1;return isNaN(s)||s<0||s>=i.value.length?e.NanOfType(t.valueType):e.ConstantOfType(It(i.valueType),i.value[s])}else return e.getReturnIndex();else return e.getReturnIndex()}case 47:{let n=e.getInstruction(t.args[0]);if(!ia(n)||bE(e,e.getReturnIndex(),n.args[0]))return e.getReturnIndex();if(wO(t.valueType)){let i=e.copy(),o=Kh(i);return e.popInstruction(),TO(e,t.valueType,o)}else throw new Error(`Constant collapsing a block with return type ${dt(t.valueType)} is not implemented.`)}case 55:{let n=e.dereferenceFunctionHeader(t.args[0]);if(n===void 0||!Gq(e,t.args.slice(1))||bE(e,n,t.args[0]))return e.getReturnIndex();if(wO(t.valueType)){let i=e.copy(),o=Kh(i);return e.popInstruction(),TO(e,t.valueType,o)}else throw new Error(`Constant collapsing a function call with return type ${dt(t.valueType)} is not implemented.`)}case 37:switch(t.symbol){case"nthroot":{let n=Bq(e,t.args);if(n!==void 0)return e.Constant(Lw(n[0],n[1]));{let i=e.getInstruction(t.args[1]);if(i.type===1&&i.valueType===C)return e.Exponent([t.args[0],e.Constant(Fx(i.value))])}return e.getReturnIndex()}case"count":{let n=di(e,t.args[0]);return n!==void 0?(e.popInstruction(),e.Constant(n)):e.getReturnIndex()}case"select":{let n=di(e,t.args[0]);if(n!==void 0&&kt(e.getInstruction(t.args[1]))){e.popInstruction();let i=wn(e,t.args[1]),o=[];for(let a=0;a<Math.min(n,i.length);a++)i[a]&&o.push(a);return xE(e,t.args[0],o)}else return e.getReturnIndex()}case"shuffle":{let n=t.args[0],i=t.args[1],o=di(e,i);if(o!==void 0&&kt(e.getInstruction(n))){e.popInstruction();let a=vA(wn(e,n),o);return xE(e,i,a)}else return e.getReturnIndex()}case"elementsAt":{let n=t.args[0],i=t.args[1];if(kt(e.getInstruction(i))){e.popInstruction();let o=wn(e,i);return xE(e,n,o)}return e.getReturnIndex()}case"restrictionToBoolean":{let n=e.getInstruction(t.args[0]);return kt(n)?(e.popInstruction(),e.ConstantOfType(tt,n.value)):n.type===37&&n.symbol==="restriction"?(e.popInstruction(),n.args[0]):e.getReturnIndex()}default:{let n=Bq(e,t.args);return n===void 0?e.getReturnIndex():(e.popInstruction(),e.ConstantOfType(t.valueType,RO(t.symbol,n)))}}case 44:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return kt(n)&&kt(i)?e.ConstantOfType(lr,NO(t.tag,wn(e,t.args[0]),i.valueType,wn(e,t.args[1]))):e.getReturnIndex()}case 48:{let n=e.getReturnIndex(),i=di(e,n);if(i!==void 0&&i===0)return e.popInstruction(),e.ConstantOfType(t.valueType,[]);let o=t.args[0],a=e.getInstruction(o),s=a.args[0],c=n-o,l=a.args[c];if(!bE(e,l,s)){if(t.valueType===Ti){if(i==null)throw Px(oa(e,n));let f=[];for(let g=0;g<i;g++){let y=e.InboundsListAccess([n,e.Constant(g+1)]);f.push(y)}return e.List(f)}let d=Nq(e,n);e.popInstruction(),e.ConstantOfType(t.valueType,d)}return n}case 49:{for(let i of t.args)if(!kt(e.getInstruction(i)))return e.getReturnIndex();e.popInstruction();let n={};for(let i=0;i<t.symbols.length;i++){let o=t.symbols[i],a=e.getInstruction(t.args[i]);if(a.type===48&&(a=e.getInstruction(To(e,t.args[i]))),a.type!==1)throw new Error("Expected instruction to be constant");let{valueType:s,value:c}=a;mE(s,c)||(n[o]={value:c,valueType:s})}return e.ConstantOfType(nr,{type:"Action",updateRules:n})}case 20:case 22:case 23:case 24:case 40:case 42:case 21:case 19:case 50:case 51:case 53:case 54:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function Gq(e,t){for(let r of t){let n=e.getInstruction(r);if(!kt(n))return!1}return!0}function Bq(e,t){let r=[];for(let n of t){let i=e.getInstruction(n);if(kt(i))r.push(i.value);else return}return r}function zq(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast");let t=e.getInstruction(e.getReturnIndex());if(pt(t))return e.getReturnIndex();switch(t.type){case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 31:case 32:case 15:case 14:case 33:case 16:return Cf(e,t);case 42:return To(e,Cf(e,t));case 37:{let n=Xn[t.symbol];switch(n.tag){case"default":case"trig":case"trig2":case"inverseTrig":case"color":return Cf(e,t);case"never-broadcast":{let i=[],o=!1;for(let a of t.args){let s=To(e,a);s!==a?(o=!0,i.push(s)):i.push(a)}return o?e.copyInstructionWithArgs(t,i):e.getReturnIndex()}case"reducer":if(cZ(e,t.args))if(t.args.length===1){let i=t.args[0],o=To(e,i);return o!==i?e.copyInstructionWithArgs(t,[o]):e.getReturnIndex()}else return Cf(e,t);else return e.getReturnIndex();case"doubleReducer":{if(t.args.length!==2)throw new Error("Programming error: double reducers must have two arguments");let i=To(e,t.args[0]),o=To(e,t.args[1]);return i!==t.args[0]||o!==t.args[1]?e.copyInstructionWithArgs(t,[i,o]):e.getReturnIndex()}case"parameterizedReducer":{if(t.args.length!==2)throw new Error("Programming error: double reducers must have two arguments");let i=To(e,t.args[0]);return i===t.args[0]?Cf(e,t,[!1,!0]):e.copyInstructionWithArgs(t,[i,t.args[1]])}default:{let i=n.tag;throw new Error(`Programming Error: unexpected tag ${i}`)}}}case 39:case 40:case 41:return Cf(e,t,[!1,!0]);case 55:{let i=e.getInstruction(t.args[0]).signature.argTypes.map(s=>!xe(s)),o=[t.args[0]],a=!1;for(let s=1;s<t.args.length;s++){let c=t.args[s],l=To(e,c);l!==c?(a=!0,o.push(l)):o.push(c)}return a?e.copyInstructionWithArgs(t,o):Cf(e,t,[!1,...i])}case 21:case 22:case 19:case 20:case 50:case 51:return e.getReturnIndex();case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 53:case 54:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function cZ(e,t){for(let r of t)if(xe(e.getInstruction(r).valueType))return!0;return!1}function Cf(e,t,r){let n=t.args,i=!1,o=[];for(let g=0;g<n.length;g++){if(r&&!r[g])continue;let y=n[g],x=e.getInstruction(y).valueType;xe(x)&&o.indexOf(y)===-1&&o.push(y),x===Rt&&(i=!0)}if(o.length===0)return e.getReturnIndex();if(t.type===33&&o.indexOf(t.args[0])==-1&&o.indexOf(t.args[1])>=0&&o.indexOf(t.args[2])>=0){let g=To(e,t.args[1]),y=To(e,t.args[2]);return g!==t.args[1]||y!==t.args[2]?Yn(e,t,[t.args[0],g,y]):e.getReturnIndex()}e.popInstruction();let a=Xh(e,o);if(a===void 0)throw new Error("Programming Error: expected minListLength to be defined for "+o.length+" lists");let s=a;if(kt(e.getInstruction(s))&&wn(e,s)===0&&i)return e.ConstantOfType(Rt,[]);let c=e.BeginBroadcast([s],{type:"implicit"}),l=[];for(let g of o)l.push(xu(e,g,c));let u=[];for(let g=0;g<n.length;g++){let y=n[g];if(r&&!r[g])u.push(y);else{let x=o.indexOf(y);u.push(x===-1?y:l[x])}}let d=e.copyInstructionWithArgs(t,u),f=e.EndBroadcast([c,d]);return e.BroadcastResult(Qn(e.getInstruction(d).valueType),[f])}function xu(e,t,r){return e.getInstruction(t).type==48?e.DeferredListAccess([t,r]):e.InboundsListAccess([t,r])}function Hq(e){let t=e.getReturnIndex(),r=xo(e,t),n=e.getInstruction(t);if(n.type!==48)return e;let i=n.args[0],o=t-i,a=e.getInstruction(i),s=a.args[0],c=a.args[o],l=[],u=[];l.push(s);let d=Al(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list");u.push({min:1,max:d,length:d});let f=!1,g=!1;for(let _=s+1;_<=c;_++){if(!r[_])continue;let A=e.getInstruction(_);if(Fo(A)||ia(A))return e;if(A.type===39||A.type===41||A.type===40){if(A.args[1]!==s)continue;let R=A.args[0];if(e.getInstruction(R).valueType!==ke||!kt(e.getInstruction(R)))continue;let W=wn(e,R),j=dZ(W);if(!isFinite(j.min)||!isFinite(j.max))continue;l.push(_),u.push(j)}else Uq(A)?f=!0:(A.type===12||A.type===13)&&(g=!0)}if(l.length===0||!g&&!f)return e;let y=[],x=[];for(let _=0;_<e.argNames.length;_++)x.push(_),y.push(cu());let b=[],w=[];for(let _=0;_<=c;_++)b.push(kO(e,x,b,_)),w.push(kO(e,l,w,_));for(let _=0;_<=c;_++){if(!r[_])continue;let A=e.getInstruction(_);if(A.type===33){let R=b[_];for(let W=0;W<R.length;W++)if(R[W])return e}else if(A.type===12||A.type===13){let R=!1,W=!1;for(let Te=0;Te<l.length;Te++)w[A.args[0]][Te]&&(R=!0),w[A.args[1]][Te]&&(W=!0);if(R||!W)continue;let j=b[A.args[0]],Q=0,ce;for(let Te=0;Te<j.length;Te++)j[Te]&&(ce=Te,Q+=1);if(Q!==1||ce===void 0)continue;let ee=x[ce],pe=Bo(e.copy().reopenFinalBlock(),ee,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Fr(pe,A.args[0])!==1)continue;let re=zc(pe,A.args[0]),[k,Ke]=kn(re,A.args[0]);if(Ke===void 0)continue;let ht=wn(re.newChunk,Ke),Ze=wn(re.newChunk,k);y[ce]=ii(y[ce],zm(Ze,ht))}}if(f){let _=e.copy().reopenFinalBlock();for(let A=0;A<l.length;A++){let R=Bo(_,l[A],{allowRestriction:!1,allowClosedBlockReferences:!1}),W=zc(R,c);for(let j=s+1;j<=c;j++){if(!r[j])continue;let Q=_.getInstruction(j);if(Uq(Q)){let ce=Q.args[0];if(Fr(R,ce)!==1)continue;let ee=kn(W,ce)[1];if(ee===void 0)continue;let pe=uZ(W.newChunk,ee),re,k=0;for(let Ne=0;Ne<pe.length;Ne++)pe[Ne]&&(re=Ne,k+=1);if(k!==1||re===void 0)continue;let Ke=Bo(W.newChunk,re,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Fr(Ke,ee)!==1)continue;let ht=zc(Ke,ee),[Ze,Te]=kn(ht,ee);if(Te===void 0||!kt(ht.newChunk.getInstruction(Ze))||!kt(ht.newChunk.getInstruction(Te)))continue;let Vt=wn(ht.newChunk,Ze),yt=wn(ht.newChunk,Te),qe=(u[A].max-u[A].min)/Math.min(u[A].length-1,31),at=Math.PI/qe;if(!isFinite(at)||at<=0)continue;y[re]=ii(y[re],zm(Vt,yt)),y[re]=ii(y[re],zm(at-Vt,-yt))}}}}let E=!1;for(let _ of y){if(Wa(_)||!qs(_))return e;(_.bounds[0]!==-1/0||_.bounds[1]!==1/0)&&(E=!0)}if(!E)return e;let I=e.copy(),S=I.Constant(1),D=I.Constant(NaN),O=t;for(let _=0;_<I.argNames.length;_++)O=lZ(I,y[_],O,_,S,D);return I.fuseBroadcast(),I}function lZ(e,t,r,n,i,o){if(Wa(t)||!qs(t)||t.bounds[0]===-1/0&&t.bounds[1]===1/0)return r;let a=e.And([e.LessEqual([e.Constant(t.bounds[0]),n]),e.LessEqual([n,e.Constant(t.bounds[1])])]);return e.Multiply([r,e.Piecewise([a,i,o])])}function uZ(e,t){let r=[];for(let i=0;i<e.argNames.length;i++)r.push(i);let n=[];for(let i=0;i<=t;i++)n.push(kO(e,r,n,i));return n[t]}function Uq(e){return e.type===37&&(e.symbol==="sin"||e.symbol==="cos")}function dZ(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function kO(e,t,r,n){let i=e.getInstruction(n),o=pZ(t.length);for(let a=0;a<t.length;a++)if(t[a]===n)return o[a]=!0,o;if(pt(i))return o;for(let a of i.args){let s=r[a];for(let c=0;c<s.length;c++)o[c]=o[c]||s[c]}return o}function pZ(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}var jq=FO({sin:Vn("isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? 0.0 : sin(x)"),cos:Vn("isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? 0.0 : cos(x)"),tan:vs(Tt`float a=abs(x);
    return isinf(x) || isnan(x) ? NaN
      : dcg_isPiMultiple(a) ? 0.0
      : dcg_isOddHalfPiMultiple(a) ? Infinity
      : tan(x);`),cot:vs(Tt`float a=abs(x);
      return isinf(x) || isnan(x) ? NaN
        : a < 0.03 ? 1.0/x - x/3.0
        : dcg_isPiMultiple(a) ? Infinity
        : dcg_isOddHalfPiMultiple(a) ? 0.0
        : 1.0 / tan(x);`),sec:Vn("isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? Infinity: 1.0 / cos(x)"),csc:vs(Tt`float a=abs(x);
      return isinf(x) || isnan(x) ? NaN
        : a < 0.03 ? 1.0/x + x/6.0
        : dcg_isPiMultiple(a) ? Infinity
        : 1.0 / sin(x);`),arcsin:vs(Tt`if (isinf(x) || isnan(x)) { return NaN; }
    if (x == 1.0) { return dcg_PI/2.0; }
    if (x == -1.0) { return -dcg_PI/2.0; }
    if (x > 1.0 || x < -1.0) return NaN;
    float y0 = asin(x);
    return y0 + (x - sin(y0)) / cos(y0);`),arccos:vs(Tt`if (isinf(x) || isnan(x)) { return NaN; }
    if (x == 1.0) { return 0.0; }
    if (x == -1.0) { return dcg_PI; }
    if (x > 1.0 || x < -1.0) return NaN;
    float y0 = acos(x);
    return y0 + (cos(y0) - x) / sin(y0);`),arctan:wE(Tt`isnan(x) || isnan(y) ? NaN
      : isinf(x) && isinf(y) ?
        (y > 0.0 ? 0.25 : 0.75) * sign(x) * dcg_PI
      : x == 0.0 && y == 0.0 ? y
      : atan(x, y)
    `),arccot:Vn("isnan(x) ? NaN : dcg_PI/2.0 - atan(x)"),arcsec:Vn("isnan(x) ? NaN : dcg_arccos(1.0/x)"),arccsc:Vn("isnan(x) ? NaN : dcg_arcsin(1.0/x)"),sinh:Vn("isinf(x) ? x : isnan(x) ? NaN : sinh(x)"),cosh:Vn("isinf(x) ? Infinity : isnan(x) ? NaN : cosh(x)"),tanh:Vn("abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : tanh(x)"),coth:Vn("abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x + x/3.0 : 1.0/tanh(x)"),sech:Vn("isinf(x) ? 0.0 : isnan(x) ? NaN : 1.0/cosh(x)"),csch:Vn("isinf(x) ? 0.0 : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x - x/6.0 : 1.0/sinh(x)"),arcsinh:vs(Tt`float a=abs(x);
      return isnan(x) ? NaN : sign(x) * (
        1.0 + x * x == 1.0
          ? dcg_log1p(a)
          : log(a + dcg_rtxsqpone(a))
      );`),arccosh:Vn("x < 1.0 || isnan(x) ? NaN : log(x + dcg_rtxsqmone(x))"),arctanh:vs(Tt`if (isnan(x) || abs(x) > 1.0) { return NaN; }
      if (x == 1.0) { return Infinity; }
      if (x == -1.0) { return -Infinity; }
      float y0 = 0.5*(dcg_log1p(x) - dcg_log1p(-x));
      float c = cosh(y0);
      return y0 + (x - tanh(y0)) * c * c;`),arccoth:Vn("isnan(x) ? NaN : abs(x) >= 1.0 ? dcg_arctanh(1.0/x) : NaN"),arcsech:Vn("isnan(x) ? NaN : 0.0 < x && x <= 1.0 ? dcg_arccosh(1.0/x) : x == 0.0 ? Infinity : NaN"),arccsch:Vn("isinf(x) ? 0.0 : isnan(x) ? NaN : dcg_arcsinh(1.0/x)"),sinpiSeries:vs(Tt`float xsq = x*x;
    return x*(dcg_PI-xsq*(5.167708-xsq*(2.549761-xsq*0.5890122)));`),sinpi:vs(Tt`if (isnan(x) || isinf(x)) { return NaN; }
    if (x==0.0) { return x; }
    if (x == floor(x)) { return x > 0.0 ? 0.0 : -0.0; }
    int i = int(dcg_round(2.0*x));
    float t = -0.5 * float(i) + x;
    float s = bool(i & 2) ? -1.0 : 1.0;
    float y = bool(i & 1) ? cos(dcg_PI * t) : dcg_sinpiSeries(t);
    return s*y;`),sincpi:Vn("isnan(x) ? NaN : isinf(x) ? 0.0 : x == 0.0 ? 1.0 : dcg_sinpi(x)/(dcg_PI*x);"),sqrt:Vn("isnan(x) ? NaN : x >= 0.0 ? sqrt(x) : NaN"),rtxsqpone:Vn("dcg_hypot(x, 1.0)"),rtxsqmone:vs("float t = x*x; return isnan(x) || t < 1.0 ? NaN : t - 1.0 == t ? abs(x) : sqrt(t - 1.0);"),nthroot:wE("isnan(x) || isnan(y) ? NaN : dcg_pow(x, 1.0/y)"),hypot:Zq(Tt`if (isnan(x) || isnan(y)) return NaN;
      if (isinf(x) || isinf(y)) return Infinity;
      x = abs(x);
      y = abs(y);
      float m = max(x,y);
      x /= m;
      y /= m;
      return m == 0.0 ? 0.0 : sqrt(x*x + y*y) * m;`),log:Vn("isnan(x) ? NaN : x > 0.0 ? log(x)*0.4342944819 : x == 0.0 ? -Infinity : NaN"),logbase:wE(Tt`isnan(x) || isnan(y) ? NaN
      : y == 1.0 ?
        (
          x > 1.0 ? Infinity
          : x == 1.0 ? NaN
          : x < 0.0 ? NaN
          : -Infinity
        )
      : y > 0.0 ?
        (
          x > 0.0 ? log(x)/log(y)
          : x == 0.0 && !isinf(y) ? -Infinity
          : NaN
        )
      : NaN`),ln:Vn("isnan(x) ? NaN : x > 0.0 ? log(x) : x == 0.0 ? -Infinity : NaN"),exp:Vn("isnan(x) ? NaN : exp(x)"),floor:Vn("isnan(x) ? NaN : floor(x)"),ceil:Vn("isnan(x) ? NaN : ceil(x)"),round:Vn("isinf(x) || isnan(x) ? x : floor(0.5 + x)"),abs:Vn("isnan(x) ? NaN : abs(x)"),sign:Vn("isnan(x) ? NaN : sign(x)"),mod:wE("isinf(x) || isinf(y) || isnan(x) || isnan(y) || y == 0.0 ? NaN : mod(x, y)"),stirlingPrefactor:sa("float","float x, float y",Tt`if (isnan(x) || isnan(y)) { return NaN; }
    return pow(x/exp(1.0), y);`),stirlerrSeries:vs(Tt`float S0 = 0.083333336;
    float S1 = 0.0027777778;
    float S2 = 0.0007936508;
    float nn = x*x;
    return (S0-(S1-S2/nn)/nn)/x;`),factorialAsymptotic:Vn("dcg_stirlingPrefactor(x,x)*sqrt(2.0*dcg_PI*x)*exp(dcg_stirlerrSeries(x))"),factorialMinimax:vs(Tt`float n1 = 2.1618295;
    float n2 = 1.5849807;
    float n3 = 0.4026814;
    float d1 = 2.2390451;
    float d2 = 1.6824219;
    float d3 = 0.43668285;

    float n = 1.0 + x*(n1 + x*(n2 + x*n3));
    float d = 1.0 + x*(d1 + x*(d2 + x*d3));
    float xp1 = x+1.0;

    return dcg_stirlingPrefactor(xp1,x)*sqrt(xp1)*(n/d);
    `),factorialPositive:Vn(Tt`(x>33.0)?Infinity:(x>8.0)?dcg_factorialAsymptotic(x):dcg_factorialMinimax(x);`),factorial:vs(Tt`if (isnan(x) || (isinf(x) && x < 0.0)) { return NaN; }
    bool isInteger = x == floor(x);
    if (x < 0.0) {
      if (isInteger) return Infinity;
      return 1.0 / (dcg_sincpi(x) * dcg_factorialPositive(-x));
    }
    float approx = dcg_factorialPositive(x);
    return isInteger ? dcg_round(approx) : approx;`),distance:sa("float","vec2 a, vec2 b",Tt`
      if (any(isnan(a)) || any(isnan(b))) return NaN;
      vec2 d = a-b;
      return dcg_hypot(d.x, d.y);`),distanceThreeD:sa("float","vec3 a, vec3 b",Tt`
      if (any(isnan(a)) || any(isnan(b))) return NaN;
      vec3 d = a-b;
      return dcg_hypot(dcg_hypot(d.x, d.y), d.z);`),hsv:sa("vec3","float h, float s, float v",Tt`if (isnan(h) || isnan(s) || isnan(v)) {discard;}
      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
      if (isinf(h)) h = 0.0;
      vec3 p = abs(fract(h / 360.0 + K.xyz) * 6.0 - K.www);
      return vec3(clamp(v, 0.0, 1.0) * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), clamp(s, 0.0, 1.0)));`),rgb:sa("vec3","float r, float g, float b",Tt`if (isnan(r) || isnan(g) || isnan(b)) {discard;}
    return clamp(vec3(r,g,b),0.0,255.0)/255.0;`),erf:vs(Tt`if (isnan(x)) return NaN;
      float t = abs(x);
      float n = x*x;
      float r = -n;
      return sign(x) * (
        r < -750.0
          ? 1.0
          : t >= 0.065
          ? 1.0 - exp(r) * (
            t > 50000000.0
              ? r / t
              : t > 50.0
              ? (r * (n * (n + 4.5) + 2.0)) / (t * (n * (n + 5.0) + 3.75))
              : ((0.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+
                t*(1.7057986861852539+t*(0.8257463703357973+
                  t*(0.28647031042892007+t*(0.07124513844341643+
                    t*(0.012296749268608364+t*(0.001347817214557592+
                      0.00007263959403471071*t))))))))
                )/(1.0+t*(3.352953590554884+t*(5.227518529742423+
                  t*(5.003720878235473+t*(3.266590890998987+
                    t*(1.5255421920765353+t*(0.5185887413188858+
                      t*(0.12747319185915415+t*(0.02185979575963238+
                        t*(0.0023889438122503674+0.00012875032817508128*t
                ))))))))))
              )
          )
          : t*(1.1283791670955126+r*(0.37612638903183754+
              r*(0.11283791670955126+r*(0.026866170645131252+
                0.005223977625442188*r))))
      );`),restriction:sa("bool","bool x","return x;"),restrictionToBoolean:sa("bool","bool x","return x;"),complex:sa("vec2","float u, float v",Tt`if (isnan(u) || isnan(v)) { return vec2(NaN, NaN); }
    return vec2(u,v);`),real:sa("float","vec2 c","return c.x;"),imag:sa("float","vec2 c","return c.y;"),arg:sa("float","vec2 c","return dcg_arctan(c.y,c.x);"),coerceComplexToReal:sa("float","vec2 a","return a.y == 0.0 ? a.x : NaN;"),coerceRealToComplex:sa("vec2","float x","return isnan(x) ? vec2(NaN, NaN) : vec2(x, 0);"),complexSqrt:bs(Tt`float u = z.x; float v = z.y;
    float r = sqrt(0.5 * (abs(u) + dcg_hypot(u, v)));
    if (r == 0.0 || isnan(v) || isinf(v)) return dcg_complex(r, v);
    if (u > 0.0) return dcg_complex(r, 0.5 * (v / r));
    if (v < 0.0) r = -r;
    return dcg_complex(0.5 * (v / r), r);`),complexDivide:sa("vec2","vec2 a, vec2 b",Tt`float u1 = a.x; float v1 = a.y;
      float u2 = b.x; float v2 = b.y;
      if (isnan(u1) || isnan(v1) || isnan(u2) || isnan(v2)) return vec2(NaN, NaN);
      if (isinf(u1) || isinf(v1)) return vec2(NaN, NaN);
      if (u2 == 0.0 && v2 == 0.0) return vec2(NaN, NaN);
      if (isinf(u2) || isinf(v2)) return vec2(0.0, 0.0);
      if (abs(v2) <= abs(u2)) {
        return dcg_subComplexDivide(a, b);
      } else {
        return dcg_conj(dcg_subComplexDivide(a.yx, b.yx));
      }`),complexLn:bs(Tt`float u = z.x; float v = z.y;
      return dcg_complex(dcg_ln(dcg_hypot(u,v)), dcg_arctan(v,u));`),complexExp:bs(Tt`float u = z.x; float v = z.y;
      if (isnan(u)) return vec2(NaN, NaN);
      float r = exp(u);
      return v == 0.0 ? vec2(r, 0.0) : dcg_complexFromPolarRounded(r, v);`),complexPow:sa("vec2","vec2 z1, vec2 z2",Tt`float u2 = z2.x; float v2 = z2.y;
      float u1 = z1.x; float v1 = z1.y;
      if (isnan(u1) || isnan(v1) || isnan(u2) || isnan(v2))
        return vec2(NaN, NaN);
      float r1 = dcg_hypot(u1, v1);
      float theta1 = dcg_arctan(v1, u1);
      float rOut = pow(r1, u2) * exp(-theta1 * v2);
      float thetaOut = log(r1) * v2 + theta1 * u2;
      if (!isinf(rOut)) {
        return dcg_complexFromPolarRounded(rOut, thetaOut);
      } else {
        return dcg_complexFromPolarRounded(
          exp(u2 * log(r1) - theta1 * v2),
          thetaOut
        );
      }
      `),complexSin:bs(Tt`float u = z.x; float v = z.y;
      return dcg_complex(dcg_sin(u) * dcg_cosh(v), dcg_cos(u) * dcg_sinh(v));`),complexCos:bs(Tt`float u = z.x; float v = z.y;
      return dcg_complex(dcg_cos(u) * dcg_cosh(v), -dcg_sin(u) * dcg_sinh(v));`),complexSinh:bs(Tt`float u = z.x; float v = z.y;
      return dcg_complex(dcg_sinh(u) * dcg_cos(v), dcg_cosh(u) * dcg_sin(v));`),complexCosh:bs(Tt`float u = z.x; float v = z.y;
      return dcg_complex(dcg_cosh(u) * dcg_cos(v), dcg_sinh(u) * dcg_sin(v));`),complexTanh:bs(Tt`float u = z.x; float v = z.y;
      float tanv = dcg_tan(v); float tanhu = dcg_tanh(u);
      if (isnan(tanv) || isnan(tanhu)) return vec2(NaN, NaN);
      if (isinf(tanv)) return vec2(1.0 / tanhu, 0.0);

      float tanv2 = tanv * tanv;
      float secv2 = 1.0 + tanv2;
      float sinhu = dcg_sinh(u);
      float sinhu2 = sinhu * sinhu;
      float tanhu2 = tanhu * tanhu;
      return dcg_complex(
        (secv2 * tanhu) / (1.0 + tanv2 * tanhu2),
        tanv / (1.0 + secv2 * sinhu2)
      );`),complexTan:bs(Tt`float u = z.x; float v = z.y;
      vec2 t = dcg_complexTanh(vec2(-v, u));
      return vec2(t.y, -t.x);`),complexSec:bs("return dcg_complexReciprocal(dcg_complexCos(z));"),complexCsc:bs("return dcg_complexReciprocal(dcg_complexSin(z));"),complexCot:bs("return dcg_complexReciprocal(dcg_complexTan(z));"),complexSech:bs("return dcg_complexReciprocal(dcg_complexCosh(z));"),complexCsch:bs("return dcg_complexReciprocal(dcg_complexSinh(z));"),complexCoth:bs("return dcg_complexReciprocal(dcg_complexTanh(z));")});function sa(e,t,r){return{type:"scalar",value:`${e} dcg_[[name_here]](${t}){ ${r} }`}}function vs(e){return sa("float","float x",e)}function Vn(e){return vs(`return ${e};`)}function Zq(e){return sa("float","float x, float y",e)}function wE(e){return Zq(`return ${e};`)}function bs(e){return sa("vec2","vec2 z",e)}function xs(e,{outType:t,deps:r}={}){let n=t!=null?t:()=>"float";return{type:"reducer",value:i=>`${n(i)} dcg_[[name_here]](float[${i}] L) { ${e(i)} }`,deps:r!=null?r:[]}}function VO(e){return{type:"double-reducer",value:(t,r)=>{let n=Math.min(t,r),i=e(n);return`float dcg_[[name_here]](float[${t}] X, float[${r}] Y) { ${i} }`}}}var gZ=FO({lcm:xs(e=>Tt`float g = abs(dcg_round(L[0]));
      if (isnan(g) || isinf(g)) return NaN;
      for (int i=1; i<${e}; i++) {
        float v = abs(dcg_round(L[i]));
        if (isnan(v) || isinf(v)) return NaN;
        if (g != 0.0)
          g *= dcg_round(v / dcg_gcd2(g, v));
      }
      return g;`),gcd:xs(e=>Tt`float g = abs(dcg_round(L[0]));
      if (isnan(g) || isinf(g)) return NaN;
      for (int i=1; i<${e}; i++) {
        float x = L[i];
        if (isnan(x) || isinf(x)) return NaN;
        g = dcg_gcd2(g, abs(dcg_round(x)));
      }
      return g;`),mean:xs(e=>Tt`float tot = 0.0;
      for (int i=0; i<${e}; i++) {
        float x = L[i];
        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;
        tot += x;
      }
      return tot / ${e}.0;`),total:xs(e=>Tt`float tot = 0.0;
      for (int i=0; i<${e}; i++) {
        float x = L[i];
        if (isnan(x) || (isinf(x) && x == -tot)) return NaN;
        tot += x;
      }
      return tot;`),stdev:xs(e=>Yq(e,e-1),{deps:["mean"]}),stdevp:xs(e=>Yq(e,e),{deps:["mean"]}),mad:xs(e=>Tt`float mean = dcg_mean(L);
      if (isnan(mean) || isinf(mean)) return NaN;
      float tot = 0.0;
      for (int i=0; i<${e}; i++) {
        tot += abs(L[i] - mean);
      }
      return tot / ${e}.0;`,{deps:["mean"]}),min:xs(e=>Wq(e,"min")),max:xs(e=>Wq(e,"max")),argmin:xs(e=>Xq(e,"<")),argmax:xs(e=>Xq(e,">=")),median:xs(e=>e%2===1?`return L[int(dcg_sortPerm(L)[${(e-1)/2}])];`:Tt`float[${e}] perm = dcg_sortPerm(L);
          return 0.5*(L[int(perm[${e/2}])]+L[int(perm[${e/2-1}])]);`,{deps:["sortPerm"]}),varp:xs(e=>$q(e,e),{deps:["mean"]}),var:xs(e=>$q(e,e-1),{deps:["mean"]}),sortPerm:xs(e=>{if(e>100)throw Ym();return Tt`int[${e}] perm;
        int[${e}] nextPerm;
        for (int i=0; i<${e}; i++)
          perm[i] = i;
        float lastMin = -Infinity;
        int lastIndex = -1;
        for (int i=0; i<${e}; i++) {
          float currMin = Infinity;
          int currIndex = -1;
          int j;
          for (j=0; j<${e}; j++) {
            float e = L[j];
            if (
              (e > lastMin || (e == lastMin && j > lastIndex))
              && e < currMin
            ) {
              currMin = e;
              currIndex = j;
            }
          }
          perm[i] = currIndex;
          lastMin = currMin;
          lastIndex = currIndex;
        }
        float[${e}] permFloat;
        for (int i=0; i<${e}; i++)
          permFloat[i] = float(perm[i]);
        return permFloat;`},{outType:e=>`float[${e}]`})});function $q(e,t){return t===0?"return NaN;":Tt`float mean = dcg_mean(L);
    if (isnan(mean) || isinf(mean)) return NaN;
    float tot = 0.0;
    for (int i=0; i<${e}; i++) {
      float delta = L[i] - mean;
      tot += delta * delta;
    }
    return tot / ${t}.0;`}function Yq(e,t){return t===0?"return NaN;":Tt`float mean = dcg_mean(L);
    if (isnan(mean) || isinf(mean)) return NaN;
    float tot = 0.0;
    for (int i=0; i<${e}; i++) {
      tot = dcg_hypot(tot, L[i] - mean);
    }
    return tot / ${GO(Math.sqrt(t))};`}function Wq(e,t){return Tt`float m = L[0];
    if (isnan(m)) return NaN;
    for (int i=1; i<${e}; i++) {
      float x = L[i];
      if (isnan(x)) return NaN;
      m = ${t}(m, x);
    }
    return m;`}function Xq(e,t){return Tt`if (isnan(L[0])) return 0.0;
    int arg = 0;
    float best = L[0];
    for (int i=1; i<${e}; i++) {
      float e = L[i];
      if (isnan(e)) return 0.0;
      if (e ${t} best) {
        arg = i;
        best = e;
      }
    }
    return float(arg + 1);`}var fZ=FO({cov:VO(e=>Kq(e,e-1)),covp:VO(e=>Kq(e,e)),corr:VO(e=>Tt`${Jq(e)}
      float t1 = 0.0;
      float t2 = 0.0;
      float tc = 0.0;
      for (int i=0; i<${e}; i++) {
        float d1 = X[i] - m1;
        float d2 = Y[i] - m2;
        t1 = dcg_hypot(t1, d1);
        t2 = dcg_hypot(t2, d2);
        tc += d1 * d2;
      }
      return tc / (t1 * t2);`)}),mZ={type:"elementsAt",value:(e,t)=>`${e}[${t}] dcg_elementsAt(${e}[${t}] X, float[${t}] Y) {
      ${e}[${t}] outList;
      for (int i=0; i<${t}; i++) {
        outList[i] = X[int(Y[i])];
      }
      return outList;
    }`},hZ={...jq,...gZ,...fZ,elementsAt:mZ},EE=hZ;function yZ(e,t){switch(e.type){case"scalar":return e.value.replace("[[name_here]]",t);case"reducer":{let r=e.value;return n=>r(n).replace("[[name_here]]",t)}case"double-reducer":{let r=e.value;return(n,i)=>r(n,i).replace("[[name_here]]",t)}default:return e.value}}function FO(e){for(let[t,r]of Object.entries(e))r.type!=="omitted"&&(r.value=yZ(r,t));return e}function Kq(e,t){return Tt`${Jq(e)}
    float tot = 0.0;
    for (int i=0; i<${e}; i++) {
      tot += (X[i] - m1) * (Y[i] - m2);
    }
    return tot / ${t}.0;`}function Jq(e){return Tt`float m1 = 0.0;
    for (int i=0; i<${e}; i++) {
      float x = X[i];
      if (isnan(x) || isinf(x)) return NaN;
      m1 += x;
    }
    m1 /= ${e}.0;
    float m2 = 0.0;
    for (int i=0; i<${e}; i++) {
      float y = Y[i];
      if (isnan(y) || isinf(y)) return NaN;
      m2 += y;
    }
    m2 /= ${e}.0;`}var bZ=[Tt`float dcg_rawpow(float x, float y) {
    if (isnan(x) || isnan(y)) return NaN;
    if (y==0.0) return 1.0;
    if (isinf(y)) {${""}
      float a = abs(x);
      if (a == 1.0) return NaN;
      if (y > 0.0) {
        return a > 1.0 ? Infinity : 0.0;
      } else {
        return a < 1.0 ? Infinity : 0.0;
      }
    }
    if (x > 0.0) return pow(x, y);
    else if (x == 0.0) {
      if (y > 0.0) return 0.0;
      else if (y == 0.0) return 1.0;
      else return Infinity;
    } else {
      float m = mod(y, 2.0);
      if (m == 1.0) return -pow(-x, y);
      else return pow(-x, y);
    }
  }`,Tt`float dcg_pow(float x, float y) {
    if (isnan(x) || isnan(y)) return NaN;
    if (y==0.0) return 1.0;
    if (isinf(y)) {
      float a = abs(x);
      if (a == 1.0) return NaN;
      if (y > 0.0) {
        return a > 1.0 ? Infinity : 0.0;
      } else {
        return a < 1.0 ? Infinity : 0.0;
      }
    }
    if (x > 0.0) return pow(x,y);
    else if (x == 0.0) {
      if (y > 0.0) return 0.0;
      if (y == 0.0) return 1.0;
      if (y < 0.0) return Infinity;
    } else {
      float m = mod(y, 2.0);
      if (m == 0.0) return pow(-x, y);
      else if (m == 1.0) return -pow(-x, y);
      else {${""}
        vec2 a0 = vec2(0.0, 1.0);
        vec2 a1 = vec2(1.0, 0.0);
        float approx = y;
        for (int i=0; i<12; i+=1) {
          float whole = floor(approx);
          vec2 a = whole * a1 + a0;
          if (a.y > 100.0) break;
          a0 = a1; a1 = a;
          if (approx == whole) break;
          approx = 1.0 / (approx - whole);
        }${""}
        float r = a1.x / a1.y;
        float m = max(max(abs(y), abs(r)), 1.0);
        if (abs(mod(a1.y, 2.0) - 1.0) < 0.01 && abs((r - y)/y) < 0.00001) {
          return (mod(a1.x, 2.0) == 0.0 ? 1.0 : -1.0) * pow(-x, y);
        } else {
          return NaN;
        }
      }
    }
  }`,Tt`float dcg_add(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : isinf(x) && isinf(y) && x != y ? NaN
      : x + y;
  }`,Tt`float dcg_sub(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : isinf(x) && isinf(y) && x != -y ? NaN
      : x - y;
  }`,Tt`float dcg_mul(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : isinf(x) && y == 0.0 ? NaN
      : x == 0.0 && isinf(y) ? NaN
      : x * y;
  }`,Tt`float dcg_div(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : isinf(x) && isinf(y) ? NaN
      : x == 0.0 && y == 0.0 ? NaN
      : x / y;
  }`,Tt`float dcg_neg(float x) {
    return isnan(x) ? NaN : -x;
  }`,Tt`bool dcg_equal(float x, float y) {
    return isnan(x) || isnan(y) ? false : x == y;
  }`,Tt`bool dcg_less(float x, float y) {
    return isnan(x) || isnan(y) ? false : x < y;
  }`,Tt`bool dcg_lessEqual(float x, float y) {
    return isnan(x) || isnan(y) ? false : x <= y;
  }`,Tt`bool dcg_greater(float x, float y) {
    return isnan(x) || isnan(y) ? false : x > y;
  }`,Tt`bool dcg_greaterEqual(float x, float y) {
    return isnan(x) || isnan(y) ? false : x >= y;
  }`,Tt`float dcg_gcd2(float u, float v) {
    for (int i=0; i<95; i++) {
      if (v == 0.0) break;
      u = mod(u, v);
      if (u == 0.0) break;
      v = mod(v, u);
    }
    return u+v;
  }`,Tt`float dcg_log1p(float x) {
    return x - 0.5 * x * x == x ? x : log(1.0 + x);
  }`,Tt`bool dcg_isPiMultiple(float absx) {
    if (absx > 1.0e5) return false;
    return floor(0.5 + dcg_PI_INV * absx) * dcg_PI == absx;
  }`,Tt`bool dcg_isOddHalfPiMultiple(float absx) {
    if (absx > 1.0e5) return false;
    float n = floor(0.5 + 2.0 * dcg_PI_INV * absx);
    return mod(n, 2.0) == 1.0 && n * dcg_PI == 2.0 * absx;
  }`,"vec2 dcg_conj(vec2 a) { return vec2(a.x, -a.y); }",Tt`vec2 dcg_subComplexDivide(vec2 a, vec2 b) {
    float u1 = a.x; float v1 = a.y;
    float u2 = b.x; float v2 = b.y;
    float r = v2 / u2;
    float t = 1.0 / (u2 + v2 * r);
    if (r == 0.0) {
      return dcg_complex((u1 + v2 * (v1 / u2)) * t, (v1 - v2 * (u1 / u2)) * t);
    } else {
      return dcg_complex((u1 + v1 * r) * t, (v1 - u1 * r) * t);
    }
  }`,Tt`vec2 dcg_complexFromPolarRounded(float r, float theta) {
    if (isnan(r) || isnan(theta)) return vec2(NaN, NaN);
    if (r == 0.0) return vec2(0.0, 0.0);
    return dcg_complex(r * dcg_cos(theta), r * dcg_sin(theta));
  }`,Tt`vec2 dcg_complexReciprocal(vec2 z) {
    return dcg_complexDivide(vec2(1.0,0.0), z);
  }`].join(`
`),xZ=`
  float dcg_round(float x);
  float dcg_hypot(float x, float y);
  float dcg_rtxsqpone(float x);
  float dcg_rtxsqmone(float x);
  float dcg_cos(float x);
  float dcg_sin(float x);
  float dcg_tan(float x);
  float dcg_tanh(float x);
  vec2 dcg_complex(float u, float v);
  vec2 dcg_complexDivide(vec2 a, vec2 b);
`,vZ=Object.values(jq).map(e=>e.value).join(`
`),Rwe=Tt`uniform float NaN;
    uniform float Infinity;
    #define dcg_PI 3.141592653589793
    #define dcg_PI_INV 0.3183098861837907
    ${xZ}\n
    ${bZ}\n
    ${vZ}`;function Tt(e,...t){let r=e[0];for(let n=0;n<t.length;n++)r+=t[n],r+=e[n+1];return TZ(r)}function TZ(e){let t=e.split(`
`);if(/^\s/.test(t[0][0]))throw new Error("Programming error: Expected un-indented first line");if(t.length<=1)return e;let r=Math.min(...t.slice(1).map(n=>n.match(/^\s*/)[0].length));return t[0]+`
`+t.slice(1).map(n=>n.slice(r)).join(`
`)}function Ap(e,t){let r=new BO(e,t),n=Jw(r);return r.finish(n)}var BO=class extends Ah{constructor(r,n){super(r,!0);this.maxUniforms=n;this.glsl=!0;this.shaderUniforms=[];this.definitions={}}finish(r){return{source:r,shaderFunctions:wZ(this.chunk,this.definitions),shaderUniforms:this.shaderUniforms}}printValue(r,n){if(Array.isArray(r)){if(r.length>100)throw Ym();let i=xe(n),o=i?It(n):n,a=r.map(l=>this.printValue(l,o)).join(","),s=Xx(n),c=Qq({type:s,arity:r.length});return this.definitions[c]=!0,(i?"buildList":s)+"("+a+")"}switch(typeof r){case"boolean":return r.toString();case"number":return this.printFloatOrUniformGLSL(r);case"string":throw $m("random");case"object":if(ap(r))throw new Error("Action values cannot be compiled");return this.printFloatOrUniformGLSL(ae(r));default:throw new Error("Unexpected value: "+r)}}printFloatOrUniformGLSL(r){if(this.shaderUniforms.length>=this.maxUniforms)return GO(r);{let i="_DCG_SC_"+this.shaderUniforms.length;return this.shaderUniforms.push(r),i}}beforeBeginLoop(r){let n=this.chunk.getInstruction(r.args[0]),i=this.chunk.getInstruction(r.args[1]),o=r.callData.type==="sum";if(n.type!==1){let c=oa(this.chunk,r.args[0]);throw o?N1(c):R1(c)}if(i.type!==1){let c=oa(this.chunk,r.args[1]);throw o?N1(c):R1(c)}if(n.valueType!==C||i.valueType!==C)throw new Error("Programming error: non-number in summation bounds");let a=ae(n.value),s=ae(i.value);if(!isFinite(s-a)||s-a>=1e3)throw o?WM():XM()}checkFiniteBounds(){return""}emitConstant(r){return this.printValue(r.value,r.valueType)}emitNeg(r){return`dcg_neg(${r})`}emitTernary(r,n,i,o){return xe(o.valueType)?`dcg_ternary(${r},${n},${i})`:`${r}?${n}:${i}`}emitVec2(r,n){return`vec2(${r},${n})`}emitVec3(r,n,i){return`vec3(${r},${n},${i})`}emitVecAccess(r,n){return`${r}.${n===0?"x":n===1?"y":"z"}`}emitBinary(r,n,i){switch(r.type){case 8:return`dcg_add(${n},${i})`;case 9:return`dcg_sub(${n},${i})`;case 10:return`dcg_mul(${n},${i})`;case 11:return`dcg_div(${n},${i})`;case 12:return`dcg_pow(${n},${i})`;case 13:return`dcg_rawpow(${n},${i})`;case 25:return`dcg_equal(${n},${i})`;case 26:return`dcg_less(${n},${i})`;case 28:return`dcg_lessEqual(${n},${i})`;case 27:return`dcg_greater(${n},${i})`;case 29:return`dcg_greaterEqual(${n},${i})`;case 31:return`${n}||${i}`;case 32:return`${n}&&${i}`;default:throw new Error("Programming Error: invalid binary opcode.")}}emitList(r,n){let i=Qq({type:Xx(n.valueType),arity:n.args.length});return this.definitions[i]=!0,`buildList(${r.join(",")})`}emitListAccess(r,n,i,o){let a=di(this.chunk,o.args[0]);if(a===void 0)throw sp(oa(this.chunk,o.args[0]));let s=`int(${n})`;return`(${s}>=1&&${s}<=${a})?${r}[${s}-1]:${i}`}emitInboundsListAccess(r,n){return`${r}[int(${n})-1]`}emitNativeFunction(r,n){if(!EE[n.symbol])throw $m(n.symbol);return`dcg_${n.symbol}(${r.join(",")})`}emitExtendSeed(){throw $m("random")}emitVarDeclaration(r,n){let i=n?";":"";return i+=qO(this.chunk,r)+" "+mn(r),i}emitImmediateAssignment(r,n,i){return`${qO(this.chunk,r)} ${n}=${i};`}emitFunctionCall(){throw $m("recursion")}};function Qq(e){let{type:t,arity:r}=e,n=t+"["+r+"]",i=n+" buildList(";for(let o=0;o<r-1;o++)i+=`${t} _${o}, `;i+=`${t} _${r-1}) {
`,i+=n+` a;
`;for(let o=0;o<r;o++)i+=`a[${o}] = _${o};
`;return i+=`return a;
}
`,i}function wZ(e,t){let r=e.argNames.length,n=e.instructionsLength()-1;for(let i=r;i<=n;i++){let o=e.getInstruction(i);if(o.type===33){if(xe(o.valueType)){let a=qO(e,i),s=`${a} dcg_ternary(bool x, ${a} y, ${a} z) { if (x) return y; return z; }`;t[s]=!0}}else if(o.type===37){let a=EE[o.symbol];if((a==null?void 0:a.type)==="reducer"){let s=o.args[0],c=di(e,s);if(c===void 0)throw sp(oa(e,s));for(let l of a.deps)t[EE[l].value(c)]=!0;t[a.value(c)]=!0}else if((a==null?void 0:a.type)==="double-reducer"){let s=o.args[0],c=o.args[1],l=di(e,s),u=di(e,c);if(l===void 0)throw sp(oa(e,s));if(u===void 0)throw sp(oa(e,c));t[a.value(l,u)]=!0}else if((a==null?void 0:a.type)==="elementsAt"){let s=Xx(It(o.valueType)),c=o.args[1],l=di(e,c);if(l===void 0)throw sp(oa(e,c));t[a.value(s,l)]=!0}}}return t}function GO(e){let t=e.toString();return/^-?\d+$/.test(t)?t+".0":t}function Xx(e){switch(xe(e)?It(e):e){case tt:return"bool";case C:return"float";case z:case $:return"vec2";case gn:case oe:return"vec3";default:throw new Error("Unexpected type: "+xr(e))}}function qO(e,t){let r=e.getInstruction(t);if(xe(r.valueType)){let n=di(e,t);if(n===void 0)throw sp(oa(e,t));if(n>100)throw Ym();return`${Xx(r.valueType)}[${n}]`}else return Xx(r.valueType)}function tz(e){let t=[],r=[];for(let n=0;n<e.argNames.length;n++){let i=[],o=[];for(let a=0;a<e.argNames.length;a++)i.push(e.argTypes[a]===C),o.push(n===a);r.push(o),t.push(i)}for(let n=e.argNames.length;n<=e.getReturnIndex();n++)r.push(EZ(e,r,n)),t.push(IZ(e,r,t,n));return t[e.getReturnIndex()]}function EZ(e,t,r){let n=e.getInstruction(r),i=CZ(e.argNames.length);if(pt(n))return i;for(let o of n.args){let a=t[o];for(let s=0;s<a.length;s++)i[s]=i[s]||a[s]}return i}function IZ(e,t,r,n){let i=e.getInstruction(n);if(pt(i))return ez(e.argNames.length);switch(i.type){case 8:case 9:case 14:case 15:case 16:case 38:{let s=ez(e.argNames.length);for(let c=0;c<i.args.length;c++){let l=r[i.args[c]];for(let u=0;u<l.length;u++)s[u]=s[u]&&l[u]}return s}case 11:{let s=[],c=r[i.args[0]],l=t[i.args[1]];for(let u=0;u<c.length;u++)s.push(c[u]&&!l[u]);return s}case 10:{let s=r[i.args[0]].slice(),c=r[i.args[1]].slice(),l=t[i.args[0]],u=t[i.args[1]],d=0,f=0;for(let g=0;g<s.length;g++){let y=s[g]&&!u[g],x=c[g]&&!l[g];s[g]=y,c[g]=x,y&&(d+=1),x&&(f+=1)}return d>=f?s:c}case 33:{let s=t[i.args[0]],c=r[i.args[1]],l=r[i.args[2]];for(var o=[],n=0;n<s.length;n++)o.push(!s[n]&&c[n]&&l[n]);return o}case 39:case 40:case 41:{let s=r[i.args[0]],c=t[i.args[1]],l=[];for(var n=0;n<c.length;n++)l.push(s[n]&&!c[n]);return l}case 48:{let s=i.args[0],c=e.getInstruction(s),l=n-s;return r[c.args[l]]}case 12:case 13:case 26:case 28:case 27:case 29:case 25:case 32:case 31:case 37:case 42:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 44:case 49:case 50:case 51:case 53:case 54:case 55:{let s=t[n],c=[];for(let l of s)c.push(!l);return c}default:let a=i;throw new Error(`Unexpected opcode ${a.type}`)}}function CZ(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function ez(e){let t=[];for(let r=0;r<e;r++)t.push(!0);return t}function Fn(e,t,r){switch(t){case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 21:case 19:case 23:case 50:return C;case 25:case 26:case 27:case 28:case 29:case 31:case 32:return tt;case 33:{let i=e.getInstruction(r[1]).valueType,o=e.getInstruction(r[2]).valueType,a=Jd(i,o);return a===void 0?i:a}case 38:return fh(r.map(i=>e.getInstruction(i).valueType));case 39:case 40:case 41:{let i=e.getInstruction(r[0]).valueType;return xe(i)?It(i):nn}case 44:return lr;case 49:return nr;case 55:return e.getInstruction(r[0]).valueType;case 1:case 2:case 37:case 42:case 47:case 48:case 3:case 0:case 24:case 22:case 20:case 51:case 4:case 53:case 54:case 15:case 16:return nn;default:let n=t;throw new Error(`Unexpected opcode ${n}`)}}function rz(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be lifted to numbers");let t=e.getInstruction(e.getReturnIndex());if(pt(t))return e.getReturnIndex();switch(t.type){case 8:let[r,n]=t.args;return eo(e,r)&&eo(e,n)?(e.popInstruction(),e.NativeFunction("complex",[e.Add([e.Slot(0,[r]),e.Slot(0,[n])]),e.Add([e.Slot(1,[r]),e.Slot(1,[n])])])):eo(e,r)&&zo(e,n)?(e.popInstruction(),e.NativeFunction("complex",[e.Add([e.Slot(0,[r]),n]),e.Slot(1,[r])])):zo(e,r)&&eo(e,n)?(e.popInstruction(),e.NativeFunction("complex",[e.Add([r,e.Slot(0,[n])]),e.Slot(1,[n])])):Op(e,r)&&Op(e,n)?(e.popInstruction(),e.TupleOfType(z,[e.Add([e.Slot(0,[r]),e.Slot(0,[n])]),e.Add([e.Slot(1,[r]),e.Slot(1,[n])])])):Lp(e,r)&&Lp(e,n)?(e.popInstruction(),e.TupleOfType(oe,[e.Add([e.Slot(0,[r]),e.Slot(0,[n])]),e.Add([e.Slot(1,[r]),e.Slot(1,[n])]),e.Add([e.Slot(2,[r]),e.Slot(2,[n])])])):gd(e,t.args)?(e.popInstruction(),Np(e,[e.Add([Pa(e,r),Pa(e,n)]),Ol(e,t.args[0])])):e.getReturnIndex();case 9:{let[o,a]=t.args;return eo(e,o)&&eo(e,a)?(e.popInstruction(),e.NativeFunction("complex",[e.Subtract([e.Slot(0,[o]),e.Slot(0,[a])]),e.Subtract([e.Slot(1,[o]),e.Slot(1,[a])])])):eo(e,o)&&zo(e,a)?(e.popInstruction(),e.NativeFunction("complex",[e.Subtract([e.Slot(0,[o]),a]),e.Slot(1,[o])])):zo(e,o)&&eo(e,a)?(e.popInstruction(),e.NativeFunction("complex",[e.Subtract([o,e.Slot(0,[a])]),e.Negative([e.Slot(1,[a])])])):Op(e,o)&&Op(e,a)?(e.popInstruction(),e.TupleOfType(z,[e.Subtract([e.Slot(0,[o]),e.Slot(0,[a])]),e.Subtract([e.Slot(1,[o]),e.Slot(1,[a])])])):Lp(e,o)&&Lp(e,a)?(e.popInstruction(),e.TupleOfType(oe,[e.Subtract([e.Slot(0,[o]),e.Slot(0,[a])]),e.Subtract([e.Slot(1,[o]),e.Slot(1,[a])]),e.Subtract([e.Slot(2,[o]),e.Slot(2,[a])])])):gd(e,t.args)?(e.popInstruction(),Np(e,[e.Subtract([Pa(e,o),Pa(e,a)]),Ol(e,o)])):e.getReturnIndex()}case 14:{let[o]=t.args;return eo(e,o)?(e.popInstruction(),e.NativeFunction("complex",[e.Negative([e.Slot(0,[o])]),e.Negative([e.Slot(1,[o])])])):Op(e,o)?(e.popInstruction(),e.TupleOfType(z,[e.Negative([e.Slot(0,[o])]),e.Negative([e.Slot(1,[o])])])):Lp(e,o)?(e.popInstruction(),e.TupleOfType(oe,[e.Negative([e.Slot(0,[o])]),e.Negative([e.Slot(1,[o])]),e.Negative([e.Slot(2,[o])])])):gd(e,t.args)?(e.popInstruction(),Np(e,[e.Negative([Pa(e,o)]),Ol(e,o)])):e.getReturnIndex()}case 10:{let[o,a]=t.args;if(eo(e,o)&&eo(e,a)){e.popInstruction();let s=e.Slot(0,[o]),c=e.Slot(1,[o]),l=e.Slot(0,[a]),u=e.Slot(1,[a]);return e.NativeFunction("complex",[e.Subtract([e.Multiply([s,l]),e.Multiply([c,u])]),e.Add([e.Multiply([s,u]),e.Multiply([l,c])])])}else{if(eo(e,o)&&zo(e,a))return e.popInstruction(),e.NativeFunction("complex",[e.Multiply([e.Slot(0,[o]),a]),e.Multiply([e.Slot(1,[o]),a])]);if(zo(e,o)&&eo(e,a))return e.popInstruction(),e.NativeFunction("complex",[e.Multiply([o,e.Slot(0,[a])]),e.Multiply([o,e.Slot(1,[a])])]);if(Kx(e,o)&&Kx(e,a))return e.popInstruction(),e.NativeFunction("restriction",[e.And([e.NativeFunction("restrictionToBoolean",[o]),e.NativeFunction("restrictionToBoolean",[a])])]);if(Kx(e,o)||Kx(e,a)){let s,c;Kx(e,o)?(s=o,c=a):(s=a,c=o);let l=e.getInstruction(c).valueType;return Vc(l)?(e.popInstruction(),e.Piecewise([e.NativeFunction("restrictionToBoolean",[s]),c,e.NanOfType(l)])):e.getReturnIndex()}else return Op(e,o)&&zo(e,a)?(e.popInstruction(),e.TupleOfType(z,[e.Multiply([e.Slot(0,[o]),a]),e.Multiply([e.Slot(1,[o]),a])])):zo(e,o)&&Op(e,a)?(e.popInstruction(),e.TupleOfType(z,[e.Multiply([o,e.Slot(0,[a])]),e.Multiply([o,e.Slot(1,[a])])])):gd(e,[o])&&zo(e,a)?(e.popInstruction(),Np(e,[e.Multiply([Pa(e,o),a]),Ol(e,o)])):zo(e,o)&&gd(e,[a])?(e.popInstruction(),Np(e,[e.Multiply([o,Pa(e,a)]),Ol(e,a)])):Lp(e,o)&&zo(e,a)?(e.popInstruction(),e.TupleOfType(oe,[e.Multiply([e.Slot(0,[o]),a]),e.Multiply([e.Slot(1,[o]),a]),e.Multiply([e.Slot(2,[o]),a])])):zo(e,o)&&Lp(e,a)?(e.popInstruction(),e.TupleOfType(oe,[e.Multiply([o,e.Slot(0,[a])]),e.Multiply([o,e.Slot(1,[a])]),e.Multiply([o,e.Slot(2,[a])])])):e.getReturnIndex()}}case 11:{let[o,a]=t.args;return eo(e,o)&&eo(e,a)?(e.popInstruction(),e.NativeFunction("complexDivide",[o,a])):eo(e,o)&&zo(e,a)?(e.popInstruction(),e.NativeFunction("complex",[e.Divide([e.Slot(0,[o]),a]),e.Divide([e.Slot(1,[o]),a])])):zo(e,o)&&eo(e,a)?(e.popInstruction(),e.NativeFunction("complexDivide",[e.NativeFunction("complex",[o,e.Constant(0)]),a])):Op(e,o)&&zo(e,a)?(e.popInstruction(),e.TupleOfType(z,[e.Divide([e.Slot(0,[o]),a]),e.Divide([e.Slot(1,[o]),a])])):gd(e,[o])&&zo(e,a)?(e.popInstruction(),Np(e,[e.Divide([Pa(e,o),a]),Ol(e,o)])):Lp(e,o)&&zo(e,a)?(e.popInstruction(),e.TupleOfType(oe,[e.Divide([e.Slot(0,[o]),a]),e.Divide([e.Slot(1,[o]),a]),e.Divide([e.Slot(2,[o]),a])])):e.getReturnIndex()}case 25:{let[o,a]=t.args;if(eo(e,o)&&eo(e,a)){e.popInstruction();let s=e.Slot(0,[o]),c=e.Slot(0,[a]),l=e.Slot(1,[o]),u=e.Slot(1,[a]);return e.And([e.Equal([s,c]),e.Equal([l,u])])}else if(zo(e,o)&&eo(e,a)){e.popInstruction();let s=o,c=e.Slot(0,[a]),l=e.Constant(0),u=e.Slot(1,[a]);return e.And([e.Equal([s,c]),e.Equal([l,u])])}else if(eo(e,o)&&zo(e,a)){e.popInstruction();let s=e.Slot(0,[o]),c=a,l=e.Slot(1,[o]),u=e.Constant(0);return e.And([e.Equal([s,c]),e.Equal([l,u])])}else return e.getReturnIndex()}case 12:case 13:case 26:case 27:case 28:case 29:case 32:case 31:case 15:case 33:case 16:case 37:case 42:case 39:case 40:case 41:case 21:case 22:case 19:case 20:case 38:case 47:case 23:case 24:case 48:case 44:case 49:case 50:case 51:case 53:case 54:case 55:return e.getReturnIndex();default:let i=t;throw new Error(`Unexpected opcode ${i.type}`)}}function Op(e,t){return e.getInstruction(t).valueType===z}function Lp(e,t){return e.getInstruction(t).valueType===oe}function zo(e,t){return e.getInstruction(t).valueType===C}function eo(e,t){return e.getInstruction(t).valueType===$}function Kx(e,t){return e.getInstruction(t).valueType===ir}function gd(e,t){return t.every(r=>Pr(e,r,Ve))||t.every(r=>Pr(e,r,Pt))}function Np(e,t){return Rp(e,t,"mathVector",jx("mathVector","mathVectorThreeD"))}function Ol(e,t){return Rp(e,[t],"start",[{match:[Ve],build:()=>e.NativeFunction("basePointFromVector",[t])},{match:[Pt],build:()=>e.NativeFunction("basePointFromVectorThreeD",[t])}])}function Pa(e,t){return Rp(e,[t],"displacement",[{match:[Ve],build:()=>e.NativeFunction("vectorDisplacementAsPoint",[t])},{match:[Pt],build:()=>e.NativeFunction("vectorThreeDDisplacementAsPoint",[t])}])}function jx(e,t){return[{match:[z,z],build:(r,n)=>r.NativeFunction(e,n)},{match:[oe,oe],build:(r,n)=>r.NativeFunction(t,n)}]}function kp(e,t){if(t.type!==33)return!1;let r=e.getInstruction(t.args[2]);return r.type===1&&Vc(r.valueType)&&aB(r.valueType,r.value)||kp(e,r)&&nz(e,t.args[1])&&nz(e,r.args[1])}function zO(e,t){let r=[];for(;t.type===33;)r.push(t.args[0]),t=e.getInstruction(t.args[2]);return r}function*IE(e,t){let r=e.getInstruction(t);r.type!==32?yield t:(yield*IE(e,r.args[0]),yield*IE(e,r.args[1]))}function iz(e,t){return e.getInstruction(t).type===25}function oz(e,t){let r=e.getInstruction(t);if(r.type!==25)return;let n=r.args[0],i=r.args[1],o=e.getInstruction(n),a=e.getInstruction(i),s=(a.type===41||a.type===40)&&kt(e.getInstruction(a.args[0]));return o.type===2&&(kt(a)||s)&&Le(a.valueType,C)?{type:"constant",variable:e.argNames[n],index:i}:Le(o.valueType,C)&&Le(a.valueType,C)?{type:"implicit",index:e.Subtract([n,i])}:void 0}function nz(e,t){let r=e.getInstruction(t);return r.type===1&&r.valueType===C&&ae(r.value)===1}var HO=class{constructor(t,r,n,i){this.openChunk=t;this.returnIndex=r;this.restrictionIndex=n;this.slices=i}getSliceVariablesOrImplicit(){return this.slices.map(t=>t.type==="constant"?t.variable:"_implicit")}getPeeledSlices(){let t=[];for(let r of this.slices)if(r.type==="constant"){let n=this.openChunk.getInstruction(r.index);if(kt(n)&&n.valueType===C)t.push({type:"constant",variable:r.variable,value:ae(n.value)});else if(!(kt(n)&&n.valueType===ke))throw lu()}else if(this.openChunk.getInstruction(r.index).valueType===C){let i=this.openChunk.copy();i.setReturnIndex(r.index),i.fuseBroadcast(),t.push({type:"implicit",sliceChunk:i})}else throw lu();return t}getValueAndRestrictionChunk(){let t=this.getPeeledSlices(),r=this.openChunk.copy();r.setReturnIndex(this.returnIndex),r.fuseBroadcast();let n;return this.restrictionIndex!==void 0&&(n=this.openChunk.copy(),n.setReturnIndex(this.restrictionIndex),n.fuseBroadcast()),{valueChunk:r,restrictionChunk:n,slices:t}}getSlicesAndRestrictionChunk(){let t=this.getPeeledSlices(),r=this.openChunk.copy(),n=r.GreaterEqual([this.returnIndex,r.Constant(0)]);return this.restrictionIndex!==void 0&&(n=r.And([n,this.restrictionIndex])),r.setReturnIndex(n),r.fuseBroadcast(),{restrictionChunk:r,slices:t}}},CE=class{constructor(t,r,n){this.chunk=t;this.slices=[];this.oldIPtoNewIP=[];this.oldIPToRestriction=[];var i,o;this.produceNumbers=(i=n==null?void 0:n.produceNumbers)!=null?i:!1,this.allowSlices=(o=n==null?void 0:n.allowSlices)!=null?o:!1,this.newChunk=new hu({argNames:t.argNames,argTypes:t.argTypes}),this.startTrue=this.produceNumbers?this.newChunk.Constant(1/0):this.newChunk.ConstantOfType(tt,!0),this.peelable=MZ(t),_Z(t,this.peelable,r)}selectRestriction(){return!0}},$O=class extends CE{constructor(r,n,i){super(r,n,i);this.currSelectIndex=0;this.selectIndex=i.selectIndex}selectRestriction(){let r=this.selectIndex===this.currSelectIndex;return this.currSelectIndex++,this.produceNumbers?r:!r}};function fd(e,t,r){let n=new CE(e,t,r);YO(n,0,e.instructionsLength()-1);let i=n.oldIPToRestriction[e.getReturnIndex()];return new HO(n.newChunk,n.oldIPtoNewIP[e.getReturnIndex()],n.startTrue===i?void 0:i,n.slices)}function*az(e,t,r){var i,o;let n=UO(e,r,{produceNumbers:!1,selectIndex:0});if(n===void 0||n.count<=1){yield{value:t,restriction:void 0};return}for(let a=0;a<n.count;a++){let s=(i=UO(e,r,{produceNumbers:!0,selectIndex:a}))==null?void 0:i.chunk,c=a===0?n.chunk:(o=UO(e,r,{produceNumbers:!1,selectIndex:a}))==null?void 0:o.chunk;if(!s||!c)throw new Error("Programming Error: selectIndex gave invalid chunk.");yield{value:s,restriction:c}}}function UO(e,t,r){let n=new $O(e,t,r);YO(n,0,e.instructionsLength()-1);let i=n.oldIPToRestriction[e.getReturnIndex()];if(n.currSelectIndex===0)return;let o=n.oldIPtoNewIP[e.getReturnIndex()],a=n.newChunk.getInstruction(o);if(a.type!==29)throw new Error("Programming Error: Expected GreaterEqual.");let s=n.produceNumbers?n.newChunk.Subtract([a.args[0],a.args[1]]):o;return n.selectRestriction()&&(i=PE(n,[i,s])),n.newChunk.setReturnIndex(i),{chunk:n.newChunk,count:n.currSelectIndex}}function YO(e,t,r){let{chunk:n,newChunk:i,peelable:o,oldIPtoNewIP:a,oldIPToRestriction:s}=e;for(let c=t;c<=r;c++){let l=n.getInstruction(c);if(o[c]&&(l.type===19||l.type===23))c=SZ(e,c);else if(l.type===2)a[c]=c,s[c]=e.startTrue;else if(pt(l))a[c]=i.copyInstruction(l),s[c]=e.startTrue;else if(o[c]&&kp(n,l)){a[c]=a[l.args[1]];let u=l.args.map(d=>s[d]);for(let d of AZ(e,l))e.selectRestriction()&&u.push(d);s[c]=PE(e,u)}else a[c]=i.copyInstructionWithArgs(l,l.args.map(u=>a[u])),s[c]=PE(e,l.args.map(u=>s[u]))}}function PE(e,t){let n=[...new Set(t)].filter(i=>!sz(e,i));return n.length?SE(e,n).reduce((i,o)=>e.produceNumbers?e.newChunk.NativeFunction("min",[i,o]):e.newChunk.And([i,o])):e.startTrue}function PZ(e,t){let r=[...new Set(t)];return r.some(n=>!sz(e,n))?SE(e,r).reduce((n,i)=>e.produceNumbers?e.newChunk.NativeFunction("max",[n,i]):e.newChunk.Or([n,i])):e.startTrue}function SE(e,t){if(!e.produceNumbers)return t;let r=e.newChunk;return t.map(n=>{let i=r.getInstruction(n);if(i.valueType!==tt)return n;switch(i.type){case 27:case 29:return r.Subtract([i.args[0],i.args[1]]);case 26:case 28:return r.Subtract([i.args[1],i.args[0]]);case 25:throw Ie("convertBoolsToNums on an equality.");case 32:return r.NativeFunction("min",SE(e,i.args));case 31:return r.NativeFunction("max",SE(e,i.args));case 1:return r.Constant(i.value?1/0:-1/0);default:throw Ie("convertBoolsToNums on a non-opcode condition.")}})}function sz({newChunk:e},t){let r=e.getInstruction(t);return r.type===1&&(r.valueType===C&&r.value===1/0||r.valueType===tt&&r.value)}function SZ(e,t){let{chunk:r,newChunk:n,oldIPtoNewIP:i,oldIPToRestriction:o,startTrue:a}=e,s=r.getInstruction(t),c=s.endIndex,l=r.getInstruction(c),u,d;if(s.type===23)i[t]=n.copyInstructionWithArgs(s,[i[s.args[0]]]),o[t]=a,d=t+1;else{let x=s.args.map(b=>i[b]);x.push(a),i[t]=n.copyInstructionWithArgs(s,x),o[t]=a;for(let b=2;b<s.args.length;b++){let w=t+b-1;i[w]=n.copyInstructionWithArgs(r.getInstruction(w),[i[t]]),o[w]=a}u=n.BlockVar(e.produceNumbers?C:tt,[i[t]]),d=t+s.args.length-1}YO(e,d,c-1);let f=l.args.map(x=>i[x]),g=e.slices.filter(x=>d<=x.index&&x.index<c),y=u;if(s.type===19){if(u===void 0)throw new Error("Expected restrictionAccumVar to be defined");y=PE(e,[u,o[l.args[1]]]),f.push(y)}else{f.push(o[l.args[1]]);for(let x of g)f.push(x.index)}i[c]=n.copyInstructionWithArgs(l,f),o[c]=a;for(let x=1;x<l.args.length;x++)i[c+x]=n.copyInstructionWithArgs(r.getInstruction(c+x),[i[c]]);if(s.type===23){let x=n.BroadcastResult(e.produceNumbers?ke:vi,[i[c]]);for(let b of g)b.index=n.BroadcastResult(ke,[i[c]]);for(let b=1;b<l.args.length;b++)o[c+b]=x}else{let x=n.BlockVar(e.produceNumbers?C:tt,[i[c]]);u===y&&(x=a);for(let b=1;b<l.args.length;b++)o[c+b]=x}return c+l.args.length-1}function MZ(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);t[e.getReturnIndex()]=!0;let r=e.instructionsLength()-1;for(let n=r;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(!pt(i))for(let o of DZ(e,i))t[o]=!0}return t}function DZ(e,t){switch(t.type){case 14:case 8:case 9:case 26:case 28:case 27:case 29:case 10:case 11:case 12:case 13:case 25:case 32:case 15:case 38:case 47:case 19:case 39:case 40:case 41:case 23:case 24:case 48:case 50:return t.args;case 33:return kp(e,t)?zO(e,t).concat([t.args[1]]):[];case 37:{let n=Xn[t.symbol];return n.noPeel?[]:n.tag==="reducer"||n.tag==="doubleReducer"||n.tag==="never-broadcast"||n.tag==="parameterizedReducer"?t.args.filter(i=>e.getInstruction(i).type!==48):t.args}case 20:return t.args.slice(1);case 51:return[];case 31:return[];case 16:case 42:case 21:case 22:case 44:case 49:case 53:case 54:case 55:return[];default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function _Z(e,t,r){let n=[];for(let i=0;i<e.argNames.length;i++){let o=e.argNames[i];r.indexOf(o)<0&&n.push(i)}for(let i of n){let o=wp(e,i);for(let a=0;a<e.instructionsLength();a++)t[i]&&(t[i]=!o[a])}}function AZ(e,t){let r=zO(e.chunk,t).map(n=>e.oldIPtoNewIP[n]);if(e.allowSlices&&r.length===1){let n=oz(e.newChunk,r[0]);if(n)return e.slices.push(n),[]}if(r.some(n=>iz(e.newChunk,n)))throw lu();if(r.length===1){let n=r[0];return[...IE(e.newChunk,n)]}return[PZ(e,r)]}function cz(e,t){let r=[],n=[],i=[];for(let a=0;a<e.argNames.length;a++)t.hasOwnProperty(e.argNames[a])||(r.push(e.argNames[a]),n.push(e.argTypes[a]));let o=new hu({argNames:r,argTypes:n});for(let a=0,s=0;a<e.argNames.length;a++)t.hasOwnProperty(e.argNames[a])?i[a]=o.ConstantOfType(e.argTypes[a],t[e.argNames[a]]):(i[a]=s,s+=1);for(let a=e.argNames.length;a<e.instructionsLength();a++){let s=e.getInstruction(a);if(pt(s))i.push(qc(o,s));else{let c=[];for(let l of s.args)c.push(i[l]);i.push(Yn(o,s,c))}}return o}var ME=class e{constructor(){this.maps={real:{},complexOne:{},complexI:{}}}clone(){let t=new e;return t.maps=Bn(this.maps),t}pruneIP(t){for(let r of Object.values(this.maps))delete r[t]}truncate(t){for(let r of Object.values(this.maps))for(let n in r){let i=+n;i>=t?delete r[i]:OZ(r[i],t)}}getMapEntry(t,r,n){let i=this.maps[r],o=i[n];if(o)return o;let a={maxValidReference:t.instructionsLength()-1,map:[]};return i[n]=a,a}_cachedDerivativesForTests(){let t=[];for(let[r,n]of Object.entries(this.maps))for(let i in n)t.push(`${i} ${r}`);return t.sort(),t}};function OZ(e,t){e.map.length=Math.min(e.map.length,t),e.maxValidReference=Math.min(e.maxValidReference,t-1)}var LZ={mcd:"gcd",gcf:"gcd",mcm:"lcm",signum:"sign",sgn:"sign",stdDevP:"stdevp",stddevp:"stdevp",stdDev:"stdev",stddev:"stdev",variance:"var",TTest:"ttest",TScore:"tscore",IndependentTTest:"ittest",iTTest:"ittest",inverseCdf:"quantile",inversecdf:"quantile",arsinh:"arcsinh",arcosh:"arccosh",artanh:"arctanh",arcsch:"arccsch",arsech:"arcsech",arcoth:"arccoth"};function lz(e){let t=0;for(;K0(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),LZ[e]||e}function uz(e,t,r){return{type:"Comparator",span:e,symbol:t,args:r}}function dz(e,t,r){if(t.length<1)throw"Programming Error: ComparatorChain must have at least one comparator.";if(r.length!==t.length+1)throw"Programming Error: ComparatorChain must have one more arg than symbols";return{type:"ComparatorChain",span:e,args:r,symbols:t}}function pz(e,t){return{type:"Tilde",span:e,args:t}}function gz(e,t){return{type:"Pos",span:e,args:t}}function fz(e,t){return{type:"Neg",span:e,args:t}}function mz(e,t){return{type:"Add",span:e,args:t}}function hz(e,t){return{type:"Sub",span:e,args:t}}function yz(e,t){return{type:"Mul",span:e,args:t}}function bz(e,t){return{type:"DotMul",span:e,args:t}}function xz(e,t){return{type:"CrossMul",span:e,args:t}}function vz(e,t){return{type:"Div",span:e,args:t}}function Tz(e,t){return{type:"Bang",span:e,args:t}}function Zx(e,t){return{type:"Call",span:e,args:t}}function WO(e,t){return{type:"ImplicitCall",span:e,args:t}}function wz(e,t){return{type:"Index",span:e,args:t}}function XO(e,t){return{type:"Paren",span:e,args:t}}function KO(e,t){return{type:"List",span:e,args:t}}function Ez(e,t){return{type:"Pipes",span:e,args:t}}function jO(e,t){return{type:"Subscript",span:e,args:t}}function DE(e,t){return{type:"Superscript",span:e,args:t}}function Jx(e,t,r){return{type:"Prime",span:e,nprimes:t,args:r}}function _E(e,t){return{type:"Seq",span:e,args:t}}function Iz(e,t){return{type:"Sqrt",span:e,args:t}}function Cz(e,t){return{type:"Nthroot",span:e,args:t}}function Pz(e,t){return{type:"Frac",span:e,args:t}}function Sz(e,t){return{type:"Derivative",span:e,args:t}}function Mz(e,t){return{type:"Integral",span:e,args:t}}function Dz(e,t){return{type:"EmptyIntegral",span:e,args:t}}function _z(e,t){return{type:"Sum",span:e,args:t}}function Az(e,t){return{type:"Product",span:e,args:t}}function Oz(e,t){return{type:"Piecewise",span:e,args:t}}function Lz(e){return{type:"EmptyPiecewise",span:e}}function Nz(e){return{type:"EmptyRangeEnd",span:e}}function Rz(e,t){return{type:"Colon",span:e,args:t}}function ZO(e,t){return{type:"Ellipsis",span:e,args:t}}function kz(e,t){return{type:"For",span:e,args:t}}function Vz(e,t){return{type:"With",span:e,args:t}}function Fz(e,t){return{type:"Dot",span:e,args:t}}function Gz(e,t){return{type:"PercentOf",span:e,args:t}}function Bz(e,t){return{type:"RightArrow",span:e,args:t}}function JO(e,t){return{type:"Juxt",span:e,args:t}}function qz(e,t){return{type:"Letter",span:e,val:t}}function AE(e,t){return{type:"Decimal",span:e,val:t}}function Pf(e,t){return{type:"Cmd",span:e,val:lz(t)}}function zz(e,t){return{type:"Alphanumeric",span:e,val:t}}function Uz(e,t,r,n){return{type:"MixedNumber",span:e,whole:t,num:r,den:n}}function Si(e){if(e.type==="Subscript"){if(e.args[1].type!=="Alphanumeric")return!1;e=e.args[0]}switch(e.type){case"Cmd":return!0;case"Letter":return!0;default:return!1}}function Hz(e){return e.type!=="Superscript"?!1:Si(e.args[0])}function $z(e,t){if(e.type!=="Letter"||e.val!=="d"||t.type!=="Juxt")return!1;let[r,n]=t.args;return r.type!=="Letter"||r.val!=="d"?!1:Si(n)}function to(e){return e.type==="Seq"?e.args:[e]}function Yz(e,t,r,n,i,o,a,s){return{opts:e,input:t,prevSpan:r,startIndex:n,endIndex:i,token:o,mode:a,parent:s}}function mt(e,t){return $a(e.token.span,t.prevSpan)}function mi(e,t){return $a(e,t.prevSpan)}function eL(e){return Tl(e.token.span.input,e.token.span.start)}function RZ(e,t){return{type:"Differential",span:e,val:t}}function Sa(e,t,r){return{type:e,span:t,val:r}}function md(e,t){let r=Tl(e.span.input,e.span.start);return tL(t,e,0,r,void 0,void 0)}function tL(e,t,r,n,i,o){let a=t.args;if(r>a.length&&o)return Wz(o,n);r=Qx(a,r);let{token:s,endIndex:c}=Xz(t,r,i);if(s.type==="End"&&o){let l=o.input.args[o.startIndex];if(l.type==="LeftRight"){let u=l.right,d=VG[u.val]||"Err",f=Sa(d,u.span,u.val);return Yz(e,t,n,r,c,f,i,o)}}else s.type==="Int"?i=kZ(i):s.type==="Differential"&&(i=VZ(i));return Yz(e,t,n,r,c,s,i,o)}function Lt(e){let t=e.input.args[e.startIndex],r=e.token.span;return t&&t.type==="LeftRight"?tL(e.opts,t.arg,0,r,e.mode,e):Wz(e,r)}function Wz(e,t){let{input:r,endIndex:n,mode:i,parent:o}=e;return tL(e.opts,r,n+1,t,i,o)}function Uo(e){return e.token}function kZ(e){return{type:"integral",parent:e}}function VZ(e){if(!e||e.type!=="integral")throw new Error("Programming Error: expected lexer to be in integral mode.");return e.parent}function wo(e,t){return Uo(e).type===t}function NE(e){return e.startIndex>=e.input.args.length}function rL(e,t){return t.token.span.start>e.token.span.start}function Bi(e,t){return{token:t,endIndex:e}}function Xz(e,t,r){let n=e.args;if(t>=n.length){let a=Tl(e.span.input,e.span.end);return Bi(t,Sa("End",a,""))}let i=e.args[t];switch(i.type){case"Sqrt":case"Frac":case"SupSub":return Bi(t,i);case"Letter":{if(!r||r.type!=="integral"||i.val!="d")return Bi(t,i);let{endIndex:u,token:d}=Xz(e,t+1,r);if(d.type==="Letter"||d.type==="Cmd"){let f=RZ($a(i.span,d.span),d.val);return Bi(u,f)}else return Bi(t,i)}case"LeftRight":{let u=i.left,d=kG[u.val]||"Err";var o=$a(i.span,u.span);return Bi(t,Sa(d,o,u.val))}case"OperatorName":let a=[];for(let u of i.arg.args){if(u.type!=="Letter")return Bi(t,Sa("Err",i.span,Jn(i.arg.span)));a.push(u.val)}let s="\\"+a.join(""),c=eu[s]||"Cmd";return Bi(t,Sa(c,i.span,s));case"TokenNode":{let u="$";if(i.arg.args.length===0)return Bi(t,Sa("Err",i.span,Jn(i.arg.span)));for(let d of i.arg.args){if(d.type!=="Digit")return Bi(t,Sa("Err",i.span,Jn(i.arg.span)));u+=d.val}return Bi(t,Sa("TokenNode",i.span,u))}case"Cmd":{let u=eu[i.val]||"Cmd";return Bi(t,Sa(u,i.span,i.val))}case"EscapedSymbol":{let u=RG[i.val]||"Err";return Bi(t,Sa(u,i.span,i.val))}case"Symbol":return FZ(e,t,i);case"Digit":return Kz(e,t);default:throw`Unexpected atom ${i.type}.`}}function FZ(e,t,r){switch(r.val){case".":return GZ(e,t);case"-":{let i=e.args[t+1];if(i&&OE(i,">")){let o=Sa("->",$a(r.span,i.span),"->");return Bi(t+1,o)}break}case"<":{let i=e.args[t+1];if(i&&OE(i,"=")){let o=Sa("<=",$a(r.span,i.span),"<=");return Bi(t+1,o)}break}case">":{let i=e.args[t+1];if(i&&OE(i,"=")){let o=Sa(">=",$a(r.span,i.span),">=");return Bi(t+1,o)}break}}let n=aS[r.val]||"Err";return Bi(t,Sa(n,r.span,r.val))}function GZ(e,t){let r=e.args[t];if(r.type!=="Symbol"||r.val!==".")throw new Error("Programming Error: expected '.'");if(t+2<e.args.length&&LE(e.args[t+1])&&LE(e.args[t+2])){let o=$a(r.span,e.args[t+2].span);return Bi(t+2,Sa("...",o,Jn(o)))}let n=Qx(e.args,t+1);if(n<e.args.length&&e.args[n].type==="Digit")return Kz(e,t);let i=aS[r.val]||"Err";return Bi(t,Sa(i,r.span,r.val))}function Kz(e,t){let r=BZ(e,t);if(r)return r;let n=e.args,i=e.args[t].span,o=[],a=!1,s=!1;for(;t<n.length;t++){let l=Qx(n,t);if(l>=n.length)break;let u=n[l];if(u.type==="Digit")t=l,a=!0,o.push(u.val);else if(!s&&LE(u)){if(l+1<n.length&&LE(e.args[l+1]))break;t=l,s=!0,o.push(".")}else break}if(!a)throw new Error("Programming Error: decimals must have at least one digit.");let c=$a(i,e.args[t-1].span);return Bi(t-1,Sa("Decimal",c,o.join("")))}function BZ(e,t){let r=e.args,n=r[t].span,i=[];for(;t<r.length;t++){let l=Qx(r,t);if(l>=r.length)break;let u=r[l];if(u.type!=="Digit")break;t=l,i.push(u.val)}if(t=Qx(r,t),t>=r.length)return;let o=r[t];if(o.type!=="Frac")return;let a=[],s=[];for(let l of o.num.args)if(!QO(l)){if(l.type!=="Digit")return;a.push(l.val)}for(let l of o.den.args)if(!QO(l)){if(l.type!=="Digit")return;s.push(l.val)}let c=$a(n,o.span);return Bi(t,Uz(c,i.join(""),a.join(""),s.join("")))}function QO(e){switch(e.type){case"Sqrt":case"Frac":case"SupSub":case"LeftRight":case"OperatorName":case"TokenNode":case"Symbol":case"Letter":case"Digit":return!1;case"Cmd":return e.val==="\\space";case"EscapedSymbol":return e.val==="\\ "||e.val==="\\:"||e.val==="\\,"||e.val==="\\;";default:throw`Unexpected atom ${e.type}.`}}function Qx(e,t){for(;t<e.length&&QO(e[t]);)t+=1;return t}function LE(e){return OE(e,".")}function OE(e,t){return e.type==="Symbol"&&e.val===t}var jh={},qZ=["sin","cos","tan","cot","sec","csc","sinh","cosh","tanh","coth","sech","csch"];qZ.forEach(function(e){jh[e]="arc"+e,jh["arc"+e]=e});var zZ=0;function FE(e,t){return UZ(e,t)}function sr(e,t){let r=[];for(let n=0;n<t.length;n++)r.push(hn(e,t[n]));return r}function UZ(e,t){return e.setInput(HZ(e,t),t.span)}function tU(e){if(e.type!=="Call")return;let[t,r]=e.args,n=to(r);if(Si(t)&&n.every(Si))return{base:t,args:n}}function oL(e){return tU(e)!==void 0}function aL(e){return Si(e)}function HZ(e,t){let r=e.nodes;switch(t.type){case"Comparator":if(t.symbol==="="){let[n,i]=t.args,o=tU(n);if(o){let{base:a,args:s}=o,c=sr(e,s),l=e;if(e.includeFunctionParametersInRandomSeed)for(let d of c)l=rv(l,{prefix:"fc",expr:d});let u=hn(l,i);return r.FunctionDefinition(hn(e,a),c,u)}else{if(n.type==="Call"&&Si(n.args[0]))return r.CallAssignment(hn(e,n),hn(e,i));if(aL(n)){let a;return i.type==="For"?a=e.setInput(kE(e,i,{parentIsList:!1}),i.span):a=hn(e,i),r.Assignment(hn(e,n),a)}}return r.Equation(hn(e,n),hn(e,i))}else return vu(e,t);case"Tilde":{let[n,i]=sr(e,t.args);return r.Regression(n,i)}case"ComparatorChain":{if(!e.specializeDoubleInequalities||t.symbols.length!==2)return vu(e,t);let[n,i,o]=t.args,[a,s]=t.symbols;return!Si(i)||t.symbols.includes("=")?vu(e,t):r.DoubleInequality([hn(e,n),a,hn(e,i),s,hn(e,o)])}case"Call":{let[n,i]=t.args;if(n.type==="Cmd")switch(n.val){case"histogram":return r.Histogram(sr(e,to(i)));case"dotplot":return r.DotPlot(sr(e,to(i)));case"boxplot":return r.BoxPlot(sr(e,to(i)));case"ttest":return r.TTest(sr(e,to(i)));case"ittest":return r.IndependentTTest(sr(e,to(i)));case"stats":return r.Stats(sr(e,to(i)));default:return ev(e,t)}return ev(e,t)}case"For":return kE(e,t,{parentIsList:!1});default:return ev(e,t)}}function rU(e){if(e.type!=="Paren")return!1;let[t]=e.args;return t.type!=="Seq"?!1:t.args.length===2||t.args.length===3}function jz(e,t,r,n){let i=$Z(e,r,n);if(i!==void 0)return e.setInput(i,$a(t.args[0].span,n.span))}function $Z(e,t,r){let n=e.nodes;if(r.type==="Letter")switch(r.val){case"x":case"y":case"z":return n.NamedCoordinateAccess(r.val,[t])}else if(r.type==="Cmd")switch(r.val){case"real":case"imag":throw fM(r.val)}}function hn(e,t){return e.setInput(ev(e,t),t.span)}function ev(e,t){let r=e.nodes;switch(t.type){case"Pos":return hn(e,t.args[0]);case"Neg":let n=-1,i=t.args[0];for(;;)if(i.type==="Pos"||i.type==="Paren"&&!rU(i))i=i.args[0];else if(i.type==="Neg")i=i.args[0],n*=-1;else break;switch(i.type){case"Decimal":{let a=Qz(i);return r.Constant(n===-1?ko(a):a)}case"MixedNumber":{let a=eU(i);return r.MixedNumber(n===-1?ko(a):a)}default:return n===-1?r.Negative([hn(e,i)]):hn(e,i)}case"Add":return r.Add(sr(e,t.args));case"Sub":return r.Subtract(sr(e,t.args));case"Mul":return r.Multiply(sr(e,t.args));case"DotMul":return r.DotMultiply(sr(e,t.args));case"CrossMul":return r.CrossMultiply(sr(e,t.args));case"Div":return r.Divide(sr(e,t.args));case"Bang":{let[a]=t.args;return a.type==="Call"&&Si(a.args[0])&&!RE(a.args[0])&&to(a.args[1]).length===1?r.FunctionFactorial(sr(e,a.args)):r.FunctionCall("\\factorial",sr(e,t.args))}case"PercentOf":return r.PercentOf(sr(e,t.args));case"Call":return Zz(e,t);case"ImplicitCall":return ZZ(t),Zz(e,t);case"Dot":{let a=t.args[1],[s,c]=sr(e,t.args);if(RE(a)){let l=Tl(a.span.input,a.span.end),u=e.setInput(iU(e),l);c=e.setInput(r.SeededFunctionCall(c,[u]),a.span)}else if(a.type==="Letter")switch(a.val){case"x":case"y":case"z":return r.NamedCoordinateAccess(a.val,[s]);default:break}else if(a.type==="Call"){let l=a.args[0],u=jz(e,t,s,l);if(u!==void 0)return r.Multiply([u,hn(e,a.args[1])])}return r.DotAccess([s,c])}case"Prime":{let[a]=t.args;if(a.type==="Call"){let[s,c]=a.args,l=to(c).length;if(s.type==="Cmd"&&s.val==="logbase"){if(l!==2)throw Bg()}else if(l!==1)throw Bg();return r.Prime(t.nprimes,sr(e,t.args))}else throw a.type==="ImplicitCall"?U1():z1()}case"Index":{let[a,s]=t.args;if(s.type==="Seq")return r.ListAccess([hn(e,a),e.setInput(r.List(sr(e,s.args)),void 0)]);if(s.type==="Ellipsis"){let[c,l]=s.args;return r.ListAccess([hn(e,a),e.setInput(r.Range([e.setInput(r.List(sr(e,to(c))),void 0),e.setInput(r.List(l.type==="EmptyRangeEnd"?[]:sr(e,to(l))),void 0)]),void 0)])}return tv(s)?r.ListAccess([hn(e,a),e.setInput(vu(e,s),void 0)]):r.ListAccess(sr(e,t.args))}case"Paren":{let[a]=t.args;if(a.type==="Seq"){if(a.args.length===0)throw yx();return r.ParenSeq(sr(e,a.args))}else return hn(e,a)}case"List":{if(t.args.length===0)return r.List([]);let a=t.args[0];if(a.type==="Ellipsis"){let[s,c]=a.args;return r.Range([e.setInput(r.List(sr(e,to(s))),void 0),e.setInput(r.List(sr(e,to(c))),void 0)])}else if(a.type==="For")return kE(e,a,{parentIsList:!0});return r.List(sr(e,to(a)))}case"Pipes":{let[a]=t.args;return r.Norm([hn(e,a)])}case"Subscript":{let[a,s]=t.args;if(s.val.length===0)throw q1();let c;switch(a.type){case"Letter":c=a.val;break;case"Cmd":c=a.val;break;default:throw bD()}if(c==="ans")throw Xa("ans");return r.Identifier(`${c}_${s.val}`)}case"Superscript":{let[a,s]=t.args;if(a.type==="Call"&&a.args[1].type!=="Seq"&&!RE(a.args[0])&&!JZ(a))return r.FunctionExponent(sr(e,[a.args[0],a.args[1],s]));if(a.type==="Dot"){let c=a.args[1],[l,u]=sr(e,a.args),d=hn(e,s);if(c.type==="Letter")switch(c.val){case"x":case"y":case"z":return r.Exponent([e.setInput(r.NamedCoordinateAccess(c.val,[l]),a.span),d]);default:break}else if(c.type==="Call"){let f=c.args[0],g=jz(e,a,l,f);if(g!==void 0)return r.Multiply([g,e.setInput(r.Exponent([hn(e,c.args[1]),d]),Ha(t.span.input,c.args[0].span.end,s.span.end))])}return r.Exponent([e.setInput(r.DotAccess([l,u]),a.span),d])}else return r.Exponent(sr(e,t.args))}case"Sqrt":return r.FunctionCall("sqrt",sr(e,t.args));case"Nthroot":return r.FunctionCall("nthroot",sr(e,[t.args[1],t.args[0]]));case"Frac":return r.Divide(sr(e,t.args));case"Derivative":{let a=sr(e,t.args);if(!Si(t.args[0]))throw Ie(`Expected identifier in derivative, but found ${t.args[0].type}`);return r.Derivative(a[0],[a[1]])}case"Integral":{let[a,s,c,l]=t.args,u=sr(e,[a,s,c,l]);return r.Integral(u)}case"EmptyIntegral":{let[a,s,c]=sr(e,t.args),l=e.setInput(r.Constant(Et(1,1)),void 0);return r.Integral([a,s,c,l])}case"Sum":{let[a,s,c]=t.args;if(s.type!=="Comparator"||!Zh(s))throw l_();let l=sr(e,[s.args[0],s.args[1],c]),u=hn(rv(e,{prefix:"ro",expr:l[0]}),a);return r.Sum(l.concat(u))}case"Product":{let[a,s,c]=t.args;if(s.type!=="Comparator"||!Zh(s))throw u_();let l=sr(e,[s.args[0],s.args[1],c]),u=hn(rv(e,{prefix:"ro",expr:l[0]}),a);return r.Product(l.concat(u))}case"Juxt":{if(e.writeIntegral){let[c,l]=t.args;if(l.type==="Letter"&&l.val==="t"&&c.type==="Juxt"&&([c,l]=c.args,l.type==="Letter"&&l.val==="n")){if(c.type==="Juxt"){if([c,l]=c.args,l.type==="Letter"&&l.val==="i")throw tw()}else if(c.type==="Letter"&&c.val==="i")throw tw()}}let[a,s]=t.args;if(a.type==="MixedNumber"&&!(Si(s)||s.type==="Piecewise"||s.type==="Call"||s.type==="Paren"))throw F1(VE(a));if(s.type==="MixedNumber")throw F1(VE(s));return r.Multiply(sr(e,t.args))}case"Letter":return r.Identifier(t.val);case"Cmd":{let a=t.val;switch(a){case"ans":{if(e.currentIndex===void 0)throw Ug("ans");return r.Ans(`ans_{${e.currentIndex-1}}`)}case"approx":throw P1(a);case"dt":{if(!e.allowDt)throw Ug(a);return r.Identifier(a)}case"index":{if(!e.allowIndex)throw Ug(a);return r.Identifier(a)}default:return r.Identifier(a)}}case"With":{if(e.isSubstitutionRHS)throw sw();let[a,s]=t.args,c={...e,isSubstitutionRHS:!0};return r.Substitution(hn(c,a),XZ(c,s))}case"Decimal":return r.Constant(Qz(t));case"MixedNumber":return r.MixedNumber(eU(t));case"Piecewise":return jZ(e,t);case"RightArrow":return KZ(e,t);case"Seq":return r.BareSeq(sr(e,t.args));case"EmptyPiecewise":return r.Restriction([e.setInput(r.Constant(!0),Tl(t.span.input,t.span.start))]);case"Comparator":throw t.symbol==="="?Xa("="):S1();case"ComparatorChain":throw t.symbols.includes("=")?JS():S1();case"Tilde":throw Xa("~");case"Colon":throw Xa(":");case"Ellipsis":throw Xa("...");case"For":return kE(e,t,{parentIsList:!1});case"EmptyRangeEnd":throw a_();case"Err":throw QZ(t.error);default:throw`Unexpected surface node ${t.type}.`}}function nL(e){return jh.hasOwnProperty(e)}function nU(e){return e==="ln"||e==="log"||e==="logbase"}function YZ(e){return e.type==="Decimal"&&e.val==="2"}function WZ(e){return e.type!=="Neg"?!1:(e=e.args[0],e.type==="Decimal"&&e.val==="1")}function Zz(e,t){let r=e.nodes,[n,i]=t.args,o=hn(e,n),a=to(i),s=sr(e,a);if(RE(n)){let c=Tl(i.span.input,i.span.start),l=e.setInput(iU(e),c);return r.SeededFunctionCall(o,[l].concat(s))}if(Si(n))return r.FunctionCall(o,s);if(n.type==="Superscript"){let[c,l]=n.args;if(c.type==="Cmd"){let u=c.val;if(nL(u)||nU(u)){if(YZ(l))return r.Exponent([e.setInput(r.FunctionCall(u,s),void 0),hn(e,l)]);if(WZ(l)&&jh[u]!==void 0)return r.FunctionCall(jh[u],s);throw nL(u)?ID(u):CD(u==="logbase"?"log":u)}}}return r.Multiply([o,hn(e,i)])}function kE(e,t,{parentIsList:r}){let n=e.nodes,[i,o]=t.args,a=e.setInput(n.Identifier(`_comprehensionIndex_${zZ++}`),void 0);if(i.type==="For")throw cp("for");let s=hn(rv(e,{prefix:"li",expr:a}),i),c=[];if(o.type==="Seq"){let d=!1,f=!1,g=!1;for(let y=0;y<o.args.length;y++){let x=o.args[y];Zh(x)||e.allowIntervalComprehensions&&x.type==="ComparatorChain"?d=!0:f=!0,x.type==="Cmd"&&x.val==="cursor"&&(g=!0)}if(d&&f){let y=cp("for");throw g&&y.setCursorContext({type:"for-assignment-lhs",allowedTypes:[z]}),y}}let l=[];for(let d of to(o))if(e.allowIntervalComprehensions&&d.type==="ComparatorChain"){let f=iL(d),{min:g,identifier:y,max:x,open:b}=f;l.push({identifier:hn(e,y),bounds:[hn(e,g),hn(e,x)],open:b})}else if(d.type==="Comparator"&&Zh(d)){let f=e.setInput(n.AssignmentExpression(sr(e,d.args)),d.span);c.push(f)}else{if(d.type==="Comparator")throw Jm("a");{let f=B_();throw d.type==="Cmd"&&d.val==="cursor"&&f.setCursorContext({type:"for-assignment-lhs",allowedTypes:[z]}),f}}let u=r;return n.ListComprehension(a,s,c,u,l)}function XZ(e,t){let r=e.nodes;if(t.type==="Seq"){let o=!1,a=!1,s=!1;for(let c=0;c<t.args.length;c++){let l=t.args[c];if(l.type==="With")throw cp("with");if(Zh(l)||Jz(l))o=!0;else if(e.allowIntervalComprehensions&&l.type==="ComparatorChain")try{iL(l),a=!0}catch(u){s=!0}else s=!0}if((o||a)&&s)throw cp("with");if(a)throw cw()}if(e.allowIntervalComprehensions&&t.type==="ComparatorChain"){let o;try{iL(t),o=!0}catch(a){o=!1}if(o)throw cw()}if(t.type==="With")throw sw();let n=to(t),i=[];for(let o of n){if(o.type!="Comparator"||!Zh(o)&&!Jz(o))throw Sx();let a=e.setInput(r.AssignmentExpression(sr(e,o.args)),o.span);i.push(a)}return i}function Jz(e){if(e.type!=="Comparator"||e.symbol!=="=")return!1;let t=e.args[0];if(t.type!=="Call")return!1;let[r]=t.args;return!!Si(r)}function iL(e){if(e.symbols.length!==2)throw Jm("a");let[t,r,n]=e.args,[i,o]=e.symbols;if(!Si(r))throw Jm("a");if(i!=="<"&&i!=="<="||o!=="<"&&o!=="<="||e.symbols.includes("="))throw Jm(Jn(r.span));return{min:t,identifier:r,max:n,open:[i==="<",o==="<"]}}function KZ(e,t){let r=e.nodes;if(!Si(t.args[0]))throw LM();return e=rv(e,{prefix:"ec",expr:e.setInput(r.Identifier("globalEventCount"),void 0)}),r.UpdateRule(sr(e,t.args))}function jZ(e,t){let r=e.nodes,[n]=t.args,i=to(n);if(i.length===1&&tv(i[0])){let f=i[0];return r.Restriction([e.setInput(vu(e,f),f.span)])}if(i.length>1&&i.every(tv)){let f=e.setInput(vu(e,i[0]),i[0].span);for(let g=1;g<i.length;g++){let y=e.setInput(vu(e,i[g]),i[g].span);f=e.setInput(r.Or([f,y]),$a(i[0].span,i[g].span))}return r.Restriction([f])}let o,a=[];e:for(o=0;o<i.length;o++){let f=i[o];switch(f.type){case"Colon":{let[g,y]=f.args;if(!tv(g))throw MD();if(y.type==="With"&&y.args[1].type==="Seq")throw cp("with");a.push({condition:e.setInput(vu(e,g),g.span),if_expr:hn(e,y)});break}case"Comparator":case"ComparatorChain":a.push({condition:e.setInput(vu(e,f),f.span),if_expr:e.setInput(r.Constant(Et(1,1)),Ha("1",0,1))});break;case"For":throw cp("for");default:break e}}if(o===0)throw PD();if(o<i.length-1)throw SD();let s,c;o===i.length-1?(s=ev(e,i[o]),c=i[o]):s=r.Constant(NaN);let l=s,u=c==null?void 0:c.span,d;for(;a.length;)d=a.pop(),l=r.Piecewise([d.condition,d.if_expr,e.setInput(l,u)]),u=void 0;return l}function tv(e){return e.type==="Comparator"||e.type==="ComparatorChain"}function vu(e,t){let r=e.nodes;switch(t.type){case"Comparator":return r.Comparator[t.symbol](sr(e,t.args));case"ComparatorChain":return r.ComparatorChain(t.symbols,sr(e,t.args));default:throw Ie(`Unexpected type for condition: ${t.type}`)}}function ZZ(e){let[t,r]=e.args;if(t.type==="Superscript"&&(t=t.args[0]),t.type==="Cmd"&&t.val==="logbase"&&r.type==="Seq"&&r.args.length===2){if(!Ll(r.args[0]))throw V1("log")}else if(!Ll(r))throw t.type==="Cmd"?V1(t.val):Ie(`Unexpected type for args of implicit call: ${r.type}`)}function Qz(e){return nf(e.val)}function eU(e){let t=nf(e.whole),r=nf(e.num),n=nf(e.den);return bo(t,yo(r,n))}function JZ(e){if(e.type!=="Call")return!1;let t=e.args[0];for(;t.type==="Superscript"||t.type==="Subscript"||t.type==="Prime";)t=t.args[0];return t.type!=="Cmd"?!1:nL(t.val)||nU(t.val)}function Zh(e){return e.type==="Comparator"&&e.symbol==="="&&Si(e.args[0])}function QZ(e){switch(e.type){case"UnexpectedParseError":case"MissingBound":case"EmptyGroup":case"UnexpectedDifferential":case"UnexpectedEnd":return Ie(`Unexpected error type: ${e.type}`);case"InvalidOperatorName":return yD();case"UnexpectedCloseDelimiter":case"MissingCloseDelimiter":return v_(e.open,e.close);case"UnrecognizedSymbol":return e.val==="."?Xa(e.val):P1(e.val);case"EmptyInput":return bx();case"BinaryOperatorMissingRight":case"BinaryOperatorMissingLeft":return hx(e.val==="%"?"% of":e.val);case"UnaryOperatorMissingLeft":return uD(e.val);case"UnaryOperatorMissingRight":return dD(e.val);case"UnexpectedSubscript":return AD(e.base);case"PercentMissingOf":return w_();case"SumMissingBound":return s_();case"ProductMissingBound":return c_();case"IntegralMissingBound":return g_();case"SumMissingBody":return h_();case"ProductMissingBody":return y_();case"IntegralMissingBody":return b_();case"DerivativeMissingBody":return x_();case"IntegralMissingDifferential":return f_();case"DifferentialWithSuperscript":return m_();case"FractionMissingNumerator":return pD();case"FractionMissingDenominator":return gD();case"FractionEmpty":return fD();case"EmptySuperscript":return mD();case"EmptySubscript":return q1();case"InvalidSubscript":return hD(e.val);case"SuperscriptWithPrime":return xD();case"PrimeWithoutParen":return U1();case"UnexpectedPrime":return z1();case"EmptyRadical":return vD();case"EmptyRadicalIndex":return TD();case"EmptySquareBracket":return wD();case"EmptyPipe":return ED();case"FunctionMissingArgument":return fc(e.val,1,0,{includeUsageExample:!0});case"AdjacentNumbers":return cD(VE(e.args[0]),VE(e.args[1]));case"TokenWithSubscript":return lD();case"UnexpectedFor":return Xa("for");default:throw`Unexpected surface node ${e.type}.`}}function VE(e){switch(e.type){case"Decimal":return e.val;case"MixedNumber":return`${e.whole} ${e.num}/${e.den}`;default:let t=e;throw new Error(`Unexpected node type ${t.type}`)}}function Ll(e){switch(e.type){case"Letter":case"Decimal":case"MixedNumber":case"Cmd":case"EmptyPiecewise":return!0;case"Neg":{let r=e.args[0];for(;;)if(r.type==="Pos"||r.type==="Paren"&&!rU(r))r=r.args[0];else if(r.type==="Neg")r=r.args[0];else break;return r.type==="Decimal"||r.type==="MixedNumber"}case"Pos":return Ll(e.args[0]);case"Paren":return Ll(e.args[0]);case"Juxt":case"Mul":case"DotMul":case"CrossMul":case"Div":return Ll(e.args[0])&&Ll(e.args[1]);case"Subscript":return Ll(e.args[0]);case"Superscript":case"Frac":case"Add":case"Sub":return Ll(e.args[0])&&Ll(e.args[1]);case"Piecewise":{let[r]=e.args;return tv(r)}case"Call":{let[r,n]=e.args;return Si(r)||Hz(r)?!1:Ll(r)&&Ll(n)}case"Derivative":case"Sqrt":case"Nthroot":case"Pipes":case"Bang":return!1;case"Comparator":case"ComparatorChain":case"Tilde":case"ImplicitCall":case"Index":case"List":case"Seq":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Colon":case"Ellipsis":case"For":case"With":case"Dot":case"PercentOf":case"Prime":case"EmptyRangeEnd":case"RightArrow":return!1;default:throw`Unexpected surface node ${e.type}.`}}function RE(e){return e.type!=="Cmd"?!1:e.val==="random"||e.val==="shuffle"}function iU(e){let t=e.nodes.ExtendSeed("",[e.setInput(e.nodes.Identifier("globalRandomSeed"),void 0),e.setInput(e.nodes.Seed(e.nextSeed()),void 0)]);if(!e.seedExtensions)return t;for(let{prefix:r,expr:n}of e.seedExtensions)t=e.nodes.ExtendSeed(r,[e.setInput(t,void 0),n]);return t}function rv(e,t){let r=e.seedExtensions||[];return{...e,seedExtensions:r.concat(t)}}function Jh(e){return{type:"initial",tokenType:e}}function nv(e){return{type:"l",tokenType:e}}function iv(e){return{type:"r",tokenType:e}}function en(e){return{type:"la",tokenType:e}}function Qh(e){return{type:"ra",tokenType:e}}function oU(e,t){for(let r of FG)if(t[r]===void 0)throw new Error(`Programming Error: token ${r} must be a assigned a ${e} precedence`)}function Sf(e,t,r,n){if(t[r]!==void 0)throw new Error(`Programming Error: duplicate ${e} entry for token ${r}.`);t[r]=n}function aU(e){let t={},r={},n={};for(let s=0;s<e.length;s++){let c=e[s];for(let{type:l,tokenType:u}of c)switch(l){case"initial":Sf("initial",t,u,s);break;case"l":Sf("left",r,u,s);break;case"r":Sf("right",n,u,s);break;case"la":Sf("left",r,u,s),Sf("right",n,u,s);break;case"ra":Sf("left",r,u,s),Sf("right",n,u,s-1);break}}oU("left",r),oU("right",n);function i(s){return n[s]}function o(s){return r[s]}function a(s){let c=t[s];return c===void 0?i(s):c}return{rightPrec:i,leftPrec:o,initialPrec:a}}function Mt(e,t){return{type:"Err",span:e,error:t}}function sL(){return{type:"UnexpectedParseError"}}function sU(){return{type:"EmptyInput"}}function cU(){return{type:"EmptyGroup"}}function cL(){return{type:"EmptySubscript"}}function lU(){return{type:"EmptySuperscript"}}function lL(){return{type:"EmptyRadical"}}function uU(){return{type:"EmptySquareBracket"}}function dU(){return{type:"EmptyPipe"}}function pU(){return{type:"EmptyRadicalIndex"}}function uL(){return{type:"UnexpectedEnd"}}function Mf(e){return{type:"BinaryOperatorMissingRight",val:e}}function gU(e){return{type:"BinaryOperatorMissingLeft",val:e}}function dL(e){return{type:"UnaryOperatorMissingRight",val:e}}function pL(e){return{type:"UnaryOperatorMissingLeft",val:e}}function fU(e,t){return{type:"MissingCloseDelimiter",open:e,close:t}}function ov(e,t){return{type:"UnexpectedCloseDelimiter",open:e,close:t}}function mU(){return{type:"UnexpectedDifferential"}}function hU(e){return{type:"UnrecognizedSymbol",val:e}}function yU(e){return{type:"InvalidSubscript",val:e}}function bU(e){return{type:"UnexpectedSubscript",base:e}}function gL(e){return{type:"FunctionMissingArgument",val:e}}function xU(){return{type:"PercentMissingOf"}}function fL(){return{type:"PrimeWithoutParen"}}function vU(){return{type:"SuperscriptWithPrime"}}function GE(){return{type:"UnexpectedPrime"}}function TU(){return{type:"SumMissingBound"}}function wU(){return{type:"ProductMissingBound"}}function mL(){return{type:"MissingBound"}}function EU(){return{type:"IntegralMissingBound"}}function IU(){return{type:"SumMissingBody"}}function CU(){return{type:"ProductMissingBody"}}function PU(){return{type:"IntegralMissingBody"}}function SU(){return{type:"DerivativeMissingBody"}}function MU(){return{type:"IntegralMissingDifferential"}}function DU(){return{type:"DifferentialWithSuperscript"}}function _U(){return{type:"FractionMissingNumerator"}}function AU(){return{type:"FractionMissingDenominator"}}function OU(){return{type:"FractionEmpty"}}function hL(e){return{type:"AdjacentNumbers",args:e}}function LU(){return{type:"UnexpectedFor"}}function NU(){return{type:"TokenWithSubscript"}}var tJ=[[Jh("("),en(")"),Jh("\\{"),en("\\}"),iv("["),en("]"),Jh("(|"),en("|)"),en("Differential"),en("End")],[en("for")],[iv("with")],[Qh("...")],[en(",")],[Qh(":")],[iv("->")],[nv("with")],[en("="),en(">"),en("<"),en(">="),en("<="),en("~")],[nv("->")],[en("+"),en("-")],[en("*"),en("\\cdot"),en("\\times"),en("/"),en("Decimal"),en("MixedNumber"),en("Letter"),en("Cmd"),en("TokenNode"),en("%"),iv("("),en("\\{"),en("(|"),en("Frac"),en("Sqrt"),en("Trig"),en("Ln"),en("Log"),Qh("Int"),Qh("Sum"),Qh("Prod")],[Jh("+"),Jh("-")],[en("!")],[en("SupSub")],[nv("["),en(".")],[nv("(")],[en("Err")]],{leftPrec:BE,rightPrec:RU,initialPrec:GU}=aU(tJ),kU={trailingComma:!1};function cv(e,t){let r=t?{...kU,...t}:kU,n=md(e,r),i=rJ(n);return i.type==="Err"&&i.error.type==="EmptyGroup"?Mt(i.span,sU()):i}function rJ(e){return Vp(e,{isToplevel:!0})}function Vp(e,{isToplevel:t}={isToplevel:!1}){if(NE(e))return Mt(mt(e,e),cU());let{state:r,tree:n}=Mi(e,0,{isToplevel:t});return n.type!=="Err"&&!NE(r)?bL(r).tree:n}function le(e,t){return{state:e,tree:t}}function Mi(e,t,{isToplevel:r}={isToplevel:!1}){let n=e,i;if({state:n,tree:i}=nJ(n),i.type==="Err")return le(n,i);if(!rL(e,n))throw new Error("Programming Error: parseInitial did not advance state.");for(;!NE(n);){let o;if(wo(n,"(")&&!aJ(i)?o=RU("("):o=BE(Uo(n).type),t>=o)break;let a=n,s=iJ(n,i,r)?BE("for")-1:RU(Uo(n).type);if({state:n,tree:i}=oJ(n,i,s),i.type==="Err")return le(n,i);if(!rL(a,n))throw new Error("Programming Error: parseSuccessor did not advance state.")}return le(n,i)}function Ws(e){return e.type==="UnexpectedDifferential"||e.type==="UnexpectedCloseDelimiter"||e.type==="UnexpectedEnd"||e.type==="BinaryOperatorMissingLeft"}function nJ(e){let t=e,r=Uo(e),n=GU(r.type),i;switch(r.type){case"+":{if(e=Lt(e),{state:e,tree:i}=Mi(e,n),i.type==="Err"){if(!Ws(i.error))return le(e,i);let a=mt(t,e),s=Mt(a,dL(r.val));return le(e,s)}return le(e,gz(mt(t,e),[i]))}case"-":if(e=Lt(e),{state:e,tree:i}=Mi(e,n),i.type==="Err"){if(!Ws(i.error))return le(e,i);let a=mt(t,e),s=Mt(a,dL(r.val));return le(e,s)}else return le(e,fz(mt(t,e),[i]));case"(":return av(e);case"\\{":return e=Lt(e),wo(e,"\\}")?(e=Lt(e),le(e,Lz(mt(t,e)))):({state:e,tree:i}=Mi(e,n),{state:e,tree:i}=sv(t,e,i,"\\{","\\}"),i.type==="Err"?le(e,i):le(e,Oz(mt(t,e),[i])));case"[":return e=Lt(e),wo(e,"]")?(e=Lt(e),le(e,KO(mt(t,e),[]))):({state:e,tree:i}=Mi(e,n),{state:e,tree:i}=sv(t,e,i,"[","]"),i.type==="Err"?le(e,i):le(e,KO(mt(t,e),[i])));case"(|":{if(e=Lt(e),wo(e,"|)")){e=Lt(e);let a=mt(t,e);return le(e,Mt(a,dU()))}return{state:e,tree:i}=Mi(e,n),{state:e,tree:i}=sv(t,e,i,"(|","|)"),i.type==="Err"?le(e,i):le(e,Ez(mt(t,e),[i]))}case"Frac":{if(e.opts.disallowFrac)throw iw();e=Lt(e);let a=Vp(md(r.num,e.opts)),s=Vp(md(r.den,e.opts));if(a.type==="Err"&&a.error.type==="EmptyGroup"&&s.type==="Err"&&s.error.type==="EmptyGroup"){let c=mt(t,e),l=Mt(c,OU());return le(e,l)}if(a.type==="Err"&&a.error.type==="EmptyGroup"){let c=mt(t,e),l=Mt(c,_U());return le(e,l)}if(s.type==="Err"&&s.error.type==="EmptyGroup"){let c=mt(t,e),l=Mt(c,AU());return le(e,l)}if(a.type==="Err")return le(e,a);if(s.type==="Err")return le(e,s);if($z(a,s)&&s.type==="Juxt"){let c=s.args[1],l;if({state:e,tree:l}=Mi(e,BE("*")-1),l.type==="Err"){if(Ws(l.error)){let u=mt(t,e);return le(e,Mt(u,SU()))}return le(e,l)}return le(e,Sz(mt(t,e),[c,l]))}return le(e,Pz(mt(t,e),[a,s]))}case"Sqrt":if(e=Lt(e),r.optArg){let a=Vp(md(r.optArg,e.opts));if(a.type==="Err")return a.error.type==="EmptyGroup"?le(e,Mt(a.span,pU())):le(e,a);let s=Vp(md(r.arg,e.opts));return s.type==="Err"?s.error.type==="EmptyGroup"?le(e,Mt(s.span,lL())):le(e,s):le(e,Cz(mt(t,e),[a,s]))}else{let a=Vp(md(r.arg,e.opts));return a.type==="Err"?a.error.type==="EmptyGroup"?le(e,Mt(a.span,lL())):le(e,a):le(e,Iz(mt(t,e),[a]))}case"Trig":case"Ln":{e=Lt(e);let a=Pf(mt(t,e),r.val),s=0,c=Uo(e);if(c.type==="SupSub"){if(e=Lt(e),c.sub){let d=mt(t,e),f=Mt(d,bU(a.val));return le(e,f)}let u=qE(c,e.opts);if(u){if(u.type==="Err")return le(e,u);a=DE(mt(t,e),[a,u])}s=c.nprimes}let l=wo(e,"(");if(l){if({state:e,tree:i}=av(e),i.type==="Err")return le(e,i);i=Zx(mt(t,e),[a,i.args[0]])}else{if({state:e,tree:i}=Mi(e,n-1),i.type==="Err")return Ws(i.error)?le(e,Mt(mt(t,e),gL(r.val))):le(e,i);i=WO(mt(t,e),[a,i])}if(s>0){let u=mt(t,e);if(!l){let d=Mt(u,fL());return le(e,d)}i=Jx(u,s,[i])}return le(e,i)}case"Log":{e=Lt(e);let a=mt(t,e),s=Pf(a,r.val),c=0,l,u,d=Uo(e);if(d.type==="SupSub"&&(e=Lt(e),l=BU(d,e.opts),u=qE(d,e.opts),c=d.nprimes),l&&l.type==="Err")return le(e,l);if(u&&u.type==="Err")return le(e,u);let f=wo(e,"(");if(f){if({state:e,tree:i}=av(e),i.type==="Err")return le(e,i);i=i.args[0]}else if({state:e,tree:i}=Mi(e,n-1),i.type==="Err")return Ws(i.error)?le(e,Mt(mt(t,e),gL(r.val))):le(e,i);let g=l?Pf(a,"\\logbase"):s,y=l?_E(mt(t,e),to(i).concat(l)):i;if(u&&(g=DE(mt(t,e),[g,u])),f?i=Zx(mt(t,e),[g,y]):i=WO(mt(t,e),[g,y]),c>0){let x=mt(t,e);if(!f){let b=Mt(x,fL());return le(e,b)}i=Jx(x,c,[i])}return le(e,i)}case"Int":{e=Lt(e);let a=Uo(e);e=Lt(e);let s=yL(a,t,e);if(s.type==="Err")return s.error.type==="MissingBound"?le(e,Mt(s.span,EU())):le(e,s);let{sup:c,sub:l}=s,u;if(wo(e,"Differential"))return{state:e,tree:u}=FU(e),u.type==="Err"?le(e,u):le(e,Dz(mt(t,e),[u,l,c]));if({state:e,tree:i}=Mi(e,n),i.type==="Err")return Ws(i.error)?le(e,Mt(i.span,PU())):le(e,i);let d=i;return wo(e,"Differential")?({state:e,tree:u}=FU(e),u.type==="Err"?le(e,u):le(e,Mz(mt(t,e),[u,l,c,d]))):le(e,Mt(mt(t,e),MU()))}case"Sum":{e=Lt(e);let a=Uo(e);e=Lt(e);let s=yL(a,t,e);if(s.type==="Err")return s.error.type==="MissingBound"?le(e,Mt(s.span,TU())):le(e,s);let{sup:c,sub:l}=s;return{state:e,tree:i}=Mi(e,n),i.type==="Err"?Ws(i.error)?le(e,Mt(i.span,IU())):le(e,i):le(e,_z(mt(t,e),[i,l,c]))}case"Prod":{e=Lt(e);let a=Uo(e);e=Lt(e);let s=yL(a,t,e);if(s.type==="Err")return s.error.type==="MissingBound"?le(e,Mt(s.span,wU())):le(e,s);let{sup:c,sub:l}=s;return{state:e,tree:i}=Mi(e,n),i.type==="Err"?Ws(i.error)?le(e,Mt(i.span,CU())):le(e,i):le(e,Az(mt(t,e),[i,l,c]))}case"Cmd":return e=Lt(e),i=Pf(mt(t,e),r.val),le(e,i);case"TokenNode":{e=Lt(e);let a=Uo(e);return a.type==="SupSub"&&a.sub?(e=Lt(e),le(e,Mt(mt(t,e),NU()))):(i=Pf(mt(t,e),r.val),le(e,i))}case"Letter":return e=Lt(e),i=qz(mt(t,e),r.val),le(e,i);case"Decimal":{e=Lt(e);let a=AE(mt(t,e),r.val),s=e.token;if(s.type==="Decimal"||s.type==="MixedNumber"){let c=e;e=Lt(e);let l=mt(t,e),u=s.type==="MixedNumber"?s:AE(mt(c,e),s.val);return le(e,Mt(l,hL([a,u])))}if(r.val.endsWith(".")&&s.type==="Cmd"&&(s.val==="\\real"||s.val==="\\imag"))throw M1();return le(e,a)}case"MixedNumber":{if(e.opts.disallowFrac)throw iw();e=Lt(e);let a=e.token;if(a.type==="Decimal"||a.type==="MixedNumber"){let s=e;e=Lt(e);let c=mt(t,e),l=a.type==="MixedNumber"?a:AE(mt(s,e),a.val);return le(e,Mt(c,hL([r,l])))}return le(e,r)}case"*":case"\\cdot":case"\\times":case"/":case",":case"=":case">":case"<":case">=":case"<=":case"->":case"~":case":":case"...":case"%":case".":{e=Lt(e);let a=mt(t,e),s=Mt(a,gU(r.val));return le(e,s)}case"for":{e=Lt(e);let a=mt(t,e),s=Mt(a,LU());return le(e,s)}case"with":{e=Lt(e);let a=mt(t,e),s=Mt(a,sL());return le(e,s)}case"!":{e=Lt(e);let a=mt(t,e),s=Mt(a,pL(r.val));return le(e,s)}case"SupSub":{e=Lt(e);let a="supsub";r.sub?a="subscript":r.sup?a="superscript":r.nprimes>0&&(a="prime");let s=mt(t,e),c=Mt(s,pL(a));return le(e,c)}case")":case"\\}":case"]":case"|)":case"Differential":return bL(e);case"Err":{e=Lt(e);let a=mt(t,e),s=Mt(a,hU(r.val));return le(e,s)}case"End":{let a=mt(t,e),s=Mt(a,uL());return le(e,s)}default:throw`Unexpected token type ${r.type}.`}}function iJ(e,t,r){return wo(e,"=")&&r&&(oL(t)||aL(t))}function oJ(e,t,r){let n=Uo(e),i;switch(n.type){case"+":case"-":case"*":case"\\cdot":case"\\times":case"/":case"~":case":":case".":case"->":case"for":{if(e=Lt(e),{state:e,tree:i}=Mi(e,r),i.type==="Err")if(Ws(i.error)){let a=mi(t.span,e),s=Mt(a,Mf(n.val));return le(e,s)}else return le(e,i);return le(e,VU(n.type,mi(t.span,e),[t,i]))}case"with":{if(e=Lt(e),{state:e,tree:i}=Mi(e,r),i.type==="Err")if(Ws(i.error)){let a=mi(t.span,e),s=Mt(a,Mf(n.val));return le(e,s)}else return le(e,i);return le(e,VU(n.type,mi(t.span,e),[t,i]))}case"%":{e=Lt(e);let a=Uo(e);if(a.type!=="Cmd"||a.val!=="of"&&a.val!=="\\of"){let s=Mt(n.span,xU());return le(e,s)}if(e=Lt(e),{state:e,tree:i}=Mi(e,r),i.type==="Err")if(Ws(i.error)){let s=mi(t.span,e),c=Mt(s,Mf(n.val));return le(e,c)}else return le(e,i);return le(e,Gz(mi(t.span,e),[t,i]))}case"=":case">=":case"<=":case">":case"<":{let a=[t],s=[];for(;;){let l=Uo(e).type;if(l!=="="&&l!==">="&&l!=="<="&&l!==">"&&l!=="<")break;if(s.push(l),e=Lt(e),{state:e,tree:i}=Mi(e,r),i.type==="Err")if(Ws(i.error)){let u=mi(t.span,e),d=Mt(u,Mf(n.val));return le(e,d)}else return le(e,i);a.push(i)}let c=a[a.length-1];return c.type==="Comparator"?(a.pop(),Array.prototype.push.apply(a,c.args),s.push(c.symbol)):c.type==="ComparatorChain"&&(a.pop(),Array.prototype.push.apply(a,c.args),Array.prototype.push.apply(s,c.symbols)),a.length===2?le(e,uz(mi(t.span,e),s[0],a)):le(e,dz(mi(t.span,e),s,a))}case"!":return e=Lt(e),le(e,Tz(mi(t.span,e),[t]));case"[":{let a=e;if(e=Lt(e),wo(e,"]")){e=Lt(e);let s=mt(a,e);return le(e,Mt(s,uU()))}return{state:e,tree:i}=Mi(e,r),{state:e,tree:i}=sv(a,e,i,"[","]"),i.type==="Err"?le(e,i):le(e,wz(mi(t.span,e),[t,i]))}case"Sqrt":case"Frac":case"Letter":case"Cmd":case"TokenNode":case"Trig":case"Ln":case"Log":case"Sum":case"Int":case"Prod":case"Decimal":case"MixedNumber":case"\\{":case"(|":return{state:e,tree:i}=Mi(e,r),i.type==="Err"?le(e,i):le(e,JO(mi(t.span,e),[t,i]));case"(":if(Si(t)){if({state:e,tree:i}=av(e),i.type==="Err")return le(e,i);let a=mi(t.span,e);return le(e,Zx(a,[t,i.args[0]]))}else if(t.type==="Prime"&&Si(t.args[0])){if({state:e,tree:i}=av(e),i.type==="Err")return le(e,i);let a=mi(t.span,e);return le(e,Jx(a,t.nprimes,[Zx(a,[t.args[0],i.args[0]])]))}else return{state:e,tree:i}=Mi(e,r),i.type==="Err"?le(e,i):le(e,JO(mi(t.span,e),[t,i]));case"SupSub":{e=Lt(e);let a=qU(n),s=qE(n,e.opts);if(a&&a.type==="Err")return le(e,a);if(s&&s.type==="Err")return le(e,s);if(a&&(t=jO(mi(t.span,e),[t,a])),s&&(t=DE(mi(t.span,e),[t,s])),n.nprimes>0){let c=mi(t.span,e);if(!Si(t)){let l=Mt(c,GE());return le(e,l)}t=Jx(c,n.nprimes,[t])}return le(e,t)}case",":{let a=[t];for(;wo(e,",")&&(e=Lt(e),!(wo(e,"...")||e.opts.trailingComma&&sJ(e)));){if({state:e,tree:i}=Mi(e,r),i.type==="Err")if(Ws(i.error)){let s=mi(t.span,e),c=Mt(s,Mf(n.val));return le(e,c)}else return le(e,i);a.push(i)}return le(e,_E(mi(t.span,e),a))}case"...":{if(e=Lt(e),wo(e,",")&&(e=Lt(e)),r>=BE(Uo(e).type))return le(e,ZO(mi(t.span,e),[t,Nz(eL(e))]));if({state:e,tree:i}=Mi(e,r),i.type==="Err")if(Ws(i.error)){let a=mi(t.span,e),s=Mt(a,Mf(n.val));return le(e,s)}else return le(e,i);return le(e,ZO(mi(t.span,e),[t,i]))}case"]":case")":case"\\}":case"|)":case"Differential":return bL(e);case"Err":return Mi(e,r);case"End":{let a=mt(e,e),s=Mt(a,uL());return le(e,s)}default:throw`Unexpected token type ${n.type}.`}}function aJ(e){return!!(Si(e)||e.type==="Prime"&&Si(e.args[0]))}function VU(e,t,r){switch(e){case"+":return mz(t,r);case"-":return hz(t,r);case"*":return yz(t,r);case"\\cdot":return bz(t,r);case"\\times":return xz(t,r);case"/":return vz(t,r);case"~":return pz(t,r);case":":return Rz(t,r);case".":switch(r[0].type){case"Decimal":case"MixedNumber":throw M1();default:return Fz(t,r)}case"->":return Bz(t,r);case"for":return kz(t,r);case"with":return Vz(t,r);default:throw`Unexpected token type ${e}.`}}function BU(e,t){if(!e.sub)return;let r=e.sub,n=Vp(md(r,t));return n.type==="Err"&&n.error.type==="EmptyGroup"?Mt(n.span,cL()):n}function qU(e){if(!e.sub)return;let t=e.sub;if(t.args.length===0)return Mt(t.span,cL());let r=[];for(let n of t.args)if(n.type==="Digit"||n.type==="Letter")r.push(n.val);else{let i=n.span;return Mt(i,yU(Jn(i)))}return zz(t.span,r.join(""))}function qE(e,t){if(!e.sup)return;let r=Vp(md(e.sup,t));return r.type==="Err"?r.error.type==="EmptyGroup"?Mt(r.span,lU()):r:e.nprimes>0?Mt(e.span,vU()):r}function yL(e,t,r){if(e.type!=="SupSub"){let o=mt(t,r);return Mt(o,mL())}if(e.nprimes>0){let o=mt(t,r);return Mt(o,GE())}let n=BU(e,r.opts),i=qE(e,r.opts);if(!n||n.type==="Err"&&n.error.type==="EmptySubscript"||!i||i.type==="Err"&&i.error.type==="EmptySuperscript"){let o=mt(t,r);return Mt(o,mL())}return n.type==="Err"?n:i.type==="Err"?i:{type:"Bounds",sup:i,sub:n}}function av(e){if(e.opts.disableParentheses)throw S_();let t=e,r=Uo(e),n=GU(r.type);if(wo(e,"("))e=Lt(e);else throw new Error("Programming Error: expected '(' at start of parseParen.");if(wo(e,")")){let o=_E(eL(e),[]);e=Lt(e);let a=mt(t,e);return le(e,XO(a,[o]))}let i;return{state:e,tree:i}=Mi(e,n),{state:e,tree:i}=sv(t,e,i,"(",")"),i.type==="Err"?le(e,i):le(e,XO(mt(t,e),[i]))}function FU(e){let t=e,r=Uo(e);if(r.type!=="Differential")throw new Error("Programming Error: expected differential");e=Lt(e);let n=Pf(r.span,r.val),i=Uo(e);if(i.type==="SupSub"){e=Lt(e);let o=mt(t,e),a=qU(i);if(a){if(a.type==="Err")return le(e,a);n=jO(o,[n,a])}if(i.sup)return le(e,Mt(o,DU()));if(i.nprimes>0)return le(e,Mt(o,GE()))}return le(e,n)}function sv(e,t,r,n,i){if(r.type==="Err"&&r.error.type!=="UnexpectedEnd")return le(t,r);if(r.type==="Err"||!wo(t,i)){let o=mt(e,t),a=Mt(o,fU(n,i));return le(t,a)}return t=Lt(t),le(t,r)}function bL(e){let t=e;switch(Uo(e).type){case")":{e=Lt(e);let n=mt(t,e);return le(e,Mt(n,ov("(",")")))}case"]":{e=Lt(e);let n=mt(t,e);return le(e,Mt(n,ov("[","]")))}case"\\}":{e=Lt(e);let n=mt(t,e);return le(e,Mt(n,ov("\\{","\\}")))}case"|)":{e=Lt(e);let n=mt(t,e);return le(e,Mt(n,ov("|","|")))}case"Differential":{e=Lt(e);let n=mt(t,e);return le(e,Mt(n,mU()))}default:{e=Lt(e);let n=mt(t,e);return le(e,Mt(n,sL()))}}}function sJ(e){return wo(e,")")||wo(e,"]")||wo(e,"\\}")}function xL(e,t){return{type:"Group",span:e,args:t}}function zU(e,t,r){return{type:"Sqrt",span:e,optArg:t,arg:r}}function UU(e,t,r){return{type:"Frac",span:e,num:t,den:r}}function HU(e,t,r,n){return{type:"SupSub",span:e,sup:t,sub:r,nprimes:n}}function $U(e,t,r,n){return{type:"LeftRight",span:e,left:t,right:r,arg:n}}function YU(e,t){return{type:"OperatorName",span:e,arg:t}}function WU(e,t){return{type:"TokenNode",span:e,arg:t}}function XU(e,t){return{type:"Symbol",span:e,val:t}}function KU(e){switch(e){case"Frac":return 2;case"^":case"_":case"Primes^":case"Left":case"Sqrt":case"OperatorName":case"Token":return 1;default:return 0}}function ey(e){let{state:t,tree:r}=zE(j0(e),!1);if(!Dm(t))throw`Parse error: unexpected ${Jn(ps(t).span)}.`;return r}function Uc(e,t){return{state:e,tree:t}}function zE(e,t){let r=e,n=[];e:for(;!Dm(e);){let o=ps(e);switch(o.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":case"[":case"{":case"^":case"_":case"Primes":case"Primes^":case"Left":case"Frac":case"Sqrt":case"OperatorName":case"Token":case"]":{if(o.type==="]"&&t)break e;let s;if({state:e,tree:s}=jU(e),s.type==="Group")for(let c of s.args)n.push(c);else n.push(s);break}case"}":case"Right":case"End":break e;default:throw`Unexpected token type ${o.type}.`}}let i=Zd(r,e);return Uc(e,xL(i,n))}function jU(e){let t=ps(e);switch(t.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return e=lc(e),Uc(e,t);case"[":case"]":return e=lc(e),Uc(e,XU(t.span,t.val));case"{":{e=lc(e);let n;return{state:e,tree:n}=zE(e,!1),e=tu(e,"}"),Uc(e,n)}case"^":case"_":case"Primes":case"Primes^":return fJ(e);case"Left":return gJ(e);case"Frac":return pJ(e);case"Sqrt":return dJ(e);case"OperatorName":return lJ(e);case"Token":return uJ(e);case"}":case"Right":throw`Parse Error: unexpected ${t.val}.`;case"End":throw"Parse Error: unexpected end.";default:throw`Unexpected token type ${t.type}.`}}function lJ(e){let t=e,r=ps(e);e=tu(e,"OperatorName");let n;({state:e,tree:n}=Fp(e,r));let i=Zd(t,e);return Uc(e,YU(i,n))}function uJ(e){let t=e,r=ps(e);e=tu(e,"Token");let n;({state:e,tree:n}=Fp(e,r));let i=Zd(t,e);return Uc(e,WU(i,n))}function dJ(e){let t=e,r=ps(e);e=tu(e,"Sqrt");let n;YG(e,"[")&&({state:e,tree:n}=mJ(e));let i;({state:e,tree:i}=Fp(e,r));let o=Zd(t,e);return Uc(e,zU(o,n,i))}function pJ(e){let t=e,r=ps(e);e=tu(e,"Frac");let n;({state:e,tree:n}=Fp(e,r));let i;({state:e,tree:i}=Fp(e,r));let o=Zd(t,e);return Uc(e,UU(o,n,i))}function gJ(e){let t=e;e=tu(e,"Left");let r=ps(e);e=lc(e);let n;({state:e,tree:n}=zE(e,!1)),e=tu(e,"Right");let i=ps(e);e=lc(e);let o=Zd(t,e);return Uc(e,$U(o,r,i,n))}function fJ(e){let t=e,r,n,i=0;e:for(;!Dm(e);){let a=ps(e);switch(a.type){case"^":if(e=lc(e),r)throw"Parse Error: double superscript.";({state:e,tree:r}=Fp(e,a));break;case"_":if(e=lc(e),n)throw"Parse Error: double subscript.";({state:e,tree:n}=Fp(e,a));break;case"Primes":if(e=lc(e),i>0)throw"Parse Error: double primes.";i=a.val.length;break;case"Primes^":if(e=lc(e),i>0)throw"Parse Error: double primes.";if(r)throw"Parse Error: double superscript";i=a.val.length-1,{state:e,tree:r}=Fp(e,a);break;default:break e}}let o=Zd(t,e);return Uc(e,HU(o,r,n,i))}function Fp(e,t){let r=KU(t.type),n;if(r<=0)throw new Error("Programming Error: greediness must be greater than 0.");let i=KU(ps(e).type);if(i>0&&i<=r){let o=Jn(t.span);throw`Parse Error: can't use ${Jn(ps(e).span)} as argument of ${o}. Use {}.`}return{state:e,tree:n}=jU(e),n.type!=="Group"&&(n=xL(n.span,[n])),Uc(e,n)}function mJ(e){e=tu(e,"[");let t;return{state:e,tree:t}=zE(e,!0),e=tu(e,"]"),Uc(e,t)}function hJ(){throw Cn()}function yJ(e,t){return t&&!e._inputSpan&&e.setInputSpan(t),e}function Gp(e,t={}){var u;let r=typeof e;if(r!=="string")throw new Error(`Type Error: parse can only be called with strings, got ${JSON.stringify(e)} of type ${r}`);let n=N;if(t.disabledFeatures){n=Object.create(n);for(let d of t.disabledFeatures){if(!n[d])throw new Error(`Programming Error: ${d} cannot be disabled because it is not a parsenode.`);n[d]=hJ}}let i=t.seedPrefix===void 0?"":t.seedPrefix,o=0,a=()=>{let d=`${i}::vc${o}`;return o+=1,d},s={nodes:n,currentIndex:t.index,setInput:yJ,nextSeed:a,allowDt:!!t.allowDt,allowIndex:!!t.allowIndex,writeIntegral:!!t.writeIntegral,allowIntervalComprehensions:!!t.allowIntervalComprehensions,specializeDoubleInequalities:!!t.specializeDoubleInequalities,includeFunctionParametersInRandomSeed:(u=t.includeFunctionParametersInRandomSeed)!=null?u:!0},c={};t.trailingComma!==void 0&&(c.trailingComma=t.trailingComma),t.disallowFrac&&(c.disallowFrac=!0),t.disableParentheses&&(c.disableParentheses=!0);function l(d){return d.parseOptions=t,d}if(e==="")return l(bx());try{let d=ey(e),f=cv(d,c),g=FE(s,f);return g.parseOptions=t,g}catch(d){let f;return d instanceof N.Error?f=d:typeof d=="string"?f=new N.Error(d):f=Ie(d),l(f)}}var bJ=["Sum","Product","Integral","List","Derivative","Piecewise","Restriction","Norm","Exponent","PercentOf","FunctionDefinition","UpdateRule","Substitution","ListComprehension"],JU={isGeometryEnabled(){return!1},is3dProduct(){return!1},is3dPolicy(){return!1},polygonUnsupportedPreferTriangle(){return!1},areAllScalesLinear(){return!0},assignmentForbidden(e){return!0},substitutionForbidden(e){return!0},graphingEnabled(){return!1},isValidSlider(e){return!1},sliderVariables(e){return[]},ansEnabled(){return!1},disabledFeatures(){return bJ},dimensionVarsEnabled(){return!1},shouldIncludeFunctionParametersInRandomSeed(){return!0},isComplexEnabled(){return!1},plotComplexAsPoints(){return!1}},QU={...JU,isGeometryEnabled(){return!0},is3dProduct(){return!0},is3dPolicy(){return!0},isComplexEnabled(){return!1}};var ty=class e{constructor(t,r,n,i){this.frame=t;this.symbolMap=r;this.symbolNodeMap=n;this.maxIndex=i}static empty(t){return new e(t,{},{},-1)}getSymbol(t){let r=this.symbolMap[t];if(r)switch(r.type){case"local":case"free":return r.value;case"global":return this.symbolMap.hasOwnProperty(t)?r.value:void 0;case"error":throw r.error;default:throw new Error("Unexpected symbolMap entry type: "+r.type)}}getMaxIndex(){return this.maxIndex}getParseNode(t){return this.symbolNodeMap[t]}setLocal(t,r,n){this.symbolNodeMap[t]=n,this.symbolMap[t]={type:"local",value:r},this.maxIndex=Math.max(this.maxIndex,r)}setGlobal(t,r,n){this.symbolNodeMap[t]=n,this.symbolMap[t]={type:"global",value:r},this.maxIndex=Math.max(this.maxIndex,r)}setFreeVariable(t,r){this.symbolMap[t]={type:"free",value:r},this.maxIndex=Math.max(this.maxIndex,r)}setErrorIfAccessed(t,r){this.symbolMap[t]={type:"error",error:r}}isLocal(t){let r=this.symbolMap[t];return(r==null?void 0:r.type)==="local"}isGlobal(t){return this.frame[t]!==void 0&&!this.isLocal(t)}isError(t){var n;let r=this.symbolMap[t];return r?r.type==="error":(n=this.frame[t])==null?void 0:n.isError}isDefined(t){return this.isLocal(t)||this.isGlobal(t)}getVisibleGlobalDefinition(t){let r=this.symbolMap[t];if(!r)return eH(this.frame[t]);switch(r.type){case"local":case"free":return;case"global":return eH(this.frame[t]);case"error":throw r.error;default:throw new Error("Unexpected symbolMap entry type: "+r.type)}}childScope(){return new e(this.frame,Fi(this.symbolMap),Fi(this.symbolNodeMap),this.maxIndex)}};function eH(e){if(e!=null&&e.isError)throw e;return e}function hd(e,t,r,n){return Bp({chunk:e,argMap:[t],start:r,unpatchedHeaderMap:new Map,processedHeaders:new Set},n)}function xJ(e,t){let{chunk:r}=e,n=r.getInstruction(t),i=[];for(let o of n.recursionGroup){let a=e.unpatchedHeaderMap.get(o);if(a===void 0)throw new Error("Programming Error: `substitute` did not include all headers in a recursion group.");i.push(a)}for(let o of n.recursionGroup)e.unpatchedHeaderMap.delete(o);for(let o of i)r.getInstruction(o).recursionGroup=i}function Bp(e,t){let{chunk:r,argMap:n,start:i}=e;if(t<i)return t;let o=n[t-i];if(o!==void 0)return o;let a=vJ(e,t);e.argMap[t-i]=a;let s=r.getInstruction(t);if(s.type===4){let c=a;e.unpatchedHeaderMap.set(t,c),e.processedHeaders.add(t);for(let l of s.recursionGroup)e.processedHeaders.has(l)||Bp(e,l);return Bp(e,s.endIndex),c}if(Fo(s))switch(s.type){case 23:case 21:case 50:break;case 19:{let l=s.args.length-2;for(let u=0;u<l;u++)Bp(e,t+1+u);break}case 53:{let u=r.getInstruction(s.args[0]).signature.argTypes.length;for(let d=0;d<u;d++)Bp(e,t+1+d);break}default:let c=s;throw new Error(`Programming Error. Unexpected OpCode: ${c.type}`)}else if(zw(s)){let c=s.args.length-1;for(let l=0;l<c;l++)Bp(e,t+1+l)}return a}function vJ(e,t){let{chunk:r,start:n}=e,i=r.getInstruction(t);if(ia(i)){let s=i.args[0];for(let c=s;c<=t;c++){let l=r.getInstruction(c);if(!pt(l))for(let u of l.args)u<s&&Bp(e,u)}}if(i.type===4)return r.FunctionHeader(i.symbol,i.valueType,i.signature,i.parameterSymbols);if(pt(i))return qc(r,i);let o=[];for(let s of i.args)o.push(Bp(e,s));let a=e.argMap[t-n];if(a!==void 0)return a;if(i.type===55&&!Yw(r,t)){let s=i.args[0];e.unpatchedHeaderMap.has(s)&&xJ(e,s)}return Yn(r,i,o)}function HE(e,t,r,n){let i=Ef(e,t),o=e.Constant(0);if(t<r)return o;let a=e.Constant(1),s=e.Constant(NaN),c=wp(e,r),l=C3(e,i),u=e.derivativeMaps.getMapEntry(e,n,r),{map:d,maxValidReference:f}=u;for(let w=0;w<d.length;w++){let E=d[w];E!==void 0&&E>f&&(d[w]=void 0)}let g=[],y=!1;for(let w=0;w<r;w++)g[w]=w,d[w]=o;let x=xo(e,i);return $E({chunk:e,derivativeVarIndex:r,forwardSeed:n,forwardMask:c,backwardMask:l,referenced:x,valueMap:g,derivativeMap:d,mustCopy:y,ZERO:o,ONE:a,NAN:s},r,i),u.maxValidReference=e.instructionsLength()-1,d[i]}function $E(e,t,r){let{chunk:n,valueMap:i,derivativeMap:o,backwardMask:a}=e;for(let s=t;s<=r;s++){let c=o[s];if(c!==void 0)if(n.getInstruction(c).type===0)o[s]=void 0;else{i[s]=UE(e,s);continue}if(!a[s]){i[s]=UE(e,s);continue}let l=n.getInstruction(s);if(Fo(l)&&l.endIndex!==-1)switch(l.type){case 21:{s=TJ(e,s);continue}case 19:case 23:{s=IJ(e,s);continue}case 53:{s=PJ(e,s);continue}}i[s]=UE(e,s),o[s]=SJ(e,s)}return r}function TJ(e,t){let{chunk:r,forwardMask:n,valueMap:i,derivativeMap:o,ZERO:a}=e,s=r.getInstruction(t),c=s.endIndex,l=r.getInstruction(c),u=a;if(n[s.args[1]]){let d=i[s.args[1]];u=r.Add([u,r.Multiply([o[s.args[1]],hd(r,d,t,l.args[1])])])}if(n[s.args[0]]){let d=i[s.args[0]];u=r.Subtract([u,r.Multiply([o[s.args[0]],hd(r,d,t,l.args[1])])])}if(wJ(r,t,n)){let d=i.slice();d[t]=Yn(r,s,[d[s.args[0]],d[s.args[1]]]),o[t]=a,$E({...e,valueMap:d,mustCopy:!0},t+1,c-1);let f=Yn(r,l,[d[l.args[0]],o[l.args[1]]]);o[c]=f,u=r.Add([u,Yn(r,r.getInstruction(c+1),[f])])}else for(let d=t;d<=c;d++)o[d]=a;if(EJ(r,t,i)){let d={...e,mustCopy:!0};for(let f=t;f<=c+1;f++)i[f]=UE(d,f)}else for(let d=t;d<=c+1;d++)i[d]=d;return o[c+1]=u,c+l.args.length-1}function wJ(e,t,r){let n=e.getInstruction(t),i=e.getInstruction(n.endIndex);if(i.args[1]<t+1)return r[i.args[1]];for(let o=t+1;o<=i.args[1];o++){let a=e.getInstruction(o);if(!pt(a)){for(let s of a.args)if(s<t&&r[s])return!0}}return!1}function EJ(e,t,r){let n=e.getInstruction(t);for(let i=t;i<=n.endIndex;i++){let o=e.getInstruction(i);if(!pt(o)){for(let a of o.args)if(r[a]!==a)return!0}}return!1}function IJ(e,t){let{chunk:r,derivativeMap:n,valueMap:i,ZERO:o}=e,a=r.getInstruction(t),s=a.endIndex,c=r.getInstruction(s),l;if(a.type===23)i[t]=Yn(r,a,[i[a.args[0]]]),n[t]=o,l=t+1;else{let d=[];d.push(i[a.args[0]],i[a.args[1]]);for(let f=2;f<a.args.length;f++)d.push(i[a.args[f]],n[a.args[f]]);i[t]=Yn(r,a,d),n[t]=o;for(let f=2;f<a.args.length;f++)i[t+f-1]=Yn(r,r.getInstruction(t+f-1),[i[t]]),n[t+f-1]=Yn(r,r.getInstruction(t+f-1),[i[t]]);l=t+a.args.length-1}$E({...e,mustCopy:!0},l,s-1);let u=[];u.push(i[c.args[0]]);for(let d=1;d<c.args.length;d++)u.push(i[c.args[d]],n[c.args[d]]);i[s]=Yn(r,c,u),n[s]=o;for(let d=1;d<c.args.length;d++)i[s+d]=Yn(r,r.getInstruction(s+d),[i[s]]),n[s+d]=Yn(r,r.getInstruction(s+d),[i[s]]);return s+c.args.length-1}function UE(e,t){let{chunk:r,valueMap:n,mustCopy:i,referenced:o}=e;if(!o[t])return t;let a=r.getInstruction(t);if(pt(a))return i?qc(r,a):t;{let s=[],c=!1;for(let l of a.args)s.push(n[l]),n[l]!==l&&(c=!0);return c||i?Yn(r,a,s):t}}function CJ(e,t){let{chunk:r,derivativeMap:n}=e,i=r.getInstruction(t),o=[],a=i.recursionGroup;for(let s of a){let c=r.getInstruction(s),l={argTypes:[]};for(let d of c.signature.argTypes)l.argTypes.push(d,d);let u=n[s];u||(u=r.FunctionHeader(c.symbol+`_\u2202${e.derivativeVarIndex}`,c.valueType,l,c.parameterSymbols),o.push(u)),e.derivativeMap[s]=u}for(let s of o){let c=r.getInstruction(s);c.recursionGroup=o}return e.derivativeMap[t]}function PJ(e,t){let{chunk:r,valueMap:n,derivativeMap:i}=e,a=r.getInstruction(t).args[0],s=r.getInstruction(a),c=s.endIndex,u=r.getInstruction(c).args[1],d=i[a],f=r.BeginFunction([d]);i[t]=f;let g=s.signature.argTypes,y=[];for(let I=0;I<g.length;I++){let S=g[I],D=t+I+1;y.push(D);let O=r.BlockVar(S,[f]),_=r.BlockVar(S,[f]);n[D]=O,i[D]=_}let x=t+g.length+1,b=c-1,w=df(r,y,x,b),E=n.slice();return E[a]=a,$E({...e,valueMap:E,mustCopy:!0,forwardMask:w},x,b),r.EndFunction([f,i[u]]),c}function SJ(e,t){let{chunk:r,derivativeVarIndex:n,forwardSeed:i,forwardMask:o,valueMap:a,derivativeMap:s,ZERO:c,ONE:l,NAN:u}=e,d=r.getInstruction(t);if(t===n){let g;switch(i){case"real":g=l;break;case"complexOne":g=r.NativeFunction("complex",[l,c]);break;case"complexI":g=r.NativeFunction("complex",[c,l]);break}if(xe(d.valueType)){let y=qo(r,t),x=r.BeginBroadcast([y]),b=r.EndBroadcast([x,g]);return r.BroadcastResult(d.valueType,[b])}else return g}if(Fo(d)||ia(d)||d.type===47||d.type===48||d.type===25||d.type===27||d.type===26||d.type===29||d.type===28||d.type===32||d.type===31||d.type===42||d.type===44||d.type===49||d.valueType===lr)return c;if(d.type===4)return CJ(e,t);if(!o[t]||pt(d))return d.valueType!==C?DJ(r,[a[t],c]):d.type!==1||isFinite(ae(d.value))?c:u;if(d.type===38||d.type===15){let g=[];for(let y of d.args)g.push(s[y]);return Yn(r,d,g)}if(d.type===33)return Yn(r,d,[a[d.args[0]],s[d.args[1]],s[d.args[2]]]);if(d.type===55){let y=[s[d.args[0]]];for(let x of d.args.slice(1)){y.push(a[x]);let b=s[x];if(b===c){let w=r.getInstruction(x).valueType;nB(w)&&(b=r.ZeroOfType(w))}y.push(b)}return r.FunctionCall(y)}let f=c;for(let g=0;g<d.args.length;g++){if(!o[d.args[g]])continue;let y=s[d.args[g]];if(y===c)continue;let x=MJ(e,a[t],g,y);x!==c&&(f=f===c?x:_J(r,[x,f]))}return f}function MJ(e,t,r,n){let{chunk:i,ZERO:o,ONE:a,NAN:s}=e,c=i.getInstruction(t);switch(c.type){case 8:return n;case 9:switch(r){case 0:return n;default:return i.Negative([n])}case 10:switch(r){case 0:return i.Multiply([n,c.args[1]]);default:return i.Multiply([c.args[0],n])}case 11:switch(r){case 0:return i.Divide([n,c.args[1]]);default:return i.Multiply([c.args[0],i.Divide([i.Negative([n]),i.Multiply([c.args[1],c.args[1]])])])}case 14:return i.Negative([n]);case 12:case 13:switch(r){case 0:return i.Multiply([i.Multiply([c.args[1],i.Exponent([c.args[0],i.Subtract([c.args[1],a])])]),n]);default:return i.Multiply([i.Piecewise([i.Equal([c.args[0],o]),i.Piecewise([i.GreaterEqual([c.args[1],o]),o,s]),i.Multiply([i.NativeFunction("ln",[c.args[0]]),t])]),n])}case 37:return AJ(i,t,rH[c.symbol][r],n);case 39:case 40:case 41:switch(r){case 0:return Yn(i,c,[n,c.args[1]]);default:return o}case 16:return Yn(i,c,[n]);default:{let l=c;throw new Error(`Unimplemented derivative for opcode ${l.type}`)}}}function DJ(e,t){switch(e.getInstruction(t[0]).valueType){case Ye:return e.NativeFunction("scaleTangentSegment",t);case Re:return e.NativeFunction("scaleTangentLine",t);case ot:return e.NativeFunction("scaleTangentRay",t);case We:return e.NativeFunction("scaleTangentCircle",t);case Oe:return e.NativeFunction("scaleTangentArc",t);case st:return e.NativeFunction("scaleTangentUndirectedAngleMarker",t);case $e:return e.NativeFunction("scaleTangentDirectedAngleMarker",t);case et:return e.NativeFunction("scaleTangentPolygon",t);case xt:return e.NativeFunction("scaleTangentTransformation",t);default:return e.Multiply(t)}}function _J(e,t){switch(e.getInstruction(t[0]).valueType){case Ye:return e.NativeFunction("addTangentSegment",t);case Mr:return e.NativeFunction("addTangentSegmentThreeD",t);case Re:return e.NativeFunction("addTangentLine",t);case ot:return e.NativeFunction("addTangentRay",t);case Ve:return e.NativeFunction("addTangentVector",t);case We:return e.NativeFunction("addTangentCircle",t);case Oe:return e.NativeFunction("addTangentArc",t);case st:return e.NativeFunction("addTangentUndirectedAngleMarker",t);case $e:return e.NativeFunction("addTangentDirectedAngleMarker",t);case et:return e.NativeFunction("addTangentPolygon",t);case xt:return e.NativeFunction("addTangentTransformation",t);default:return e.Add(t)}}function AJ(e,t,r,n){let i=ty.empty(An),a=e.getInstruction(t).args;for(let s=0;s<a.length;s++){let c=OJ[s];i.setLocal(c,a[s])}return i.setLocal("x_1",n),i.setLocal("q",t),Ct(vL(QU,e,i,lv.root,void 0,void 0),r)}var OJ=["x","y","z","u"],tH={exp:["q*x_1"],complexExp:["q*x_1"],ln:["\\{x >= 0: x_1/x \\}"],complexLn:["x_1/x"],log:["\\{x >= 0: x_1/(x*\\ln(10)) \\}"],sqrt:["x_1/(2*q)"],complexSqrt:["x_1/(2*q)"],complexPow:["q*y/x*x_1","q*\\ln(x)*x_1"],rtxsqpone:["x*x_1/q"],rtxsqmone:["x*x_1/q"],sin:["\\cos(x)*x_1"],complexSin:["\\cos(x)*x_1"],cos:["-\\sin(x)*x_1"],complexCos:["-\\sin(x)*x_1"],tan:["(1+q^2)*x_1"],complexTan:["(s*s)*x_1 \\with s=\\sec(x)"],arcsin:["x_1/\\sqrt{1 - x^2}"],complexArcsin:["x_1/(\\complexSqrt(1+x)\\complexSqrt(1-x))"],arccos:["-x_1/\\sqrt{1 - x^2}"],complexArccos:["-x_1/(\\complexSqrt(1+x)\\complexSqrt(1-x))"],sinh:["\\cosh(x)*x_1"],complexSinh:["\\cosh(x)*x_1"],cosh:["\\sinh(x)*x_1"],complexCosh:["\\sinh(x)*x_1"],tanh:["(\\sech(x))^2*x_1"],complexTanh:["(s*s)*x_1 \\with s=\\sech(x)"],arcsinh:["x_1/\\rtxsqpone(x)"],complexArcsinh:["x_1/(\\complexSqrt(1+\\complex(0,1)x)\\complexSqrt(1-\\complex(0,1)x))"],arccosh:["\\{ x > 0: x_1/\\rtxsqmone(x) \\}"],complexArccosh:["x_1/(\\complexSqrt(x+1)\\complexSqrt(x-1))"],arctanh:["\\{ \\abs(x) < 1: x_1/(1 - x^2) \\}"],complexArctanh:["x_1/((1+x)(1-x))"],csc:["-\\cot(x)*q*x_1"],complexCsc:["-\\cot(x)*q*x_1"],sec:["\\tan(x)*q*x_1"],complexSec:["\\tan(x)*q*x_1"],cot:["-(1+q^2)*x_1"],complexCot:["-(c*c)*x_1 \\with c=\\csc(x)"],arccsc:["-x_1/(\\abs(x)*\\rtxsqmone(x))"],complexArccsc:["-x_1/((x\\complexSqrt(1-1/x))(x\\complexSqrt(1+1/x)))"],arcsec:["x_1/(\\abs(x)*\\rtxsqmone(x))"],complexArcsec:["x_1/((x\\complexSqrt(1-1/x))(x\\complexSqrt(1+1/x)))"],arccot:["-x_1/(1+x^2)"],complexArccot:["-x_1/((x+\\complex(0,1))(x-\\complex(0,1)))"],csch:["-\\coth(x)*q*x_1"],complexCsch:["-\\coth(x)*q*x_1"],sech:["-\\tanh(x)*q*x_1"],complexSech:["-\\tanh(x)*q*x_1"],coth:["-(\\csch(x))^2*x_1"],complexCoth:["-(c*c)*x_1 \\with c=\\csch(x)"],arccsch:["-x_1/(\\abs(x)*\\rtxsqpone(x))"],complexArccsch:["-x_1/((x\\complexSqrt(1+\\complex(0,1)/x))(x\\complexSqrt(1-\\complex(0,1)/x)))"],arcsech:["\\{ x >= 0: -x_1/(x*\\sqrt{1 - x^2}) \\}"],complexArcsech:["-x_1/((x\\complexSqrt((1-x)/(1+x)))(1+x))"],arccoth:["\\{ \\abs(x) > 1 : x_1/(1 - x^2) \\}"],complexArccoth:["x_1/((1+x)(1-x))"],factorial:["q*\\polyGamma(0, x + 1)*x_1"],floor:["\\{ q=x: 0/0, 0*x_1 \\}"],complexFloor:["\\{ \\real(d) + \\imag(d) = 0: 0/0, \\imag(d) - \\real(d) = 1: 0/0, 0*x_1 \\} \\with d = x - q"],ceil:["\\{ q=x: 0/0, 0*x_1 \\}"],complexCeil:["\\{ \\real(d) + \\imag(d) = 0: 0/0, \\imag(d) - \\real(d) = -1: 0/0, 0*x_1 \\} \\with d = x - q"],round:["\\{ \\abs(\\mod(x, 1) - 0.5) > 0: 0*x_1 \\}"],complexRound:["\\{ \\real(q) - \\real(x) = 0.5: 0/0, \\imag(q) - \\imag(x) = 0.5: 0/0, 0*x_1 \\}"],abs:["\\{ x=0: 0/0, \\sign(x)*x_1 \\}"],sign:["\\{ x=0: 0/0, 0*x_1 \\}"],distance:["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q","((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q"],distanceThreeD:["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q","((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q"],segmentThreeD:["\\segmentThreeD(x_1,(0,0,0))","\\segmentThreeD((0,0,0),x_1)"],vectorThreeD:["\\vectorThreeD(x_1,(0,0,0))","\\vectorThreeD((0,0,0),x_1)"],triangle:["\\triangle(x_1,(0,0,0),(0,0,0))","\\triangle((0,0,0),x_1,(0,0,0))","\\triangle((0,0,0),(0,0,0),x_1)"],sphere:["\\sphere(x_1,0)","\\sphere((0,0,0),x_1)"],pointDet:["\\pointDet(x_1,y)","\\pointDet(x,x_1)"],pointDot:["\\pointDot(x_1,y)","\\pointDot(x,x_1)"],pointPerp:["\\pointPerp(x_1)"],complexMultiplyPoints:["\\complexMultiplyPoints(x_1,y)","\\complexMultiplyPoints(x,x_1)"],segment:["\\segment(x_1,(0,0))","\\segment((0,0),x_1)"],line:["\\line(x_1,(0,0))","\\line((0,0),x_1)"],ray:["\\ray(x_1,(0,0))","\\ray((0,0),x_1)"],vector:["\\vector(x_1, (0,0))","\\vector((0,0), x_1)"],mathVector:["\\mathVector(x_1,(0,0))","\\mathVector((0,0),x_1)"],mathVectorThreeD:["\\mathVectorThreeD(x_1,(0,0,0))","\\mathVectorThreeD((0,0,0),x_1)"],rawTransform:["\\rawTransform(x_1,(0,0))","\\rawTransform((0,0),x_1)"],rawTransformConj:["\\rawTransformConj(x_1,(0,0))","\\rawTransformConj((0,0),x_1)"],transformWithoutTranslation:["\\transformWithoutTranslation(x_1)"],transformScaleFactor:["\\transformScaleFactor(x_1)"],vectorDisplacementAsPoint:["\\vectorDisplacementAsPoint(x_1)"],vectorThreeDDisplacementAsPoint:["\\vectorThreeDDisplacementAsPoint(x_1)"],basePointFromVector:["\\basePointFromVector(x_1)"],basePointFromVectorThreeD:["\\basePointFromVectorThreeD(x_1)"],circle:["\\circle(x_1,0)","\\circle((0,0),x_1)"],arc:["\\arc(x_1,(0,0),(0,0))","\\arc((0,0),x_1,(0,0))","\\arc((0,0),(0,0),x_1)"],arcCenter:["(\\pointDot(q-p1,p1_1)\\pointPerp(v_2)+\\pointDot(q-p2,p2_1)\\pointPerp(v_3)+\\pointDot(q-p3,p3_1)\\pointPerp(v_1))/\\pointDet(v_2,v_1) \\with v_1=p2-p1,v_2=p3-p2,v_3=p1-p3".replace(/p1_1/g,"\\arcFirstPoint(x_1)").replace(/p2_1/g,"\\arcMiddlePoint(x_1)").replace(/p3_1/g,"\\arcThirdPoint(x_1)").replace(/p1/g,"\\arcFirstPoint(x)").replace(/p2/g,"\\arcMiddlePoint(x)").replace(/p3/g,"\\arcThirdPoint(x)")],arcFirstPoint:["\\arcFirstPoint(x_1)"],arcMiddlePoint:["\\arcMiddlePoint(x_1)"],arcThirdPoint:["\\arcThirdPoint(x_1)"],arcOmega:["2 * (X_1*Y/(Y*Y+X*X) - Y_1*X/(Y*Y+X*X))".replace(/X_1/g,"((v1x * v2y_1 + v1x_1 * v2y) - (v2x_1 * v1y + v2x * v1y_1))").replace(/Y_1/g,"((v1x * v2x_1 + v1x_1 * v2x) + (v1y_1 * v2y + v1y * v2y_1))").replace(/X/g,"(v1x * v2y - v2x * v1y)").replace(/Y/g,"(v1x * v2x + v1y * v2y)").replace(/v1x_1/g,"(\\arcMiddlePoint(x_1) - \\arcFirstPoint(x_1)).x").replace(/v2x_1/g,"(\\arcThirdPoint(x_1) - \\arcMiddlePoint(x_1)).x").replace(/v1y_1/g,"(\\arcMiddlePoint(x_1) - \\arcFirstPoint(x_1)).y").replace(/v2y_1/g,"(\\arcThirdPoint(x_1) - \\arcMiddlePoint(x_1)).y").replace(/v1x/g,"(\\arcMiddlePoint(x) - \\arcFirstPoint(x)).x").replace(/v2x/g,"(\\arcThirdPoint(x) - \\arcMiddlePoint(x)).x").replace(/v1y/g,"(\\arcMiddlePoint(x) - \\arcFirstPoint(x)).y").replace(/v2y/g,"(\\arcThirdPoint(x) - \\arcMiddlePoint(x)).y")],center:["\\center(x_1)"],radius:["\\radius(x_1)"],undirectedAngleMarker:["\\undirectedAngleMarker(x_1)"],directedAngleMarker:["\\directedAngleMarker(x_1,0,0,0)","\\directedAngleMarker((0,0),x_1,0,0)","\\directedAngleMarker((0,0),0,x_1,0)","\\directedAngleMarker((0,0),0,0,x_1)"],directedCoterminalAngle:["\\directedAngleMarker((0,0),0,\\directedAngleMarkerRawDelta(x_1),0)"],undirectedCoterminalAngle:["\\undirectedAngleMarker(\\directedAngleMarker((0,0),0,\\undirectedAngleMarkerRawDelta(x_1),0))"],supplement:["\\directedAngleMarker((0,0),0,-\\directedAngleMarkerRawDelta(x_1),0)"],directedAngleMarkerMultiplier:["\\directedAngleMarkerMultiplier(x_1)"],undirectedAngleMarkerMultiplier:["\\undirectedAngleMarkerMultiplier(x_1)"],directedAngleMarkerRawDelta:["\\directedAngleMarkerRawDelta(x_1)"],undirectedAngleMarkerRawDelta:["\\undirectedAngleMarkerRawDelta(x_1)"],polygonInteriorUndirectedAngles:["\\polygonInteriorUndirectedAngles(x_1)"],polygonInteriorDirectedAngles:["\\polygonInteriorDirectedAngles(x_1)"],lineFromSegment:["\\lineFromSegment(x_1)"],lineFromRay:["\\lineFromRay(x_1)"],segmentGlider:["\\segmentGlider(x_1,y)","\\{0<y<1:(\\segmentGlider(x,1)-\\segmentGlider(x,0))*x_1,(0,0)\\}"],segmentThreeDGlider:["\\segmentThreeDGlider(x_1,y)","\\{0<y<1:(\\segmentThreeDGlider(x,1)-\\segmentThreeDGlider(x,0))*x_1,(0,0,0)\\}"],rayGlider:["\\rayGlider(x_1,y)","\\{0<y:(\\rayGlider(x,1)-\\rayGlider(x,0))*x_1,(0,0)\\}"],lineGlider:["\\lineGlider(x_1,y)","(\\lineGlider(x,1)-\\lineGlider(x,0))*x_1"],circleGlider:["\\circleGlider(x_1,y)","\\{0<y<1:2*\\pi*\\pointPerp(q-\\center(x))*x_1,(0,0)\\}"],arcGlider:["(0/0,0/0)","(0/0,0/0)"],polygonEdgeByParameter:["\\polygonEdgeByParameter(x_1,y)","\\{\\floor(y)=y:\\segment((0/0,0/0),(0/0,0/0)),\\segment((0,0),(0,0))\\}"],polygonGlider:["\\polygonGlider(x_1,y)","\\{y<0:(0,0),y>x.\\vertices.\\count:(0,0),\\floor(y)=y:(0/0,0/0),(x_1*(\\segmentGlider(s,1)-\\segmentGlider(s,0))\\with s=\\polygonEdgeByParameter(x,y))\\}"],chooseNonIncidentPoint:["(0/0,0/0)"],circleCircleIntersection:["(\\radius(x)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(x))))/\\pointDot(\\pointPerp(q-\\center(y)),q-\\center(x))*\\pointPerp(q-\\center(y))","(\\radius(y)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(y))))/\\pointDot(\\pointPerp(q-\\center(x)),q-\\center(y))*\\pointPerp(q-\\center(x))"],circleArcIntersection:["(0/0,0/0)"],circleLineIntersection:["(\\radius(x)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(x))))/\\pointDot((\\lineGlider(y,1)-\\lineGlider(y,0)),q-\\center(x))*(\\lineGlider(y,1)-\\lineGlider(y,0))","(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(y,1))+\\pointDet(\\lineGlider(y,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\pointPerp(q-\\center(x)),\\lineGlider(y,1)-\\lineGlider(y,0)))*(\\pointPerp(q-\\center(x)))"],arcCircleIntersection:["(0/0,0/0)"],arcArcIntersection:["(0/0,0/0)"],arcLineIntersection:["(0/0,0/0)"],lineCircleIntersection:["(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(x,1))+\\pointDet(\\lineGlider(x,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\pointPerp(q-\\center(y)),\\lineGlider(x,1)-\\lineGlider(x,0)))*(\\pointPerp(q-\\center(y)))","(\\radius(y)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(y))))/\\pointDot((\\lineGlider(x,1)-\\lineGlider(x,0)),q-\\center(y))*(\\lineGlider(x,1)-\\lineGlider(x,0))"],lineArcIntersection:["(0/0,0/0)"],lineLineIntersection:["(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(x,1))+\\pointDet(\\lineGlider(x,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\lineGlider(y,1)-\\lineGlider(y,0),\\lineGlider(x,1)-\\lineGlider(x,0)))*(\\lineGlider(y,1)-\\lineGlider(y,0))","(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(y,1))+\\pointDet(\\lineGlider(y,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\lineGlider(x,1)-\\lineGlider(x,0),\\lineGlider(y,1)-\\lineGlider(y,0)))*(\\lineGlider(x,1)-\\lineGlider(x,0))"],parallel:["\\parallel(x_1,(0,0))","\\parallel(\\line((0,0),(0,0)),x_1)"],perpendicular:["\\perpendicular(x_1,(0,0))","\\perpendicular(\\line((0,0),(0,0)),x_1)"],angleVertex:["\\angleVertex(x_1)"],angleStart:["\\angleStart(x_1)"],directedAngleVertex:["\\directedAngleVertex(x_1)"],directedAngleStart:["\\directedAngleStart(x_1)"],anglebisector:["\\ray(\\angleVertex(x_1),\\angleVertex(x_1) + \\pointPerp( \\rayGlider(q,1) - \\angleVertex(x) ) * (s_1 + d_1 / 2)) \\with s_1 = \\angleStart(x_1), d_1 = \\undirectedAngleMarkerRawDelta(x_1)"],directedanglebisector:["\\ray(\\directedAngleVertex(x_1),\\directedAngleVertex(x_1) + \\pointPerp( \\rayGlider(q,1) - \\directedAngleVertex(x) ) * (s_1 + d_1 / 2)) \\with s_1 = \\directedAngleStart(x_1), d_1 = \\directedAngleMarkerRawDelta(x_1)"],scaleTangentTransformation:["\\scaleTangentTransformation(x_1, y)","\\scaleTangentTransformation(x, x_1)"],scaleTangentPolygon:["\\scaleTangentPolygon(x_1, y)","\\scaleTangentPolygon(x, x_1)"],scaleTangentSegment:["\\scaleTangentSegment(x_1, y)","\\scaleTangentSegment(x, x_1)"],scaleTangentLine:["\\scaleTangentLine(x_1, y)","\\scaleTangentLine(x, x_1)"],scaleTangentRay:["\\scaleTangentRay(x_1, y)","\\scaleTangentRay(x, x_1)"],scaleTangentCircle:["\\scaleTangentCircle(x_1, y)","\\scaleTangentCircle(x, x_1)"],scaleTangentArc:["\\scaleTangentArc(x_1, y)","\\scaleTangentArc(x, x_1)"],scaleTangentDirectedAngleMarker:["\\scaleTangentDirectedAngleMarker(x_1, y)","\\scaleTangentDirectedAngleMarker(x, x_1)"],scaleTangentUndirectedAngleMarker:["\\scaleTangentUndirectedAngleMarker(x_1, y)","\\scaleTangentUndirectedAngleMarker(x, x_1)"],addTangentPolygon:["x_1","x_1"],addTangentSegment:["x_1","x_1"],addTangentSegmentThreeD:["x_1","x_1"],addTangentLine:["x_1","x_1"],addTangentRay:["x_1","x_1"],addTangentVector:["x_1","x_1"],addTangentCircle:["x_1","x_1"],addTangentArc:["x_1","x_1"],addTangentDirectedAngleMarker:["x_1","x_1"],addTangentUndirectedAngleMarker:["x_1","x_1"],addTangentTransformation:["x_1","x_1"],translation:["\\rawTransform((0,0),x_1)"],dilation:["\\rawTransform((0,0),(1-y)x_1)","\\rawTransform((x_1,0),-x*x_1)"],reflection:["\\rawTransformConj(a_1,p1_1-\\complexMultiplyPoints(a_1,(p1.x,-p1.y))-\\complexMultiplyPoints(qa,(p1_1.x,-p1_1.y)))\\with a_1=\\pointPerp(qa)*(\\pointDet(v,v_1)*2/(v.x^2+v.y^2))".replace(/p1_1/g,"\\glider(x_1,0)").replace(/p1/g,"\\glider(x,0)").replace(/v_1/g,"(\\glider(x_1,1)-\\glider(x_1,0))").replace(/v/g,"(\\glider(x,1)-\\glider(x,0))").replace(/qa/g,"\\transformScaleFactor(q)")],rotation:["\\rawTransform((0,0),\\complexMultiplyPoints(p,x_1))\\with p=(1,0)-(\\cos(y),\\sin(y))","\\rawTransform(p,\\complexMultiplyPoints(-p,x))\\with p=(-x_1*\\sin(y),x_1*\\cos(y))"],compose:["\\reflection(\\line((0/0,0/0),(0/0,0/0)))","\\reflection(\\line((0/0,0/0),(0/0,0/0)))"],inverse:["\\reflection(\\line((0/0,0/0),(0/0,0/0)))"],transformPoint:["\\transformPoint(x_1,y)","\\transformPoint(\\transformWithoutTranslation(x),x_1)"],transformSegment:["\\transformSegment(x_1,y)","\\transformSegment(\\transformWithoutTranslation(x),x_1)"],transformVector:["\\transformVector(x_1,y)","\\transformVector(\\transformWithoutTranslation(x),x_1)"],transformLine:["\\transformLine(x_1,y)","\\transformLine(\\transformWithoutTranslation(x),x_1)"],transformRay:["\\transformRay(x_1,y)","\\transformRay(\\transformWithoutTranslation(x),x_1)"],transformCircle:["\\circle(\\transformPoint(x_1,y.\\center), y.\\radius * \\pointDot(a_1,a) / \\hypot(a.x,a.y))\\with a=\\transformScaleFactor(x),a_1=\\transformScaleFactor(x_1)","\\transformCircle(\\transformWithoutTranslation(x),x_1)"],transformArc:["\\transformArc(x_1,y)","\\transformArc(\\transformWithoutTranslation(x),x_1)"],transformPolygon:["\\transformPolygon(x_1,y)","\\transformPolygon(\\transformWithoutTranslation(x),x_1)"],transformAngleMarker:["\\angle((1,0),(0,0),(1,0))","\\transformAngleMarker(\\transformWithoutTranslation(x),x_1)"],transformDirectedAngleMarker:["\\directedangle((1,0),(0,0),(1,0))","\\transformDirectedAngleMarker(\\transformWithoutTranslation(x),x_1)"],mean:["\\mean(x_1)"],total:["\\total(x_1)"],count:["0"],var:["2*\\cov(x, x_1)"],varp:["2*\\cov(x, x_1)*(\\count(x)-1)/\\count(x)"],stdev:["\\cov(x, x_1)/q"],stdevp:["\\covp(x, x_1)/q"],mad:["\\mean(\\sign(x-\\mean(x))*(x_1 - \\mean(x_1)))"],min:["x_1[\\argmin(x)]"],max:["x_1[\\argmax(x)]"],median:["0.5*(x_1[\\lowerQuantileIndex(x, 0.5)] + x_1[\\upperQuantileIndex(x, 0.5)])"],argmin:["0/0"],argmax:["0/0"],gcd:["0/0"],complexGCD:["0/0"],lcm:["0/0"],complexLCM:["0/0"],erf:["\\frac{2x_1}{\\sqrt{\\pi }}\\exp(-x^2)"],invNorm:["\\frac{x_1}{\\pdf(\\normaldist(0,1),q)}"],logbase:["\\{x > 0: \\frac{x_1}{x*\\ln(y)} \\}","\\frac{-q*x_1}{y*\\ln(y)}"],nthroot:["x^{1/y - 1}/y*x_1","-\\frac{q*\\ln(x)*x_1}{y^2}"],hypot:["x_1*x/q","x_1*y/q"],polyGamma:["0/0","\\polyGamma(1 + x, y)*x_1"],mod:["\\{ q=0: 0/0, x_1 \\}","\\{ \\mod(x/y, 1) > 0: -\\floor(x/y)*x_1 \\}"],complexMod:["\\{ q=0: 0/0, x_1 \\}","\\{ \\round(r)=r: 0/0, -\\floor(x/y)*x_1 \\} \\with r=\\round(x/y)"],cov:["\\cov(x_1, y)","\\cov(x, x_1)"],covp:["\\covp(x_1, y)","\\covp(x, x_1)"],corr:["(\\cov(x_1, y) - (\\cov(x, y)*\\cov(x, x_1)/\\var(x)))/(\\stdevp(x)\\stdevp(y))","(\\cov(x, x_1) - (\\cov(x, y)*\\cov(y, x_1)/\\var(y)))/(\\stdevp(x)\\stdevp(y))"],spearman:["0/0","0/0"],quantile:["\\{ \\floor(y*(\\count(x)-1)) = y*(\\count(x)-1) :   x_1[\\upperQuantileIndex(x, y)],  (\\ceil(y*(\\count(x)-1)) - y*(\\count(x)-1))*x_1[\\lowerQuantileIndex(x, y)] +   (y*(\\count(x)-1) - \\floor(y*(\\count(x)-1)))*x_1[\\upperQuantileIndex(x, y)]\\}","\\{ \\floor(y*(\\count(x)-1)) < y*(\\count(x)-1) :   (\\count(x)-1)*(x[\\upperQuantileIndex(x, y)] - x[\\lowerQuantileIndex(x, y)])*x_1\\}"],quartile:["0.5*(x_1[\\lowerQuartileIndex(x, y)] + x_1[\\upperQuartileIndex(x, y)])","0/0"],tscore:["\\frac{\\sqrt{\\count(x)}(\\stdev(x)*\\mean(x_1)-(\\mean(x)-y)*\\frac{\\cov(x,x_1)}{\\stdev(x)})}{\\stdev(x)^2}","-x_1*\\sqrt{\\count(x)}/\\stdev(x)"],quartileIndex:["0/0","0/0"],upperQuartileIndex:["0/0","0/0"],lowerQuartileIndex:["0/0","0/0"],upperQuantileIndex:["0/0","0/0"],lowerQuantileIndex:["0/0","0/0"],nCr:["q*(\\polyGamma(0, 1 + x) - \\polyGamma(0, 1 + x - y))","q*(\\polyGamma(0, 1 + x - y) - \\polyGamma(0, 1 + y))"],nPr:["q*(\\polyGamma(0, 1 + x) - \\polyGamma(0, 1 + x - y))","q*\\polyGamma(0, 1 + x - y)"],arctan:["x_1*y/(y^2+x^2)","-x_1*x/(y^2+x^2)"],complexArctan:["x_1/((x+\\complex(0,1))(x-\\complex(0,1)))"],poissonpdf:["0/0","x_1\\frac{\\exp(-y)(\\floor(x)-y)y^{(\\floor(x)-1)}}{(\\floor(x))!}"],invPoisson:["0/0","0/0"],tpdf:["x_1*q*\\frac{-(y+1)*x}{y+x^2}","x_1*\\frac{1}{2}q*(  \\frac{x^2-1}{y + x^2} + \\ln(\\frac{y}{y + x^2}) +   \\polyGamma(0, \\frac{1+y}{2}) - \\polyGamma(0, y/2))"],invT:["x_1/\\pdf(\\tdist(y),q)","0/0"],tcdf:["-x_1*\\pdf(\\tdist(z),x)","x_1*\\pdf(\\tdist(z),y)","0/0"],poissoncdf:["0/0","0/0","x_1\\sum _{n=\\max(0,\\floor(\\min(x,y)))}^{\\floor(\\max(x,y))}\\frac{\\exp(-z)(n-z)z^{(n-1)}}{n!}"],normalpdf:["-x_1*\\frac{x-y}{z^2} q","x_1*\\frac{x-y}{z^2} q","x_1*(\\frac{(x-y-z)*(x-y+z)}{z^3}) q"],binompdf:["0/0","0/0","\\{0<=z<=1: x_1*q*(\\frac{\\round(x)}{z}-\\frac{\\round(y)-\\round(x)}{1-z}), 0 \\}"],invBinom:["0/0","0/0","0/0"],uniformpdf:["0","\\{y<=x: \\frac{x_1}{(z-y)^2}, 0\\}","\\{z>=x: -\\frac{x_1}{(z-y)^2}, 0\\}"],invUniform:["\\{y<=x<=z: x_1*(z-y), 0\\}","\\{y<=x<=z: x_1*(1-x), 0\\}","\\{y<=x<=z: x_1*x, 0\\}"],normalcdf:["-x_1\\pdf(\\normaldist(z,u), x)","x_1\\pdf(\\normaldist(z,u), y)","-x_1*(\\pdf(\\normaldist(z,u), y) - \\pdf(\\normaldist(z,u), x))","x_1*(  \\{\\abs(y)=1/0:0,\\frac{z-y}{u}\\pdf(\\normaldist(z,u),y)\\} -   \\{\\abs(x)=1/0:0,\\frac{z-x}{u}\\pdf(\\normaldist(z,u),x)\\})"],binomcdf:["0/0","0/0","0/0","\\{0<=u<=1: x_1*\\sum _{n=\\max(0,\\round(\\min(x,y)))}^{\\round(\\max(x,y))}(  \\pdf(\\binomialdist(z,u),n)*(\\frac{n}{u}-\\frac{\\round(z)-n}{1-u})), 0 \\}"],uniformcdf:["\\{z>u: 0/0, -x_1\\pdf(\\uniformdist(z,u), x)\\}","\\{z>u: 0/0, x_1\\pdf(\\uniformdist(z,u), y)\\}","\\{z>u: 0/0, x_1*(\\frac{\\{z<x<u:u-x,0\\} + \\{z<y<u:y-u,0\\}}{(u-z)^2})\\}","\\{z>u: 0/0, x_1*(\\frac{\\{z<x<u:x-z,0\\} + \\{z<y<u:z-y,0\\}}{(u-z)^2})\\}"],normalSample:["0/0","0/0","0/0"],uniformSample:["0/0","0/0","0/0"],tSample:["0/0","0/0"],poissonSample:["0/0","0/0"],binomSample:["0/0","0/0","0/0"],rgb:["0/0","0/0","0/0"],hsv:["0/0","0/0","0/0"],polygon:["\\polygon(x_1)"],area:["0/0"],perimeter:["0/0"],vertices:["\\vertices(x_1)"],segments:["\\segments(x_1)"],validateRangeLength:["0","0","0","\\{q \\ge 1: x_1, 0\\}"],validateSampleCount:["\\{x<0:0,1\\}*x_1"],select:["\\select(x_1, y)","0*q"],shuffle:["0*y","\\shuffle(x, x_1)"],sortPerm:["0*x"],elementsAt:["\\elementsAt(x_1, y)","0*q"],uniquePerm:["0*q"],tone:["\\tone(x_1,0)","\\tone(0,x_1)"],restriction:["0"],restrictionToBoolean:["0"],complex:["\\complex(x_1,0)","\\complex(0,x_1)"],arg:["\\imag(x_1/x)"],complexDivide:["x_1/y","-(q/y)x_1"],coerceComplexToReal:["\\coerceComplexToReal(x_1)"],coerceRealToComplex:["\\coerceRealToComplex(x_1)"]},rH={};for(let e in tH){let t=e,r=tH[t],n=[];for(let i=0;i<r.length;i++){let o=r[i];n.push(Gp(o,{}))}rH[t]=n}function uv(e){return Le(e,C)?"number":Le(e,$)?"complex":void 0}function YE(e,t,r,n){let i=e.getInstruction(r).valueType;if(uv(i)!==n)throw Ie(`Incorrect derivative strategy '${n}' for type ${i}.`);let o=e.getInstruction(t).valueType;if(!LJ(o,n)){let a=e.areAllArgsConstant([t]);throw n==="number"?IM([dt(o)],{blockExport:a}):CM([dt(o),dt(i)],{blockExport:a})}switch(n){case"number":return HE(e,t,r,"real");case"complex":let a=HE(e,t,r,"complexOne"),s=HE(e,t,r,"complexI");return e.Multiply([e.Constant(Et(1,2)),e.Subtract([a,e.Multiply([e.ImaginaryUnit(),s])])]);default:throw Ie(`Invalid derivative strategy '${n}'.`)}}function LJ(e,t){switch(t){case"number":return Li(e,$)||Li(e,Dn)||Le(e,z)||Le(e,oe);case"complex":return Li(e,$)||Li(e,Dn);default:throw Ie(`Invalid derivative strategy '${t}'.`)}}function TL(e,t,r){let n=e.getInstruction(r).valueType,i=uv(n);if(!i)throw Ie(`chunk.derivative called on non-number ${xr(n)}.`);return YE(e,t,r,i)}function nH(e){let t=[];t.push("digraph {");for(let r=0;r<e.instructionsLength();r++)e.getInstruction(r).type!==0&&t.push(`${r} [label="${r}: ${gf(e,r)}"];`);for(let r=0;r<e.instructionsLength();r++){let n=e.getInstruction(r);if(I3(n))for(let i of n.args)t.push(`${r} -> ${i};`)}return t.push("}"),t.join(`
`)}var hu=class e{constructor(t){this.derivativeMaps=new ME;if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error("Programming Error: length of argNames must match length of argTypes");this.argNames=t.argNames,this.argTypes=t.argTypes;for(let r=0;r<this.argTypes.length;r++){let n=this.argTypes[r];this.LoadArg(n)}this.returnIndex=this.Constant(NaN)}computeNeedsThunking(){for(let t=this.returnIndex;t>=0;t--)if(this.instructions[t].type===55)return!0;return!1}setError(t){this.error=t}getError(){return this.error}getReturnIndex(){return this.returnIndex}setReturnIndex(t){if(!(0<=t&&t<this.instructions.length))throw new Error(`Programming Error: out of bounds return index ${t}`);this.returnIndex=t}addComments(t){for(let r in t){let n=this.comments[r]||"";this.comments[r]=n+t[r]}return this}instructionsLength(){return this.instructions.length}getInstruction(t){return this.instructions[t]}popInstruction(){this.truncate(this.instructions.length-1)}truncate(t){this.instructions.length=Math.min(t,this.instructions.length),this.blockMask.length=Math.min(t,this.blockMask.length),this.comments.length=Math.min(t,this.comments.length),this.derivativeMaps.truncate(t),this.setReturnIndex(this.instructions.length-1)}dereferenceFunctionHeader(t){let r=this.getInstruction(t);return r.endIndex===-1?void 0:r.endIndex}getDirectDependencies(t){if(t.type===55){let r=t.args,n=this.dereferenceFunctionHeader(r[0]);if(n!==void 0)return r.concat(n)}return t.args}getRecursionStructure(t){let r=this.getInstruction(t);if(r.endIndex===-1)throw Ie("Programming error: cannot get recursion structure before function is closed");if(!r.__cachedRecursionStructure){let n={};for(let i of r.recursionGroup){let o=this.getInstruction(i);n[o.symbol]=i}r.__cachedRecursionStructure=q3(this,n)}return r.__cachedRecursionStructure}getRecursiveFunctionMetadata(t){let r=this.getRecursionStructure(t),n=this.getInstruction(t);return{type:r.canIterate?"iterative":"general",recursionGroup:n.recursionGroup.map(i=>this.getInstruction(i).symbol),returnType:n.valueType,signature:n.signature,recursiveStructure:r}}pushInstructionChecked(t){if(this.instructions.length>=32768)throw UM();this.instructions.push(t),this.setReturnIndex(this.instructions.length-1)}pushLeafInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushInstruction(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.setReturnIndex(zq(this)),this.setReturnIndex(rz(this)),this.setReturnIndex(Iq(this)),Eq(this,this.getReturnIndex()),this.returnIndex===this.instructions.length-1&&this.setReturnIndex(qq(this)),this.getReturnIndex()}checkInstructionArguments(t){for(let r of t.args)if(this.blockMask[r])throw new Error("Programming Error: cannot reference an instruction in a closed block")}markClosedBlock(t,r){for(let n=t;n<r;n++)this.blockMask[n]=!0}LoadArg(t){return this.pushLeafInstruction({type:2,valueType:t})}BlockVar(t,r){return this.pushInstruction({type:47,valueType:t,args:r})}SymbolicVar(t,r){return this.pushLeafInstruction({type:3,valueType:t,symbol:r})}BroadcastResult(t,r){let n=r[0],o=this.instructions[n].args[0],s=this.getInstruction(o).args[0],c=this.getInstruction(s);return this.pushInstruction({type:48,valueType:t,args:r,constantLength:kt(c)?wn(this,s):void 0})}Constant(t){return this.ConstantOfType(C,t)}ConstantOfType(t,r){if(typeof r=="number"&&(r=Et(r,1)),xe(t)&&r.length>1e4)throw gx();return this.pushLeafInstruction({type:1,valueType:t,value:r})}TupleOfType(t,r){return this.pushInstruction({type:15,valueType:t,args:r})}Slot(t,r){let n=16,i=this.getInstruction(r[0]).valueType,o=Fb[i],a=o?o[t]:nn;if(a===void 0)throw Ie(`Invalid slot index: ${t} for ${xr(i)}.`);return this.pushInstruction({type:n,valueType:a,args:r,index:t})}ImaginaryUnit(){return this.ConstantOfType($,[Et(0,1),Et(1,1)])}NanOfType(t){if(t===cr){let r=this.Constant(NaN);return this.Distribution("uniformdist",[r,r])}else return this.ConstantOfType(t,na(t))}ZeroOfType(t){return this.ConstantOfType(t,iB(t))}Add(t){let r=8,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Subtract(t){let r=9,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Multiply(t){let r=10,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Divide(t){let r=11,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Exponent(t){let r=12,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}RawExponent(t){let r=13,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Negative(t){let r=14,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Equal(t){let r=25,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Less(t){let r=26,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Greater(t){let r=27,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}LessEqual(t){let r=28,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}GreaterEqual(t){let r=29,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Comparator(t,r){switch(t){case"=":return this.Equal(r);case">":return this.Greater(r);case"<":return this.Less(r);case"<=":return this.LessEqual(r);case">=":return this.GreaterEqual(r);default:{let n=t;throw new Error(`Unexpected comparator symbol: ${n}`)}}}Or(t){let r=31,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}And(t){let r=32,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Piecewise(t){let r=33,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}List(t){let r=38,n=Fn(this,r,t);if(t.length>1e4)throw gx();return this.pushInstruction({type:r,valueType:n,args:t})}ListAccess(t){let r=39,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}DeferredListAccess(t){let r=40,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}InboundsListAccess(t){let r=41,n=Fn(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}NativeFunction(t,r){let n=37,i=Xn[t].returnType,o=typeof i=="function"?i(r.map(a=>this.getInstruction(a).valueType)):i;return this.pushInstruction({type:n,valueType:o,args:r,symbol:t})}Distribution(t,r){let n=42,i=cr;return this.pushInstruction({type:n,valueType:i,args:r,symbol:t})}BeginIntegral(t,r){let n=21,i=Fn(this,n,[]);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndIntegral(t){let r=22,n=Fn(this,r,t),i=t[0],o=this.getInstruction(i);this.instructions[i]={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),callData:o.callData};let a=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,a),a}BeginBroadcast(t,r){let n=23,i=Fn(this,n,[]),o=this.getInstruction(t[0]);if(kt(o)&&wn(this,t[0])>1e4)throw gx();return this.pushInstruction({type:n,valueType:i,endIndex:-1,args:t,context:r})}EndBroadcast(t){let r=24,n=Fn(this,r,t),i=t[0],o=this.getInstruction(i),a={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),context:o.context};this.instructions[i]=a;let s=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,s),s}BeginLoop(t,r){let n=19,i=Fn(this,n,r);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndLoop(t){let r=20,n=Fn(this,r,t),i=t[0],o=this.getInstruction(i);this.instructions[i]={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),callData:o.callData};let a=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,a),a}BeginMap(t,r){let n=50,i=Fn(this,n,r);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndMap(t){let r=51,n=Fn(this,r,t),i=t[0],o=this.getInstruction(i);this.instructions[i]={type:o.type,valueType:o.valueType,args:o.args,endIndex:this.instructionsLength(),callData:o.callData};let a=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,a),a}FunctionHeader(t,r,n,i){let o=4;return this.pushLeafInstruction({type:o,valueType:r,endIndex:-1,symbol:t,signature:n,parameterSymbols:i,recursionGroup:[]})}BeginFunction(t){let r=53,n=this.getInstruction(t[0]);return this.pushInstruction({type:r,valueType:n.valueType,endIndex:-1,args:t})}EndFunction(t){let r=54,n=t[0],i=this.getInstruction(n);this.instructions[n]={type:i.type,valueType:i.valueType,args:i.args,endIndex:this.instructionsLength()};let o=i.args[0],a=this.getInstruction(i.args[0]);this.instructions[o]={type:a.type,valueType:a.valueType,endIndex:this.instructionsLength(),symbol:a.symbol,signature:a.signature,parameterSymbols:a.parameterSymbols,recursionGroup:a.recursionGroup};let s=this.pushInstruction({type:r,valueType:nn,args:t});return this.markClosedBlock(n,s),s}FunctionCall(t){let r=55;return this.pushInstruction({type:r,valueType:Fn(this,r,t),args:t})}ExtendSeed(t,r){let n=44,i=lr;return this.pushInstruction({type:n,valueType:i,args:r,tag:t})}Noop(){let t=0,r=nn;return this.pushLeafInstruction({type:t,valueType:r})}Action(t,r){return this.pushInstruction({type:49,valueType:nr,args:r,symbols:t})}replaceInstructionWithConstant(t,r){this.instructions[t]=r,this.blockMask[t]=void 0}replaceInstructionWithBlockVarOrFunctionCall(t,r){this.instructions[t]=r}reopenFinalBlock(){let t=this.getInstruction(this.getReturnIndex());if(t.type!==48)return this;let r=t.args[0],i=this.getInstruction(r).args[0];for(let o=i;o<r;o++)this.blockMask[o]=void 0;return this.truncate(r),this}reopenAllBlocks(){this.blockMask=[]}isInClosedBlock(t){return!!this.blockMask[t]}copy(){let t=new e({argNames:this.argNames,argTypes:this.argTypes});return t.instructions=this.instructions.slice(),t.blockMask=this.blockMask.slice(),t.comments=this.comments.slice(),t.derivativeMaps=this.derivativeMaps.clone(),t.setReturnIndex(this.getReturnIndex()),t}fuseBroadcast(){return this.setReturnIndex(To(this,this.getReturnIndex())),this}copyInstruction(t){return qc(this,t)}copyInstructionWithArgs(t,r){return Yn(this,t,r)}replaceInstructionWithNoop(t){this.instructions[t]={type:0,valueType:nn}}getReturnType(){return this.instructions[this.getReturnIndex()].valueType}isConstant(){return kt(this.instructions[this.getReturnIndex()])}areAllArgsConstant(t){for(let r of t)if(!kt(this.instructions[r]))return!1;return!0}asValue(){return wn(this,this.getReturnIndex())}asCompilerValue(){let t=this.instructions[this.getReturnIndex()];switch(t.type){case 1:return t.value;default:throw new Error(`Unexpected opcode ${t.type}.`)}}getConstantListLength(){return di(this,this.getReturnIndex())}getListLengthDependencies(){let t=this.copy(),r=qo(t,t.getReturnIndex());return oa(t,r)}elementAt(t){let r=this.copy(),n=r.getReturnIndex();return r.setReturnIndex(Yx(r,n,t)),r}substituteConstantArguments(t){return cz(this,t)}interpretWithParameters(t){return Rq(this,this.getReturnIndex(),t)}getCompiledFunction(t){let r;if(t){r=t.slice();for(let a of this.argNames)r.indexOf(a)===-1&&r.push(a)}else r=this.argNames;let{source:n,constants:i}=eE(this),o={};return{args:r,source:n,constants:i,executionMetadata:o,fn:Uw(r,n,i,o)}}getRestrictedFunctionForGLSL(t,r){let n=fd(this,t,{allowSlices:!0}),{restrictionChunk:i,valueChunk:o}=n.getValueAndRestrictionChunk(),a;if(i!==void 0)try{a=Ap(i,r)}catch(s){i=void 0}return a===void 0&&n.getSliceVariablesOrImplicit().length==0?{concrete:new dn(this),restriction:void 0,restrictionExpr:void 0}:{concrete:new dn(o),restriction:a,restrictionExpr:i&&new dn(i)}}polynomialOrder(t,r){return mq(this,t,r)}getPolynomialCoefficients(t){return hq(this,t)}takeDerivative(t){let r=this.argNames.indexOf(t);return r===-1?this.Constant(0):this.setReturnIndex(TL(this,this.getReturnIndex(),r)),this}gradient(t){let r=[],n=this.getReturnIndex();for(let i of t){let o=this.argNames.indexOf(i);o===-1?r.push(this.Constant(0)):r.push(TL(this,n,o))}return this.List(r),this}deriveRegressionRestrictions(){return Hq(this)}boundDomain(t){return yq(this,t,this.getReturnIndex())}findLinearSubset(t){let r=tz(this),n=[];for(let i of t){let o=this.argNames.indexOf(i);if(o===-1)throw new Error("Programming Error: findLinearSubset called with a non-dependency");n.push(r[o])}return n}isLinearIn(t){let r=this.argNames.filter(n=>t.includes(n));return r.length===0?!1:this.findLinearSubset(r).every(Boolean)}isImplicitPlane(){let t=r=>r==="x"||r==="y"||r==="z";return this.isLinearIn(["x","y","z"])&&this.argNames.every(t)}print(t,r=this.comments){let n;return t===void 0?(t=this.instructionsLength()-1,n={printUnreferencedInstructions:!0,comments:r}):n={printUnreferencedInstructions:!1,comments:r},_3(this,t,n)}printInstruction(t){return gf(this,t)}toDot(){return nH(this)}getLiveArgNames(){let t=xo(this,this.getReturnIndex()),r=[];for(let n=0;n<this.argNames.length;n++)t[n]&&r.push(this.argNames[n]);return r}getCursorContext(){return this.cursorContext}setCursorContext(t){this.cursorContext=t}coerceToNumericIfPossible(){return bu(this,this.getReturnIndex())}coerceNonComplexToNumberIfPossible(){return Ef(this,this.getReturnIndex())}};function Df(e,t){return wL(e,t).freeDependencies}function wL(e,t){let r={};if(t.type==="FunctionDefinition"||t.type==="RecursiveFunctionBaseCase"){let{freeDependencies:n,updateSymbols:i,substitutionSymbols:o}=WE(e,t._expression,r),a=n.filter(s=>s!==t._symbol);if(t instanceof hs)for(let s of t._argSymbols)a.includes(s)||a.push(s);return{freeDependencies:a,updateSymbols:i,substitutionSymbols:o}}return WE(e,t,r)}function iH(e,t,r){let n=[],i=[],o=[],a=[];for(let s of t.scopes){let c=iH(e,s,r);for(let l of c.freeDependencies)n.indexOf(l)===-1&&t.definitions.indexOf(l)===-1&&n.push(l);for(let l of c.updateSymbols)i.indexOf(l)===-1&&i.push(l);for(let l of c.substitutionSymbols)o.indexOf(l)===-1&&o.push(l)}for(let s of t.dependencies){if(t.definitions.indexOf(s)!==-1)continue;let c=NJ(e,s,r),l=t.substitutionDependencies.indexOf(s)!==-1;for(let u of c.freeDependencies)n.indexOf(u)===-1&&t.definitions.indexOf(u)===-1&&n.push(u),l&&a.indexOf(u)===-1&&t.definitions.indexOf(u)===-1&&a.push(u);for(let u of c.updateSymbols)i.indexOf(u)===-1&&i.push(u);for(let u of c.substitutionSymbols)o.indexOf(u)===-1&&o.push(u)}return{freeDependencies:n,updateSymbols:i,substitutionSymbols:o}}function WE(e,t,r){if(t.type==="Slider"||t.type==="Assignment")return WE(e,t._expression,r);{let{freeDependencies:n,updateSymbols:i,substitutionSymbols:o}=iH(e,t.getScope(),r),a=t.getUpdateSymbols();if(a.length>0){i=i.slice();for(let c of a)i.indexOf(c)===-1&&i.push(c)}let s=t.getSubstitutionSymbols();if(s.length>0){o=o.slice();for(let c of s)o.indexOf(c)===-1&&o.push(c)}return{freeDependencies:n,updateSymbols:i,substitutionSymbols:o}}}function NJ(e,t,r){if(r[t])return r[t];let n=RJ(e,t,r);return r[t]=n,n}function RJ(e,t,r){if(An[t])return{freeDependencies:[],updateSymbols:[],substitutionSymbols:[]};let n=e[t];return n?(r[t]={freeDependencies:[],updateSymbols:[],substitutionSymbols:[]},WE(e,n,r)):{freeDependencies:[t],updateSymbols:[],substitutionSymbols:[]}}function oH(e,t){for(var r={},n=t.getDependencies().slice();n.length;){var i=n.pop();if(!r.hasOwnProperty(i)){if(e.isLocal(i)||e.isError(i))return;var o=e.getVisibleGlobalDefinition(i);r[i]=o,o&&o.getDependencies&&Array.prototype.push.apply(n,o.getDependencies())}}return Object.entries(r)}function aH(e,t,r){sH(e,t,r,{})}function sH(e,t,r,n){let i={};for(let o of r.definitions){if(i[o])switch(r.kind){case"Sum":case"Product":case"Integral":throw Ie(new Error(`${r.kind} scope is not expected to define multiple symbols`));case"FunctionDefinition":throw DD(o);case"ListComprehension":throw aw(o);case"Substitution":throw X_(o);default:let a=r.kind;throw Ie(new Error(`Unexpected scope kind ${a}`))}i[o]=!0}for(let o of r.definitions){let a=t[o];if(a)switch(r.kind){case"Sum":case"Product":throw Y1(o);case"Integral":throw ew(o);case"FunctionDefinition":if(o===r.functionDefinitionSymbol)break;throw H1(o);case"ListComprehension":{if(a.type==="FunctionDefinition")throw Dx(o);if(e.assignmentForbidden(o))throw Zm(o);break}case"Substitution":break;default:let s=r.kind;throw Ie(new Error(`Unexpected scope kind ${s}`))}if(n[o])switch(r.kind){case"Sum":case"Product":throw Y1(o);case"Integral":throw ew(o);case"FunctionDefinition":throw H1(o);case"ListComprehension":throw aw(o);case"Substitution":throw Mx(o);default:let s=r.kind;throw Ie(new Error(`Unexpected scope kind ${s}`))}}n=Fi(n);for(let o of r.definitions)n[o]=!0;for(let o of r.scopes)sH(e,t,o,n)}var Tu={normaldist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("normalpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("normalcdf",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){return Tu.normaldist.mean(e,t,r)},stdev:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("abs",[n.args[1]])},var:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[1],n.args[1]])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.Add([e.Multiply([e.NativeFunction("invNorm",r),e.NativeFunction("abs",[n.args[1]])]),n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("normalSample",[r[0],n.args[0],n.args[1]])}},tdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("tpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("tcdf",r.concat(n.args))},mean:function(e,t,r){return e.Constant(0)},median:function(e,t,r){return e.Constant(0)},stdev:function(e,t,r){return e.NativeFunction("sqrt",[Tu.tdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Constant(2),o=n.args[0];return e.Piecewise([e.GreaterEqual([o,i]),e.Divide([o,e.Subtract([o,i])]),e.Constant(NaN)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("invT",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("tSample",[r[0],n.args[0]])}},poissondist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("poissonpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("poissoncdf",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("invPoisson",[e.Constant(.5),n.args[0]])},stdev:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("sqrt",[n.args[0]])},var:function(e,t,r){return Tu.poissondist.mean(e,t,r)},quantile:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("invPoisson",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("poissonSample",[r[0],n.args[0]])}},binomialdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("binompdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("binomcdf",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[0],n.args[1]])},median:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("invBinom",[e.Constant(.5),n.args[0],n.args[1]])},stdev:function(e,t,r){return e.NativeFunction("sqrt",[Tu.binomialdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),[i,o]=n.args;return e.Multiply([i,e.Multiply([o,e.Subtract([e.Constant(1),o])])])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("invBinom",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("binomSample",[r[0],n.args[0],n.args[1]])}},uniformdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("uniformpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("uniformcdf",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Divide([e.Add([n.args[0],n.args[1]]),e.Constant(2)])},median:function(e,t,r){return Tu.uniformdist.mean(e,t,r)},stdev:function(e,t,r){return e.NativeFunction("sqrt",[Tu.uniformdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Subtract([n.args[1],n.args[0]]);return e.Divide([e.Multiply([i,i]),e.Constant(12)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("invUniform",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.NativeFunction("uniformSample",[r[0],n.args[0],n.args[1]])}}};function cH(e,t,r){let n=r[0],i=e.Constant(0),o=e.Constant(1);if(di(e,t)===0)return e.Constant(NaN);let s=qo(e,t);return e.InboundsListAccess([t,e.Add([e.NativeFunction("floor",[e.Multiply([e.NativeFunction("uniformSample",[n,i,o]),s])]),o])])}function lH(e,t,r){switch(t){case $:return e.NativeFunction("complex",r);case z:case oe:return e.TupleOfType(t,r);default:throw Ie(`Type ${xr(t)} is not a supported aggregate type for building.`)}}function dv(e){if(!e)return;let{latex:t,latexSelection:r}=e;if(t===void 0||r===void 0)return;let{start:n,end:i}=r;return{input:t,start:n,end:i}}function EL(e,t,r){if(!t)return;let n=IL(t,r._expression);n==="start-to-end"?e.setCursorContext({type:r.type==="Assignment"?"assignment-rhs":"function-definition-body",allowedTypes:[nn]}):n==="empty-list"&&e.setCursorContext({type:"expression-arguments",expressionType:"List",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:"start-to-end",allowedTypesForInsertedArg:[nn]})}function uH(e,t,r){if(t){let n=IL(t,r.args[1]);n==="start-to-end"?e.setCursorContext({type:"for-assignment-rhs",allowedTypes:[Ye,We,Oe,Re,ot,et,...uc.types]}):n==="empty-list"&&e.setCursorContext({type:"for-assignment-rhs",allowedTypes:[nn]})}}function ry(e,t,r,n,i){let o=kJ(e,t,r,n,i);o&&e.setCursorContext(o)}function IL(e,t){let r=t.getInputSpan();return r?e.start===r.start&&e.end===r.end?"start-to-end":e.start===e.end&&e.start===r.end?"end":e.start===e.end&&e.start===r.start?"start":e.start===e.end&&t.type==="List"&&t.args.length===0?"empty-list":"not-aligned":"not-aligned"}function CL(e,t){if(!e)return;let r=!1;t instanceof Ea&&t.args[1]instanceof Tn&&(r=!0,t=t.args[1]);let n=t.args;if(n){if(n.length===0){let i=t.getInputSpan();if(!i)return;let o=Jn(i),a=-1;return t.type==="List"?a=o.indexOf("["):(t.type==="FunctionCall"||t.type==="SeededFunctionCall")&&(a=o.indexOf("(")),a<0?void 0:e.start===i.start+a+1?{argIndex:0,positionWithinArg:"start-to-end",isDotCall:r}:void 0}for(let i=0;i<n.length;i++){let o=n[i],a=o.getInputSpan();if((a==null?void 0:a.input)!==e.input)continue;if(e.start<a.start)break;let s=IL(e,o);if(s!=="not-aligned")return{argIndex:i,positionWithinArg:s,isDotCall:r}}}}function kJ(e,t,r,n,i){if(!r||!n.args)return;let o=CL(r,n);if(o===void 0)return;o.isDotCall&&(n=n.args[1]);let a=o.positionWithinArg==="end"?o.argIndex+1:o.argIndex;o.isDotCall&&(a+=1);let s;o.positionWithinArg==="empty-list"||o.positionWithinArg==="start-to-end"?s=[...i.slice(0,a),void 0,...i.slice(a+1)]:n instanceof wa?s=a===1?[i[0],void 0,i[1]]:[i[0],i[1],void 0]:s=[...i.slice(0,a),void 0,...i.slice(a)],s=s.map(d=>{if(!(d===void 0||e.getInstruction(d).type===2))return d});let c=[];for(let d of s)c.push(d===void 0?void 0:e.getInstruction(d).valueType);let l=hE(t,n,c),u=l&&r1(l,a);if(o.positionWithinArg==="empty-list"){let d=u==null?void 0:u.filter(xe).map(It);return(d==null?void 0:d.length)===0?void 0:{type:"expression-arguments",expressionType:"List",argIndex:0,argCount:0,isLastValidArg:!1,positionWithinArg:"start-to-end",allowedTypesForInsertedArg:d!=null?d:[nn]}}else{if((u==null?void 0:u.length)===0)return;let d=!1;if(l){let y=0;for(let x of l){let b=x.maxArity!==void 0?x.maxArity-1:1/0;y=Math.max(y,b)}d=o.positionWithinArg==="end"&&o.argIndex===y-1||o.positionWithinArg==="start-to-end"&&o.argIndex===y}let f=n.args.length;if(n instanceof wa&&n.args.length===3){let y=n.args[2];y instanceof Yr&&y.isNaN()&&(f=2)}let g={type:"expression-arguments",expressionType:n.type,argIndex:o.argIndex,argCount:f,isLastValidArg:d,positionWithinArg:o.positionWithinArg,allowedTypesForInsertedArg:u!=null?u:[nn]};if(n instanceof Tn&&(g.functionSymbol=n._symbol,g.isDotCall=o.isDotCall,n instanceof Tn&&n._symbol==="polygon")){let y=n.args.filter(x=>!(x instanceof Ut&&x._symbol==="cursor"));if(y.length>0){let x=y[0].getInputSpan(),b=y[y.length-1].getInputSpan();g.polygonVertices=x&&b?{firstLatex:Jn(x),lastLatex:Jn(b)}:void 0}}return g}}function pv(e,t,r){if(t===r)return!0;if(t<r)return!1;let n=[!0];for(let o=r+1;o<=t;o++)n.push(!1);let i=[t];for(;i.length;){let o=i.pop();if(n[o-r])continue;n[o-r]=!0;let a=e.getInstruction(o);if(!pt(a))for(let s of e.getDirectDependencies(a)){if(s===r)return!0;s<r||n[s-r]||i.push(s)}}return!1}function dH(e,t,r){var d,f;let{chunk:n}=e,i=n.instructionsLength(),o=[],a=[];for(let g=0;g<r.length;g++){let y=n.getInstruction(r[g]).valueType;xe(y)?(o.push(2),a.push(n.SymbolicVar(y,t._argSymbols[g]))):(o.push(0),a.push(r[g]))}if(o.every(g=>g===0))return o;let s=XE(e,t,a),c=Math.min(...a),l=xo(n,s),u=[];for(let g=0;g<a.length;g++)u[a[g]]=new Set([g]);for(let g=c;g<=s;g++){if(!l[g])continue;let y=n.getInstruction(g);if(!pt(y)){if(y.type===39||y.type===40||y.type===41){let x=y.args[0],b=y.args[1],w=n.getInstruction(b);if(w.type===23){let E=w.endIndex,I=(d=u[E])!=null?d:new Set;for(let S of u[x]||[])I.add(S);u[E]=I;continue}}if(y.type===48)u[g]=u[y.args[0]];else if(y.type===37&&y.symbol==="count"&&y.args.length===1)u[g]=u[y.args[0]];else if(!(y.type===23&&((f=y.context)==null?void 0:f.type)==="implicit")){if(!(y.type===44&&y.tag==="fc"))for(let x of y.args){let b=u[x]||[];for(let w of b)o[w]=1}}}}return n.truncate(i),o}function VJ(e,t,r){let n=ty.empty(t);for(let i=0;i<e.argNames.length;i++){let o=e.argNames[i];r.includes(o)?n.setLocal(o,i):n.setFreeVariable(o,i)}return n}var ny=class ny{constructor(t,r,n,i,o){if(this.kind=t,this.substitutedGlobals={...r==null?void 0:r.substitutedGlobals},this.functionBodySubstitutions={...r==null?void 0:r.functionBodySubstitutions},t&&n&&o){let a=o.filter(s=>n.isGlobal(s));for(let s of a)this.substitutedGlobals[s]||(this.substitutedGlobals[s]=t);if(i&&a.length>0){let s=this.recursionGroupKey(i.fnSymbols);this.functionBodySubstitutions[s]||(this.functionBodySubstitutions[s]={operator:t,substitutedGlobals:a})}}}recursionGroupKey(t){return[...t].sort().join(",")}getFunctionBodySubstitution(t){let r=this.recursionGroupKey(t);return this.functionBodySubstitutions[r]}allowsRegressionParameterDependency(){if(!this.kind)return!0;for(let t in this.substitutedGlobals)return!1;return!0}getRegressionDependencyError(t){if(this.allowsRegressionParameterDependency())return;let[r,n]=Object.entries(this.substitutedGlobals)[0];return W_(r,t,n)}getKind(){return this.kind}getSubstitutedGlobals(){return this.substitutedGlobals}with(t,r,n){return new ny("with",this,t,r,n)}for(t,r,n){return new ny("for",this,t,r,n)}};ny.root=new ny;var lv=ny,ML=class{constructor(t,r){this.definitions=t;this.baseCases=r;this.type="type-inference";this.argTypes={};this.returnTypes={};this.baseCaseTypes={};this.firstValidBaseCaseIdentifiers={};this.stack=[];this.isUnconditionallyRecursive=!1;this.fnSymbols=Object.keys(t)}registerFunctionCall(t,r){this.argTypes[t]||(this.argTypes[t]=r)}};function vL(e,t,r,n,i,o){return{policy:e,chunk:t,scope:r,substitutionContext:n,recursiveFunctionContext:i,selection:o}}function Xs(e,t){return{...e,scope:t}}function QE(e){let{policy:t,frame:r,argNames:n,argTypes:i,selection:o,locals:a}=e,s=new hu({argNames:n,argTypes:i}),c=VJ(s,r,a);return vL(t,s,c,lv.root,void 0,o)}function iy(e,t){let{policy:r,frame:n,argNames:i,argTypes:o}=e,a=dv(t.userData),s=wL(n,t),{freeDependencies:c,updateSymbols:l}=s;if(i||(i=c),!o){o=[];for(let f=0;f<i.length;f++)o.push(C)}let u;t.type==="FunctionDefinition"||t.type==="RecursiveFunctionBaseCase"?u=t._argSymbols:u=[];let d=QE({policy:r,frame:n,argNames:i,argTypes:o,selection:a,locals:u});try{aH(r,n,t.getScope()),Ct(d,t),e.coerceToNumber==="all"||Le(d.chunk.getReturnType(),ir)?d.chunk.coerceToNumericIfPossible():e.coerceToNumber==="all-except-complex"&&d.chunk.coerceNonComplexToNumberIfPossible(),e.wrapInList&&!xe(d.chunk.getReturnType())&&d.chunk.List([d.chunk.getReturnIndex()]),d.chunk.fuseBroadcast(),GJ(d,t,s),FJ(d,t,l)}catch(f){let g=f instanceof q?f:Ie(f);g.setCursorContext(d.chunk.getCursorContext()),d.chunk.setError(g)}return d.chunk}function FJ(e,t,r){let{chunk:n,scope:i}=e;if(t.type==="FunctionDefinition"){for(let a of r)if(t._argSymbols.indexOf(a)!==-1||t._symbol===a)throw O1(a)}let o=[];for(let a of r)i.isDefined(a)||o.push(a);if(o.length){let a=_L(e,o[0]).setDependencies(n.argNames.concat(o));throw n.isConstant()&&n.getReturnType()===nr&&a.setActionValue(n.asValue()),a}}function GJ(e,t,{substitutionSymbols:r}){let{policy:n,scope:i}=e;if(t.type==="FunctionDefinition"){for(let a of r)if(t._argSymbols.indexOf(a)!==-1||t._symbol===a)throw Mx(a)}let o=[];for(let a of r)i.isDefined(a)||o.push(a);if(o.length){let a=o[0];if(n.substitutionForbidden(a))throw Zm(a)}}function Ct(e,t){let r;if(uq(),zJ(e,t))sq(),r=e.chunk.copyInstruction(t.__IRCache.instruction);else{cq();let n=e.chunk.instructionsLength();r=UJ(e,t),r=BJ(e,n,r),qJ(e,t,r)}return e.chunk.setReturnIndex(r),r}function BJ(e,t,r){let{chunk:n,scope:i}=e;if(r<=t)return r;let o=n.getInstruction(r);return kt(o)?(n.truncate(Math.max(t,i.getMaxIndex()+1)),qc(n,o)):r}function qJ(e,t,r){let{chunk:n,scope:i}=e,o=n.getInstruction(r);if(!kt(o))return;let a=oH(i,t);a&&(lq(),t.__IRCache={keys:a,instruction:o})}function zJ(e,t){let{scope:r,substitutionContext:n}=e;if(!t.__IRCache)return!1;let i=t.__IRCache.keys;for(let[o,a]of i){if(r.isLocal(o)||r.isError(o))return!1;let s=r.getVisibleGlobalDefinition(o);if(s!==a||s&&s.type==="RegressionParameter"&&!n.allowsRegressionParameterDependency())return!1}return!0}function UJ(e,t){var c,l,u,d;let{policy:r,chunk:n,scope:i,substitutionContext:o,selection:a}=e,s=t.type;switch(s){case"Constant":{let g=t._constantValue,y=typeof g=="boolean"?tt:C;return n.ConstantOfType(y,g)}case"RegressionParameter":return n.Constant(t._constantNode._constantValue);case"MixedNumber":return n.Constant(t._constantValue);case"ImaginaryUnit":return n.ImaginaryUnit();case"Negative":return n.Negative(KE(e,t,t.args));case"Add":return n.Add(Hc(e,t,t.args));case"Subtract":return n.Subtract(Hc(e,t,t.args));case"Multiply":return n.Multiply(Hc(e,t,t.args));case"DotMultiply":{let[g,y]=Hc(e,t,t.args);return(l=(c=pH(e,g,y))!=null?c:gd(n,[g,y])?pH(e,Pa(n,g),Pa(n,y),{forcePermitted:!0}):void 0)!=null?l:n.Multiply([g,y])}case"CrossMultiply":{let[g,y]=Hc(e,t,t.args);return e.policy.is3dPolicy()?Pr(n,g,Pt)&&Pr(n,y,Pt)?Np(n,[gH(e,Pa(n,g),Pa(n,y)),Ol(n,g)]):Pr(n,g,oe)&&Pr(n,y,oe)?gH(e,g,y):n.Multiply([g,y]):n.Multiply([g,y])}case"Divide":return n.Divide(Hc(e,t,t.args));case"Exponent":{let g=Hc(e,t,t.args);if(r.isComplexEnabled()){let y=t.args[1];if(iQ(y)){let x=n.getInstruction(g[0]).valueType;if(_m(x,C)||_m(x,ke))return n.Exponent(g)}return n.NativeFunction("complexPow",g)}else return n.Exponent(g)}case"Comparator['=']":case"Comparator['>']":case"Comparator['<']":case"Comparator['>=']":case"Comparator['<=']":return n.Comparator(t.operator,Hc(e,t,t.args));case"ComparatorChain":{let g=qp(e,t,t.args),y=n.Comparator(t.symbols[0],[g[0],g[1]]);for(let x=1;x<t.symbols.length;x++)y=n.And([y,n.Comparator(t.symbols[x],[g[x],g[x+1]])]);return y}case"Or":return n.Or(Hc(e,t,t.args));case"PercentOf":return n.Divide([n.Multiply(Hc(e,t,t.args)),n.Constant(100)]);case"ParenSeq":return XJ(e,t);case"BareSeq":return KJ(e,t);case"NamedCoordinateAccess":{let[g]=KE(e,t,t.args),y=t.symbol;switch(y){case"x":return n.Slot(0,[g]);case"y":return n.Slot(1,[g]);case"z":return n.Slot(2,[g]);default:{let x=y;throw new Error(`Programming Error: unexpected named coordinate: '${x}'.`)}}}case"Norm":{let g=KE(e,t,t.args)[0];return Pr(n,g,$)?xH(n,g):(d=(u=DL(e,g))!=null?u:gd(n,[g])?DL(e,Pa(n,g)):void 0)!=null?d:n.NativeFunction("abs",[g])}case"UpdateRule":{let g=t._symbol;if(i.isLocal(g))throw _L(e,g);let y=i.getVisibleGlobalDefinition(g);if(y!==void 0&&y.type!=="Assignment"&&y.type!=="Slider")throw _L(e,g);let x=Ct(e,t.args[1]);return n.Action([g],[x])}case"List":case"TableColumnValue":{if(t.getDependencies().length>0)return aa(t.args),n.List(qp(e,t,t.args));if(t.args.length===0)return ry(n,r,a,t,[]),n.ConstantOfType(Rt,[]);{let g=n.instructionsLength(),y=[],x,b;aa(t.args);let w=!0;for(let I of t.args){let S=Ct(e,I),D=n.getInstruction(S);if(x===void 0){if(x=D.valueType,!ei(x))throw Gg([dt(x)],{blockExport:w});b=Qn(x)}else if(D.valueType!==x){if(Cg(x,D.valueType)!==void 0)return n.truncate(g),n.List(qp(e,t,t.args));throw px({blockExport:w})}if(D.type!==1)throw new Error("Programming error: expected list with no dependencies to constant collapse.");y.push(D.value),n.truncate(g)}let E=CL(e.selection,t);if(e.selection&&E!==void 0&&b!==void 0&&E.positionWithinArg!=="empty-list"){let I=It(b);n.setCursorContext({type:"expression-arguments",expressionType:"List",argIndex:E.argIndex,argCount:t.args.length,isLastValidArg:!1,positionWithinArg:E.positionWithinArg,allowedTypesForInsertedArg:[I]})}return n.ConstantOfType(b,y)}}case"ListAccess":{let g=Ct(e,t.args[0]),y=n.getInstruction(g);if(t.args[1].type==="Range"&&t.args[1].args[1].length===0){if(!xe(y.valueType))throw ux([dt(y.valueType),dt(C)],{blockExport:kt(y)});let x=qo(n,g),b=AL(e,Ct(e,t.args[1].args[0]),n.List([x]),{stepMustBePositive:!0});return n.ListAccess([g,b])}else{let x=Ct(e,t.args[1]),b=n.getInstruction(x);if(_p(n,r,t,[g,x]),b.valueType===vi)return n.NativeFunction("select",[g,x]);if(b.valueType===tt&&xe(y.valueType)){let w=n.ConstantOfType(y.valueType,[]);return n.Piecewise([x,g,w])}return n.ListAccess([g,x])}}case"Range":{let[g,y]=Hc(e,t,t.args);return AL(e,g,y,{stepMustBePositive:!1})}case"ListComprehension":return ZJ(e,t);case"Piecewise":{let g=HJ(e,t,t.args),y=n.getInstruction(g[0]),x=n.getInstruction(g[1]),b=n.getInstruction(g[2]),w=Nc(x.valueType,b.valueType)||Nc(b.valueType,x.valueType);if(y.type===1&&y.valueType===tt&&w){let S=g[y.value?1:2],D=n.getInstruction(S),O=x.valueType!==Rt?x.valueType:b.valueType;return D.valueType===Rt&&O!==Rt?n.ConstantOfType(O,[]):S}let E=x.valueType,I=xe(E)?It(E):E;if(!w&&kt(b)&&b.valueType===C&&Ys(b.value)&&Vc(I)){if(Le(x.valueType,ir))return n.NativeFunction("restriction",[n.And([g[0],n.NativeFunction("restrictionToBoolean",[g[1]])])]);let S=n.NanOfType(I);g=[g[0],g[1],S]}return n.Piecewise(g)}case"Restriction":return n.NativeFunction("restriction",KE(e,t,t.args));case"Ans":case"Identifier":{let g=t._symbol,y=t._errorSymbol;if(t.type==="Ans"&&n.argNames.indexOf(g)!==-1)throw C_();let x=i.getSymbol(g);if(x!==void 0)return x;let b=i.getVisibleGlobalDefinition(g);if(b===void 0){if(An[g]){let E=e.policy.is3dPolicy();throw An[g].isFunction?ba(y,E):Hg(y)}throw e.recursiveFunctionContext&&e.recursiveFunctionContext.fnSymbols.includes(g)?G1(g):new Error(`Programming Error: reached undefined symbol ${g}`)}if(i.isLocal(g)||b.isFunction)throw G1(y);if(b.type==="RegressionParameter"){let E=o.getRegressionDependencyError(y);if(E)throw E}let w=Ct(e,b);return i.setGlobal(g,w,b),w}case"FunctionCall":case"SeededFunctionCall":{aa(t.args);let g=qp(e,t,t.args);return aa(g),jE(e,t._symbol,t._errorSymbol,g,t.args)}case"Substitution":return tQ(e,t);case"FunctionExponent":{let g=t.args[0]._symbol,y=i.getVisibleGlobalDefinition(g),x=i.getSymbol(g),b=x!==void 0?n.getInstruction(x):void 0;return i.isLocal(g)&&(b==null?void 0:b.type)===4||y!=null&&y.isFunction?Ct(e,new N.Exponent([new N.FunctionCall(g,[t.args[1]]),t.args[2]])):Ct(e,new N.Multiply([t.args[0],new N.Exponent([t.args[1],t.args[2]])]))}case"FunctionFactorial":{let g=t.args[0]._symbol,y=i.getVisibleGlobalDefinition(g),x=i.getSymbol(g),b=x!==void 0?n.getInstruction(x):void 0;return i.isLocal(g)&&(b==null?void 0:b.type)===4||y!=null&&y.isFunction?Ct(e,new N.FunctionCall("\\factorial",[new N.FunctionCall(g,[t.args[1]])])):Ct(e,new N.Multiply([t.args[0],new N.FunctionCall("\\factorial",[t.args[1]])]))}case"DotAccess":{let g=t.args[0],y=t.args[1],x=i.getVisibleGlobalDefinition(y._symbol);if(g.type==="Identifier"&&g._symbol==="construction")return rQ(e,y);if((y.type==="Identifier"||y.type==="FunctionCall")&&(x!=null&&x.isFunction)){let b=y._symbol,w=y._errorSymbol;if(sO(x))throw dx(w);let E=y.type==="Identifier"?[g]:[g].concat(y.args),I=qp(e,t,E);return jE(e,b,w,I,E)}else if(y.type==="SeededFunctionCall"){let b=y._symbol,w=y._errorSymbol,E=[y.seed,g].concat(y.args.slice(1)),I=qp(e,t,E);return jE(e,b,w,I,E)}else throw Xa(".")}case"Seed":return n.ConstantOfType(lr,t._stringValue);case"ExtendSeed":return n.ExtendSeed(t.tag,Hc(e,t,t.args));case"Integral":{let g=t._differential._symbol,y=i.childScope();y.setErrorIfAccessed(g,T_(g));let x=Xs(e,y),b=Ct(x,t.args[1]),w=Ct(x,t.args[2]),E=n.getInstruction(b),I=n.getInstruction(w),S=n.SymbolicVar(C,g),D=i.childScope();D.setLocal(g,S);let O=Ct(Xs(e,D),t.args[3]);if(!pv(n,O,S))return n.Multiply([O,n.Subtract([w,b])]);let _=Xh(n,[b,w,O]);if(_!==void 0&&pv(n,_,S))throw Y_(g);let A=_!==void 0?n.BeginBroadcast([_]):void 0,R=b;A!==void 0&&xe(E.valueType)&&(R=xu(n,b,A));let W=w;A!==void 0&&xe(I.valueType)&&(W=xu(n,w,A));let j=n.getInstruction(O).valueType,Q=xe(j)?It(j):j,ce;if(Bb(Q)&&Q!==C){let ee=[],pe=Q===$||Q===z?2:3;for(let re=0;re<pe;re++){let k=n.BeginIntegral({indexSymbol:g},[R,W]),Ke=hd(n,k,S,O),ht=n.getInstruction(Ke);A!==void 0&&xe(ht.valueType)&&(Ke=xu(n,Ke,A)),Ke=n.Slot(re,[Ke]);let Ze=n.EndIntegral([k,Ke]);ee.push(n.BlockVar(C,[Ze]))}ce=lH(n,Q,ee)}else{let ee=n.BeginIntegral({indexSymbol:g},[R,W]),pe=hd(n,ee,S,O),re=n.getInstruction(pe);A!==void 0&&xe(re.valueType)&&(pe=xu(n,pe,A));let k=n.EndIntegral([ee,pe]);ce=n.BlockVar(C,[k])}if(A!==void 0){let ee=n.EndBroadcast([A,ce]);return n.BroadcastResult(Qn(Q),[ee])}else return ce}case"Sum":case"Product":{let g=t._index._symbol,y=t.type==="Sum",x=i.childScope();x.setErrorIfAccessed(g,y?d_(g):p_(g));let b=Xs(e,x),w=Ct(b,t.args[1]);w=bu(b.chunk,w);let E=Ct(b,t.args[2]);if(E=bu(b.chunk,E),!Pr(n,w,C)){let Ne=Dp(n,[w]),he=n.areAllArgsConstant([w]);throw y?mM(Ne,{blockExport:he}):bM(Ne,{blockExport:he})}if(!Pr(n,E,C)){let Ne=Dp(n,[E]),he=n.areAllArgsConstant([E]);throw y?hM(Ne,{blockExport:he}):xM(Ne,{blockExport:he})}let I=n.NativeFunction("round",[w]),S=n.NativeFunction("round",[E]),D=n.getInstruction(I),O=n.getInstruction(S);if(D.type===1&&D.valueType===C&&!isFinite(ae(D.value)))throw y?D1():_1();if(O.type===1&&O.valueType===C&&!isFinite(ae(O.value)))throw y?D1():_1();let _=n.SymbolicVar(C,g),A=i.childScope();A.setLocal(g,_);let R=Ct(Xs(e,A),t.args[3]),W=n.getInstruction(R).valueType,j=xe(W)?It(W):W,ce=(t.type==="Sum"?cS:lS).find(Ne=>_m(j,Ne));if(ce===void 0){let Ne=Dp(n,[R]),he=n.areAllArgsConstant([R]);throw y?yM(Ne,{blockExport:he}):vM(Ne,{blockExport:he})}if(!pv(n,R,_)){let Ne=n.Add([n.Subtract([S,I]),n.Constant(1)]);Ne=n.NativeFunction("max",[Ne,n.Constant(0)]);let he=y?n.Multiply([R,Ne]):n.Exponent([R,Ne]);return n.Piecewise([n.Less([Ne,n.Constant(1/0)]),he,n.NanOfType(ce)])}let ee=Xh(n,[I,S,R]);if(ee!==void 0&&pv(n,ee,_))throw y?H_(g):$_(g);let pe=ee!==void 0?n.BeginBroadcast([ee]):void 0,re=I;pe!==void 0&&xe(D.valueType)&&(re=xu(n,I,pe));let k=S;pe!=null&&xe(O.valueType)&&(k=xu(n,S,pe));let Ke=y?n.ZeroOfType(ce):ce===$?n.NativeFunction("complex",[n.Constant(1),n.Constant(0)]):n.Constant(1),ht=n.BeginLoop({type:y?"sum":"product",indexSymbol:g},[re,k,Ke]),Ze=n.BlockVar(ce,[ht]),Te=hd(n,ht,_,R),Vt=n.getInstruction(Te);pe!==void 0&&xe(Vt.valueType)&&(Te=xu(n,Te,pe));let yt=y?n.Add([Ze,Te]):n.Multiply([Ze,Te]),qe=n.EndLoop([ht,yt]),at=n.BlockVar(ce,[qe]);if(pe!==void 0){let Ne=n.EndBroadcast([pe,at]);return n.BroadcastResult(Qn(ce),[Ne])}else return at}case"Derivative":{let g=t._symbol,y=Ct(e,new N.Identifier(g)),x=Ef(n,y),b=n.getInstruction(x),w=uv(b.valueType);if(!w)throw PM(g,Dp(n,[x]),{blockExport:kt(b)});let E,I,S=!1;if((b.type===2||b.type===3)&&b.valueType===C)E=e,I=x;else{let A=i.childScope();I=n.SymbolicVar(b.valueType),A.setLocal(g,I),S=!0,E=Xs(e,A)}let D=1;for(;t.args[0].type==="Derivative"&&t.args[0]._symbol===t._symbol;)D+=1,t=t.args[0];let _=To(n,Ct(E,t.args[0]));for(let A=0;A<D;A++)_=YE(n,_,I,w);return I===x?_:(S&&n.derivativeMaps.pruneIP(I),hd(n,x,I,_))}case"Prime":{let g=t.args[0];if(i.isLocal(g._symbol))throw B1(g._symbol);let y=i.getVisibleGlobalDefinition(g._symbol);if(!y)throw Wm(g._symbol);if(!y.isFunction)throw B1(g._symbol);let x=Ct(e,g.args[0]),b=Ef(n,x),w=n.getInstruction(b),E=uv(w.valueType);if(!E)throw SM(g._symbol,Dp(n,[b]),{blockExport:kt(w)});let I=!1,S;(w.type===2||w.type===3)&&w.valueType===C?S=b:(S=n.SymbolicVar(w.valueType),I=!0);let D,O;if(g._symbol==="logbase"){if(g.args.length!==2)throw Bg();D=[S,Ct(e,g.args[1])],O=[g.args[0],g.args[1]]}else{if(g.args.length!==1)throw Bg();D=[S],O=[g.args[0]]}let A=To(n,jE(e,g._symbol,g._errorSymbol,D,O));for(let R=0;R<t.order;R++)A=YE(n,A,S,E);return S===b?A:(I&&n.derivativeMaps.pruneIP(S),hd(n,b,S,A))}case"Slider":return e.chunk.Constant(t.getConcreteTree(r,i.frame).asCompilerValue());case"Assignment":return EL(n,e.selection,t),Ct(e,t._expression);case"FunctionDefinition":{let g=t;if(EL(n,e.selection,g),g.recursionInfo)return EH(e,g,g.recursionInfo);{let y=i.childScope();return y.setErrorIfAccessed(g._symbol,qg([g._symbol])),Ct(Xs(e,y),t._expression)}}case"RecursiveFunctionBaseCase":{let g=i.childScope(),y=t;return g.setErrorIfAccessed(y._symbol,LD(y._symbol)),Ct(Xs(e,g),t._expression)}case"Construction":throw Xa("construction");default:let f=s;throw new Error(`Programming error, unimplemented node type ${f}`)}}function KE(e,t,r){let n=[Ct(e,r[0])];return ry(e.chunk,e.policy,e.selection,t,n),_p(e.chunk,e.policy,t,n),n}function Hc(e,t,r){let n=[Ct(e,r[0]),Ct(e,r[1])];return ry(e.chunk,e.policy,e.selection,t,n),_p(e.chunk,e.policy,t,n),n}function xH(e,t){return e.NativeFunction("hypot",[e.Slot(0,[t]),e.Slot(1,[t])])}function DL(e,t){let r=e.chunk;return Pr(r,t,oe)?r.NativeFunction("hypot",[r.Slot(0,[t]),r.NativeFunction("hypot",[r.Slot(1,[t]),r.Slot(2,[t])])]):Pr(r,t,z)?r.NativeFunction("hypot",[r.Slot(0,[t]),r.Slot(1,[t])]):void 0}function pH(e,t,r,{forcePermitted:n}={forcePermitted:!1}){let i=e.chunk;return(n||e.policy.is3dProduct())&&Pr(i,t,z)&&Pr(i,r,z)?i.Add([i.Multiply([i.Slot(0,[t]),i.Slot(0,[r])]),i.Multiply([i.Slot(1,[t]),i.Slot(1,[r])])]):(n||e.policy.is3dProduct())&&Pr(i,t,oe)&&Pr(i,r,oe)?i.Add([i.Add([i.Multiply([i.Slot(0,[t]),i.Slot(0,[r])]),i.Multiply([i.Slot(1,[t]),i.Slot(1,[r])])]),i.Multiply([i.Slot(2,[t]),i.Slot(2,[r])])]):void 0}function gH(e,t,r){let n=e.chunk,i=n.Slot(0,[t]),o=n.Slot(1,[t]),a=n.Slot(2,[t]),s=n.Slot(0,[r]),c=n.Slot(1,[r]),l=n.Slot(2,[r]);return n.TupleOfType(oe,[n.Subtract([n.Multiply([o,l]),n.Multiply([a,c])]),n.Subtract([n.Multiply([a,s]),n.Multiply([i,l])]),n.Subtract([n.Multiply([i,c]),n.Multiply([o,s])])])}function HJ(e,t,r){let n=[Ct(e,r[0]),Ct(e,r[1]),Ct(e,r[2])];return ry(e.chunk,e.policy,e.selection,t,n),_p(e.chunk,e.policy,t,n),n}function qp(e,t,r){let n=[];for(let i of r)n.push(Ct(e,i));return ry(e.chunk,e.policy,e.selection,t,n),_p(e.chunk,e.policy,t,n),n}function jE(e,t,r,n,i){var f;let{chunk:o,scope:a,recursiveFunctionContext:s,substitutionContext:c,policy:l}=e;if(l.isComplexEnabled()&&t in w3&&(t=Bx[t]),s&&s.type==="type-inference"&&s.definitions[t]){let g=c.getFunctionBodySubstitution(s.fnSymbols);if(g&&g.substitutedGlobals.length>0)throw K_(g.operator,g.substitutedGlobals[0],t);s.registerFunctionCall(t,n.map(b=>o.getInstruction(b).valueType));let y=s.definitions[t];if(y instanceof q)throw y;let x=CH(e,s,y,n);return o.SymbolicVar(x.returnType)}let u=a.getSymbol(t);if(u!==void 0){let g=o.getInstruction(u);if(g.type===4){if(g.signature.argTypes.length!==n.length)throw fc(t,g.signature.argTypes.length,n.length,{includeUsageExample:!0});for(let y=0;y<n.length;y++){let x=o.getInstruction(n[y]).valueType,b=g.signature.argTypes[y];if(!Le(x,b))throw jS(y,xr(b),xr(x),{blockExport:kt(o.getInstruction(n[y]))})}return o.FunctionCall([u,...n])}else if(Le(g.valueType,xt))return JE(e.chunk,[u,...n],r,!0);if(n.length>=1){let y=n.length===1?n[0]:Ct(e,new N.ParenSeq(i));return o.Multiply([u,y])}else throw g.type===2?Wm(r):g.valueType===cr?Q1(r):Km(r)}let d=a.getVisibleGlobalDefinition(t);if(d===void 0||!d.isFunction){if((f=An[t])!=null&&f.isFunction){if(t==="logbase"&&a.isGlobal("ln")&&a.isGlobal("log"))throw P_();let g=e.policy.is3dPolicy();throw ba(r,g)}if(d){let g=Ct(e,d);if(o.getInstruction(g).valueType===cr)throw Q1(r);if(Le(o.getInstruction(g).valueType,xt))return JE(e.chunk,[g,...n],r,!0)}if(n.length>=1){let g=n.length===1?n[0]:Ct(e,new N.ParenSeq(i));return o.Multiply([Ct(e,new N.Identifier(t)),g])}throw d?Km(r):new Error(`Programming Error: reached undefined symbol ${t}`)}if(sO(d)){if(n.length!==d._argSymbols.length)throw fc(r,d._argSymbols.length,n.length,{includeUsageExample:!0});if(d.getDependencies().includes("globalRandomSeed")&&l.shouldIncludeFunctionParametersInRandomSeed()){let g=dH(e,d,n),y=n.filter((x,b)=>g[b]===2);if(y.length>0){let x=Xh(o,y);if(x===void 0)throw Ie("Programming error: expected list length to be defined");let b=o.BeginBroadcast([x]),w=[];for(let D=0;D<n.length;D++)g[D]===2?w.push(xu(o,n[D],b)):w.push(n[D]);let E=XE(e,d,w,i),I=o.EndBroadcast([b,E]),S=o.getInstruction(E).valueType;if(ei(S))return o.BroadcastResult(Qn(S),[I])}}return XE(e,d,n,i)}else{if(pu.hasOwnProperty(t))return WJ(e,t,r,n,i);if(Xn.hasOwnProperty(t))return yd(e,t,n);{let g=e.policy.is3dPolicy();throw ba(r,g)}}}function XE(e,t,r,n){let{scope:i}=e,o=i.childScope();for(let s=0;s<t._argSymbols.length;s++)o.setLocal(t._argSymbols[s],r[s],n&&n[s]);let a=Xs(e,o);return t.recursionInfo?EH(a,t,t.recursionInfo):Ct(a,t._expression)}function $J(e,t){let r=Ol(e,t),n=e.Add([r,Pa(e,t)]);return e.NativeFunction("segment",[r,n])}function yd(e,t,r){let{chunk:n}=e,i=Xn[t],o=r.length,{minArity:a,maxArity:s}=i;if(o>s||o<a)throw Ie("Unexpected arity mismatch");let c=vH(n,r,i);switch(i.tag){case"default":case"reducer":case"doubleReducer":case"parameterizedReducer":case"color":case"never-broadcast":return n.NativeFunction(t,c);case"trig":{let l=Ct(e,new N.Identifier("trigAngleMultiplier")),u=n.Multiply([c[0],l]);return n.NativeFunction(t,[u])}case"trig2":{let l=Ct(e,new N.Identifier("trigAngleMultiplier")),u=n.Multiply([c[1],l]);return n.NativeFunction(t,[c[0],u])}case"inverseTrig":{let l=Ct(e,new N.Identifier("trigAngleMultiplier")),u=n.NativeFunction(t,c);return n.Divide([u,l])}default:{let l=i.tag;throw new Error(`Programming Error: unexpected tag ${l}`)}}}function vH(e,t,{minArity:r,defaultArguments:n}){if(!n||!(t.length-r<n.length))return t;let i=t.slice();for(;i.length-r<n.length;)i.push(e.copyInstruction(n[i.length-r]));return i}function YJ(e,t,r){let n=[r.noBroadcast?Dr(r.match,Qu):St(r.match,Qu)];return yE(n,t.map(i=>e.getInstruction(i).valueType),0).length>0}function Rp(e,t,r,n){let i=n.find(o=>YJ(e,t,o));if(!i){if(typeof r=="string")throw ra(r,yu(e,t),{blockExport:e.areAllArgsConstant(t)});return r(e,t)}return i.build(e,t)}function fH(e,t){if(t.length!==2)throw Ie("Can only take the midpoint of two points");let r=e.Constant(Et(1,2));return e.Multiply([r,e.Add(t)])}function WJ(e,t,r,n,i){var y,x;let{chunk:o,policy:a}=e,s=pu[t],{minArity:c,maxArity:l}=s,u=n.length;if(u<c||u>l)throw Sp(t)?yO(o,{symbol:t,errorSymbol:r,argsWithoutSeed:n,signatures:s.getSignatures(a),minArity:c,providedArgs:n,builtInTag:void 0,defaultArgumentCount:(x=(y=s.defaultArguments)==null?void 0:y.length)!=null?x:0,isDotCall:!1,maxArity:l}):new Error("Programming Error: unexpected arity mismatch");let d;if(t==="cdf")u===2?d=[n[0],o.Constant(-1/0),n[1]]:d=n;else if(t==="random")if(u===1||u<4&&!xe(o.getInstruction(n[1]).valueType)&&o.getInstruction(n[1]).valueType!==cr){let b=o.Distribution("uniformdist",[o.Constant(0),o.Constant(1)]);d=[n[0],b].concat(n.slice(1))}else d=n;else d=vH(o,n,s);let f=qx(a,t);if(t==="join"){let b=[];for(let E of d)b.push(o.getInstruction(E).valueType);let w=Nw(b);f=[Dr({type:"variadic",initial:[w,w],rest:w},w)]}if(f){let b=xO(o,d,f);b.didCoerce&&(d=b.args)}function g(b,w=r){return Rp(o,d,w,b)}switch(t){case"length":if(a.isGeometryEnabled()||a.is3dPolicy()){let b=d[0];return g([{match:[Mr],build:()=>{let w=o.Constant(0),E=o.Constant(1);return o.NativeFunction("distanceThreeD",[o.NativeFunction("segmentThreeDGlider",[b,w]),o.NativeFunction("segmentThreeDGlider",[b,E])])}},{match:[Ye],build:()=>{let w=o.Constant(0),E=o.Constant(1);return o.NativeFunction("distance",[o.NativeFunction("segmentGlider",[b,w]),o.NativeFunction("segmentGlider",[b,E])])}},{match:[Oe],build:()=>{let w=o.NativeFunction("abs",[o.NativeFunction("arcOmega",[d[0]])]),{radius:E,startPoint:I}=JJ(o,d[0]),S=o.NativeFunction("arcThirdPoint",[d[0]]);return o.Piecewise([o.Equal([w,o.Constant(0)]),o.NativeFunction("distance",[I,S]),o.Multiply([E,w])])}},{match:[KG],build:()=>DL(e,Pa(o,b))}])}else return o.NativeFunction("count",d);case"round":return g([{match:[vr],build:()=>o.NativeFunction("round",d)},{match:[vr,C],build:()=>{let b=o.NativeFunction("round",[d[1]]),w=o.RawExponent([o.Constant(10),b]);return o.Divide([o.NativeFunction("round",[o.Multiply([d[0],w])]),w])}},{match:[$],build:()=>o.NativeFunction("complexRound",d)},{match:[$,C],build:()=>{let b=o.NativeFunction("round",[d[1]]),w=o.RawExponent([o.Constant(10),b]);return o.Divide([o.NativeFunction("complexRound",[o.Multiply([d[0],w])]),w])}}]);case"abs":return g([{match:[vr],build:()=>o.NativeFunction(t,d)},{match:[$],build:()=>xH(o,d[0])}]);case"real":return g([{match:[vr],build:()=>d[0]},{match:[$],build:()=>o.Slot(0,[d[0]])}]);case"imag":return g([{match:[vr],build:()=>o.Constant(0)},{match:[$],build:()=>o.Slot(1,[d[0]])}]);case"conj":return g([{match:[vr],build:()=>d[0]},{match:[$],build:()=>o.NativeFunction("complex",[o.Slot(0,[d[0]]),o.Negative([o.Slot(1,[d[0]])])])}]);case"exp":case"sin":case"cos":case"tan":case"sinh":case"cosh":case"tanh":case"sec":case"csc":case"cot":case"sech":case"csch":case"coth":case"arccot":case"arcsinh":case"arccsch":case"floor":case"ceil":return g([{match:[vr],build:()=>yd(e,t,d)},{match:[$],build:()=>yd(e,Bx[t],d)}]);case"arctan":return g([{match:[vr],build:()=>yd(e,t,d.concat(o.Constant(1)))},{match:[C,C],build:()=>yd(e,t,d)},{match:[$],build:()=>yd(e,Bx[t],d)}]);case"mod":return g([{match:[vr,vr],build:()=>yd(e,t,d)},{match:[$,$],build:()=>yd(e,Bx[t],d)}]);case"midpoint":return g([{match:[Ye],build:()=>{let b=o.Constant(Et(1,2));return o.NativeFunction("segmentGlider",[d[0],b])}},{match:[Mr],build:()=>{let b=o.Constant(Et(1,2));return o.NativeFunction("segmentThreeDGlider",[d[0],b])}},{match:[z,z],build:fH},{match:[oe,oe],build:fH}]);case"circle":return g([{match:[z,Ye],build:()=>{let b=o.Constant(0),w=o.Constant(1);return o.NativeFunction("circle",[d[0],o.NativeFunction("distance",[o.NativeFunction("segmentGlider",[d[1],b]),o.NativeFunction("segmentGlider",[d[1],w])])])}},{match:[z,z],build:()=>o.NativeFunction("circle",[d[0],o.NativeFunction("distance",d)])},{match:[z,C],build:()=>o.NativeFunction("circle",d)}]);case"segment":return g(jx("segment","segmentThreeD"));case"vector":return g(jx("vector","vectorThreeD"));case"sphere":return g([{match:[oe,C],build:(b,w)=>b.NativeFunction("sphere",w)},{match:[z,C],build:(b,w)=>b.NativeFunction("sphere",[b.TupleOfType(oe,[b.Slot(0,[w[0]]),b.Slot(1,[w[0]]),b.Constant(0)]),w[1]])}]);case"distance":return g(jx("distance","distanceThreeD"));case"center":return g([{match:[We],build:()=>o.NativeFunction("center",[d[0]])},{match:[Oe],build:()=>o.NativeFunction("arcCenter",[d[0]])}]);case"radius":return g([{match:[We],build:()=>o.NativeFunction("radius",[d[0]])},{match:[Oe],build:()=>o.NativeFunction("distance",[o.NativeFunction("arcFirstPoint",[d[0]]),o.NativeFunction("arcCenter",[d[0]])])}]);case"glider":return TH(e.chunk,d);case"intersection":case"strictintersection":{let b=0;t==="strictintersection"&&((Pr(o,d[0],Ye)||Pr(o,d[0],Oe))&&(b+=3),(Pr(o,d[1],Ye)||Pr(o,d[1],Oe))&&(b+=12),Pr(o,d[0],ot)&&(b+=1),Pr(o,d[1],ot)&&(b+=4));let w=eQ(e,i,d),E=w&&ys(w);if(!w||!E)return SL(o,d,b);let I=Ct(e,new N.Identifier(E)),S=mu(w);return S!==void 0&&(I=o.ListAccess([I,o.Constant(S)])),o.NativeFunction("chooseNonIncidentPoint",[I,SL(o,[d[0],d[1]],b),SL(o,[d[1],d[0]],b<<2&12|b>>2&3)])}case"parallel":case"perpendicular":return g([{match:[uS,z],build:()=>{let w=[ZE(o,d[0]),d[1]];return o.NativeFunction(t,w)}}]);case"anglebisector":return g([{match:[st],build:()=>o.NativeFunction("anglebisector",d)},{match:[$e],build:()=>o.NativeFunction("directedanglebisector",d)}]);case"start":return Ol(o,d[0]);case"end":return o.Add([Ol(o,d[0]),Pa(o,d[0])]);case"translate":case"reflect":case"rotate":case"dilate":return QJ(e,t,d);case"apply":return JE(o,d,r,!1);case"normaldist":case"tdist":case"poissondist":case"binomialdist":case"uniformdist":return o.Distribution(t,d);case"median":case"stdev":case"var":case"quantile":return hH(o,n)?PL(o,d,t):yd(e,t,n);case"pdf":case"cdf":return PL(o,d,t);case"total":case"mean":return t==="mean"&&hH(o,n)?PL(o,d,t):g([{match:Pg(vr,0),build:()=>o.NativeFunction(t,d)},{match:Pg($,1),build:()=>o.NativeFunction("complex",[o.NativeFunction(t,d.map(b=>o.Slot(0,[b]))),o.NativeFunction(t,d.map(b=>o.Slot(1,[b])))])},{match:Pg(z,1),build:()=>{let b=w=>o.NativeFunction(t,d.map(E=>o.Slot(w,[E])));return o.TupleOfType(z,[b(0),b(1)])}},{match:Pg(oe,1),build:()=>{let b=w=>o.NativeFunction(t,d.map(E=>o.Slot(w,[E])));return o.TupleOfType(oe,[b(0),b(1),b(2)])}}]);case"lcm":case"gcd":return g([{match:Pg(vr,1),build:()=>o.NativeFunction(t,d)},{match:Pg($,1),build:()=>{let b;switch(t){case"lcm":b="complexLCM";break;case"gcd":b="complexGCD";break}return o.NativeFunction(b,d)}}]);case"random":{let b=d[0],w=d[1],E=o.getInstruction(d[0]),I=o.getInstruction(w);if(E.valueType!==lr)throw Ie(`Unexpected value type for seed arg: ${E.valueType}`);if(I.valueType===Ti)throw eD();let S;if(xe(I.valueType))S=cH;else{if(I.type!==42||I.valueType!==cr)throw Ie('Expected distribution argument to "random"');S=Tu[I.symbol][t]}if(d.length>2){let D=d[2],O=o.getInstruction(D);if(O.valueType!==C)throw Ie(`Expected numSamples argument to random() to be a number but got ${O.valueType}`);if(d.length===4){if(o.getInstruction(d[3]).valueType!==C)throw Ie(`Expected userSeed argument to random() to be a number but got ${O.valueType}`);b=o.ExtendSeed("us",[b,d[3]])}let _=o.Constant(1),A=o.NativeFunction("round",[o.NativeFunction("validateSampleCount",[D])]),R=o.BeginBroadcast([A]);b=o.ExtendSeed("lc",[b,o.Subtract([R,_])]);let W=S(o,w,[b]),j=o.EndBroadcast([R,W]);return o.BroadcastResult(Qn(o.getInstruction(W).valueType),[j])}return S(o,w,[b])}case"shuffle":{let b=d[0],w=d[1],E=d[2];if(!xe(o.getInstruction(w).valueType)||E!==void 0&&o.getInstruction(E).valueType!==C)throw Ie(`Unexpected args for "${t}"`);return E!==void 0&&(b=o.ExtendSeed("us",[b,E])),o.NativeFunction("shuffle",[b,w])}case"sort":return g([{match:[ke],noBroadcast:!0,build:()=>mH(e,d[0],d[0])},{match:[uc,ke],noBroadcast:!0,build:()=>mH(e,d[0],d[1])}]);case"join":{let b=[],w=!0;for(let Q of d){let ce=o.getInstruction(Q);kt(ce)||(w=!1);let ee=ce.valueType;if(ee!==Rt)if(xe(ee))b.push({isList:!0,index:Q,elementType:It(ee)});else if(ei(ee))b.push({isList:!1,index:Q,elementType:ee});else throw ra(r,yu(o,n),{blockExport:o.areAllArgsConstant(d)})}if(b.length===0)return o.ConstantOfType(Rt,[]);for(let Q of b)if(Q.elementType!==b[0].elementType)throw ra(r,yu(o,n),{blockExport:o.areAllArgsConstant(d)});if(w){let Q=[];for(let ce of b){let ee=o.getInstruction(To(o,ce.index));B3(ee),ce.isList?Q.push(...ee.value):Q.push(ee.value)}return o.ConstantOfType(Qn(b[0].elementType),Q)}let E=o.Constant(0),I=o.Constant(1),S={};for(let Q of b)Q.isList&&S[Q.index]===void 0&&(S[Q.index]=qo(o,Q.index));let D=o.NativeFunction("total",b.map(Q=>Q.isList?S[Q.index]:I)),O=o.BeginBroadcast([D]),_=E,A=[],R=[];for(let Q of b){let ce=Q.isList?o.ListAccess([Q.index,o.Subtract([O,_])]):Q.index;if(R.push(ce),Q!==b[b.length-1]){let ee=Q.isList?S[Q.index]:I;_=o.Add([_,ee]),A.push(o.LessEqual([O,_]))}}let W=R[R.length-1];for(let Q=R.length-2;Q>=0;Q--)W=o.Piecewise([A[Q],R[Q],W]);let j=o.EndBroadcast([O,W]);return o.BroadcastResult(Qn(b[0].elementType),[j])}case"unique":{let b=d[0],w=o.getInstruction(b);if(!xe(w.valueType)||w.valueType===Ti)throw Ie(`Unexpected types for ${t}`);return o.NativeFunction("elementsAt",[b,o.NativeFunction("uniquePerm",[b])])}case"polygon":return g([{match:[],build:()=>{let b=o.ConstantOfType(on,[]);return o.NativeFunction("polygon",[b])}},{match:[C,C],noBroadcast:!0,build:()=>{throw fx()}},{match:[C,C],build:()=>{let b=o.TupleOfType(z,d);return o.NativeFunction("polygon",[b])}},{match:{type:"variadic",initial:[],rest:z},build:()=>o.NativeFunction("polygon",d)}]);case"directedangle":return yH(e,d,r);case"angle":return o.NativeFunction("undirectedAngleMarker",[yH(e,d,r)]);case"angles":return o.NativeFunction("polygonInteriorUndirectedAngles",[d[0],Ct(e,new N.Identifier("trigAngleMultiplier"))]);case"directedangles":return o.NativeFunction("polygonInteriorDirectedAngles",[d[0],Ct(e,new N.Identifier("trigAngleMultiplier"))]);case"coterminal":{if(Pr(o,d[0],$e))return o.NativeFunction("directedCoterminalAngle",d);if(Pr(o,d[0],st))return o.NativeFunction("undirectedCoterminalAngle",d);throw Ie(`Unexpected types for ${t}`)}case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":case"points":case"lines":case"circles":case"polygons":case"rays":case"arcs":case"vectors":throw Xa(r);default:{let b=t;throw new Error(`Programming Error: unexpected compiler function ${b}`)}}}function TH(e,t){return Rp(e,t,"glider",[{match:[Ye,C],build:()=>e.NativeFunction("segmentGlider",t)},{match:[Re,C],build:()=>e.NativeFunction("lineGlider",t)},{match:[ot,C],build:()=>e.NativeFunction("rayGlider",t)},{match:[We,C],build:()=>e.NativeFunction("circleGlider",t)},{match:[Oe,C],build:()=>e.NativeFunction("arcGlider",t)},{match:[et,C],build:()=>e.NativeFunction("polygonGlider",t)}])}function mH(e,t,r){let{chunk:n}=e;if(di(n,r)===0)return r;let o=n.NativeFunction("min",[qo(n,t),qo(n,r)]);return r=n.ListAccess([r,AL(e,n.List([n.Constant(1)]),n.List([o]),{stepMustBePositive:!0})]),n.NativeFunction("elementsAt",[t,n.NativeFunction("sortPerm",[r])])}function PL(e,t,r){let n=t[0],i=e.getInstruction(n);if(!Le(i.valueType,cr))throw Ie(`Unexpected args for "${r}"`);let o=t.slice(1);for(let a of o)if(!Le(e.getInstruction(a).valueType,C))throw Ie(`Unexpected args for "${r}"`);if(xe(i.valueType)){let a=[],s=1/0;for(let l of t){let u=To(e,l);a.push(u);let d=e.getInstruction(u);if(xe(d.valueType)){let f=di(e,u);if(f===void 0)throw Px(oa(e,u));s=Math.min(s,f)}}let c=[];for(let l=0;l<s;l++){let u=Yx(e,a[0],l),d=e.getInstruction(u);if(d.type!==42)throw Ie(`Unexpected opcode for distribution arg: ${d.type}`);let f=[];for(let g of a.slice(1))xe(e.getInstruction(g).valueType)?f.push(Yx(e,g,l)):f.push(g);c.push(Tu[d.symbol][r](e,u,f))}return e.List(c)}else{if(i.type!==42)throw Ie(`Unexpected opcode for distribution arg: ${i.type}`);return Tu[i.symbol][r](e,n,o)}}function hH(e,t){return t.length!==0&&e.getInstruction(t[0]).valueType!==Rt&&Le(e.getInstruction(t[0]).valueType,cr)}function XJ(e,t){let{chunk:r}=e;aa(t.args);let n=qp(e,t,t.args),i=!1,o=!1;for(let a=0;a<n.length;a++){let c=r.getInstruction(n[a]).valueType;i=i||c===nr,o=o||c!==nr}if(i&&o)throw Ie("Unexpected mix of actions and non-actions");if(i)return wH(e,n);if(n.length===2)return r.TupleOfType(z,n);if(n.length==3)return r.TupleOfType(oe,n);throw Ie(`Unexpected tuple dimensions: ${n.length}`)}function KJ(e,t){let{chunk:r}=e;aa(t.args);let n=qp(e,t,t.args);if(n.length<1)throw Ie("Empty bare sequence");let i=r.getInstruction(n[0]).valueType;if(i===C)throw Ie("Ambiguous bare sequence");return i===nr?wH(e,n):r.List(n)}function wH(e,t){let{chunk:r}=e,n=[],i=[];for(let a of t){let s=r.getInstruction(a);switch(s.type){case 49:{Array.prototype.push.apply(n,s.symbols),Array.prototype.push.apply(i,s.args);break}case 1:{let l=s.value.updateRules;for(let u of _n(l)){let d=l[u];n.push(u),i.push(r.ConstantOfType(d.valueType,d.value))}break}default:{var o=oa(r,a);throw o.length>0?FM(o):Ie(`Unexpected opcode for action: ${s.type}`)}}}return r.Action(n,i)}function _L(e,t){let{scope:r,policy:n}=e;if(r.isLocal(t))return O1(t);let i=r.getVisibleGlobalDefinition(t);return n.assignmentForbidden(t)?kM(t):i&&i.type==="FunctionDefinition"?VM(t):RM(t).allowExport()}function jJ(e,t){switch(e.getInstruction(t).valueType){case Ye:case We:case Oe:return[e.Constant(0),e.Constant(1)];case Re:return[e.Constant(-1/0),e.Constant(1/0)];case ot:return[e.Constant(0),e.Constant(1/0)];case et:return[e.Constant(0),e.NativeFunction("count",[e.NativeFunction("vertices",[t])])];default:return}}function ZJ(e,t){let{policy:r,chunk:n,scope:i,selection:o}=e;if(!(t instanceof pd))throw new Error("Programming error: expected a ListComprehension node but got "+t.type);let a=t._body,s=[],c=[],l=n.Constant(1),u=i.childScope();aa(t._inputLists);for(let{_symbol:E}of t._inputLists){let I=E;u.setErrorIfAccessed(I,q_(I))}for(let E of t.parameters){let I=E.identifier._symbol;u.setErrorIfAccessed(I,z_(I))}let d=Xs(e,u);for(let E=t._inputLists.length-1;E>=0;E--){let I=t._inputLists[E],S=I._symbol,D=Ct(d,I.args[1]);uH(n,o,I);let O=n.getInstruction(D);if(!xe(O.valueType)){let A=jJ(n,D);if(A){s.push({symbol:S,object:D,gliderBounds:A});continue}let R;if(ei(O.valueType)){let W=I.args[1].getInputSpan();W&&(R=Jn(W))}throw G_(S,dt(O.valueType),R,{blockExport:kt(O)})}let _=qo(n,D);c.push({symbol:S,assignedList:D,lengthIndex:_}),l=n.Multiply([l,_])}let f=i.childScope(),g=[],y;if(c.length>0){let E=n.Constant(1);y=n.BeginBroadcast([l],{type:"list-comprehension",callData:{inputListSymbols:c.map(S=>S.symbol)}}),f.setLocal(t._index._symbol,y);let I=E;for(let S=c.length-1;S>=0;S--){let{symbol:D,assignedList:O,lengthIndex:_}=c[S],A;if(c.length===1)A=y;else{let R=n.NativeFunction("floor",[n.Divide([n.Subtract([y,E]),I])]);A=n.Add([n.NativeFunction("mod",[R,_]),E]),S>0&&(I=n.Multiply([I,_]))}f.setLocal(D,n.ListAccess([O,A])),g.push(D)}}let x;if(t.parameters.length>0||s.length>0){let E=[],I=[];for(let S of t.parameters)E.push(S.identifier._symbol),I.push(Ct(d,S.bounds[0]),Ct(d,S.bounds[1]));for(let S of s)E.push(S.symbol),I.push(S.gliderBounds[0],S.gliderBounds[1]);x=n.BeginMap({parameterSymbols:E},I);for(let S=0;S<t.parameters.length+s.length;S++)n.BlockVar(C,[x]);for(let S=0;S<t.parameters.length;S++){let D=t.parameters[S].identifier._symbol,[O,_]=t.parameters[S].open,A=I[2*S],R=I[2*S+1],W=x+S+1,j=n.Piecewise([n.And([O?n.Greater([W,A]):n.GreaterEqual([W,A]),_?n.Less([W,R]):n.LessEqual([W,R])]),W,n.NanOfType(C)]);f.setLocal(D,j),g.push(D)}for(let S=0;S<s.length;S++){let D=s[S].symbol,O=x+t.parameters.length+S+1;f.setLocal(D,TH(n,[s[S].object,O])),g.push(D)}}let w=Ct({...Xs(e,f),substitutionContext:e.substitutionContext.for(i,e.recursiveFunctionContext,g)},a);if(x!==void 0){let E=n.EndMap([x,w]),I=n.getInstruction(w).valueType;if(Qd(I))throw Q_();if(!JG(I))throw Z_(I);let S=r.is3dPolicy()?2:1;if(t.parameters.length+s.length>S)throw J_(I,t.parameters.length);let D=QG(I,t.parameters.length+s.length);w=n.BlockVar(D,[E])}if(y!==void 0){let E=n.getInstruction(w);if(!ei(E.valueType))throw Gg([dt(E.valueType)],{blockExport:kt(E)});let I=n.EndBroadcast([y,w]);w=n.BroadcastResult(Qn(E.valueType),[I])}else t.shouldCoerceToList&&(w=n.List([w]));return w}function AL(e,t,r,n){let{stepMustBePositive:i}=n,{chunk:o}=e;t=bu(o,t),r=bu(o,r);let a=o.getInstruction(t),s=o.getInstruction(r),c=Al(o,t,"Programming error: expected range start list to have constant length."),l=Al(o,r,"Programming error: expected range start list to have constant length.");if(a.valueType!==ke||s.valueType!==ke)throw wx();let u=o.Constant(1),d=o.Constant(0),f=o.ListAccess([t,u]),g=o.ListAccess([t,o.Constant(2)]),y=o.ListAccess([r,o.Constant(l)]),x=o.Subtract([y,f]),b=c>1?o.Subtract([g,f]):o.Piecewise([o.GreaterEqual([x,d]),u,o.Constant(-1)]),w=o.Add([u,o.NativeFunction("round",[o.Divide([x,b])])]),E=o.NativeFunction("validateRangeLength",[t,r,b,w]);i&&(E=o.Piecewise([o.GreaterEqual([b,d]),E,d]));let I=o.BeginBroadcast([E]),S=o.Add([f,o.Multiply([b,o.Subtract([I,u])])]),D=o.EndBroadcast([I,S]);return o.addComments({[f]:"start",[g]:"second",[y]:"last",[w]:"proposedLength",[b]:"step",[S]:"body"}),o.BroadcastResult(Qn(o.getInstruction(S).valueType),[D])}function ZE(e,t){return Pr(e,t,Ye)?e.NativeFunction("lineFromSegment",[t]):Pr(e,t,Ve)?e.NativeFunction("lineFromSegment",[$J(e,t)]):Pr(e,t,ot)?e.NativeFunction("lineFromRay",[t]):t}function JJ(e,t){let r=e.NativeFunction("arcCenter",[t]),n=e.NativeFunction("arcFirstPoint",[t]),i=e.NativeFunction("distance",[r,n]);return{center:r,radius:i,startPoint:n}}function yH(e,t,r){let{chunk:n}=e;if(t.length===3&&Pr(n,t[0],z)&&Pr(n,t[1],z)&&Pr(n,t[2],z)){let i=t[0],o=t[1],a=t[2],s=n.Subtract([i,o]),c=n.Subtract([a,o]),l=n.Slot(0,[s]),u=n.Slot(1,[s]),d=n.Slot(0,[c]),f=n.Slot(1,[c]),g=n.NativeFunction("arctan",[u,l]),y=n.Subtract([n.Multiply([l,f]),n.Multiply([u,d])]),x=n.Add([n.Multiply([l,d]),n.Multiply([u,f])]),b=n.NativeFunction("arctan",[y,x]),w=n.NativeFunction("abs",[b]),E=n.Constant(Math.PI),I=n.Constant(Math.PI*2);b=n.Piecewise([n.Equal([w,E]),E,n.Piecewise([n.Less([w,E]),b,n.Multiply([n.Multiply([n.NativeFunction("sign",[b]),n.Constant(-1)]),n.Subtract([I,w])])])]);let S=n.NativeFunction("directedAngleMarker",[o,g,b,Ct(e,new N.Identifier("trigAngleMultiplier"))]),D=n.Constant(0),O=n.And([n.Equal([y,D]),n.Equal([x,D])]);return n.Piecewise([O,n.NanOfType($e),S])}else throw Ie(`Unexpected types for ${r}`)}function Cq(e,t){return e.Divide([e.NativeFunction("directedAngleMarkerRawDelta",[t]),e.NativeFunction("directedAngleMarkerMultiplier",[t])])}function Pq(e,t){return e.NativeFunction("abs",[e.Divide([e.NativeFunction("undirectedAngleMarkerRawDelta",[t]),e.NativeFunction("undirectedAngleMarkerMultiplier",[t])])])}function QJ(e,t,r){let{chunk:n,policy:i}=e,o=r.slice(1),a=qx(i,t);if(!a)throw new Error(`Unexpected transformation type: ${t}`);let s=a.map(d=>{let f=0;for(let g=1;g<r.length;g++){let y=n.getInstruction(r[g]).valueType,x=d.argTypeAtIndex(g);x&&Lm(y,x)&&f++}return{signature:d,matchedArgsCount:f,signatureArgsCount:d.maxArity===void 0?d.initial.length+1:d.argTypes.length-1,providedArgsCount:r.length-1}}).sort((d,f)=>f.matchedArgsCount!==d.matchedArgsCount?f.matchedArgsCount-d.matchedArgsCount:d.signatureArgsCount-f.signatureArgsCount),c;switch(t){case"translate":{c=[{match:[Ve],build:()=>n.NativeFunction("translation",[n.NativeFunction("vectorDisplacementAsPoint",o)])},{match:[z,z],build:()=>n.NativeFunction("translation",[n.Subtract([o[1],o[0]])])}];break}case"reflect":{c=[{match:[uS],build:()=>{let d=ZE(n,o[0]);return n.NativeFunction("reflection",[d])}}];break}case"rotate":{c=[{match:[z,C],build:()=>{let d=Ct(e,new N.Identifier("trigAngleMultiplier"));return n.NativeFunction("rotation",[o[0],n.Multiply([o[1],d])])}}];break}case"dilate":{c=[{match:[z,C],build:()=>n.NativeFunction("dilation",o)}];break}default:{let d=t;throw new Error(`Programming error: exhaustive check failed: ${d}`)}}let l=n.areAllArgsConstant(o),u=Rp(n,o,()=>{throw lM(t,yu(n,o),s[0].signature,{blockExport:l})},c);return JE(n,[u,r[0]],t,!0)}function JE(e,t,r,n){let i=[[xt,"compose"],[z,"transformPoint"],[Ye,"transformSegment"],[Re,"transformLine"],[ot,"transformRay"],[Ve,"transformVector"],[We,"transformCircle"],[Oe,"transformArc"],[et,"transformPolygon"],[st,"transformAngleMarker"],[$e,"transformDirectedAngleMarker"]].map(([a,s])=>({match:[xt,a],build:(c,l)=>c.NativeFunction(s,l)}));function o(){if(n){let a=t.slice(1);throw uM(r,Dp(e,a),{blockExport:e.areAllArgsConstant(a)})}else throw ra(r,Dp(e,t),{blockExport:e.areAllArgsConstant(t)})}return Rp(e,t,o,i)}function SL(e,t,r){let n=ZE(e,t[0]),i=ZE(e,t[1]),o=[n,i,e.ConstantOfType(C,r)];if(Pr(e,n,We)){if(Pr(e,i,We))return e.NativeFunction("circleCircleIntersection",o);if(Pr(e,i,Oe))return e.NativeFunction("circleArcIntersection",o);if(Pr(e,i,Re))return e.NativeFunction("circleLineIntersection",o)}if(Pr(e,n,Oe)){if(Pr(e,i,We))return e.NativeFunction("arcCircleIntersection",o);if(Pr(e,i,Oe))return e.NativeFunction("arcArcIntersection",o);if(Pr(e,i,Re))return e.NativeFunction("arcLineIntersection",o)}if(Pr(e,n,Re)){if(Pr(e,i,We))return e.NativeFunction("lineCircleIntersection",o);if(Pr(e,i,Oe))return e.NativeFunction("lineArcIntersection",o);if(Pr(e,i,Re))return e.NativeFunction("lineLineIntersection",o)}throw Ie("Invalid intersection types")}function eQ(e,[t,r],[n,i]){let{chunk:o,scope:a}=e,s=o.getInstruction(n).valueType,c=o.getInstruction(i).valueType,l=f=>{var g;return(g=a.getParseNode(f))!=null?g:a.getVisibleGlobalDefinition(f)},u=iE(t)?l(t._symbol):t,d=iE(r)?l(r._symbol):r;if(!(!u||!d))return fq({getGeometryTree:f=>fE(f).tree,lookup:l,isPointOrListOfPoints:f=>{if(f.isFunction)return!1;let g=Ct(e,f);return Le(o.getInstruction(g).valueType,z)},resolvesTo:(f,g)=>a.getVisibleGlobalDefinition(f)===g},u,s,d,c)}function tQ(e,t){let{policy:r,scope:n}=e,i=t._body,o=n.childScope(),a=[];for(let c=0;c<t._assignments.length;c++){let l=t._assignments[c]._lhs,u;if(l instanceof Ut)u=l._symbol;else throw Sx();let d=t._assignments[c].args[1],f=n.getVisibleGlobalDefinition(u);if(f){if(f.type==="FunctionDefinition")throw Dx(u);if(r.assignmentForbidden(u))throw Zm(u)}let g=Ct(e,d);o.setLocal(u,g,d),a.push(u)}return Ct({...Xs(e,o),substitutionContext:e.substitutionContext.with(n,e.recursiveFunctionContext,a)},i)}var bH={points:on,lines:Ei,segments:zn,polygons:ti,circles:wi,arcs:ci,angles:Un,directedangles:ri,rays:li,vectors:Ii};function rQ(e,t){let{chunk:r,scope:n}=e,i=n.getVisibleGlobalDefinition("construction");if(!i)throw Ie("Expected 'construction' to be defined in the frame");if(i.type!=="Construction"||!(i instanceof Pe))throw Ie(`Expected construction node but found ${i.type}}`);if(!iE(t))throw Ie(`Expected identifier but found ${t.type}`);let o=t._symbol;if(!(o in bH))throw Xa("construction");let a=bH[o];if(i.args.length===0)return r.ConstantOfType(a,[]);let s=It(a),c=[];for(let l of i.args)try{let u=Ct(e,l);r.getInstruction(u).valueType===s&&c.push(u)}catch(u){if(u instanceof N.Base)continue;throw u}return r.List(c)}function gv(e,t){let r=e.args,n=e instanceof Tn?e._symbol:e instanceof vp||e instanceof xp?e.args[0]._symbol:void 0;if(n&&t.definitions[n])return!1;if(e instanceof wa){let s=[gv(e.args[0],t)||new Yr(!0)],c=gv(e.args[1],t),l=gv(e.args[2],t);return c&&s.push(c),l&&s.push(l),s.length===1?!1:(s.length===2&&s.push(s[1]),new wa(s))}let i=[],o=!1;for(let a of r){let s=gv(a,t);if(s===!1){o=!0;continue}i.push(s)}return o?!1:e.copyWithArgs(i)}function EH(e,t,r){let{chunk:n,scope:i}=e,o={},a=_n(r.definitions);for(let y of a){let x=r.definitions[y];if(x instanceof q)throw x;o[y]=x}let s=t._argSymbols.map(y=>Ct(e,new Ut(y))),c=new ML(o,r.baseCases);try{CH(e,c,t,s)}catch(y){throw c.isUnconditionallyRecursive&&y instanceof q&&!y.blocksExport?a.length>1||IH(t,t._expression)?qg(a):I1(a):y}let l={},u={},d={},f=i.childScope();for(let y of a){let x=c.returnTypes[y];if(x===void 0)throw Ie(`Could not infer the return type for recursive function ${y}.`);let b=c.argTypes[y];if(b===void 0)throw Ie(`Could not infer the argument types for recursive function ${y}.`);u[y]={argTypes:b},l[y]=x,d[y]=n.FunctionHeader(y,x,u[y],o[y]._argSymbols),f.setLocal(y,d[y])}let g=[];for(let y of a)g.push(d[y]);for(let y of g)n.getInstruction(y).recursionGroup=g;for(let y of a){let x=f.childScope(),b=o[y],w=d[y],E=n.BeginFunction([w]);for(let D=0;D<b._argSymbols.length;D++){let O=b._argSymbols[D],_=n.BlockVar(u[y].argTypes[D],[E]);x.setLocal(O,_)}let I={...Xs(e,x),recursiveFunctionContext:{type:"compile-general",fnSymbols:a}},S=PH(I,b,r.baseCases,Ct(I,b._expression));if(n.getInstruction(S).valueType!==l[y])throw ra(y,yu(n,s),{blockExport:n.areAllArgsConstant(s)});S=To(n,S),n.EndFunction([E,S])}if(c.isUnconditionallyRecursive){let y=n.getRecursiveFunctionMetadata(d[t._symbol]),x=y==null?void 0:y.recursiveStructure;throw x!=null&&x.canIterate?new Error("Programming error: expected canIterate==false for unconditionally recursive function."):x!=null&&x.maxRecursiveCallOffsets&&a.every(b=>x.maxRecursiveCallOffsets[b]===0)?qg(a):US(a,{type:"missing-non-recursive-branch",recursionGroup:a,recursiveStructure:x})}return n.FunctionCall([d[t._symbol],...s])}function IH(e,t){return t instanceof Tn&&t._symbol===e._symbol?t.args.every((r,n)=>r instanceof Ut&&r._symbol===e._argSymbols[n]):t.args.every(r=>IH(e,r))}function CH(e,t,r,n){var S;let{chunk:i,scope:o}=e,a=t.returnTypes[r._symbol],s=t.argTypes[r._symbol];if(a!==void 0&&s!==void 0)return{returnType:a,argTypes:s};let c=r._argSymbols.length,l=n.length;if(c!==l)throw fc(r._symbol,c,l,{includeUsageExample:!0});let u=n.map(D=>i.getInstruction(D).valueType),d=`${r._symbol}:${u.join(",")}:${Object.keys(t.returnTypes).join(",")}`;if(t.stack.includes(d))return t.isUnconditionallyRecursive=!0,{returnType:C,argTypes:u};t.stack.push(d);let f=i.instructionsLength(),g=i.getReturnIndex(),y;{let D=gv(r._expression,t),O=r._symbol,_=(S=t.baseCases[O])!=null?S:[],A=o.childScope(),R={...Xs(e,A),recursiveFunctionContext:t},W=[];for(let Q=0;Q<r._argSymbols.length;Q++){let ce=r._argSymbols[Q],ee=i.SymbolicVar(u[Q]);W.push(ee),A.setLocal(ce,ee)}if(!t.baseCaseTypes.hasOwnProperty(O)){let Q,ce,ee,pe=!0;for(let re of _){let k=re.getRef();if(!re.specifiedArg.valid||!k)continue;let Ke=new Ut(k),ht=Ct(R,Ke);ee||(ee=Ke);let Ze=i.getInstruction(ht),Te=Ze.valueType;if(kt(Ze)||(pe=!1),Q===void 0)Q=re.specifiedArg.argIndex;else if(Q!==re.specifiedArg.argIndex)throw ix();let Vt=ce;if(Vt===void 0)ce=Te;else{let yt=Jd(Vt,Te);if(yt===void 0)throw nx({blockExport:pe});ce=yt}}t.baseCaseTypes[O]=ce,t.firstValidBaseCaseIdentifiers[O]=ee}let j=t.firstValidBaseCaseIdentifiers[O];if(D||j){let Q=PH(R,r,t.baseCases,Ct(R,D||j)),{someArgBroadcasts:ce,inferredArgTypes:ee}=nQ(i,W,g,Q);if(u=ee,y=i.getInstruction(Q).valueType,ce){if(!xe(y))throw Ie(`TODO: expected a list type but found ${xr(y)}`);y=It(y)}let pe=t.returnTypes[r._symbol];if(pe!==void 0&&y!==pe)throw nx({blockExport:!1});t.argTypes[r._symbol]=ee,t.returnTypes[r._symbol]=y}}i.truncate(f);let x=o.childScope(),b={...Xs(e,x),recursiveFunctionContext:t};for(let D=0;D<r._argSymbols.length;D++){let O=r._argSymbols[D],_=i.SymbolicVar(u[D]);x.setLocal(O,_)}let w=Ct(b,r._expression);t.stack.pop();let E=i.getInstruction(w).valueType,I=y===void 0?E:Jd(y,E);if(I===void 0)throw Ie(`Mismatched return types: ${y&&xr(y)} vs ${xr(E)}`);return t.returnTypes[r._symbol]=I,i.truncate(f),{returnType:I,argTypes:u}}function nQ(e,t,r,n){let i=[],c=[];for(let d=0;d<n-r;d++)c.push(0);if(e.getInstruction(n).type===48){c.push(1);for(let d=n;d>=0;d--){let f=c[d-r];if(f===0)continue;let g=e.getInstruction(d);if(!pt(g)){if(g.type===24?i.push(d):g.type===23&&i.pop(),(g.type===48||g.type===24)&&(c[g.args[0]-r]|=f),g.type===39||g.type===41||g.type===40)for(let y of i){let b=e.getInstruction(y).args[0];if(g.args[1]===b){c[g.args[0]-r]|=f;break}}if(i.length>0){let y=i[i.length-1],b=e.getInstruction(y).args[0];for(let w of g.args)w>=b&&(c[w-r]|=f);g.type===33&&g.args[0]>=b&&(c[g.args[0]-r]|=2)}}}}let l=[],u=!1;for(let d=0;d<t.length;d++){let f=t[d],g=e.getInstruction(f).valueType;if(c[f-r]&2){if(!xe(g))throw Ie(`Expected list type but found ${xr(g)}`);u=!0,l.push(It(g))}else l.push(g)}return{inferredArgTypes:l,someArgBroadcasts:u}}function PH(e,t,r,n){let{chunk:i}=e,o=!0,a=r[t._symbol];for(let s of a){let c=s.specifiedArg;if(!c.valid)continue;let l=t._argSymbols[c.argIndex],u=Ct(e,new Ut(l)),d=i.Equal([u,i.Constant(c.argValue)]),f=Ct(e,s),g=i.getInstruction(f);kt(g)||(o=!1);let y=i.getInstruction(f).valueType,x=i.getInstruction(n).valueType;if(Jd(y,x)===void 0)throw nx({blockExport:o});n=i.Piecewise([d,f,n])}return n}function iQ(e){return e.type==="Constant"&&Number.isInteger(e.asValue())}Gr.prototype.buildIRExpression=function(e,t,r){var i;var n=iy({policy:e,frame:t,wrapInList:r&&r.wrapInList,coerceToNumber:r&&r.coerceToNumber},this);return e.isGeometryEnabled()&&n.argNames.some(o=>o[0]==="$")?j_():(i=n.getError())!=null?i:new dn(n)};q.prototype.buildIRExpression=function(e,t,r){return this};var SH=e1;function OL(e){for(var t=[],r=0;r<e.length;r++)t.push(dt(e[r].valueType));return t}var Ks=!0;function MH(e,t){var r=t.length,n=t[0];if(r<2)throw kc(this._symbol,{blockExport:Ks});if(!SH(n.valueType,[ke,Rt]))throw kc(this._symbol,{blockExport:Ks});if(r>2)throw k1(this._symbol,2)}N.Histogram.prototype.typeCheck=MH;N.DotPlot.prototype.typeCheck=MH;N.BoxPlot.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw kc(this._symbol,{blockExport:Ks});if(!SH(n.valueType,[ke,Rt]))throw kc(this._symbol,{blockExport:Ks});if(r>1)throw kc(this._symbol,{blockExport:Ks})};N.TTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length===0)throw kc(r,{blockExport:Ks});if(t[0].valueType===Rt)throw jm(r);if(t[0].valueType!==ke)throw kc(r,{blockExport:Ks});if(t.length>2)throw k1(r,2);if(t[0].length<2)throw jm(r);if(t[1]&&t[1].valueType!==C)throw ra(r,OL(t),{blockExport:Ks})};N.IndependentTTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length!==2)throw mx(r);if(!xe(t[0].valueType)||!xe(t[1].valueType))throw Tx(r,{blockExport:Ks});if(t[0].valueType===Rt||t[1].valueType===Rt)throw jm("ittest");if(t[0].valueType!==ke||t[1].valueType!==ke)throw ra(r,OL(t),{blockExport:Ks});if(t[0].length<2||t[1].length<2)throw jm("ittest")},N.Stats.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw kc(this._symbol,{blockExport:Ks});if(n.valueType===Rt)throw ra(this._symbol,OL(t),{blockExport:Ks});if(n.valueType!==ke)throw kc(this._symbol,{blockExport:Ks});if(r>1)throw kc(this._symbol,{blockExport:Ks})};var bd=function(e,t,r){r=r||0;var n=Array(r+1).join("  "),i=n+"  ";return`[
`+i+e.map(function(o){return o.repr(t,r+1)}).join(`,
`+i)+`
`+n+"]"},qi=function(e,t){return t=t||"",""+t+e};N.Expression.prototype.repr=function(e,t){return qi(this.type,e)+"("+bd(this.args,e,t)+")"};N.IRExpression.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join("  "),n=r+"  ",i=this._chunk.print().split(`
`);return i.pop(),qi(this.type,e)+"(`\n"+n+i.join(`
`+n)+`
`+r+"`)"};N.DoubleInequality.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join("  "),n=r+"  ";return qi(this.type,e)+`([
`+n+this.args[0].repr(e,t+1)+`,
`+n+"'"+this.args[1]+`',
`+n+this.args[2].repr(e,t+1)+`,
`+n+"'"+this.args[3]+`',
`+n+this.args[4].repr(e,t+1)+`
`+r+"])"};N.ComparatorChain.prototype.repr=function(e,t){return t=t||0,qi(this.type,e)+"(["+this.symbols.map(r=>`'${r}'`).join(",")+`],
`+bd(this.args,e,t)+")"};N.Identifier.prototype.repr=function(e){return qi(this.type,e)+"('"+this._symbol+"')"};N.Constant.prototype.repr=function(e){return qi(this.type,e)+"("+this.asValue()+")"};N.ExtendSeed.prototype.repr=function(e,t){return qi(this.type,e)+"('"+this.tag+"', "+bd(this.args,e,t)+")"};N.Seed.prototype.repr=function(e){return qi(this.type,e)+"("+this.asValue()+")"};N.FunctionCall.prototype.repr=function(e,t){return qi(this.type,e)+"('"+this._symbol+"', "+bd(this.args,e,t)+")"};N.RecursiveFunctionBaseCase.prototype.repr=function(e,t){return this.originalNode.repr(e,t)};N.Assignment.prototype.repr=function(e,t){return qi(this.type,e)+"("+new N.Identifier(this._symbol).repr(e,t)+", "+this._expression.repr(e,t)+")"};N.Regression.prototype.repr=N.Equation.prototype.repr=N.CallAssignment.prototype.repr=function(e,t){return qi(this.type,e)+"("+this._lhs.repr(e,t)+", "+this._rhs.repr(e,t)+")"};N.FunctionDefinition.prototype.repr=function(e,t){return qi(this.type,e)+"("+new N.Identifier(this._symbol).repr(e,t)+", "+bd(this._argSymbols.map(function(r){return new N.Identifier(r)}),e,t)+", "+this._expression.repr(e,t)+")"};N.Error.prototype.repr=function(e,t){return qi(this.type,e)+"('"+this._msg+"')"};N.Derivative.prototype.repr=function(e,t){return qi(this.type,e)+"('"+this._symbol+"', "+bd(this.args,e,t)+")"};N.SolvedEquation.prototype.repr=function(e,t){return qi(this.type,e)+"('"+this._symbol+"', "+this._expression.repr(e,t)+")"};N.OptimizedRegression.prototype.repr=function(e,t){return qi(this.type,e)+"("+JSON.stringify(this.parameters)+", "+JSON.stringify(this.residuals)+", "+JSON.stringify(this.statistics)+", "+this.model.repr(e,t+1)+", "+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+")"};N.Table.prototype.repr=function(e,t){return qi(this.type,e)+"("+bd(this.columns,e,t)+")"};N.TableColumn.prototype.repr=function(e,t){return qi(this.type,e)+"("+this.header.repr(e,t)+", "+this.length+", "+bd(this.values,e,t)+")"};N.TableColumnValue.prototype.repr=function(e,t){return"TableColumnValue("+bd(this.rawArgs,e,t)+", "+this.headerSymbol+")"};N.Image.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return qi(this.type,e)+`({
`+n+"center: "+this.center.repr(e,t+1)+`,
`+n+"radianAngle: "+this.radianAngle.repr(e,t+1)+`,
`+n+"width: "+this.width.repr(e,t+1)+`,
`+n+"height: "+this.height.repr(e,t+1)+`},
`+n+"opacity: "+this.opacity.repr(e,t+1)+`,
`+n+JSON.stringify(this.moveStrategy)+`
`+r+"})"};N.Ticker.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return qi(this.type,e)+`({
`+n+"handler: "+this.handler.repr(e,t+1)+`,
`+n+"minStep: "+this.minStep.repr(e,t+1)+`
`+r+"})"};N.Slider.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return qi(this.type,e)+`({
`+n+"sliderAssignment: "+this.sliderAssignment.repr(e,t+1)+`,
`+n+"sliderMin: "+(this.sliderMin&&this.sliderMin.repr(e,t+1))+`,
`+n+"sliderMax: "+(this.sliderMax&&this.sliderMax.repr(e,t+1))+`,
`+n+"sliderStep: "+(this.sliderStep&&this.sliderStep.repr(e,t+1))+`},
`+r+")"};N.ImaginaryUnit.prototype.repr=function(e){return qi(this.type,e)+"()"};var eI=function(e,t){return e.map(function(r){return r.substitute(t)})};N.Identifier.prototype.substitute=function(e){return e[this._symbol]?e[this._symbol]:this};N.FunctionCall.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type==="Identifier")return new N.FunctionCall(t,eI(this.args,e));if(t.type==="Constant")return new N.Multiply([t,this.args.length===1?this.args[0].substitute(e):new N.Constant(NaN)])}return N.Expression.prototype.substitute.call(this,e)};N.Constant.prototype.substitute=function(e){return this};N.Expression.prototype.substitute=function(e){return this.copyWithArgs(eI(this.args,e))};N.Derivative.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type==="Identifier")return new N.Derivative(t,eI(this.args,e));throw new Error("Cannot substitute for a derivative variable with a non-Identifier")}return new N.Derivative(this._symbol,eI(this.args,e))};N.Expression.prototype.simpleFunctionExpression=function(){return this};N.Assignment.prototype.simpleFunctionExpression=function(){return this._expression};N.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression};N.RecursiveFunctionBaseCase.prototype.simpleFunctionExpression=function(){return this._expression};N.Equation.prototype.simpleFunctionExpression=N.CallAssignment.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()};var tI={normaldist:{type:"distribution",symbol:"normaldist",params:["mean","stdev"],defaults:["0","1"],discrete:!1},tdist:{type:"distribution",symbol:"tdist",params:["dof"],defaults:[void 0],discrete:!1},binomialdist:{type:"distribution",symbol:"binomialdist",params:["trials","probsuccess"],defaults:[void 0,"0.5"],discrete:!0},poissondist:{type:"distribution",symbol:"poissondist",params:["mean"],defaults:[void 0],discrete:!0},uniformdist:{type:"distribution",symbol:"uniformdist",params:["min","max"],defaults:["0","1"],discrete:!1}},oQ={Histogram:{type:"visualization",symbol:"histogram",params:["data","binwidth"],defaults:[void 0,"1"]},DotPlot:{type:"visualization",symbol:"dotplot",params:["data","binwidth"],defaults:[void 0,"1"]},BoxPlot:{type:"visualization",symbol:"boxplot",params:["data"],defaults:[void 0]}};function zp(e){let t=e,r=oQ[t.type];if(!r)switch(t.type==="Assignment"&&(t=t._expression),t.type){case"FunctionCall":{r=tI[t._symbol];break}default:return}if(!r)return;let n={},i=r.params,o=t.args;for(let a=0;a<i.length;a++){let s=o[a];n[i[a]]=s&&s.getInputString()||""}return{...r,span:t.getInputSpan(),values:n}}var sQ={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!0,fill:!0},DOTPLOT:{points:!0,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!0,fill:!1},TTEST:{points:!1,lines:!1,fill:!1},STATS:{points:!1,lines:!1,fill:!1},VECTOR2D:{points:!1,lines:!0,fill:!1},POINT3D:{points:!0,lines:!1,fill:!1},POINT3D_LIST:{points:!0,lines:!1,fill:!1},CURVE3D_xyz_t:{points:!1,lines:!0,fill:!1},SLICE:{points:!1,lines:!0,fill:!1},SLICE_r\u03B8z_at_z:{points:!1,lines:!0,fill:!1},SLICE_zr\u03B8_at_r:{points:!1,lines:!0,fill:!1},SLICE_zr\u03B8_at_\u03B8:{points:!1,lines:!0,fill:!1},SLICE_zr\u03B8_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_r\u03B8\u03C6_at_\u03B8:{points:!1,lines:!0,fill:!1},SLICE_r\u03B8\u03C6_at_\u03C6:{points:!1,lines:!0,fill:!1},SLICE_r\u03B8\u03C6_at_xyz:{points:!1,lines:!0,fill:!1},SLICE_xyz_uv:{points:!1,lines:!0,fill:!1},SEGMENT3D:{points:!1,lines:!0,fill:!1},VECTOR3D:{points:!1,lines:!0,fill:!1},SPHERE3D:{points:!1,lines:!0,fill:!1},SURFACE_xyz_uv:{points:!1,lines:!0,fill:!1},SURFACE_z_r\u03B8:{points:!1,lines:!0,fill:!1},SURFACE_r_\u03B8z:{points:!1,lines:!0,fill:!1},SURFACE_r_\u03B8\u03C6:{points:!1,lines:!0,fill:!1},SURFACE_r_\u03B8z_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE:{points:!1,lines:!0,fill:!1},TRIANGLE3D:{points:!1,lines:!0,fill:!1},SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1},SURFACE_CONSTANT_AMBIGUOUS:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE:{points:!1,lines:!0,fill:!1},IMPLICIT_SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1}};function fv(e,t,r){var i,o,a,s,c,l;if(e===void 0)return{points:!1,lines:!1,fill:!1};let n=sQ[e];switch(e){case"SINGLE_POINT":return{points:!0,lines:!1,fill:!1};case"POINT_LIST":case"POINT3D_LIST":case"DOTPLOT":return{points:(i=t.points)!=null?i:n.points,lines:(o=t.lines)!=null?o:n.lines,fill:!1};case"POINT3D":return{points:(a=t.points)!=null?a:n.points,lines:!1,fill:!1};case"PARAMETRIC":case"POLYGON":case"X_OR_Y":case"VECTOR2D":case"POLAR":case"IMPLICIT":case"HISTOGRAM":case"BOXPLOT":case"TTEST":case"STATS":case"CURVE3D_xyz_t":return{points:!1,lines:(s=t.lines)!=null?s:n.lines,fill:(c=t.fill)!=null?c:n.fill};case"TRIANGLE3D":case"SPHERE3D":case"SURFACE":case"SURFACE_r_\u03B8z":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"IMPLICIT_SURFACE_AMBIGUOUS":case"SEGMENT3D":case"VECTOR3D":case"SLICE":case"SLICE_r\u03B8z_at_z":case"SLICE_zr\u03B8_at_r":case"SLICE_zr\u03B8_at_\u03B8":case"SLICE_zr\u03B8_at_xyz":case"SLICE_r\u03B8\u03C6_at_\u03B8":case"SLICE_r\u03B8\u03C6_at_\u03C6":case"SLICE_r\u03B8\u03C6_at_xyz":case"SLICE_xyz_uv":return{points:!1,lines:(l=t.lines)!=null?l:n.lines,fill:!1};default:r&&r(e);let u=e;return fv(e,t)||u}}function DH(e){if(e===void 0)return!1;switch(e){case"SINGLE_POINT":case"POINT_LIST":case"PARAMETRIC":case"POLYGON":case"X_OR_Y":case"VECTOR2D":case"POLAR":case"IMPLICIT":case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_CONSTANT_AMBIGUOUS":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":case"CURVE3D_xyz_t":case"SLICE":case"SLICE_r\u03B8z_at_z":case"SLICE_zr\u03B8_at_r":case"SLICE_zr\u03B8_at_\u03B8":case"SLICE_zr\u03B8_at_xyz":case"SLICE_r\u03B8\u03C6_at_\u03B8":case"SLICE_r\u03B8\u03C6_at_\u03C6":case"SLICE_r\u03B8\u03C6_at_xyz":case"SLICE_xyz_uv":case"SEGMENT3D":case"VECTOR3D":case"SPHERE3D":case"POINT3D":case"POINT3D_LIST":case"TRIANGLE3D":return!0;case"HISTOGRAM":case"BOXPLOT":case"DOTPLOT":case"TTEST":case"STATS":return!1;default:return e}}var se=function(){};se.version="1.2.6";se._myIndexOf=function(t){var r=this.length,n;for(n=0;n<r;++n)if(this[n]===t)return n;return-1};se.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:se._myIndexOf;se.precision=4;se.largeArray=50;se.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t="return function ("+e.join(",")+") {"+t+"}",new Function(["numeric"],t)(se)};se._dim=function(t){for(var r=[];typeof t=="object";)r.push(t.length),t=t[0];return r};se.dim=function(t){var r,n;return typeof t=="object"?(r=t[0],typeof r=="object"?(n=r[0],typeof n=="object"?se._dim(t):[t.length,r.length]):[t.length]):[]};se.mapreduce=function(t,r){return se.compile("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+r+`;
if(typeof x === "number") { var xi = x; `+t+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+t+`;
    xi = x[i-1];
    `+t+`;
}
if(i === 0) {
    xi = x[i];
    `+t+`
}
return accum;`)};se.mapreduce2=function(t,r){return se.compile("x",`var n = x.length;
var i,xi;
`+r+`
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+t+`
}
return accum;`)};se.rep=function(t,r,n){typeof n=="undefined"&&(n=0);var i=t[n],o=Array(i),a;if(n===t.length-1){for(a=i-2;a>=0;a-=2)o[a+1]=r,o[a]=r;return a===-1&&(o[0]=r),o}for(a=i-1;a>=0;a--)o[a]=se.rep(t,r,n+1);return o};se.dotMMsmall=function(t,r){var n,i,o,a,s,c,l,u,d,f,g,y,x,b;for(a=t.length,s=r.length,c=r[0].length,l=Array(a),n=a-1;n>=0;n--){for(u=Array(c),d=t[n],o=c-1;o>=0;o--){for(f=d[s-1]*r[s-1][o],i=s-2;i>=1;i-=2)g=i-1,f+=d[i]*r[i][o]+d[g]*r[g][o];i===0&&(f+=d[0]*r[0][o]),u[o]=f}l[n]=u}return l};se._getCol=function(t,r,n){var i=t.length,o;for(o=i-1;o>0;--o)n[o]=t[o][r],--o,n[o]=t[o][r];o===0&&(n[0]=t[0][r])};se.dotMMbig=function(t,r){var n=se._getCol,i=r.length,o=Array(i),a=t.length,s=r[0].length,c=new Array(a),l,u=se.dotVV,d,f,g,y;for(--i,--a,d=a;d!==-1;--d)c[d]=Array(s);for(--s,d=s;d!==-1;--d)for(n(r,d,o),f=a;f!==-1;--f)y=0,l=t[f],c[f][d]=u(l,o);return c};se.dotMV=function(t,r){var n=t.length,i=r.length,o,a=Array(n),s=se.dotVV;for(o=n-1;o>=0;o--)a[o]=s(t[o],r);return a};se.dotVM=function(t,r){var n,i,o,a,s,c,l,u,d,f,g,y,x,b,w,E,I,S,D;for(a=t.length,s=r[0].length,l=Array(s),o=s-1;o>=0;o--){for(f=t[a-1]*r[a-1][o],i=a-2;i>=1;i-=2)g=i-1,f+=t[i]*r[i][o]+t[g]*r[g][o];i===0&&(f+=t[0]*r[0][o]),l[o]=f}return l};se.dotVV=function(t,r){var n,i=t.length,o,a=t[i-1]*r[i-1];for(n=i-2;n>=1;n-=2)o=n-1,a+=t[n]*r[n]+t[o]*r[o];return n===0&&(a+=t[0]*r[0]),a};se.dot=function(t,r){var n=se.dim;switch(n(t).length*1e3+n(r).length){case 2002:return r.length<10?se.dotMMsmall(t,r):se.dotMMbig(t,r);case 2001:return se.dotMV(t,r);case 1002:return se.dotVM(t,r);case 1001:return se.dotVV(t,r);case 1e3:return se.mulVS(t,r);case 1:return se.mulSV(t,r);case 0:return t*r;default:throw new Error("numeric.dot only works on vectors and matrices")}};se.diag=function(t){var r,n,i,o=t.length,a=Array(o),s;for(r=o-1;r>=0;r--){for(s=Array(o),n=r+2,i=o-1;i>=n;i-=2)s[i]=0,s[i-1]=0;for(i>r&&(s[i]=0),s[r]=t[r],i=r-1;i>=1;i-=2)s[i]=0,s[i-1]=0;i===0&&(s[0]=0),a[r]=s}return a};se.getDiag=function(e){var t=Math.min(e.length,e[0].length),r,n=Array(t);for(r=t-1;r>=1;--r)n[r]=e[r][r],--r,n[r]=e[r][r];return r===0&&(n[0]=e[0][0]),n};se.identity=function(t){return se.diag(se.rep([t],1))};se.pointwise=function(t,r,n){typeof n=="undefined"&&(n="");var i=[],o,a=/\[i\]$/,s,c="",l=!1;for(o=0;o<t.length;o++)a.test(t[o])?(s=t[o].substring(0,t[o].length-3),c=s):s=t[o],s==="ret"&&(l=!0),i.push(s);return i[t.length]="_s",i[t.length+1]="_k",i[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+c+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(l?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(",")+`,_s,_k+1);
    return ret;
}
`+n+`
for(i=_n-1;i!==-1;--i) {
    `+r+`
}
return ret;`,se.compile.apply(null,i)};se.pointwise2=function(t,r,n){typeof n=="undefined"&&(n="");var i=[],o,a=/\[i\]$/,s,c="",l=!1;for(o=0;o<t.length;o++)a.test(t[o])?(s=t[o].substring(0,t[o].length-3),c=s):s=t[o],s==="ret"&&(l=!0),i.push(s);return i[t.length]="var _n = "+c+`.length;
var i`+(l?"":", ret = Array(_n)")+`;
`+n+`
for(i=_n-1;i!==-1;--i) {
`+r+`
}
return ret;`,se.compile.apply(null,i)};se._biforeach=function e(t,r,n,i,o){if(i===n.length-1){o(t,r);return}var a,s=n[i];for(a=s-1;a>=0;a--)e(typeof t=="object"?t[a]:t,typeof r=="object"?r[a]:r,n,i+1,o)};se._biforeach2=function e(t,r,n,i,o){if(i===n.length-1)return o(t,r);var a,s=n[i],c=Array(s);for(a=s-1;a>=0;--a)c[a]=e(typeof t=="object"?t[a]:t,typeof r=="object"?r[a]:r,n,i+1,o);return c};se._foreach=function e(t,r,n,i){if(n===r.length-1){i(t);return}var o,a=r[n];for(o=a-1;o>=0;o--)e(t[o],r,n+1,i)};se._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var o,a=r[n],s=Array(a);for(o=a-1;o>=0;o--)s[o]=e(t[o],r,n+1,i);return s};se.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};se.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="};se.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"];se.mathfuns2=["atan2","pow","max","min"];se.ops1={neg:"-",not:"!",bnot:"~",clone:""};se.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi);","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]};(function(){var e,t;for(e=0;e<se.mathfuns2.length;++e)t=se.mathfuns2[e],se.ops2[t]=t;for(e in se.ops2)if(se.ops2.hasOwnProperty(e)){t=se.ops2[e];var r,n,i="";se.myIndexOf.call(se.mathfuns2,e)!==-1?(i="var "+t+" = Math."+t+`;
`,r=function(o,a,s){return o+" = "+t+"("+a+","+s+")"},n=function(o,a){return o+" = "+t+"("+o+","+a+")"}):(r=function(o,a,s){return o+" = "+a+" "+t+" "+s},se.opseq.hasOwnProperty(e+"eq")?n=function(o,a){return o+" "+t+"= "+a}:n=function(o,a){return o+" = "+o+" "+t+" "+a}),se[e+"VV"]=se.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),i),se[e+"SV"]=se.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),i),se[e+"VS"]=se.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),i),se[e]=se.compile(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+n("x","y")+`
}
return x;
`),se[t]=se[e],se[e+"eqV"]=se.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),i),se[e+"eqS"]=se.pointwise2(["ret[i]","x"],n("ret[i]","x"),i),se[e+"eq"]=se.compile(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+e+"eqV, S = numeric."+e+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(e=0;e<se.mathfuns2.length;++e)t=se.mathfuns2[e],delete se.ops2[t];for(e=0;e<se.mathfuns.length;++e)t=se.mathfuns[e],se.ops1[t]=t;for(e in se.ops1)se.ops1.hasOwnProperty(e)&&(i="",t=se.ops1[e],se.myIndexOf.call(se.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+`;
`),se[e+"eqV"]=se.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),se[e+"eq"]=se.compile("x",'if(typeof x !== "object") return '+t+`x
var i;
var V = numeric.`+e+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),se[e+"V"]=se.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),se[e]=se.compile("x",'if(typeof x !== "object") return '+t+`(x)
var i;
var V = numeric.`+e+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(e=0;e<se.mathfuns.length;++e)t=se.mathfuns[e],delete se.ops1[t];for(e in se.mapreducers)se.mapreducers.hasOwnProperty(e)&&(t=se.mapreducers[e],se[e+"V"]=se.mapreduce2(t[0],t[1]),se[e]=se.compile("x","s","k",t[1]+`if(typeof x !== "object") {    xi = x;
`+t[0]+`
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+e+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+t[0]+`
}
return accum;
`))})();se.inv=function(x){var r=se.dim(x),n=Math.abs,i=r[0],o=r[1],a=se.clone(x),s,c,l=se.identity(i),u,d,f,g,y,x;for(g=0;g<o;++g){var b=-1,w=-1;for(f=g;f!==i;++f)y=n(a[f][g]),y>w&&(b=f,w=y);for(c=a[b],a[b]=a[g],a[g]=c,d=l[b],l[b]=l[g],l[g]=d,x=c[g],y=g;y!==o;++y)c[y]/=x;for(y=o-1;y!==-1;--y)d[y]/=x;for(f=i-1;f!==-1;--f)if(f!==g){for(s=a[f],u=l[f],x=s[g],y=g+1;y!==o;++y)s[y]-=c[y]*x;for(y=o-1;y>0;--y)u[y]-=d[y]*x,--y,u[y]-=d[y]*x;y===0&&(u[0]-=d[0]*x)}}return l};se.det=function(t){var r=se.dim(t);if(r.length!==2||r[0]!==r[1])throw new Error("numeric: det() only works on square matrices");var n=r[0],i=1,o,a,s,c=se.clone(t),l,u,d,f,g,y,x;for(a=0;a<n-1;a++){for(s=a,o=a+1;o<n;o++)Math.abs(c[o][a])>Math.abs(c[s][a])&&(s=o);for(s!==a&&(f=c[s],c[s]=c[a],c[a]=f,i*=-1),l=c[a],o=a+1;o<n;o++){for(u=c[o],d=u[a]/l[a],s=a+1;s<n-1;s+=2)g=s+1,u[s]-=l[s]*d,u[g]-=l[g]*d;s!==n&&(u[s]-=l[s]*d)}if(l[a]===0)return 0;i*=l[a]}return i*c[a][a]};se.transpose=function(t){var r,n,i=t.length,o=t[0].length,a=Array(o),s,c,l;for(n=0;n<o;n++)a[n]=Array(i);for(r=i-1;r>=1;r-=2){for(c=t[r],s=t[r-1],n=o-1;n>=1;--n)l=a[n],l[r]=c[n],l[r-1]=s[n],--n,l=a[n],l[r]=c[n],l[r-1]=s[n];n===0&&(l=a[0],l[r]=c[0],l[r-1]=s[0])}if(r===0){for(s=t[0],n=o-1;n>=1;--n)a[n][0]=s[n],--n,a[n][0]=s[n];n===0&&(a[0][0]=s[0])}return a};se.negtranspose=function(t){var r,n,i=t.length,o=t[0].length,a=Array(o),s,c,l;for(n=0;n<o;n++)a[n]=Array(i);for(r=i-1;r>=1;r-=2){for(c=t[r],s=t[r-1],n=o-1;n>=1;--n)l=a[n],l[r]=-c[n],l[r-1]=-s[n],--n,l=a[n],l[r]=-c[n],l[r-1]=-s[n];n===0&&(l=a[0],l[r]=-c[0],l[r-1]=-s[0])}if(r===0){for(s=t[0],n=o-1;n>=1;--n)a[n][0]=-s[n],--n,a[n][0]=-s[n];n===0&&(a[0][0]=-s[0])}return a};se.norm2=function(t){return Math.sqrt(se.norm2Squared(t))};se.linspace=function(t,r,n){if(typeof n=="undefined"&&(n=Math.max(Math.round(r-t)+1,1)),n<2)return n===1?[t]:[];var i,o=Array(n);for(n--,i=n;i>=0;i--)o[i]=(i*r+(n-i)*t)/n;return o};se.getBlock=function(t,r,n){var i=se.dim(t);function o(a,s){var c,l=r[s],u=n[s]-l,d=Array(u);if(s===i.length-1){for(c=u;c>=0;c--)d[c]=a[c+l];return d}for(c=u;c>=0;c--)d[c]=o(a[c+l],s+1);return d}return o(t,0)};se.setBlock=function(t,r,n,i){var o=se.dim(t);function a(s,c,l){var u,d=r[l],f=n[l]-d;if(l===o.length-1)for(u=f;u>=0;u--)s[u+d]=c[u];for(u=f;u>=0;u--)a(s[u+d],c[u],l+1)}return a(t,i,0),t};se.getRange=function(t,r,n){var i=r.length,o=n.length,a,s,c=Array(i),l,u;for(a=i-1;a!==-1;--a)for(c[a]=Array(o),l=c[a],u=t[r[a]],s=o-1;s!==-1;--s)l[s]=u[n[s]];return c};se.blockMatrix=function(t){var r=se.dim(t);if(r.length<4)return se.blockMatrix([t]);var n=r[0],i=r[1],o,a,s,c,l;for(o=0,a=0,s=0;s<n;++s)o+=t[s][0].length;for(c=0;c<i;++c)a+=t[0][c][0].length;var u=Array(o);for(s=0;s<o;++s)u[s]=Array(a);var d=0,f,g,y,x,b;for(s=0;s<n;++s){for(f=a,c=i-1;c!==-1;--c)for(l=t[s][c],f-=l[0].length,y=l.length-1;y!==-1;--y)for(b=l[y],g=u[d+y],x=b.length-1;x!==-1;--x)g[f+x]=b[x];d+=t[s][0].length}return u};se.tensor=function(t,r){if(typeof t=="number"||typeof r=="number")return se.mul(t,r);var n=se.dim(t),i=se.dim(r);if(n.length!==1||i.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var o=n[0],a=i[0],s=Array(o),c,l,u,d;for(l=o-1;l>=0;l--){for(c=Array(a),d=t[l],u=a-1;u>=3;--u)c[u]=d*r[u],--u,c[u]=d*r[u],--u,c[u]=d*r[u],--u,c[u]=d*r[u];for(;u>=0;)c[u]=d*r[u],--u;s[l]=c}return s};se.epsilon=2220446049250313e-31;se.LU=function(e,t){t=t||!1;var r=Math.abs,n,i,o,a,s,c,l,u,d,f=e.length,g=f-1,y=new Array(f);for(t||(e=se.clone(e)),o=0;o<f;++o){for(l=o,c=e[o],d=r(c[o]),i=o+1;i<f;++i)a=r(e[i][o]),d<a&&(d=a,l=i);for(y[o]=l,l!=o&&(e[o]=e[l],e[l]=c,c=e[o]),s=c[o],n=o+1;n<f;++n)e[n][o]/=s;for(n=o+1;n<f;++n){for(u=e[n],i=o+1;i<g;++i)u[i]-=u[o]*c[i],++i,u[i]-=u[o]*c[i];i===g&&(u[i]-=u[o]*c[i])}}return{LU:e,P:y}};se.LUsolve=function(t,r){var n,i,o=t.LU,a=o.length,s=se.clone(r),c=t.P,l,u,d,f;for(n=a-1;n!==-1;--n)s[n]=r[n];for(n=0;n<a;++n)for(l=c[n],c[n]!==n&&(f=s[n],s[n]=s[l],s[l]=f),u=o[n],i=0;i<n;++i)s[n]-=s[i]*u[i];for(n=a-1;n>=0;--n){for(u=o[n],i=n+1;i<a;++i)s[n]-=s[i]*u[i];s[n]/=u[n]}return s};se.solve=function(t,r,n){return se.LUsolve(se.LU(t,n),r)};var Kn=se;var cQ=Math.pow(2,-52);function rI(e){for(let t of e)for(let r of t)if(!Zr(r))return!1;return!0}function AH(e){let t=[];for(let r of e)t.push(r.slice());return t}function nI(e){let{numRows:t,numCols:r}=yc(e),n=[];for(let i=0;i<r;i++)n.push([]);for(let i=0;i<t;i++)for(let o=0;o<r;o++)n[o].push(e[i][o]);return n}function yc(e){let t=e.length,r=t>0?e[0].length:0;return{numRows:t,numCols:r}}function vd(e){let{numRows:t,numCols:r}=yc(e);return t===r}function mv(e,t){var r=yc(e),n=yc(t);return r.numCols===n.numCols&&r.numRows===n.numRows}function iI(e){if(!vd(e))return!0;let t=ae(kL(e));return!isFinite(t)||t===0}function LL(){throw new Error("Matrix dimension mismatch")}function NL(){throw new Error("Expected square matrix")}function OH(e,t){mv(e,t)||LL();let r=[];for(let n=0;n<e.length;n++){let i=[];for(let o=0;o<e[n].length;o++)i.push(bo(e[n][o],t[n][o]));r.push(i)}return r}function LH(e,t){mv(e,t)||LL();let r=[];for(let n=0;n<e.length;n++){let i=[];for(let o=0;o<e[n].length;o++)i.push(Ro(e[n][o],t[n][o]));r.push(i)}return r}function xd(e,t){let r=yc(e),n=yc(t);r.numCols!==n.numRows&&LL();let i=[];for(let o=0;o<r.numRows;o++){let a=[];for(let s=0;s<n.numCols;s++){let c=Et(0,1);for(let l=0;l<e[o].length;l++)c=bo(c,Pi(e[o][l],t[l][s]));a.push(c)}i.push(a)}return i}function NH(e,t){if(vd(e)||NL(),t=ae(t),t!==Math.floor(t))throw new Error("Cannot raise a matrix to a fractional power");let r=lQ(yc(e).numCols);if(t===0)return r;t<0&&(t=-t,e=VL(e));let n=r;for(;t>1;)t%2===1?(n=xd(e,n),e=xd(e,e),t=(t-1)/2):(e=xd(e,e),t=t/2);return xd(e,n)}function RL(e,t){let r=[];for(let n of e){let i=[];for(let o of n)i.push(Pi(o,t));r.push(i)}return r}function RH(e,t){let r=[];for(let n of e){let i=[];for(let o of n)i.push(yo(o,t));r.push(i)}return r}function kH(e){let t=[];for(let r of e){let n=[];for(let i of r)n.push(ko(i));t.push(n)}return t}function kL(e){let{determinant:t}=FL(AH(e));return t}function VH(e){vd(e)||NL();let{numRows:t}=yc(e),r=Et(0,1);for(let n=0;n<t;n++)r=bo(r,e[n][n]);return r}function VL(e){if(vd(e)||NL(),iI(e))throw new Error("Cannot invert a singular matrix");let{numRows:t,numCols:r}=yc(e),n=[];for(let o=0;o<t;o++){let a=e[o].slice();for(let s=0;s<r;s++)a.push(Et(o===s?1:0,1));n.push(a)}FL(n);let i=[];for(let o of n)i.push(o.slice(r));return i}function lQ(e){let t=[];for(let r=0;r<e;r++){let n=[];for(let i=0;i<e;i++)n.push(Et(r===i?1:0,1));t.push(n)}return t}function oI(e){let t=AH(e);return FL(t),t}function uQ(e){let t=0;for(let r of e)for(let n of r){let i=Math.abs(ae(n));if(!isFinite(i))return NaN;i>t&&(t=i)}return t}function _H(e){for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)e[t][r]=NaN}function FL(e){let{numRows:t,numCols:r}=yc(e),n=uQ(e);if(!isFinite(n))return _H(e),{determinant:NaN,rank:0};let i=Math.max(t,r)*n*cQ,o=Et(1,1),a=0,s=0;for(;a<t&&s<r;){let c=a,l=Math.abs(ae(e[a][s]));for(let d=a+1;d<t;d++){let f=Math.abs(ae(e[d][s]));(!isFinite(f)||f>l)&&(l=f,c=d)}if(!isFinite(l))return _H(e),{determinant:NaN,rank:0};if(l===0){o=Et(0,1),s+=1;continue}if(!Zr(e[c][s])&&l<i){for(let d=a;d<t;d++)e[a][d]=0;o=0,s+=1;continue}if(c!==a){o=ko(o);let d=e[a];e[a]=e[c],e[c]=d}for(let d=0;d<t;d++){if(d===a)continue;let f=yo(e[d][s],e[a][s]);e[d][s]=Et(0,1);for(let g=s+1;g<r;g++)e[d][g]=Ro(e[d][g],Pi(f,e[a][g]))}let u=e[a][s];o=Pi(o,u),e[a][s]=Et(1,1);for(let d=s+1;d<r;d++)e[a][d]=yo(e[a][d],u);a+=1,s+=1}return{rank:a,determinant:a===t&&a===r?o:Et(0,1)}}function dQ(e,t){let r=e.length,n=t.length,i=0,o=0;for(let s=n-r;s<n;s++)i+=e[s+r-n]*t[s],o+=e[s+r-n]*e[s+r-n];let a=i/o;for(let s=n-r;s<n;s++)t[s]=2*a*e[s+r-n]-t[s]}function pQ(e,t,r){let n=e.length,i=t.length,o=0,a=0;for(let c=i-n;c<i;c++)o+=e[c+n-i]*t[c][r],a+=e[c+n-i]*e[c+n-i];let s=o/a;for(let c=i-n;c<i;c++)t[c][r]=2*s*e[c+n-i]-t[c][r]}function gQ(e,t,r,n){let i=Array(e.length-t);if(i.length===1)return i[0]=1,i;if(n===0){i[0]=1;for(let a=1;a<i.length;a++)i[a]=0;return i}let o=e[t][r]<0?-1:1;i[0]=e[t][r]+o*Math.sqrt(n);for(let a=t+1;a<e.length;a++)i[a-t]=e[a][r];return i}function fQ(e,t,r){let n=0;for(;t<e.length;t++)n+=e[t][r]*e[t][r];return n}function aI(e,t){if(!t||!t.mutateInput){let o=e;e=Array(e.length);for(let a=0;a<o.length;a++)e[a]=o[a].slice()}let r=Math.min(e.length,e[0].length),n=Array(r),i=[];for(let o=0;o<r;o++){let a=-1/0,s=o;for(let l=o;l<e[o].length;l++){let u=fQ(e,o,l);u>a&&(a=u,s=l)}if(n[o]=s,s!==o)for(let l=0;l<e.length;l++){let u=e[l][s];e[l][s]=e[l][o],e[l][o]=u}let c=gQ(e,o,o,a);for(let l=o;l<e[o].length;l++)pQ(c,e,l);i.push(c)}return{reflectors:i,r:e,p:n}}function GH(e,t,r){let{reflectors:n,r:i,p:o}=e,a=t.slice();for(let l=0;l<n.length;l++)dQ(n[l],a);for(let l=n.length;l<i[0].length;l++)a[l]=0;a.length=i[0].length;let s=Math.pow(2,-52),c=r.regularize?s*Math.abs(i[0][0])*Math.max(i.length,i[0].length):0;for(let l=n.length-1;l>=0;l--){let u=i[l];if(Math.abs(u[l])<=c)a[l]=0;else{for(let d=l+1;d<n.length;d++)a[l]-=a[d]*u[d];a[l]/=u[l]}}for(let l=o.length-1;l>=0;l--)if(o[l]!==l){let u=a[l];a[l]=a[o[l]],a[o[l]]=u}return a}function mQ(e,t,r){let n=Array(e.r[0].length);for(let o=0;o<n.length;o++)n[o]=Array(t[0].length);let i=Array(t.length);for(let o=0;o<t[0].length;o++){for(let s=0;s<t.length;s++)i[s]=t[s][o];let a=GH(e,i,r);for(let s=0;s<a.length;s++)n[s][o]=a[s]}return n}function _f(e,t,r){return Array.isArray(t[0])?mQ(e,t,r):GH(e,t,r)}function hQ(e){let t=e.r,r=Math.min(t.length,t[0].length),n=t[0][0],i=t[r-1][r-1];return n===0?1/0:Math.abs(n/i)}function BH(e){let t=Math.pow(2,-52);return Math.max(e.r.length,e.r[0].length)*t*hQ(e)<1}function cI(e,t){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function Hp(e,t){let r=Up(e,t),n=0;for(let i of r){let o=i;n+=o*o}return n/r.length}function Up(e,t){return e.apply(void 0,t)}function sI(e,t){let r=[];for(let n of e){let i=n.apply(void 0,t);r.push(i)}return r}function qH(e,t){let r=[];for(let n=0;n<e.length;n++)t[n]&&r.push(e[n]);return r}function GL(e,t,r){let n=[];for(let i=0,o=0;i<e.length;i++){let a=0;r[i]&&(a=t[o],o+=1),n.push(e[i]+a)}return n}function zL(e,t){let r=t.solution.map(c=>Math.abs(c)<1e-6?0:c),n=t.solution.map(()=>0),i=Hp(e,r),o=Up(e,r),a=Up(e,n),s=0;for(let c=0;c<o.length;c++){let l=a[c]*1e-15;s+=Math.abs(o[c]*l)+l*l}return s/=o.length,isFinite(s)||(s=0),isFinite(t.MSE)&&!isFinite(i)?t:i<=t.MSE+s?{solution:r,MSE:i}:t}function UL(e,t){if(!rI(t)||!rI([e]))return;let r=nI(t),n=xd([e],r)[0],i=xd(t,r);for(let l=0;l<n.length;l++)i[l].push(ko(n[l]));let o=oI(i);if(!rI(o))return;let a=[],s=n.length,c=0;for(let l of o)for(;c<s;)if(ae(l[c])===1){a.push(l[l.length-1]),c++;break}else a.push(Et(0,1)),c++;for(;c<s;)a.push(Et(0,1)),c++;return a}function HL(e,t){let r=cI(0,t.length),n=sI(t,r),i=aI(Kn.transpose(n),{mutateInput:!0});for(var o=0;o<2;o++){let l=Up(e,r),u=Kn.neg(_f(i,l,{regularize:!1}));r=Kn.add(r,u)}let a=Hp(e,r);if(BH(i))return{solution:r,MSE:a};let s=cI(0,t.length);for(var o=0;o<2;o++){let u=Up(e,s),d=Kn.neg(_f(i,u,{regularize:!0}));s=Kn.add(s,d)}let c=Hp(e,s);return .999*c<=a?{solution:s,MSE:c}:{solution:r,MSE:a}}function BL(e,t,r,n){let i=n.maxIterations,o=n.linearSubset||cI(!1,r.length),a=Kn.not(o),s=qH(t,o),c=qH(t,a),l=2,u=.1,d=r,f=0,g=.001,y;if(Kn.any(o)){let w=Kn.transpose(sI(s,d)),E=aI(w);y={Jv:w,F:E};let I=Up(e,d),S=Kn.neg(_f(E,I,{regularize:!0}));d=GL(d,S,o)}let x=!1,b=Hp(e,d);for(;f<i&&!x&&isFinite(b);){let w=Up(e,d),E=sI(c,d),I=Kn.transpose(E),S,D;if(y){let{F:A,Jv:R}=y;S=Kn.dot(E,Kn.sub(w,Kn.dot(R,_f(A,w,{regularize:!0})))),D=Kn.dot(E,Kn.sub(I,Kn.dot(R,_f(A,I,{regularize:!0}))))}else S=Kn.dot(E,w),D=Kn.dot(E,I);let O=d,_=!1;for(;f<i&&!x&&!_;){f+=1;let A=Kn.add(D,Kn.diag(cI(g,c.length))),R=Kn.neg(Kn.solve(A,S,!0));O=GL(d,R,a),x=Kn.all(Kn.eq(O,d));let W;if(y){let Q=Kn.transpose(sI(s,O)),ce=aI(Q);W={Jv:Q,F:ce};let ee=Up(e,O),pe=Kn.neg(_f(ce,ee,{regularize:!0}));O=GL(O,pe,o)}let j=Hp(e,O);_=j<b,_?(d=O,b=j,y=W,g*=u):(g=Math.max(g,1e-64),g*=l)}}return{solution:d,MSE:b}}var qL=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500],yQ=function(e){let t=e*503%qL.length;return qL[t]},bQ=function(e){let t=[];for(let r=0;r<qL.length;r++){let n=[];for(let i=0;i<e;i++)r===0&&e!==1?n[i]=0:r===1&&e!==1?n[i]=1:n[i]=yQ(r*e+i);t.push(n)}return t},zH=function(e,t,r,n,i){let o=[];for(let s of r)o.push({soln:BL(e,t,s,i),initialGuess:s});o.sort(function(s,c){return isNaN(s.soln.MSE)?1:isNaN(c.soln.MSE)?-1:s.soln.MSE-c.soln.MSE});let a=[];for(let s=0;s<n;s++)a.push(o[s].initialGuess);return a};function xQ(e,t,r,n){if(!t||Wa(t))return e;let i=t.bounds;return i[0]===-1/0&&i[1]===1/0?e:i[0]===-1/0?i[1]-Math.exp(-e):i[1]===1/0?i[0]+Math.exp(e):r/(n-1)*i[1]+(n-1-r)/(n-1)*i[0]}var UH=[3,5,7,11,13,17,19];function vQ(e,t){let r=[];for(let i=0;i<e.length;i++){let o=e[i],a=[];for(let s=0;s<o.length;s++){var n=UH[s%UH.length]*i%e.length;a.push(xQ(o[s],t[s],n,e.length))}r.push(a)}return r}function HH(e,t,r){r||(r={});let{linearSubset:n,bounds:i,preferredInitialGuess:o}=r,a=bQ(t.length);i&&(a=vQ(a,i));let s=zH(e,t,a,5,{maxIterations:3,linearSubset:n}),c=zH(e,t,s,1,{maxIterations:60,linearSubset:n}),l=BL(e,t,c[0],{maxIterations:250,linearSubset:n});if(!o)return l;let u=BL(e,t,o,{maxIterations:100,linearSubset:n});return isFinite(u.MSE)&&(u.MSE<l.MSE||Bs(u.MSE,l.MSE,8))?u:l}function Lr(e,t){switch(e){case C:case tt:return new N.Constant(t);case lr:return new N.Seed(t);case z:case $:return new N.ParenSeq([Lr(C,t[0]),Lr(C,t[1])]);case oe:return new N.ParenSeq([Lr(C,t[0]),Lr(C,t[1]),Lr(C,t[2])]);case Mr:return new N.FunctionCall("segment",[Lr(oe,t[0]),Lr(oe,t[1])]);case Pt:return new N.FunctionCall("vector",[Lr(oe,t[0]),Lr(oe,t[1])]);case Hn:return new N.FunctionCall("triangle",[Lr(oe,t[0]),Lr(oe,t[1]),Lr(oe,t[2])]);case $n:return new N.FunctionCall("sphere",[Lr(oe,t[0]),Lr(C,t[1])]);case gn:return new N.FunctionCall("rgb",[Lr(C,t[0]),Lr(C,t[1]),Lr(C,t[2])]);case et:return new N.FunctionCall("polygon",[Lr(on,t)]);case Ye:return new N.FunctionCall("segment",[Lr(z,t[0]),Lr(z,t[1])]);case Re:return new N.FunctionCall("line",[Lr(z,t[0]),Lr(z,t[1])]);case ot:return new N.FunctionCall("ray",[Lr(z,t[0]),Lr(z,t[1])]);case Ve:return new N.FunctionCall("mathVector",[Lr(z,t[0]),Lr(z,t[1])]);case We:return new N.FunctionCall("circle",[Lr(z,t[0]),Lr(C,t[1])]);case Oe:return new N.FunctionCall("arc",[Lr(z,t[0]),Lr(z,t[1]),Lr(z,t[2])]);case st:return new N.FunctionCall("angle",[Lr(z,t[0]),Lr(C,t[1]),Lr(C,t[2])]);case $e:return new N.FunctionCall("directedangle",[Lr(z,t[0]),Lr(C,t[1]),Lr(C,t[2])]);case Rt:case ke:case vi:case Dn:case on:case uo:case ti:case zn:case Ei:case li:case Ii:case Un:case ri:case wi:case ci:case ji:case Zi:case Qi:case Ji:case No:case Lo:{let n=[],i=It(e);for(let o of t)n.push(Lr(i,o));return new N.List(n)}case nn:case cr:case vn:case Ti:case nr:case xt:case Oo:case wl:case Ni:case ki:case Ri:case po:case fo:case go:case jo:case ea:case Zo:case Jo:case ta:case Qo:case ir:case gs:throw new Error(`Programming error: cannot create parse node from valueType: ${xr(e)}`);case In:return new N.FunctionCall("tone",[Lr(C,t[0]),Lr(C,t[1])]);default:let r=e;throw new Error(`Programming error: unexpected valueType: ${xr(r)}`)}}function $L(e){return{chunk:e,isLazy:!0}}function $H(e){return e.slice()}function uI(e){if(!e.isLazy)return e;let t=e.chunk.copy();return t.reopenFinalBlock(),{chunk:t,forwardParameterMap:$H,reverseParameterMap:$H,isLazy:!1,valueMap:PQ(e.chunk.instructionsLength()),replacementMask:oy(e.chunk.argNames.length)}}function YH(e){let{chunk:t,forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:o,replacementMask:a,didShiftScale:s}=e;return{chunk:t.copy(),forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:o.slice(),replacementMask:a.slice(),didShiftScale:s}}function TQ(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function KH(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r);if(i.args.length!==2)return;let o=i.args[0],a=i.args[n],s=[],c=[];s.push(o),c.push({min:1,max:Al(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list"),length:Al(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list")});let l=!1,u=!1;for(let b=o+1;b<=a;b++){let w=e.getInstruction(b);if(w.type===39||w.type===41||w.type===40){if(w.args[1]!==o)continue;let E=w.args[0];if(e.getInstruction(E).valueType!==ke||!kt(e.getInstruction(E)))continue;let I=wn(e,E),S=TQ(I);if(!isFinite(S.min)||!isFinite(S.max))continue;s.push(b),c.push(S)}else if(w.type===37)w.symbol==="exp"?u=!0:XH(w)&&(l=!0);else if(w.type===12||w.type===13)u=!0;else if(Fo(w)||ia(w))return}if(s.length===0||!u&&!l)return;let d=[];for(let b=0;b<=a;b++){let w=s.indexOf(b);if(w!==-1){let E=oy(s.length);E[w]=!0,d.push(E)}else d.push(lI(e,d,s.length,b))}let f=[];for(let b=0;b<=e.getReturnIndex();b++)if(e.getInstruction(b).type===2){let E=oy(e.argNames.length);E[b]=!0,f.push(E)}else f.push(lI(e,f,e.argNames.length,b));let g={listAccessDependencyTable:d,listAccesses:s,listStatisticsTable:c},y;for(let b=o+1;b<=e.getReturnIndex();b++){let w=e.getInstruction(b);switch(w.type){case 37:{if(w.symbol==="exp"){let pe=w.args[0],re=YL(g,pe);if(re===void 0){Td(e,f,y,b);break}let{listStatistics:k,listAccessIndex:Ke}=re,ht=hv($L(e),b,pe,Ke,k);ht?y=[ht]:Td(e,f,y,b)}break}case 12:case 13:{let[pe,re]=w.args,k=YL(g,re);if(k===void 0||WH(g,pe)){Td(e,f,y,b);break}let{listStatistics:Ke,listAccessIndex:ht}=k,Ze=EQ($L(e),b,ht,Ke);Ze?y=[Ze]:Td(e,f,y,b);break}case 10:if(y&&y.length>1){Td(e,f,y,b);break}let E=y&&y.length>0?y[0]:$L(e),[I,S]=w.args,D=E.isLazy?I:E.valueMap[I],O=E.isLazy?S:E.valueMap[S],_=E.chunk.getInstruction(D),A=E.chunk.getInstruction(O),R,W,j;if(_.type===37)R=I,j=_,W=S;else if(A.type===37)R=S,j=A,W=I;else{Td(e,f,y,b);break}let Q=YL(g,R);if(Q===void 0||WH(g,W)){Td(e,f,y,b);break}let{listAccessIndex:ce,listStatistics:ee}=Q;if(j.symbol==="exp"){let pe=IQ(E,b,W,R,ce,ee);if(pe){y=pe;break}}else if(XH(j)){let pe=wQ(E,b,W,R,ce);if(pe){y=[pe];break}}Td(e,f,y,b);break;default:{Td(e,f,y,b);break}}}if(y===void 0||y.length===0)return;let x=[];for(let b of y)x.push({chunk:b.chunk,forwardParameterMap:b.forwardParameterMap,reverseParameterMap:b.reverseParameterMap});return x}function Td(e,t,r,n){if(r===void 0)return;let i=e.getInstruction(n);if(pt(i))for(let o of r)o.valueMap[n]=n;else for(let o of r){let{chunk:a,valueMap:s}=o,c=[],l=0;for(let u of i.args){if(s[u]!==u){if(l+=1,l>1){r.length=0;return}}else{let d=t[u];for(let f=0;f<d.length;f++)if(d[f]&&o.replacementMask[f]){r.length=0;return}}c.push(s[u])}s[n]=l>0?Yn(a,i,c):n}}function YL(e,t){let{listAccessDependencyTable:r,listAccesses:n,listStatisticsTable:i}=e,o,a=r[t];for(let s=0;s<a.length;s++)if(a[s]){if(o)return;o={listAccessIndex:n[s],listStatistics:i[s]}}return o}function WH(e,t){let{listAccessDependencyTable:r}=e,n=r[t];for(let i of n)if(i)return!0;return!1}function WL(e,t){let r=[];for(let o=0;o<=t;o++)if(e.getInstruction(o).type===2){let s=oy(e.argNames.length);s[o]=!0,r.push(s)}else r.push(lI(e,r,e.argNames.length,o));let n,i=r[t];for(let o=0;o<i.length;o++)if(i[o]){if(n!==void 0)return;n=o}return n}function wQ(e,t,r,n,i){let o=e.chunk,a=WL(o,r);if(a===void 0)return;let s=XL(e,r,a);if(s===void 0)return;let c=o.getInstruction(n),l=c.args[0];if(s=jH(s,l,i),s===void 0)return;let{chunk:u,valueMap:d}=s,f=u.getInstruction(d[l]);if(f.type!==8)return;let g=f.args[1],y=u.getInstruction(f.args[0]);if(y.type!==10)return;let[x,b]=y.args,w=a,E=g,I=x,S=b,D=u.Multiply([I,S]),O=u.NativeFunction("cos",[D]),_=u.NativeFunction("sin",[D]),A=c.symbol==="sin"?u.Add([u.Multiply([w,_]),u.Multiply([E,O])]):u.Subtract([u.Multiply([w,O]),u.Multiply([E,_])]);d[t]=A;function R(Q){let ce=s.forwardParameterMap(Q),ee=ce[a],pe=ce[g],re=ee*Math.cos(pe),k=ee*Math.sin(pe);return ce[a]=re,ce[g]=k,ce}function W(Q){let ce=Q.slice(),ee=Q[a],pe=Q[g],re=xa(ee,pe),k=Math.atan2(pe,ee);return ce[a]=re,ce[g]=k,s.reverseParameterMap(ce)}let j=s.replacementMask.slice();return j[a]=!0,j[x]=!0,j[g]=!0,{chunk:u,forwardParameterMap:R,reverseParameterMap:W,valueMap:d,replacementMask:j,isLazy:!1}}function EQ(e,t,r,n){let i=e.chunk,o=i.getInstruction(t),[a,s]=o.args,c=i.getInstruction(a);if(c.type===1&&c.valueType===C&&ae(c.value)>0){let E=uI(e),{chunk:I,valueMap:S}=E,D=I.Multiply([I.NativeFunction("ln",[S[a]]),S[s]]);return S[s]=D,S[t]=I.NativeFunction("exp",[D]),hv(E,t,s,r,n)||E}let l=WL(i,a);if(l===void 0)return;let u=XL(e,a,l);if(u===void 0)return;let{chunk:d,valueMap:f}=u,g=d.Multiply([f[a],f[s]]);f[s]=g,f[t]=d.NativeFunction("exp",[g]);function y(E){let I=u.forwardParameterMap(E),S=I[l],D=Math.log(S);return I[l]=D,I}function x(E){let I=E.slice(),S=I[l],D=Math.exp(S);return I[l]=D,u.reverseParameterMap(I)}let b=u.replacementMask.slice();b[l]=!0;let w={chunk:d,forwardParameterMap:y,reverseParameterMap:x,isLazy:!1,valueMap:f,replacementMask:b};return hv(w,t,s,r,n)||w}function IQ(e,t,r,n,i,o){if(!e.isLazy&&e.didShiftScale)return;let a=e.isLazy?e:YH(e),s=e.chunk,c=WL(s,r);if(c===void 0)return;let l=XL(e,r,c);if(l===void 0)return;let{chunk:u,valueMap:d}=l,f=u.getInstruction(d[n]).args[0],g=u.Add([f,d[r]]);d[r]=g,d[t]=u.NativeFunction("exp",[g]);function y(O){let _=l.forwardParameterMap(O),A=_[c],R=Math.log(A);return _[c]=R,_}function x(O){let _=O.slice(),A=_[c],R=Math.exp(A);return _[c]=R,l.reverseParameterMap(_)}function b(O){let _=l.forwardParameterMap(O),A=_[c],R=Math.log(-A);return _[c]=R,_}function w(O){let _=O.slice(),A=_[c],R=-Math.exp(A);return _[c]=R,l.reverseParameterMap(_)}let E=l.replacementMask.slice();E[c]=!0;let I=uI(a);I.valueMap[t]=I.chunk.Multiply([I.valueMap[r],I.valueMap[n]]);let S={chunk:u,forwardParameterMap:y,reverseParameterMap:x,isLazy:!1,valueMap:d,replacementMask:E},D=YH(S);return D.forwardParameterMap=b,D.reverseParameterMap=w,S=hv(S,t,r,i,o)||S,D=hv(D,t,r,i,o)||D,D.valueMap[t]=D.chunk.Negative([D.valueMap[t]]),[I,S,D]}function hv(e,t,r,n,i){let o=CQ(e,r,n,i);if(o!==void 0)return o.valueMap[t]=o.chunk.NativeFunction("exp",[o.valueMap[r]]),o}function CQ(e,t,r,n){let i=jH(e,t,r);if(i===void 0)return;let{chunk:o,valueMap:a}=i,s=o.getInstruction(a[t]);if(s.type!==8)return;let c=s.args[1],l=o.getInstruction(s.args[0]);if(l.type!==10)return;let[u,d]=l.args,{min:f,max:g}=n,y=g-f,x=.5*(g+f),b=o.Divide([o.Subtract([d,o.Constant(x)]),o.Constant(y)]),w=o.Add([o.Multiply([u,b]),c]);a[t]=w;function E(S){let D=i.forwardParameterMap(S),O=D[u],_=D[c],A=O*y,R=_+x*O;return D[u]=A,D[c]=R,D}function I(S){let D=S.slice(),O=S[u],_=S[c],A=O/y,R=_-A*x;return D[u]=A,D[c]=R,i.reverseParameterMap(D)}return{chunk:o,forwardParameterMap:E,reverseParameterMap:I,isLazy:!1,valueMap:a,replacementMask:i.replacementMask,didShiftScale:!0}}function XL(e,t,r){let n=e.chunk,i=Bo(n,r,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Fr(i,t)!==1)return;let o=zc(i,t),[a,s]=kn(o,t);if(s===void 0)return;let c=o.newChunk.getInstruction(a);if(c.type!==1||c.valueType!==C)return;let l=o.newChunk.getInstruction(s);if(l.type!==1||l.valueType!==C)return;let u=uI(e),{chunk:d,valueMap:f}=u,g=ae(c.value),y=ae(l.value);f[t]=r;function x(E){let I=u.forwardParameterMap(E),S=I[r],D=g+y*S;return I[r]=D,I}function b(E){let I=E.slice(),D=(I[r]-g)/y;return I[r]=D,u.reverseParameterMap(I)}let w=u.replacementMask.slice();return w[r]=!0,{chunk:d,forwardParameterMap:x,reverseParameterMap:b,isLazy:!1,valueMap:f,replacementMask:w}}function jH(e,t,r){let n=e.chunk,i=e.isLazy?t:e.valueMap[t],o=Bo(n,r,{allowRestriction:!1,allowClosedBlockReferences:!0});if(Fr(o,i)!==1)return;e.isLazy&&(o=Bo(n.copy().reopenFinalBlock(),r,{allowRestriction:!1,allowClosedBlockReferences:!1}));let a=zc(o,i),[s,c]=kn(a,i);if(c===void 0)return;let l=a.newChunk,u=Math.max(c,s),d=[];for(let Te=0;Te<=u;Te++)if(l.getInstruction(Te).type===2){let yt=oy(l.argNames.length);yt[Te]=!0,d.push(yt)}else d.push(lI(l,d,l.argNames.length,Te));let f,g;for(let Te=0;Te<n.argNames.length;Te++)if(d[c][Te])if(f===void 0)f=Te;else return;else if(d[s][Te])if(g===void 0)g=Te;else return;if(f===void 0||g===void 0)return;let y=Bo(l,f,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Fr(y,c)!==1)return;let x=Bo(l,g,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Fr(x,s)!==1)return;let b=zc(y,c),w=zc(x,s),[E,I]=kn(b,c),S=b.newChunk.getInstruction(E);if(S.type!==1||S.valueType!==C)return;let D=b.newChunk.getInstruction(I);if(D.type!==1||D.valueType!==C)return;let O=uI(e),{chunk:_,valueMap:A}=O,R=_.Add([_.Multiply([f,r]),g]);A[t]=R;let W=l.copy();W.List([c,s]);let j=W.getCompiledFunction().fn;function Q(Te){let Vt=O.forwardParameterMap(Te),[yt,qe]=j.apply(null,Vt);return Vt[f]=yt,Vt[g]=qe,Vt}let ce=ae(S.value),ee=ae(D.value),[pe,re]=kn(w,s),k=w.newChunk.copy();k.List([pe,re]);let Ke=k.getCompiledFunction().fn;function ht(Te){let Vt=Te.slice(),yt=Te[f],qe=Te[g],at=(yt-ce)/ee,Ne=Te.slice();Ne[f]=at,Ne.splice(g,1);let[he,ie]=Ke.apply(null,Ne),ct=(qe-he)/ie;return Vt[f]=at,Vt[g]=ct,O.reverseParameterMap(Vt)}let Ze=O.replacementMask.slice();return Ze[f]=!0,Ze[g]=!0,{chunk:_,forwardParameterMap:Q,reverseParameterMap:ht,isLazy:!1,valueMap:A,replacementMask:Ze}}function lI(e,t,r,n){let i=e.getInstruction(n),o=oy(r);if(pt(i))return o;for(let a of i.args){let s=t[a];for(let c=0;c<s.length;c++)o[c]=o[c]||s[c]}return o}function oy(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function PQ(e){let t=[];for(let r=0;r<e;r++)t.push(r);return t}function XH(e){return e.type===37&&(e.symbol==="sin"||e.symbol==="cos")}function n5(e,t){try{return SQ(e,t)}catch(r){return r instanceof N.Error?r:Ie(r)}}var ay={coerceToNumber:"all"},KL={...ay,wrapInList:!0};function SQ(e,t){let{policy:r,frame:n,exportFrame:i,lastExportFrame:o,priorAnalysis:a}=e,s=t._lhs.buildIRExpression(r,n,ay),c=t._rhs.buildIRExpression(r,n,ay);if(s.isError)throw s;if(c.isError)throw c;if(s.valueType!==C&&s.valueType!==ke||c.valueType!==C&&c.valueType!==ke)throw AM([dt(s.valueType),dt(c.valueType)]);let l=t._difference.buildIRExpression(r,n,KL);if(l.isError)throw l;for(let D of l.getDependencies())if(!r.validRegressionParameter(D))throw n_(D);let u=DQ(l.getDependencies(),t.userData.regressionParameters,o),{parameters:d,residuals:f,isLinear:g,parameterWarning:y}=r5(u,l),x={policy:r,frame:n},b=ZH(x,t,d),w=OQ(t,s,b),E;if(t.userData.isLogModeRegression&&(w===Ma.LOGLIN||w===Ma.LOGLOG)){let D=t._logDifference.buildIRExpression(r,n,KL);if(D.isError)throw D;let O=t._logLhs.buildIRExpression(r,n,KL);if(O.isError)throw O;({parameters:d,isLinear:g,parameterWarning:y}=r5(u,D)),b=ZH(x,t,d),f=t5(x,t._difference,d);let _=t5(x,t._logDifference,d);E=e5(t,O,b,_,t.userData.isLogModeRegression,w)}else E=e5(t,s,b,f,t.userData.isLogModeRegression,w);let I=MQ(t,i),S=AQ(t,I,a,r);return t.userData.residualVariable=ni(I),new N.OptimizedRegression(d,Lr(ke,f),E,b.substituted,{isModelValid:b.isValid,residualVariable:I,residualSuggestionId:S,shouldSuggestLogMode:w!==Ma.NONE,isLinear:g,parameterWarning:y})}function MQ(e,t){if(e.userData&&e.userData.residualVariable){let o=Mg(e.userData.residualVariable);if(!t[o])return o}let r=e.getDependencies().filter(o=>o[0]!=="_"),n;for(let o of r){let a=o.match(/_(.*)/);if(a&&(n="e_"+a[1],!t[n]))return n}let i=1;for(;;){if(n="e_"+i,!t[n])return n;i++}}function ZH({policy:e,frame:t},r,n){let i=r._rhs.getDependencies(),o,a;for(let d of i){if(n.hasOwnProperty(d))continue;let f=t[d];if(!f||(f.type==="Assignment"&&(f=f._expression),!f.buildIRExpression))continue;let g=f.buildIRExpression(e,t,ay);if(!g.isError&&g.valueType===ke){if(o!==void 0){o=void 0,a=void 0;break}g.getDependencies().length===0&&(o=d,a=g)}}let s=Fi(t);o!==void 0&&(s[o]=void 0);let c=r._rhs.buildIRExpression(e,s,ay),l=Fi(s);for(let d of _n(n))l[d]=n[d];let u=r._rhs.buildIRExpression(e,l,ay);return a?{node:c,substituted:u,listNode:a,isValid:!0}:{node:c,substituted:u,listNode:a,isValid:!1}}function DQ(e,t,r){let n=[];t||(t={}),r||(r={});for(let i of e){let o=ni(i),a=r[i];a&&isFinite(a.asValue())?n.push(+a.asValue()):t.hasOwnProperty(o)&&isFinite(+t[o])?n.push(+t[o]):n.push(1)}return n}function JH(e,t){let r=t.getDependencies(),n=t.getCompiledFunction(r).fn;if(r.length){let i=t.findLinearSubset(r),o=i.every(s=>s),a=[];for(let s of r)a.push(t.takeDerivative(s).getCompiledFunction(r).fn);if(o){let s=r.map(()=>Et(0,1)),c=t.interpretWithParameters(s),l=[];for(let g of r)l.push(t.takeDerivative(g).interpretWithParameters(s));let u=UL(c,l);if(u){let g=t.interpretWithParameters(u);return{solution:u,residuals:g,MSE:ZL(g),isLinear:o}}let{solution:d,MSE:f}=zL(n,HL(n,a));return{solution:d,residuals:n.apply(void 0,d),MSE:f,isLinear:o}}else{let s=[];for(let d of r)s.push(t.boundDomain(d));let c={linearSubset:i,bounds:s,preferredInitialGuess:e},{solution:l,MSE:u}=zL(n,HH(n,a,c));return{solution:l,residuals:n.apply(void 0,l),MSE:u,isLinear:o}}}else return{solution:[],residuals:t.interpretWithParameters([]),MSE:Hp(n,[]),isLinear:!0}}function QH(e,t){let r={},n=t.getDependencies();for(let i=0;i<n.length;i++){let o=new N.RegressionParameter(e[i]);r[n[i]]=o}return r}function e5(e,t,r,n,i,o){let a=ZL(n);if(!isFinite(a))throw i_();if(t.getDependencies().length>0)return{RMSE:Math.sqrt(a)};let s=xe(t.valueType)?Rx(t.asValue()):0;if(t.getDependencies().length||!isFinite(s)||s<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(a)};{let c=1-a/s;if(r.isValid){let l=[],u=[],d=i&&(o===Ma.LINLOG||o===Ma.LOGLOG);N.List.eachArgs([r.listNode,t],function(g){let y=g[0].isConstant?g[0].asCompilerValue():NaN,x=g[1].isConstant?g[1].asCompilerValue():NaN;l.push(d?Math.log(ae(y)):y),u.push(x)});let f=_w(l.map(g=>ae(g)),u.map(g=>ae(g)));if(Bs(_Q(l,u).MSE,a,8))return{r:f,rsquared:f*f}}return{Rsquared:c}}}function _Q(e,t){let r=t,n=[e.map(s=>ko(s)),e.map(()=>Et(-1,1))],i=UL(r,n);if(i){let[s,c]=i,l=[];for(let u=0;u<t.length;u++)l.push(Ro(t[u],bo(Pi(s,e[u]),c)));return{solution:i,MSE:ZL(l)}}function o(s,c){let l=[];for(let u=0;u<e.length;u++)l.push(ae(t[u])-(s*ae(e[u])+c));return l}return HL(o,[function(){return e.map(function(s){return-ae(s)})},function(){return e.map(function(){return-1})}])}function AQ(e,t,r,n){let i=e._rhs.getDependencies(),o;for(let a in r){if(!r.hasOwnProperty(a))continue;let s=r[a].concreteTree;if(!oE(s)||!s.columns[0])continue;let c=r[a].rawTree.columns;if(!c||!c.length)continue;let l=c[0].getExports(n);if(l.length===1&&i.indexOf(l[0])!==-1){for(let u=1;u<c.length;u++)if(c[u].getDependencies().indexOf(t)!==-1)return;o=o||a}}return o||void 0}function jL(e,t){let r=e.length,n=e[0],i=t[0],o=e[r-1],a=t[r-1];if(!isFinite(n)||!isFinite(o)||!isFinite(i)||!isFinite(a)||a-i===0)return!1;let s=o-n;if(s===0)return!1;for(let c=1;c<r-1;c++){let l=e[c],u=t[c],d=(a*(l-n)+i*(o-l))/s;if(!Bs(u,d,5))return!1}return!0}var Ma={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function OQ(e,t,r){if(!e.isLhsSimple||!r.isValid)return Ma.NONE;let n=r.substituted;if(n.isError||n.valueType!==C)return Ma.NONE;let i=n.getDependencies();if(i.length!==1||isFinite(r.node.polynomialOrder(i[0])))return Ma.NONE;let o=n.getCompiledFunction(i).fn,a=r.listNode;if(n.valueType!==C)return Ma.NONE;let s=a.mapElements(f=>+f.asValue());if(s.length<3)return Ma.NONE;s.sort(function(f,g){return f-g});let c=s.map(o),l=c.map(Math.log),u=s.map(Math.log),d=!0;return N.List.wrap(t).eachElement(f=>{isFinite(Math.log(+f.asValue()))||(d=!1)}),jL(s,l)&&d?Ma.LOGLIN:jL(u,l)&&d?Ma.LOGLOG:jL(u,c)?Ma.LINLOG:Ma.NONE}function t5({policy:e,frame:t},r,n){let i=Fi(t);for(let s of _n(n))i[s]=n[s];let o=iy({policy:e,frame:i,wrapInList:!0},r),a=o.getError();if(a)throw a;return o.asCompilerValue()}function ZL(e){let t=0;for(let r of e){let n=ae(r);t+=n*n}return t/e.length}function r5(e,t){let r,n,i=t._chunk;if(i&&(n=KH(i)),!n||n.length===0)return t=t.deriveRegressionRestrictions(),r=JH(e,t),{parameters:QH(r.solution,t),residuals:r.residuals,isLinear:r.isLinear,parameterWarning:!1};let o=t.getDependencies(),a=t.getCompiledFunction(o).fn,s=1/0,c={},l,u=!1;for(let d of n){let f=new dn(d.chunk);if(f=f.deriveRegressionRestrictions(),r=JH(d.forwardParameterMap(e),f),r.MSE<s){let g=d.reverseParameterMap(r.solution.map(x=>ae(x))),y=Hp(a,g);if(c&&(!isFinite(y)||y>=s)){isFinite(y)||(u=!0);continue}s=r.MSE,c=QH(g,t),l=a.apply(void 0,g)}}return{parameters:c,residuals:l,isLinear:!1,parameterWarning:u}}var Nl={pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0};function i5(e,t){let{mappedArgIndex:r,mappedReturnIndex:n,solutionIndex:i}=t,o=[],a=wp(e,r),s=NQ(e,a,n),c=i,l=e.NanOfType(e.getReturnType());for(let u=0;u<=n;u++){let d=e.getInstruction(u);if(u===r){o.push(i);continue}if(!a[u]&&!e.isInClosedBlock(u)){o.push(u);continue}if(pt(d))o.push(e.copyInstruction(d));else{let f=LQ(o,d.args);o.push(e.copyInstructionWithArgs(d,f)),d.type===33&&s[u]&&(c=e.Piecewise([f[0],c,l]))}}return c}function LQ(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function NQ(e,t,r){let n=[];for(let i=0;i<r;i++)n.push(!1);n[r]=t[r];for(let i=r;i>=0;i--){if(!n[i]||!t[i])continue;let o=e.getInstruction(i);if(o.type===33)n[o.args[1]]=!0;else if(!pt(o))for(let a of o.args)n[a]=!0}return n}function o5(e,t){try{return RQ(e,t)}catch(r){return r instanceof N.Base?r:Ie(r)}}function JL(e,t){try{let r=new dn(t),n=Df({},r),i=[];for(let a=0;a<n.length;a++)i.push(C);let o=QE({policy:e,frame:{},argNames:n,argTypes:i,selection:void 0,locals:[]});return o.chunk=t,t.fuseBroadcast(),a5({policy:e,ctx:o,isInequality:!1,allowSolvingIn3D:!0},t)}catch(r){return r instanceof N.Base?r:Ie(r)}}function RQ({policy:e,frame:t},r){let n=!1;if(r instanceof $h){let x=r._lhs,b=x._symbol;if(!t[b]&&!e.assignmentForbidden(b)&&(n=!0,x.args.length>1)){let w=un([b]);throw w.silent=!0,w}}let i=r.asComparator(),o=Df(t,i),a=[];for(let x=0;x<o.length;x++)a.push(C);let s=QE({policy:e,frame:t,argNames:o,argTypes:a,selection:void 0,locals:[]}),{chunk:c}=s,l=i.getOperator(),u=l!=="=",d=Ct(s,i.args[0]),f=Ct(s,i.args[1]);try{_p(c,e,i,[d,f])}catch(x){throw x instanceof q&&n&&(x.silent=!0),x}switch(l){case"<":c.Less([d,f]);break;case">":c.Greater([d,f]);break;case"<=":c.LessEqual([d,f]);break;case">=":c.GreaterEqual([d,f]);break;case"=":c.Equal([d,f]);break}if(c.fuseBroadcast(),c.isConstant())return new dn(c);let y=c.getInstruction(d).type!==2||Df(t,i.args[1]).indexOf(c.argNames[d])!==-1;if(!Nl.plotImplicits&&y)throw jD();return Vo[l].direction===-1?c.Subtract([f,d]):c.Subtract([d,f]),c.fuseBroadcast(),a5({policy:e,ctx:s,isInequality:u,allowSolvingIn3D:!1,maybeBaseCase:n},c)}function a5({policy:e,ctx:t,isInequality:r,allowSolvingIn3D:n,maybeBaseCase:i},o){let a=o.getLiveArgNames();if(a.length===0)throw Ie(`Unexpected: non-constant node with dependencies: ${a}`);if(a.length===1&&!r&&!Nl.plotSingleVariableImplicitEquations)return KD();let s=y=>y==="x"||y==="y"||y==="z";if(e.is3dPolicy()?!a.every(s):a.length>2)return un(e.sliderVariables(a)).setDependencies(a);if(r&&!e.validInequalityVariables(a))return WD().setDependencies(a);let{localFrames:c,effectiveOrder:l,variableOfInterest:u}=kQ(t,r);if(e.complicatedPolarImplicit(u,l))return ZD().setDependencies(a);if(!e.validImplicitVariables(a)){let y=zg();return i&&(y.silent=!0),y}if(e.is3dPolicy()&&n&&l!==1)return lu();if(l>2||e.is3dPolicy()&&!n)return new dn(o);let d=[],f=[],g=1;for(let y=0;y<c.length;y++){let x=c[y],b=VQ(x,r);g=b.length;for(let E of b){let I=x.chunk.copy();if(I.setReturnIndex(E),x.isRestrictedPolynomial){let{mappedArgIndex:S,mappedReturnIndex:D}=x;I.setReturnIndex(i5(I,{mappedArgIndex:S,mappedReturnIndex:D,solutionIndex:I.getReturnIndex()}))}I.fuseBroadcast(),d.push(new dn(I))}let w=!1;for(let E of x.coefficients){let I=x.chunk.getInstruction(E);I.type===1&&I.value!==0&&(w=!0)}if(o.argNames.length!==2||w)f.push(void 0);else{let E=x.chunk.copy(),I=x.coefficients.slice();E.List(I);let S=xe(o.getReturnType())?o.elementAt(y):o.copy(),O=S.argNames.indexOf(u)===0?1:0,_=S.getReturnIndex();S.Add([O,S.Multiply([S.Constant(0),_])]),f.push({coefficients:E,restriction:S})}}return new N.SolvedEquation(u,new N.List(d),f,g)}function kQ(e,t){let r=e.chunk,n=e.policy,i=r.argNames,o=xe(r.getReturnType()),a=[];e:for(let s=0;s<i.length;s++){let c=i[s],l=i.length>1&&!n.validSolvedVariable(c);a[s]={localFrames:[],effectiveOrder:0,variableOfInterest:c};let u=!t;if(l){a[s].effectiveOrder=1/0;continue}let d=o?r.getConstantListLength():1;if(d==null)throw new Error("Programming error: cannot solve a variable-length list expression");for(let f=0;f<d;f++){let g=o?r.elementAt(f):r;if(g.polynomialOrder(c,{allowRestriction:u,allowClosedBlockReferences:!1})>2){a[s].effectiveOrder=1/0;continue e}let x=g.getPolynomialCoefficients(c);a[s].localFrames.push(x),a[s].effectiveOrder=Math.max(a[s].effectiveOrder,x.coefficients.length-1)}}if(i.length===1)return a[0];if(i.length===2&&!i.includes("z"))return i[0]==="y"&&(a=[a[1],a[0]]),a[0].effectiveOrder===0?a[1]:a[1].effectiveOrder===0?a[0]:a[a[0].effectiveOrder<a[1].effectiveOrder?0:1];{let s=a.filter(l=>l.effectiveOrder===1);if(s.length>0)return s[0];let c=a.filter(l=>l.effectiveOrder===2);return c.length>0?c[0]:a[0]}}function VQ(e,t){return t?GQ(e):FQ(e)}function FQ({chunk:e,coefficients:t}){let[r,n,i]=t,o=e.Constant(Et(0,1)),a=e.Constant(NaN);if(i===void 0){n===void 0&&(n=o);let s=e.Negative([e.Divide([r,n])]),c=e.Equal([n,o]);return[e.Piecewise([c,a,s])]}else{let s=e.Constant(Et(2,1)),c=e.Multiply([s,i]),l=e.Negative([e.Divide([n,c])]),u=e.Divide([r,i]),d=e.Subtract([e.Multiply([l,l]),u]),f=e.Equal([i,o]),g=e.Equal([d,o]),y=e.getInstruction(d);if(y.type===1&&ae(y.value)===0)return[e.Piecewise([f,a,l])];{let x=e.NativeFunction("sqrt",[d]),b=e.Greater([n,o]),w=e.Less([n,o]),E=e.Greater([l,o]),I=e.Piecewise([E,e.Add([l,x]),e.Subtract([l,x])]),S=e.Piecewise([g,I,e.Divide([u,I])]),D=e.Negative([e.Divide([r,n])]);return[e.Piecewise([f,e.Piecewise([w,D,a]),I]),e.Piecewise([f,e.Piecewise([b,D,a]),S])]}}}function GQ({chunk:e,coefficients:t}){let[r,n,i]=t,o=e.Constant(Et(0,1));i===void 0&&(i=o),n===void 0&&(n=o),r===void 0&&(r=o);let a=e.Constant(Et(2,1)),s=e.Constant(NaN),c=e.Constant(Et(1e305,1)),l=e.Negative([c]),u=e.Multiply([a,i]),d=e.Negative([e.Divide([n,u])]),f=e.Divide([r,i]),g=e.Subtract([e.Multiply([d,d]),f]),y=e.NativeFunction("sqrt",[g]),x=e.Negative([e.Divide([r,n])]),b=e.Equal([i,o]),w=e.Equal([g,o]),E=e.Greater([i,o]),I=e.Equal([n,o]),S=e.Greater([n,o]),D=e.Less([n,o]),O=e.Greater([d,o]),_=e.Greater([r,o]),A=e.Less([g,o]),R=e.Piecewise([O,e.Add([d,y]),e.Subtract([d,y])]),W=e.Piecewise([w,R,e.Divide([f,R])]),j=e.Piecewise([O,W,R]),Q=e.Piecewise([O,R,W]);return[e.Piecewise([b,e.Piecewise([D,x,s]),e.Piecewise([E,j,s])]),e.Piecewise([b,e.Piecewise([I,e.Piecewise([_,l,s]),s]),e.Piecewise([E,e.Piecewise([A,l,s]),j])]),e.Piecewise([b,e.Piecewise([I,e.Piecewise([_,c,s]),s]),e.Piecewise([E,e.Piecewise([A,c,s]),Q])]),e.Piecewise([b,e.Piecewise([S,x,s]),e.Piecewise([E,Q,s])])]}function wu(e){return e>=100}function s5(e,t){switch(e){case 106:return 200;case 107:return 201;case 108:return 202;case 103:return 214;case 130:return 215;case 112:return 209;case 113:return 210;case 110:switch(t){case"z":return 206;case"theta":return 205;case"x":case"y":case"r":case"_implicit":return 211;default:return 10}case 109:switch(t){case"r":return 203;case"theta":return 204;case"x":case"y":case"z":case"_implicit":return 213;default:return 10}case 111:switch(t){case"theta":return 207;case"phi":return 208;case"x":case"y":case"z":case"rho":case"_implicit":return 212;default:return 10}default:return 10}}function QL(e){switch(e){case 123:case 122:case 121:case 120:case 124:case 126:case 127:return!0;default:return!1}}function yv(e){return e===26||e===4}var BQ=e=>{for(var t=[],r=[],n=e.length,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return{defined:{x:t,y:r}}},$c=BQ;var{sin:qQ,cos:zQ}=Math,Yt=class e{constructor(t=0,r=0,n=0){this.x=t;this.y=r;this.z=n}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}set(t,r,n){return this.x=t,this.y=r,this.z=n,this}clone(){return new e(this.x,this.y,this.z)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}isZero(){return this.x===0&&this.y===0&&this.z===0}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiply(1/this.magnitude()),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){let n=t.x,i=t.y,o=t.z,a=r.x,s=r.y,c=r.z;return this.x=i*c-o*s,this.y=o*a-n*c,this.z=n*s-i*a,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateAroundAxis(t,r){let n=UQ(t,r);return new e(n[0]*this.x+n[1]*this.y+n[2]*this.z,n[3]*this.x+n[4]*this.y+n[5]*this.z,n[6]*this.x+n[7]*this.y+n[8]*this.z)}};function UQ(e,t){let r=e.x,n=e.y,i=e.z,o=qQ(t),a=zQ(t),s=1-a;return[s*r*r+a,s*r*n+o*i,s*r*i-o*n,s*n*r-o*i,s*n*n+a,s*n*i+o*r,s*i*r+o*n,s*i*n-o*r,s*i*i+a]}function sy(e,t,r,n,i,o,a){let[s,c,l]=[new Yt,new Yt,new Yt],[u,d,f]=[new Yt,new Yt,new Yt],[g,y]=[new Yt,new Yt];for(let b=0;b<e.length/3;b++){let w=e[3*b],E=e[3*b+1],I=e[3*b+2];s.set(t[3*w],t[3*w+1],t[3*w+2]),c.set(t[3*E],t[3*E+1],t[3*E+2]),l.set(t[3*I],t[3*I+1],t[3*I+2]),u.set(r[3*w],r[3*w+1],r[3*w+2]),d.set(r[3*E],r[3*E+1],r[3*E+2]),f.set(r[3*I],r[3*I+1],r[3*I+2]),g.subVectors(l,s),y.subVectors(s,c);var x=g.cross(y).normalize();if(!(u.dot(x)>a&&d.dot(x)>a&&f.dot(x)>a)||u.dot(d)<0||u.dot(f)<0||d.dot(f)<0){let D=t.length/3;e[3*b]=D,e[3*b+1]=D+1,e[3*b+2]=D+2,t.push(s.x,s.y,s.z),t.push(c.x,c.y,c.z),t.push(l.x,l.y,l.z),r.push(x.x,x.y,x.z),r.push(x.x,x.y,x.z),r.push(x.x,x.y,x.z),n.push(n[2*w],n[2*w+1]),n.push(n[2*E],n[2*E+1]),n.push(n[2*I],n[2*I+1]);let O=i;if(i>0){for(let _=0;_<O;_++)o.push(o[O*w+_]);for(let _=0;_<O;_++)o.push(o[O*E+_]);for(let _=0;_<O;_++)o.push(o[O*I+_])}}}}function pI(e){let{triangles:t,normalDirHints:r}=e.triangulate(),{extraAttrCount:n}=e,i=e.getVertexCount(),o=new Array(i),a=new Array(i*3),s=[],c=!1,l=new Array(i*3),u=new Array(i*2),d=new Array(i*n),f=[],g=0;function y(b){let w=e.getVertex(b);if(!w)return null;let E=r[b],I=E?e.hintedNormal(b,E):e.getNormal(b);I?(l[3*g]=I[0],l[3*g+1]=I[1],l[3*g+2]=I[2]):(s[g]=!0,c=!0,l[3*g]=0,l[3*g+1]=0,l[3*g+2]=0),a[3*g]=w[0],a[3*g+1]=w[1],a[3*g+2]=w[2];let S=e.getUV(b);if(u[2*g]=S[0],u[2*g+1]=S[1],n>0)for(let D=0;D<n;D++)d[n*g+D]=e.getExtraAttr(b,D);return g++}function x(b){let w=o[b];return w===void 0?o[b]=y(b):w}for(let b=0;b<t.length;b+=3){let w=t[b],E=t[b+1],I=t[b+2],S=x(w),D=x(E),O=x(I);if(S===null||D===null||O===null)continue;f.push(S,D,O);let _=s[S],A=s[D],R=s[O];if(_||A||R){let W=a,j=l,Q=new Yt(W[3*S],W[3*S+1],W[3*S+2]),ce=new Yt(W[3*D],W[3*D+1],W[3*D+2]),ee=new Yt(W[3*O],W[3*O+1],W[3*O+2]),pe=new Yt().subVectors(ee,Q),re=new Yt().subVectors(Q,ce),k=pe.cross(re);if(!k.isFinite())continue;_&&(j[3*S+0]+=k.x,j[3*S+1]+=k.y,j[3*S+2]+=k.z),A&&(j[3*D+0]+=k.x,j[3*D+1]+=k.y,j[3*D+2]+=k.z),R&&(j[3*O+0]+=k.x,j[3*O+1]+=k.y,j[3*O+2]+=k.z)}}if(a.length=g*3,l.length=g*3,u.length=g*2,c)for(let b=0;b<g;b++){if(!s[b])continue;let w=l[3*b],E=l[3*b+1],I=l[3*b+2],S=Math.sqrt(w*w+E*E+I*I);l[3*b]=w/S,l[3*b+1]=E/S,l[3*b+2]=I/S}return sy(f,a,l,u,n,d,0),{positions:a,normals:l,faces:f,uvs:u,resolved:!0,extraAttrs:d}}var rN=class{constructor({resolution:t,uRange:r,vRange:n,du:i,dv:o,extraAttrCount:a}){this.normalDirHints=[];this.isVertexAtCreaseCache=[];this.triangles=[];this.edgeVertices=new Map;this.edgeNormalVertices=new Map;this.finiteVertices=new Map;this.resolution=t,this.uRange=r,this.vRange=n,this.du=i,this.dv=o,this.extraAttrCount=a,this.duSquared=i*i,this.dvSquared=o*o}addVertex(t){return this.normalDirHints.push(void 0),this.isVertexAtCreaseCache.push(void 0),this._addVertex(t)}jumpAlongEdge(t,r){let n=0;if(t>r){let c=t;t=r,r=c,n=1}let i=r*r+t,o=this.edgeVertices.get(i);if(o===null)return;if(o!==void 0)return[o[n],o[1-n]];let a=this.findJumpBetweenTwoSamples(t,r);if(a===void 0){this.edgeVertices.set(i,null);return}let s=[this.addVertex(a[0]),this.addVertex(a[1])];return this.edgeVertices.set(i,s),[s[n],s[1-n]]}edgeNormalFeature(t,r){let n=0;if(t>r){let c=t;t=r,r=c,n=1}let i=r*r+t,o=this.edgeNormalVertices.get(i);if(o!==void 0)return this.flipEdgeNormalFeature(o,n);let a=this.findCreaseBetweenTwoSamples(t,r),s=a===null?null:a.type==="high-curvature"?{type:"high-curvature",pos:this.addVertex(a.pos)}:{type:"crease",left:this.addVertex(a.left),right:this.addVertex(a.right)};return this.edgeNormalVertices.set(i,s),this.flipEdgeNormalFeature(s,n)}flipEdgeNormalFeature(t,r){return(t==null?void 0:t.type)==="crease"?{type:"crease",left:r===0?t.left:t.right,right:r===0?t.right:t.left}:t}findCreaseBetweenTwoSamples(t,r){let o=this.getUV(t),a=this.getUV(r),s=this.getNormal(t),c=this.getNormal(r),l=E=>{var S;let I=Ci(o,a,E);return(S=this.fn(I).normal)!=null?S:[NaN,NaN,NaN]};if(!s||!c)return null;let u=a[0]-o[0],d=a[1]-o[1],f=this.du,g=this.dv,y=(Math.abs(f*u)+Math.abs(g*d))/(u*u+d*d),x=l1(0,s,1,c,l,.01,2*y,.9);if(x===void 0)return null;if(typeof x=="number")return x<y||x>1-y?null:{type:"high-curvature",pos:this.fn(Ci(o,a,x))};let b=x[0],w=x[1];return b<y||w>1-y?null:(b-=y,w+=y,b<=1e-8&&(b=1e-8),w>=1-1e-8&&(w=1-1e-8),{type:"crease",left:this.fn(Ci(o,a,b)),right:this.fn(Ci(o,a,w))})}isVertexAtCrease(t){let r=this.isVertexAtCreaseCache[t];if(r!==void 0)return r;let n=this._isVertexAtCrease(t);return this.isVertexAtCreaseCache[t]=n,n}finiteAlongEdge(t,r){if(t>r){let s=t;t=r,r=s}let n=r*r+t,i=this.finiteVertices.get(n);if(i!==void 0)return i;let o=this.findFiniteBetweenTwoSamples(t,r);if(o===void 0)return;let a=this.addVertex(o);return this.finiteVertices.set(n,a),a}pushTriangle(t,r,n){this.isDegenerate(t,r,n)||this.triangles.push(t,r,n)}getTriangles(){return this.triangles}},HQ=1e-4,$Q=.99,ly=.9999;function eN(e,t){return!e||!t?!0:e[0]*t[0]+e[1]*t[1]+e[2]*t[2]<$Q}var nN=class extends rN{hintVec(t,r){let n=this.getUV(t),i=this.getUV(r);return h2(m2(i,n),HQ)}hintNormal1(t,r,n){let i=this.hintVec(t,r),o=this.hintVec(t,n);this.normalDirHints[t]=[i,o]}hintNormals2(t,r){let n=this.hintVec(t,r),i=tN(n);this.normalDirHints[t]=[dI(n),i],this.normalDirHints[r]=[i,dI(i)]}hintNormals2Finite(t,r){let n=this.hintVec(t,r),i=dI(n);this.normalDirHints[t]=this.normalDirHints[r]=[i,tN(i)]}hintNormalFirstBad(t,r){let n=this.hintVec(t,r);this.normalDirHints[t]=[dI(n),tN(n)]}hintNormalSecondBad(t,r){let n=this.hintVec(r,t);this.normalDirHints[r]=[WQ(n),YQ(n)]}},iN=class extends nN{oneJump(t,r,n,i){let o=i[0],a=i[1];this.pushTriangle(o,n,t),this.pushTriangle(a,r,n),this.hintNormalFirstBad(o,n),this.hintNormalSecondBad(n,a)}oneJumpOneExtra(t,r,n,i,o){let a=i[0],s=i[1];this.pushTriangle(a,n,t),this.pushTriangle(a,o,n),this.pushTriangle(s,r,o),this.hintNormalFirstBad(a,n),this.hintNormalSecondBad(n,s)}oneJumpOneExtra2(t,r,n,i,o){let a=i[0],s=i[1];this.pushTriangle(s,r,n),this.pushTriangle(s,n,o),this.pushTriangle(a,o,t),this.hintNormalFirstBad(a,n),this.hintNormalSecondBad(n,s)}oneJumpTwoExtra(t,r,n,i,o,a){let s=i[0],c=i[1];this.pushTriangle(s,a,t),this.pushTriangle(s,o,a),this.pushTriangle(o,n,a),this.pushTriangle(c,r,o)}twoJumps(t,r,n,i,o){let a=i[0],s=i[1],c=o[0],l=o[1];this.pushTriangle(a,n,t),this.pushTriangle(a,l,n),this.pushTriangle(s,r,c),this.hintNormals2(a,l),this.hintNormals2(c,s)}twoJumpsOneExtraPoint(t,r,n,i,o,a){let s=i[0],c=i[1],l=o[0],u=o[1];this.pushTriangle(s,a,t),this.pushTriangle(s,u,a),this.pushTriangle(u,n,a),this.pushTriangle(c,r,l),this.hintNormals2(s,u),this.hintNormals2(l,c)}oneExtraPoint(t,r,n,i){this.pushTriangle(i,n,t),this.pushTriangle(i,r,n)}oneExtraPointOneVertexCrease(t,r,n,i){let o=this.copyVertex(n);this.pushTriangle(i,o,t),this.pushTriangle(i,r,o),this.hintNormal1(o,t,r)}twoExtraPoints(t,r,n,i,o){this.pushTriangle(i,n,t),this.pushTriangle(i,o,n),this.pushTriangle(i,r,o)}threeExtraPoints(t,r,n,i,o,a){this.pushTriangle(i,a,t),this.pushTriangle(i,o,a),this.pushTriangle(i,r,o),this.pushTriangle(o,n,a)}oneEdgeJumpOneVertexCrease(t,r,n,i){let o=i[0],a=i[1],s=this.copyVertex(n),c=this.copyVertex(n);this.pushTriangle(o,s,t),this.pushTriangle(a,r,c),this.hintNormals2(c,a),this.hintNormals2(o,s)}threeVertexCrease(t,r,n){let i=this.copyVertex(t),o=this.copyVertex(r),a=this.copyVertex(n);this.pushTriangle(i,o,a),this.hintNormals2(i,o),this.hintNormalFirstBad(a,i)}twoVertexCrease(t,r,n){let i=this.copyVertex(t),o=this.copyVertex(r);this.pushTriangle(i,o,n),this.hintNormals2(i,o)}oneVertexCrease(t,r,n){let i=this.copyVertex(t);this.pushTriangle(i,r,n),this.hintNormal1(i,r,n)}pushTrianglesBasedOnJumps(t,r,n){let i=this.jumpAlongEdge(t,r),o=this.jumpAlongEdge(r,n),a=this.jumpAlongEdge(n,t);if(i&&o&&a){let b=this.getUV(t),w=this.getUV(r),E=this.getUV(n),I=this.addVertex(this.fn(Ci(b,Ci(w,E,.5),1e-4))),S=this.addVertex(this.fn(Ci(w,Ci(E,b,.5),1e-4))),D=this.addVertex(this.fn(Ci(E,Ci(b,w,.5),1e-4))),O=this.jumpAlongEdge(I,S),_=this.jumpAlongEdge(S,D),A=this.jumpAlongEdge(D,I);if(O&&_&&A)return;t=I,r=S,n=D,i=O,o=_,a=A}let s=this.getNormal(t),c=this.getNormal(r),l=this.getNormal(n),u=this.isVertexAtCrease(t),d=this.isVertexAtCrease(r),f=this.isVertexAtCrease(n),g,y,x;if(!u&&!d&&!i&&eN(s,c)){let b=this.edgeNormalFeature(t,r);b!==null&&(b.type==="high-curvature"?g=b.pos:i=[b.left,b.right])}if(!d&&!f&&!o&&eN(c,l)){let b=this.edgeNormalFeature(r,n);b!==null&&(b.type==="high-curvature"?y=b.pos:o=[b.left,b.right])}if(!f&&!u&&!a&&eN(l,s)){let b=this.edgeNormalFeature(n,t);b!==null&&(b.type==="high-curvature"?x=b.pos:a=[b.left,b.right])}i&&o?x?this.twoJumpsOneExtraPoint(t,r,n,i,o,x):this.twoJumps(t,r,n,i,o):o&&a?g?this.twoJumpsOneExtraPoint(r,n,t,o,a,g):this.twoJumps(r,n,t,o,a):a&&i?y?this.twoJumpsOneExtraPoint(n,t,r,a,i,y):this.twoJumps(n,t,r,a,i):i?f?this.oneEdgeJumpOneVertexCrease(t,r,n,i):y&&x?this.oneJumpTwoExtra(t,r,n,i,y,x):y?this.oneJumpOneExtra(t,r,n,i,y):x?this.oneJumpOneExtra2(t,r,n,i,x):this.oneJump(t,r,n,i):o?u?this.oneEdgeJumpOneVertexCrease(r,n,t,o):x&&g?this.oneJumpTwoExtra(r,n,t,o,x,g):x?this.oneJumpOneExtra(r,n,t,o,x):g?this.oneJumpOneExtra2(r,n,t,o,g):this.oneJump(r,n,t,o):a?d?this.oneEdgeJumpOneVertexCrease(n,t,r,a):g&&y?this.oneJumpTwoExtra(n,t,r,a,g,y):g?this.oneJumpOneExtra(n,t,r,a,g):y?this.oneJumpOneExtra2(n,t,r,a,y):this.oneJump(n,t,r,a):u&&d&&f?this.threeVertexCrease(t,r,n):u&&d?this.twoVertexCrease(t,r,n):d&&f?this.twoVertexCrease(r,n,t):f&&u?this.twoVertexCrease(n,t,r):u?y?this.oneExtraPointOneVertexCrease(r,n,t,y):this.oneVertexCrease(t,r,n):d?x?this.oneExtraPointOneVertexCrease(n,t,r,x):this.oneVertexCrease(r,n,t):f?g?this.oneExtraPointOneVertexCrease(t,r,n,g):this.oneVertexCrease(n,t,r):g&&y&&x?this.threeExtraPoints(t,r,n,g,y,x):g&&y?this.twoExtraPoints(t,r,n,g,y):y&&x?this.twoExtraPoints(r,n,t,y,x):x&&g?this.twoExtraPoints(n,t,r,x,g):g?this.oneExtraPoint(t,r,n,g):y?this.oneExtraPoint(r,n,t,y):x?this.oneExtraPoint(n,t,r,x):this.pushTriangle(t,r,n)}oneNonFinite(t,r,n){let i=this.finiteAlongEdge(r,n),o=this.finiteAlongEdge(t,n);o!==void 0&&i!==void 0&&(this.pushTrianglesBasedOnJumps(i,t,r),this.pushTrianglesBasedOnJumps(i,o,t),this.hintNormals2Finite(i,o))}twoNonFinite(t,r,n){let i=this.finiteAlongEdge(t,r),o=this.finiteAlongEdge(t,n);i!==void 0&&o!==void 0&&(this.pushTrianglesBasedOnJumps(t,i,o),this.hintNormals2Finite(i,o))}pushTriangles(t,r,n){let i=this.allowVertex(t),o=this.allowVertex(r),a=this.allowVertex(n);i&&o&&a?this.pushTrianglesBasedOnJumps(t,r,n):i&&o?this.oneNonFinite(t,r,n):o&&a?this.oneNonFinite(r,n,t):a&&i?this.oneNonFinite(n,t,r):i?this.twoNonFinite(t,r,n):o?this.twoNonFinite(r,n,t):a&&this.twoNonFinite(n,t,r)}},cy=class extends iN{triangulate(){let t=this.resolution,{uRange:r,vRange:n,fn:i}=this,o=[r.min,n.min],a=[r.max,n.max],s=t-1,c=new Array(t*t);c[0]=this.addVertex(i(o));for(let l=1;l<=s;l++)c[l]=this.addVertex(i(s1(o,a,[l/s,0]))),c[t*l]=this.addVertex(i(s1(o,a,[0,l/s])));for(let l=1;l<=s;l++)for(let u=1;u<=s;u++){let d=c[(u-1)*t+(l-1)],f=c[u*t+(l-1)],g=c[(u-1)*t+l],y=this.addVertex(i(s1(o,a,[l/s,u/s])));c[u*t+l]=y,(l+u)%2===0?(this.pushTriangles(d,y,f),this.pushTriangles(d,g,y)):(this.pushTriangles(d,g,f),this.pushTriangles(g,y,f))}return{triangles:this.getTriangles(),normalDirHints:this.normalDirHints}}};function YQ(e){let t=e[0]*Math.SQRT1_2,r=e[1]*Math.SQRT1_2;return[t+r,r-t]}function dI(e){let t=e[0]*Math.SQRT1_2,r=e[1]*Math.SQRT1_2;return[t-r,t+r]}function WQ(e){return[e[1],-e[0]]}function tN(e){return[-e[1],e[0]]}var _t=class{constructor(t,r){this.min=t;this.max=r}get width(){return this.max-this.min}};var oN=class extends cy{constructor(r,n,i,o,a,s=[0,1,2]){let c=n.width/1e8,l=i.width/1e8;super({resolution:a,uRange:n,vRange:i,du:c,dv:l,extraAttrCount:0});this.vertices=[];this.fn=r=>{let n=this._fn(r),i=this.tangentInForcedDf(r,[this.du,0],n),o=this.tangentInForcedDf(r,[0,this.dv],n),a=Vm([this.du,0,i],[0,this.dv,o]);return{uv:r,f:n,normal:[a[this.perm0],a[this.perm1],a[this.perm2]],dfEast:i,dfNorth:o}};this._fn=u=>r(u[0],u[1]),this.paddedOutputDomain=new _t(o.min-5*o.width,o.max+5*o.width),this.jumpTolerance=o.width/1e3,this.perm0=s[0],this.perm1=s[1],this.perm2=s[2]}getVertexCount(){return this.vertices.length}getUV(r){return this.vertices[r].uv}getNormal(r){return this.vertices[r].normal}_addVertex(r){return this.vertices.push(r)-1}copyVertex(r){return this.addVertex(this.vertices[r])}getF(r){return this.vertices[r].f}getDfNorth(r){return this.vertices[r].dfNorth}getDfEast(r){return this.vertices[r].dfEast}tangentInForcedDf(r,n,i){let o=Hb(r,n);return this._fn(o)-i}tangentInForced(r,n,i){let o=Hb(r,n);return[n[0],n[1],this._fn(o)-i]}getExtraAttr(){throw new Error("Unexpected getExtraAttr call in explicit-surface.ts")}_isVertexAtCrease(r){let n=this.getUV(r),i=this.getDfEast(r),o=this.getDfNorth(r),a=this.getF(r),s=this.tangentInForcedDf(n,[-this.du,0],a);if((-this.duSquared+s*i)/Math.sqrt((this.duSquared+s*s)*(this.duSquared+i*i))>-ly)return!0;let u=this.tangentInForcedDf(n,[0,-this.dv],a);return(-this.dvSquared+o*u)/Math.sqrt((this.dvSquared+o*o)*(this.dvSquared+u*u))>-ly}hintedNormal(r,n){let i=this.getUV(r),o=this.getF(r),a=Vm(this.tangentInForced(i,n[0],o),this.tangentInForced(i,n[1],o));return Fm(...a)?[a[this.perm0],a[this.perm1],a[this.perm2]]:this.getNormal(r)}getVertex(r){if(!this.allowVertex(r))return;let n=this.getF(r),i=this.getUV(r);return[this.perm0===2?n:i[this.perm0],this.perm1===2?n:i[this.perm1],this.perm2===2?n:i[this.perm2]]}findJumpBetweenTwoSamples(r,n){let i=this.getUV(r),o=this.getF(r),a=0,s=this.getUV(n),c=this.getF(n),l=1,u=f=>this._fn(Ci(i,s,f));if(!isFinite(o)||!isFinite(c))return;let d=C2(a,o,l,c,u,this.jumpTolerance);if(d)return[this.fn(Ci(i,s,pc(d[0],0,1e-5))),this.fn(Ci(i,s,pc(d[1],1,1e-5)))]}findFiniteBetweenTwoSamples(r,n){let i=this.getUV(r),o=this.getF(r),a=this.getUV(n),s=this.getF(n),c=d=>{let f=this._fn(d);return f<this.paddedOutputDomain.min||f>this.paddedOutputDomain.max?NaN:f},l=d=>c(Ci(i,a,d)),u=ya(0,this.paddedOutputDomain.min<o&&o<this.paddedOutputDomain.max?o:NaN,1,this.paddedOutputDomain.min<s&&s<this.paddedOutputDomain.max?s:NaN,l);if(u!==void 0)return this.fn(Ci(i,a,u))}allowVertex(r){let n=this.getF(r);return this.paddedOutputDomain.min<n&&n<this.paddedOutputDomain.max}isDegenerate(r,n,i){let o=this.getUV(r),a=this.getUV(n),s=this.getUV(i),c=this.uRange.width*1e-6,l=this.vRange.width*1e-6;return Math.abs(o[0]-a[0])<c&&Math.abs(o[1]-a[1])<l||Math.abs(a[0]-s[0])<c&&Math.abs(a[1]-s[1])<l||Math.abs(s[0]-o[0])<c&&Math.abs(s[1]-o[1])<l}};function gI(e,t,r,n,i,o=[0,1,2]){let a=new oN(e,t,r,n,i,o);return pI(a)}var bc=class{constructor(t){this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}colinear(t,r,n){let i=this.map(t),o=this.map(r),a=this.map(n);var s=El(a[0],a[1],a[2]||0,i[0],i[1],i[2]||0,o[0],o[1],o[2]||0);if(s<1)return!1;var c=[i[0]+s*(o[0]-i[0]),i[1]+s*(o[1]-i[1]),i.length===3?i[2]+s*(o[2]-i[2]):0];return Math.abs(a[0]-c[0])<=this.xtolerance&&Math.abs(a[1]-c[1])<=this.ytolerance&&(i.length===2||Math.abs(a[2]-c[2])<=this.ztolerance)}addPoint(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(this.dimensions===2||this.ztolerance<0)){this.segment.push.apply(this.segment,t);return}if(!this.segment.length){this.segment.push.apply(this.segment,t);return}let r=this.dimensions===2?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(!(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2])){if(!this.pivotPoint||!this.pendingPoint){this.pivotPoint=t,this.pendingPoint=t;return}(!this.colinear(r,this.pivotPoint,t)||Gs(r[0]-t[0],r[1]-t[1],(r[2]||0)-(t[2]||0))<Gs(r[0]-this.pendingPoint[0],r[1]-this.pendingPoint[1],(r[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}flushPending(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)}breakSegment(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]}getSegments(){return this.breakSegment(),this.segments}finish(){return{segments:this.getSegments(),resolved:!0}}};var l5=5,XQ=Math.pow(2,14),{abs:Yc}=Math;function Tv(e,t){let r=KQ(e,t);return{segments:r.contours.strokeSegments,fillSegments:r.contours.fillSegments,resolved:r.quadTree.resolved}}function KQ(e,t){let r=Math.pow(2,-l5),n=c5(t,r),i=c5(t,2*r),o=jQ(e,n,i),a=nee(o.root,e,n),s=cee(a,e,n);return{paddedDomain:n,rootDomain:i,quadTree:o,triangles:a,contours:s}}function dy(e,t,r){return{x:e,y:t,z:r}}function $p(e,t,r){return{x:e,y:t,isZero:r}}function fI(e,t,r){return{vertices:[e,t,r],visited:!1,next:void 0}}function c5(e,t){let{mathToPixels:r}=e,n=r.interpolateX(e.xmin,e.xmax,-t),i=r.interpolateX(e.xmax,e.xmin,-t),o=r.interpolateY(e.ymin,e.ymax,-t),a=r.interpolateY(e.ymax,e.ymin,-t);return{...e,xmin:n,ymin:o,xmax:i,ymax:a}}function bv(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function aN(e,t,r){e.center=u5(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,r)}function jQ(e,t,r){let n=ZQ(e,r),i=[],o=[];o.push(n);let a=1,s=!0;e:for(;o.length;){let c=i;i=o,o=c;let l;for(;l=i.pop();)if(QQ(l,e,t)){if(JQ(l,e,t),!l.children){s=!1;break e}if(o.push(l.children[0]),o.push(l.children[1]),o.push(l.children[2]),o.push(l.children[3]),a+=3,a>=XQ){s=!1;break e}}else aN(l,e,t)}for(let c=0;c<i.length;c++)aN(i[c],e,t);for(let c=0;c<o.length;c++)aN(o[c],e,t);return{root:n,resolved:s}}function ZQ(e,t){let r=t.xmin,n=t.xmax,i=t.ymin,o=t.ymax;return bv(0,[uy(r,o,e),uy(n,o,e),uy(n,i,e),uy(r,i,e)])}function JQ(e,t,r){let n=e.depth+1,i=e.vertices[0],o=e.vertices[1],a=e.vertices[2],s=e.vertices[3],c=Da(i,o,t,r),l=Da(o,a,t,r),u=Da(a,s,t,r),d=Da(s,i,t,r),f=Da(i,a,t,r);e.children=[bv(n,[i,c,f,d]),bv(n,[c,o,l,f]),bv(n,[f,l,a,u]),bv(n,[d,f,u,s])]}function QQ(e,t,r){if(e.depth<l5)return!0;if(tee(e,r)||eee(e,r))return!1;let n=e.vertices[0],i=e.vertices[1],o=e.vertices[2],a=e.vertices[3];if(isNaN(n.z)&&isNaN(i.z)&&isNaN(o.z)&&isNaN(a.z))return!1;if(isNaN(n.z)||isNaN(i.z)||isNaN(o.z)||isNaN(a.z))return!0;let s=u5(n,i,o,a,t,r),c=Iu(n,i,t,r),l=Iu(i,o,t,r),u=Iu(o,a,t,r),d=Iu(a,n,t,r);return Wp(n,c,t,r)||Wp(i,c,t,r)||Wp(i,l,t,r)||Wp(o,l,t,r)||Wp(o,u,t,r)||Wp(a,u,t,r)||Wp(a,d,t,r)||Wp(n,d,t,r)||Yp(n,c,s,t,r)||Yp(c,i,s,t,r)||Yp(i,l,s,t,r)||Yp(l,o,s,t,r)||Yp(o,u,s,t,r)||Yp(u,a,s,t,r)||Yp(a,d,s,t,r)||Yp(d,n,s,t,r)}function Yp(e,t,r,n,i){if(e.z>0==t.z>0&&t.z>0==r.z>0)return!1;let o=0;isFinite(e.z)&&(o=Math.max(o,Math.abs(e.z))),isFinite(t.z)&&(o=Math.max(o,Math.abs(t.z))),isFinite(r.z)&&(o=Math.max(o,Math.abs(r.z)));let a=32*Number.EPSILON*o,s,c,l,u;if(e.z>0==t.z>0){if(s=Da(e,t,n,i),s.z>0!=e.z>0)return!0;c=Eu(e,r,n,i,a),l=Eu(t,r,n,i,a),u=Eu(s,r,n,i,a)}else if(t.z>0==r.z>0){if(s=Da(t,r,n,i),s.z>0!=t.z>0)return!0;c=Eu(t,e,n,i,a),l=Eu(r,e,n,i,a),u=Eu(s,e,n,i,a)}else{if(s=Da(r,e,n,i),s.z>0!=r.z>0)return!0;c=Eu(r,t,n,i,a),l=Eu(e,t,n,i,a),u=Eu(s,t,n,i,a)}let{mathToPixels:d,map3d:f}=i;if(f){let y=f(u.x,u.y),x=f(c.x,c.y),b=f(l.x,l.y);var g=c2(y[0],y[1],y[2],x[0],x[1],x[2],b[0],b[1],b[2]);return g>i.tolerance}else{let[y,x]=d.mapCoordinatePair([u.x,u.y]),[b,w]=d.mapCoordinatePair([c.x,c.y]),[E,I]=d.mapCoordinatePair([l.x,l.y]);return s2(y,x,b,w,E,I)>i.tolerance}}function Wp(e,t,r,n){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;let o=4*Da(e,t,r,n).z-t.z-3*e.z,a=1e-4,s=(r((1-a)*e.x+a*t.x,(1-a)*e.y+a*t.y)-e.z)/a,c=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(o-s)>.125*c}function eee(e,t){let{mathToPixels:r,map3d:n,tolerance:i}=t;if(n)return!1;{let[o,a]=r.mapCoordinatePair([e.vertices[1].x,e.vertices[1].y]),[s,c]=r.mapCoordinatePair([e.vertices[0].x,e.vertices[0].y]),[l,u]=r.mapCoordinatePair([e.vertices[3].x,e.vertices[3].y]);if(Yc(o-s)<10*i||Yc(c-u)<10*i)return!0}return!1}function tee(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function py(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function uy(e,t,r){return dy(e,t,r(e,t))}function Da(e,t,r,n){let{mathToPixels:i}=n;return uy(i.interpolateX(e.x,t.x,.5),i.interpolateY(e.y,t.y,.5),r)}function Iu(e,t,r,n){if(py(e,n)||py(t,n))return Da(e,t,r,n);if(isNaN(e.z)||isNaN(t.z))return ree(e,t,r,n);if(e.z>0!=t.z>0)return Da(e,t,r,n);let i=.01,o=r((1-i)*e.x+i*t.x,(1-i)*e.y+i*t.y)-e.z,a=t.z-r(i*e.x+(1-i)*t.x,i*e.y+(1-i)*t.y);return isNaN(o)||isNaN(a)||o>0==a>0?Da(e,t,r,n):d5(dy(e.x,e.y,o),dy(t.x,t.y,a),r,n)}function u5(e,t,r,n,i,o){let a=Iu(e,r,i,o);return e.z>0==r.z>0&&a.z>0!=e.z>0||(a=Iu(t,n,i,o),t.z>0==n.z>0&&a.z>0!=t.z>0)?a:Da(e,r,i,o)}function d5(e,t,r,n){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(!isFinite(e.z)&&!isFinite(t.z))return Da(e,t,r,n);if(isFinite(e.z))if(isFinite(t.z)){let i=1-e.z/t.z,o=1-t.z/e.z;return uy(e.x/i+t.x/o,e.y/i+t.y/o,r)}else return e;else return t}function Eu(e,t,r,n,i){let{mathToPixels:o,map3d:a}=n,s=e.x,c=t.x,l=e.y,u=t.y,d=e.z,f=t.z;if(py(e,n)||py(t,n)){let g=Da(e,t,r,n);return $p(g.x,g.y,!1)}if(a){let[g,y,x]=a(s,l),[b,w,E]=a(c,u);for(;Yc(g-b)>n.tolerance||Yc(y-w)>n.tolerance||Yc(x-E)>n.tolerance;){let I=.5*(s+c),S=.5*(l+u),D=r(I,S);if(D>0==d>0?(s=I,l=S,d=D):(c=I,u=S,f=D),(I===s||I===c)&&(S===l||S===u))break;[g,y,x]=a(s,l),[b,w,E]=a(c,u)}}else{let[g,y]=o.mapCoordinatePair([s,l]),[x,b]=o.mapCoordinatePair([c,u]);for(;Yc(g-x)>n.tolerance||Yc(y-b)>n.tolerance;){let w=.5*(s+c),E=.5*(l+u),I=r(w,E);I>0==d>0?(s=w,l=E,d=I):(c=w,u=E,f=I),[g,y]=o.mapCoordinatePair([s,l]),[x,b]=o.mapCoordinatePair([c,u])}}if(isNaN(d))return $p(c,u,!1);if(isNaN(f))return $p(s,l,!1);{let g=Math.abs(d),y=Math.abs(f);if(g<i&&y>100*i)return 1/g>=y?$p(s,l,!0):$p(c,u,!1);if(y<i&&g>100*i)return 1/y>=g?$p(c,u,!0):$p(s,l,!1);let x=d5(dy(s,l,d),dy(c,u,f),r,n),b=d===0||f===0||x.z===0||x.z>=d==f>=x.z&&Math.abs(x.z)<1e250;return $p(x.x,x.y,b)}}function ree(e,t,r,n){let{mathToPixels:i,map3d:o}=n;if(isNaN(e.z)===isNaN(t.z))return Da(e,t,r,n);if(isNaN(e.z)){let d=e;e=t,t=d}let a=e.x,s=t.x,c=e.y,l=t.y,u=e.z;if(o){let[d,f,g]=o(a,c),[y,x,b]=o(s,l);for(;Yc(d-y)>n.tolerance||Yc(f-x)>n.tolerance||Yc(g-b)>n.tolerance||isNaN(d)||isNaN(y);){let w=.5*(a+s),E=.5*(c+l),I=r(w,E);if(isNaN(I)===isNaN(u)?(a=w,c=E,u=I):(s=w,l=E),(w===a||w===s)&&(E===c||E===l))break;[d,f,g]=o(a,c),[y,x,b]=o(s,l)}}else{let[d,f]=i.mapCoordinatePair([a,c]),[g,y]=i.mapCoordinatePair([s,l]);for(;Yc(d-g)>n.tolerance||Yc(f-y)>n.tolerance;){let x=.5*(a+s),b=.5*(c+l),w=r(x,b);isNaN(w)===isNaN(u)?(a=x,c=b,u=w):(s=x,l=b),[d,f]=i.mapCoordinatePair([a,c]),[g,y]=i.mapCoordinatePair([s,l])}}return dy(a,c,u)}function nee(e,t,r){let n={triangles:[],edgeCache:{},domain:r,fn:t};return xv(e,n),n.triangles}function xv(e,t){e.children&&(xv(e.children[0],t),xv(e.children[1],t),xv(e.children[2],t),xv(e.children[3],t),Xp(e.children[0],e.children[1],t),Xp(e.children[3],e.children[2],t),Kp(e.children[1],e.children[2],t),Kp(e.children[0],e.children[3],t))}function Xp(e,t,r){e.children&&t.children?(Xp(e.children[1],t.children[0],r),Xp(e.children[2],t.children[3],r)):e.children?(Xp(e.children[1],t,r),Xp(e.children[2],t,r)):t.children?(Xp(e,t.children[0],r),Xp(e,t.children[3],r)):iee(e,t,r)}function Kp(e,t,r){e.children&&t.children?(Kp(e.children[2],t.children[1],r),Kp(e.children[3],t.children[0],r)):e.children?(Kp(e.children[2],t,r),Kp(e.children[3],t,r)):t.children?(Kp(e,t.children[1],r),Kp(e,t.children[0],r)):oee(e,t,r)}function iee(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=Iu(e.vertices[1],e.vertices[2],r.fn,r.domain),i=yI(e.vertices[1],t.center,e.vertices[2],e.center,n)):(n=Iu(t.vertices[0],t.vertices[3],r.fn,r.domain),i=yI(t.vertices[0],t.center,t.vertices[3],e.center,n)),p5(i,r.edgeCache,r.domain);for(let o=0;o<4;o++)r.triangles.push(i[o])}function oee(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=Iu(e.vertices[3],e.vertices[2],r.fn,r.domain),i=yI(e.vertices[2],t.center,e.vertices[3],e.center,n)):(n=Iu(t.vertices[1],t.vertices[0],r.fn,r.domain),i=yI(t.vertices[1],t.center,t.vertices[0],e.center,n)),p5(i,r.edgeCache,r.domain);for(let o=0;o<4;o++)r.triangles.push(i[o])}function yI(e,t,r,n,i){return[fI(e,i,t),fI(t,i,r),fI(r,i,n),fI(n,i,e)]}function vv(e,t,r){return e.z>0&&!py(e,r)&&(!(t.z>0)||py(t,r))}function mI(e,t){return""+e.x+","+e.y+","+t.x+","+t.y}function p5(e,t,r){hI(e[0],e[1],e[2],mI(e[1].vertices[2],e[1].vertices[0]),t,r),hI(e[1],e[2],e[3],mI(e[2].vertices[0],e[2].vertices[2]),t,r),hI(e[2],e[3],e[0],mI(e[3].vertices[2],e[3].vertices[0]),t,r),hI(e[3],e[0],e[1],mI(e[0].vertices[0],e[0].vertices[2]),t,r)}function hI(e,t,r,n,i,o){let a=t.vertices[0],s=t.vertices[1],c=t.vertices[2];vv(s,c,o)&&(t.next=r),vv(a,s,o)&&(t.next=e),vv(c,a,o)&&see(t,n,i),vv(a,c,o)&&aee(t,n,i)}function aee(e,t,r){r[t]?r[t].next=e:r[t]=e}function see(e,t,r){r[t]?e.next=r[t]:r[t]=e}function cee(e,t,r){let{tolerance:n,mathToPixels:i,map3d:o}=r,a;if(o){let s={tolerance:n,map:c=>o(c[0],c[1])};a={fillAccumulator:new bc(s),strokeAccumulator:new bc(s),fn:t,domain:r}}else{let s={tolerance:n,map:c=>i.mapCoordinatePair(c)};a={fillAccumulator:new bc(s),strokeAccumulator:new bc(s),fn:t,domain:r}}for(let s=0;s<e.length;s++){let c=e[s];c.next&&!c.visited&&lee(c,a)}return{strokeSegments:a.strokeAccumulator.finish().segments,fillSegments:a.fillAccumulator.finish().segments}}function lee(e,t){for(;;){let r=e.vertices[0],n=e.vertices[1],i=e.vertices[2],o=0;isFinite(r.z)&&(o=Math.max(o,Math.abs(r.z))),isFinite(n.z)&&(o=Math.max(o,Math.abs(n.z))),isFinite(i.z)&&(o=Math.max(o,Math.abs(i.z)));let a=32*Number.EPSILON*o;if(sN(r,n,t,a),sN(n,i,t,a),sN(i,r,t,a),e.visited||!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function sN(e,t,r,n){if(vv(e,t,r.domain)){let i=Eu(e,t,r.fn,r.domain,n);r.fillAccumulator.addPoint([i.x,i.y]),i.isZero?r.strokeAccumulator.addPoint([i.x,i.y]):r.strokeAccumulator.breakSegment()}}function cN(e,t){return{type:"linear",s:e,t}}function g5(e,t){return{type:"logarithmic",s:e,t}}function f5(e,t){return{type:"exponential",s:e,t}}function lN(){return cN(1,0)}function uee([e,t],[r,n]){let i=(n-r)/(t-e),o=(r+n)/2-i*(t+e)/2;return cN(i,o)}function dee([e,t],[r,n]){let i=(n-r)/(Math.log(t)-Math.log(e)),o=(Math.log(t)*r-Math.log(e)*n)/(Math.log(t)-Math.log(e));return g5(i,o)}function pee([e,t],[r,n]){let i=(Math.log(n)-Math.log(r))/(t-e),o=(t*Math.log(r)-e*Math.log(n))/(t-e);return f5(i,o)}function uN(e,t,r){switch(e){case"linear":return uee(t,r);case"logarithmic":return dee(t,r);case"exponential":return pee(t,r);default:{let n=e;throw new Error("Unexpected scale type: "+n)}}}function dN({type:e,s:t,t:r},n){switch(e){case"linear":return t*n+r;case"logarithmic":return t*Math.log(n)+r;case"exponential":return Math.exp(t*n+r);default:let i=e;throw new Error("Unexpected scale type: "+i)}}function pN(e,t,r,n){switch(e){case"linear":return gee(t,r,n);case"logarithmic":return Math.pow(t,1-n)*Math.pow(r,n);case"exponential":return n===0?t:n===1?r:Math.log((1-n)*Math.exp(t)+n*Math.exp(r));default:let i=e;throw new Error("Unexpected scale type: "+i)}}function gee(e,t,r){return(1-r)*e+r*t}function gN({type:e,s:t,t:r}){switch(e){case"linear":return cN(1/t,-r/t);case"logarithmic":return f5(1/t,-r/t);case"exponential":return g5(1/t,-r/t);default:let n=e;throw new Error("Unexpected scale type: "+n)}}function fN(e){switch(e){case"linear":return"linear";case"logarithmic":return"exponential";case"exponential":return"logarithmic";default:let t=e;throw new Error("Unexpected scale type: "+t)}}function bI({width:e,height:t}){return{left:0,right:e,top:0,bottom:t}}function xI({xmin:e,xmax:t,ymin:r,ymax:n}){return{left:e,right:t,bottom:r,top:n}}var jp=class e{constructor(t,r){this.xScale=t,this.yScale=r}static fromRects(t,r,{xAxisScale:n,yAxisScale:i}){return new e(uN(n,[t.left,t.right],[r.left,r.right]),uN(i,[t.bottom,t.top],[r.bottom,r.top]))}static fromRectsInverse(t,r,{xAxisScale:n,yAxisScale:i}){return e.fromRects(r,t,{xAxisScale:fN(n),yAxisScale:fN(i)})}inverse(){return new e(gN(this.xScale),gN(this.yScale))}mapX(t){return dN(this.xScale,t)}mapY(t){return dN(this.yScale,t)}mapPoint({x:t,y:r}){return{x:this.mapX(t),y:this.mapY(r)}}mapCoordinatePair([t,r]){return[this.mapX(t),this.mapY(r)]}mapRect({top:t,bottom:r,left:n,right:i}){return{left:this.mapX(n),right:this.mapX(i),bottom:this.mapY(r),top:this.mapY(t)}}interpolateX(t,r,n){return pN(this.xScale.type,t,r,n)}interpolateY(t,r,n){return pN(this.yScale.type,t,r,n)}dangerouslyGetXScaleFactor(){if(this.xScale.type!=="linear")throw new Error(`Cannot get scale factor a '${this.xScale.type}' scale`);return this.xScale.s}dangerouslyGetYScaleFactor(){if(this.yScale.type!=="linear")throw new Error(`Cannot get scale factor a '${this.yScale.type}' scale`);return this.yScale.s}};function vI(e,t,r,n){let i=[],o=[],a=[],s=[],{xmin:c,xmax:l,ymin:u,ymax:d,zmin:f,zmax:g}=r,y,x,b;switch(n){case"z":y={xmin:c,xmax:l,ymin:u,ymax:d},x=(S,D)=>[S[D],S[D+1],f,S[D],S[D+1],g],b=(S,D)=>e(S,D,0);break;case"y":y={xmin:c,xmax:l,ymin:f,ymax:g},x=(S,D)=>[S[D],u,S[D+1],S[D],d,S[D+1]],b=(S,D)=>e(S,0,D);break;case"x":y={xmin:f,xmax:g,ymin:u,ymax:d},x=(S,D)=>[c,S[D+1],S[D],l,S[D+1],S[D]],b=(S,D)=>e(0,D,S);break}let w=bI({width:500,height:500}),E={...y,mathToPixels:jp.fromRects(xI(y),w,{xAxisScale:"linear",yAxisScale:"linear"}),tolerance:Wc},I=Tv(b,E);for(let S of I.segments)for(let D=0;D<S.length/2;D++){let[O,_,A,R,W,j]=x(S,2*D);if(i.push(O,_,A,R,W,j),a.push(O,_,R,W),t){let Q=t(O,_,A),ce=t(R,W,j);o.push(Q[0],Q[1],Q[2]),o.push(ce[0],ce[1],ce[2])}else o.push(0,0,0),o.push(0,0,0);if(D>0){let Q=i.length/3-4;s.push(Q,Q+1,Q+2),s.push(Q+2,Q+1,Q+3)}}return sy(s,i,o,a,0,[],.7),{positions:i,normals:o,faces:s,uvs:a,resolved:I.resolved,extraAttrs:[]}}var TI=[[1,2,4,21,20,18],[0,1,3,20,19,18],[2,6,7,25,21,18],[5,6,8,25,22,18],[5,9,11,23,22,18],[0,9,10,23,19,18],[10,12,14,24,23,19],[3,12,13,24,20,19],[4,13,15,24,21,20],[15,7,16,25,24,21],[11,17,14,24,23,22],[17,8,16,25,24,22]],Eo=[0,1,0,2,0,3,1,2,2,3,0,4,0,7,3,7,4,7,0,5,1,5,4,5,1,6,2,6,5,6,3,6,6,7,4,6,0,8,1,8,2,8,3,8,4,8,5,8,6,8,7,8],h5=[[0,2,3,8],[0,1,2,8],[0,3,7,8],[0,4,7,8],[0,4,5,8],[0,1,5,8],[1,5,6,8],[1,2,6,8],[2,3,6,8],[3,6,7,8],[4,5,6,8],[4,6,7,8]],y5=[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,1],[0,1,1],[1,1,1],[1,0,1],[.5,.5,.5]],mN=[[1,2,4],[4,20,21],[2,18,21],[1,18,20],[0,1,3],[3,19,20],[0,18,19],[2,6,7],[7,21,25],[6,18,25],[5,6,8],[8,22,25],[5,18,22],[5,9,11],[11,22,23],[9,18,23],[0,9,10],[10,19,23],[10,12,14],[14,23,24],[12,19,24],[3,12,13],[13,20,24],[4,13,15],[15,21,24],[15,7,16],[16,24,25],[11,17,14],[17,22,24],[17,8,16]],hN=[];for(let e=0;e<30;e++){let t=mN[e],r=new Set;for(let n of t)r.add(Eo[n*2]),r.add(Eo[n*2+1]);hN[e]=[...r]}var b5=[[0,3,2,1],[4,6,3,5],[7,2,9,8],[10,12,9,11],[13,12,15,14],[16,6,15,17],[18,17,20,19],[21,5,20,22],[23,1,22,24],[25,24,8,26],[27,14,28,19],[29,28,11,26]],mee=1<<31,hee=1<<30,m5=1<<24,Af=1<<24,xc=1<<24,Xc=65536,Kc=256,jc=1;function x5(e,t,r){return r*Xc+t*Kc+e*jc}var yee={0:0*m5,1:Kc,2:jc+Kc,3:jc,4:Xc,5:Kc+Xc,6:jc+Kc+Xc,7:jc+Xc,8:8*m5};function v5(e,t){return mee+e+yee[t]}var bee={3:2*xc+Kc,4:0*xc+jc,7:5*xc+jc,8:2*xc+Xc,10:5*xc+Kc,11:0*xc+Xc,12:6*xc+Kc,13:5*xc+jc+Kc,14:2*xc+Kc+Xc,15:9*xc+jc,16:0*xc+jc+Xc,17:1*xc+Xc};function wv(e,t){var r;return hee+e+((r=bee[t])!=null?r:xc*t)}var xee={18:10*Af+Kc,21:7*Af+Kc,23:16*Af+jc,25:13*Af+jc,27:4*Af+Xc,29:0*Af+Xc};function yN(e,t){var r;return e+((r=xee[t])!=null?r:Af*t)}var gy=class{constructor(t,r,n,i,o){this.PAConstructor=t;this.x=r;this.y=n;this.z=i;this.gridsize=o;this.i=0;this.j=0;this.k=0;this.cubeVertex=new Array(9);this.cubeVertexValue=new this.PAConstructor(9);if(o>250)throw new Error("Programming Error: resolution should be clamped well below 250.");this.size=new Yt(this.x.width/o,this.y.width/o,this.z.width/o)}loopOverUnitCubes(t){let r=this.gridsize,n=r+1,i=new wI(this.x.min,this.y.min,this.z.min,this.size.x,this.size.y,this.size.z,r+1,r+1,r+1),o=new wI(this.x.min+this.size.x/2,this.y.min+this.size.y/2,this.z.min+this.size.z/2,this.size.x,this.size.y,this.size.z,r,r,r),a=i.setupArray(this.PAConstructor),s=i.setupArray(this.PAConstructor),c=o.setupArray(this.PAConstructor);this.evaluateArray(s,i,0);for(let l=0;l<r;l++){this.k=l,[a,s]=[s,a],this.evaluateArray(s,i,l+1),this.evaluateArray(c,o,l);for(let u=0;u<r;u++){this.j=u;for(let d=0;d<r;d++){this.i=d;let f=u*n+d;this.cubeVertexValue.setFrom(0,a,f),this.cubeVertexValue.setFrom(1,a,f+n),this.cubeVertexValue.setFrom(2,a,f+n+1),this.cubeVertexValue.setFrom(3,a,f+1),this.cubeVertexValue.setFrom(4,s,f),this.cubeVertexValue.setFrom(5,s,f+n),this.cubeVertexValue.setFrom(6,s,f+n+1),this.cubeVertexValue.setFrom(7,s,f+1),this.cubeVertexValue.setFrom(8,c,u*r+d),t()}}}}evaluateArray(t,r,n){let i=r.z0+n*r.dz;for(let o=0;o<r.numX;o++)for(let a=0;a<r.numY;a++){let s=r.x0+o*r.dx,c=r.y0+a*r.dy;this.setAt(t,a*r.numX+o,s,c,i)}}setVertexPositions(){for(let t=0;t<9;t++){let r=y5[t];this.cubeVertex[t]=[this.x.min+(this.i+r[0])*this.size.x,this.y.min+(this.j+r[1])*this.size.y,this.z.min+(this.k+r[2])*this.size.z]}}},wI=class{constructor(t,r,n,i,o,a,s,c,l){this.x0=t;this.y0=r;this.z0=n;this.dx=i;this.dy=o;this.dz=a;this.numX=s;this.numY=c;this.numZ=l}setupArray(t){return new t(this.numX*this.numY)}};var EI=class{constructor(t){this.length=t;this.n=1;this.buffer=new Float64Array(t)}set(t,r){this.buffer[t]=r}get(t){return this.buffer[t]}setFrom(t,r,n){if(r.n!==this.n)throw new Error("Programming Error: Mismatched dimensions");this.set(t,r.get(n))}},II=class{constructor(t){this.length=t;this.n=2;this.buffer=new Float64Array(t*2)}set(t,r,n){this.buffer[t*2]=r,this.buffer[t*2+1]=n}getX(t){return this.buffer[t*2]}getY(t){return this.buffer[t*2+1]}setFrom(t,r,n){if(r.n!==this.n)throw new Error("Programming Error: Mismatched dimensions");this.set(t,r.getX(n),r.getY(n))}};function Ev(e,t,r,n,i,o=100){if(isFinite(n)||([n,i]=[i,n],[t,r]=[r,t]),isFinite(i))return bN(e,t,r,n,i,o);for(;;){let a=gc(t,r,.5),s=e(...a);if(s===0)return a;if(!isFinite(s))r=a,i=s;else if(n<0==s<0)t=a,n=s;else return r=a,i=s,bN(e,t,r,n,i,o);if(o*=.5,o<1)return}}function T5(e,t,r,n,i,o=100){if(isFinite(n)||([n,i]=[i,n],[t,r]=[r,t]),!isFinite(i))for(;;){let a=gc(t,r,.5),s=e(...a);if(s===0)return{posNeg:a};if(!isFinite(s))r=a,i=s;else if(n<0==s<0)t=a,n=s;else if(n>0){r=a,i=s;break}else return{posNeg:xN(e,a,t,s,n,o),posNaN:vee(e,a,r,o)};if(o*=.5,o<1){let c=gc(t,r,.5);return n>0?{posNaN:c}:{}}}return{posNeg:bN(e,t,r,n,i,o)}}function bN(e,t,r,n,i,o){return n>0?xN(e,t,r,n,i,o):xN(e,r,t,i,n,o)}function xN(e,t,r,n,i,o){let a=n-i;for(;;){let s=gc(t,r,.5),c=e(...s);if(c<0)r=s,i=c;else if(c>0)t=s,n=c;else return c===0?s:void 0;if(o*=.5,o<1){if(n-i<.1*a)return gc(t,r,.5);if(o<1e-6)return}}}function vee(e,t,r,n){for(;;){let i=gc(t,r,.5),o=e(...i);if(!isFinite(o))r=i;else if(o>=0)t=i;else return;if(n*=.5,n<1)return gc(t,r,.5)}}var Cv=50;function Of(e){return e!==void 0&&e!==0}function Tee(e){return Of(e.posNeg)||Of(e.posNaN)}var Iv={};function vN(e=Iv,t=Iv,r=Iv){return{edge0:e,edge1:t,edge2:r}}function w5(e,t,r,n,{isInequality:i}){return new TN(e,t,new _t(r.xmin,r.xmax),new _t(r.ymin,r.ymax),new _t(r.zmin,r.zmax),n,{isInequality:i}).fullLoopOverUnitCubes()}var TN=class extends gy{constructor(r,n,i,o,a,s,{isInequality:c}){super(EI,i,o,a,s);this.f=r;this.gradient=n;this.cubeEdge=new Array(26);this.face=vN();this.cubeHasCrossing=!1;this.allNormalsFromGradient=!0;this.normalFromGradient=[];this.edgesMaybeCross=0;this.positions=[];this.uvs=[];this.normals=[];this.triangles=[];this.isInequality=c,this.sheet=Array((s+1)*(s+1)),this.strip=Array(s+1);for(let l=0;l<(s+1)*(s+1);l++)this.sheet[l]=vN();for(let l=0;l<s+1;l++)this.strip[l]=vN()}setAt(r,n,i,o,a){let s=this.f(i,o,a);r.set(n,s)}fullLoopOverUnitCubes(){this.positions=[],this.normals=[],this.triangles=[],this.loopOverUnitCubes(this.onEachCube.bind(this));let{uvs:r,positions:n,normals:i}=this;if(!this.allNormalsFromGradient)for(let o=0;o<i.length/3;o++){if(this.normalFromGradient[o])continue;let a=i[3*o],s=i[3*o+1],c=i[3*o+2],l=Math.sqrt(a*a+s*s+c*c);i[3*o]=a/l,i[3*o+1]=s/l,i[3*o+2]=c/l}return sy(this.triangles,this.positions,i,r,0,[],.7),{positions:n,normals:i,faces:this.triangles,uvs:r,resolved:!0,extraAttrs:[]}}onEachCube(){this.edgesMaybeCross=0,this.cubeHasCrossing=!1;for(let r=0;r<26;r++){let n=this.cubeVertexValue.get(Eo[r*2]),i=this.cubeVertexValue.get(Eo[r*2+1]);(n===0||i===0)&&(this.cubeHasCrossing=!0),!(n>0&&i>0||n<0&&i<0)&&(isFinite(n)||isFinite(i))&&(this.edgesMaybeCross|=1<<r)}this.edgesMaybeCross&&(this.setVertexPositions(),this.setEdges()),this.saveEdges(),this.cubeHasCrossing&&this.generateTriangles()}setEdges(){let{i:r,j:n,k:i,gridsize:o}=this,a=this.sheet[(r+0)*(o+1)+n+0],s=this.sheet[(r+1)*(o+1)+n+0],c=this.sheet[(r+0)*(o+1)+n+1],l=0;i>0&&(this.cubeEdge[0]=a.edge0,this.cubeEdge[1]=a.edge1,this.cubeEdge[2]=a.edge2,this.cubeEdge[3]=c.edge2,this.cubeEdge[4]=s.edge0,l|=31),n>0&&(this.cubeEdge[5]=this.strip[r].edge0,this.cubeEdge[6]=this.strip[r].edge1,this.cubeEdge[7]=this.strip[r+1].edge0,this.cubeEdge[8]=this.strip[r].edge2,l|=480,i==0&&(this.cubeEdge[2]=a.edge2,l|=4)),r>0&&(this.cubeEdge[9]=this.face.edge0,this.cubeEdge[10]=this.face.edge1,this.cubeEdge[11]=this.face.edge2,l|=3584,i==0&&(this.cubeEdge[0]=a.edge0,l|=1),n==0&&(this.cubeEdge[5]=this.strip[r].edge0,l|=32));for(let u=0;u<26;u++){if(~this.edgesMaybeCross>>u&1){this.cubeEdge[u]=Iv;continue}if(l>>u&1){!this.cubeHasCrossing&&(this.cubeEdge[u].posNeg||this.cubeEdge[u].posNaN)&&(this.cubeHasCrossing=!0);continue}let d=this.findSurfaceCrossingEDI(Eo[u*2],Eo[u*2+1]);this.cubeEdge[u]=d,Tee(d)&&(this.cubeHasCrossing=!0)}}saveEdges(){let{i:r,j:n,k:i,gridsize:o}=this;i<o-1&&(this.sheet[(r+0)*(o+1)+n+0].edge0=this.cubeEdge[11],this.sheet[(r+0)*(o+1)+n+0].edge1=this.cubeEdge[17],this.sheet[(r+0)*(o+1)+n+0].edge2=this.cubeEdge[8]),n<o-1&&(this.strip[r].edge0=this.cubeEdge[10],this.strip[r].edge1=this.cubeEdge[12],this.strip[r].edge2=this.cubeEdge[14]),r<o-1&&(this.face.edge0=this.cubeEdge[15],this.face.edge1=this.cubeEdge[13],this.face.edge2=this.cubeEdge[16]),i==0&&(this.sheet[(r+0)*(o+1)+n+1].edge2=this.cubeEdge[3],this.sheet[(r+1)*(o+1)+n+0].edge0=this.cubeEdge[4]),n==0&&(this.strip[r+1].edge0=this.cubeEdge[7]),n==o-1&&(this.sheet[r*(o+1)+o].edge2=this.cubeEdge[14]),r==o-1&&(this.sheet[(o+0)*(o+1)+n].edge0=this.cubeEdge[16],this.strip[o].edge0=this.cubeEdge[13])}findSurfaceCrossingEDI(r,n){let i=this.cubeVertexValue.get(r),o=this.cubeVertexValue.get(n);if(i===0||o===0)return Iv;let a=this.cubeVertex[r],s=this.cubeVertex[n];if(this.isInequality){let{posNeg:c,posNaN:l}=T5(this.f,a,s,i,o);return{posNeg:c!==void 0?this.pushPositionWithGradient(...c):void 0,posNaN:l!==void 0?this.pushPositionNoGradient(...l):void 0}}else{let c=Ev(this.f,a,s,i,o);return{posNeg:c!==void 0?this.pushPositionWithGradient(...c):void 0}}}pushPositionWithGradient(r,n,i){if(!(isFinite(r)&&isFinite(n)&&isFinite(i)))return 0;let[o,a,s]=this.computeGradient(r,n,i),c=Math.sqrt(o*o+a*a+s*s);return o/=-c,a/=-c,s/=-c,Fm(o,a,s)?(this.normalFromGradient.push(!0),this._pushPositionAndNormal(r,n,i,o,a,s)):this.pushPositionNoGradient(r,n,i)}pushPositionNoGradient(r,n,i){return isFinite(r)&&isFinite(n)&&isFinite(i)?(this.allNormalsFromGradient=!1,this.normalFromGradient.push(!1),this._pushPositionAndNormal(r,n,i,0,0,0)):0}_pushPositionAndNormal(r,n,i,o,a,s){return this.positions.push(r,n,i),this.uvs.push((r-this.x.min)/this.x.width,(n-this.y.min)/this.y.width),this.normals.push(o,a,s),this.positions.length/3}computeGradient(r,n,i){let o=NaN,a=NaN,s=NaN;if(this.gradient&&([o,a,s]=this.gradient(r,n,i),isFinite(o)&&isFinite(a)&&isFinite(s)))return[o,a,s];let c=.001*Math.min(this.size.x,this.size.y,this.size.z),l=this.f(r,n,i);if(isFinite(o)||(o=(this.f(r+c,n,i)-l)/c),isFinite(o)||(o=(l-this.f(r-c,n,i))/c),isFinite(a)||(a=(this.f(r,n+c,i)-l)/c),isFinite(a)||(a=(l-this.f(r,n-c,i))/c),isFinite(s)||(s=(this.f(r,n,i+c)-l)/c),isFinite(s)||(s=(l-this.f(r,n,i-c))/c),isFinite(o)&&isFinite(a)&&isFinite(s))return[o,a,s];let u=NaN,d=NaN,f=NaN,g=NaN,y=NaN,x=NaN,b=c/2;return(!isFinite(o)||!isFinite(a))&&(u=(this.f(r+b,n+b,i)-l)/c,isFinite(u)||(u=(l-this.f(r-b,n-b,i))/c),d=(this.f(r+b,n-b,i)-l)/c,isFinite(d)||(d=(l-this.f(r-b,n+b,i))/c),isFinite(u)&&isFinite(d)&&(isFinite(o)||(o=u+d),isFinite(a)||(a=u-d))),(!isFinite(a)||!isFinite(s))&&(f=(this.f(r,n+b,i+b)-l)/c,isFinite(f)||(f=(l-this.f(r,n-b,i-b))/c),g=(this.f(r,n+b,i-b)-l)/c,isFinite(g)||(g=(l-this.f(r,n-b,i+b))/c),isFinite(f)&&isFinite(g)&&(isFinite(a)||(a=f+g),isFinite(s)||(s=f-g))),(!isFinite(s)||!isFinite(o))&&(y=(this.f(r+b,n,i+b)-l)/c,isFinite(y)||(y=(l-this.f(r-b,n,i-b))/c),x=(this.f(r-b,n,i+b)-l)/c,isFinite(x)||(x=(l-this.f(r+b,n,i-b))/c),isFinite(y)&&isFinite(x)&&(isFinite(o)||(o=y-x),isFinite(s)||(s=y+x))),[o,a,s]}generateTriangles(){for(let r=0;r<12;r++){let n=TI[r],i=[],o=0,a=h5[r],s=0,c=a[0],l=Math.abs(this.cubeVertexValue.get(c));l>s&&isFinite(l)&&(s=l);let u=a[1],d=Math.abs(this.cubeVertexValue.get(u));d>s&&isFinite(d)&&(s=d);let f=a[2],g=Math.abs(this.cubeVertexValue.get(f));g>s&&isFinite(g)&&(s=g);let y=a[3],x=Math.abs(this.cubeVertexValue.get(y));x>s&&isFinite(x)&&(s=x);let b=s*Number.EPSILON*32;if(l<=b){o|=35;let E=this.pushPositionWithGradient(...this.cubeVertex[c]);E!==void 0&&i.push(E)}if(d<=b){o|=21;let E=this.pushPositionWithGradient(...this.cubeVertex[u]);E!==void 0&&i.push(E)}if(g<=b){o|=14;let E=this.pushPositionWithGradient(...this.cubeVertex[f]);E!==void 0&&i.push(E)}if(x<=b){o|=56;let E=this.pushPositionWithGradient(...this.cubeVertex[y]);E!==void 0&&i.push(E)}if(i.length===4)continue;let w;for(let E=0;E<4;E++){let I=a[E];if(this.cubeVertexValue.get(I)>b){w=this.cubeVertex[I];break}}if(w===void 0&&this.isInequality)for(let E=0;E<6;E++){if(o>>E&1)continue;let{posNeg:I,posNaN:S}=this.cubeEdge[n[E]];if(Of(I)&&Of(S)){w=gc(this.positions.slice((I-1)*3,I*3),this.positions.slice((S-1)*3,S*3),.5);break}}if(w===void 0)for(let E=0;E<4;E++){let I=a[E];if(!isFinite(this.cubeVertexValue.get(I))){w=this.cubeVertex[I];break}}if(w===void 0&&o&&i.length>0){let E;for(let I=0;I<4;I++){let S=a[I];if(this.cubeVertexValue.get(S)<-b){E=this.cubeVertex[S];break}}if(E){let I=i[0],S=this.positions.slice((I-1)*3,I*3);w=gc(E,S,2)}}if(w!==void 0){if(this.isInequality){let E=[],I=[],S=!1;for(let D=0;D<6;D++){if(o>>D&1)continue;let{posNeg:O,posNaN:_}=this.cubeEdge[n[D]],A=Of(O),R=Of(_);A&&E.push(O),R&&I.push(_),A&&R&&(S=!0)}if(S){E.push(...i),this.pushTriangleFromCorners(I,w),this.pushTriangleFromCorners(E,w);continue}}for(let E=0;E<6;E++){if(o>>E&1)continue;let{posNeg:I,posNaN:S}=this.cubeEdge[n[E]],D=I||S;Of(D)&&i.push(D)}this.pushTriangleFromCorners(i,w)}}}pushTriangleFromCorners(r,n){if(r.length>=3){let i=r[0]-1,o=r[1]-1,a=r[2]-1;this.pushTriangle(i,o,a,n)}if(r.length==4){let i=r[0]-1,o=r[2]-1,a=r[3]-1;this.pushTriangle(i,o,a,n)}}pushTriangle(r,n,i,o){this.allNormalsFromGradient||this.fixBadNormals(r,n,i,o),this.checkWindingOrder(r,n,i)&&([n,i]=[i,n]),this.triangles.push(r,n,i)}fixBadNormals(r,n,i,o){let a=!this.normalFromGradient[r],s=!this.normalFromGradient[n],c=!this.normalFromGradient[i];if(!(a||s||c))return;let l=this.positions,u=this.normals,d=new Yt(l[3*r],l[3*r+1],l[3*r+2]),f=new Yt(l[3*n],l[3*n+1],l[3*n+2]),g=new Yt(l[3*i],l[3*i+1],l[3*i+2]),y=new Yt().subVectors(g,d),x=new Yt().subVectors(d,f);var b=y.cross(x);let w=new Yt().subVectors(d,new Yt(...o));b.dot(w)<0&&b.multiply(-1),b.isFinite()&&(a&&(u[3*r+0]+=b.x,u[3*r+1]+=b.y,u[3*r+2]+=b.z),s&&(u[3*n+0]+=b.x,u[3*n+1]+=b.y,u[3*n+2]+=b.z),c&&(u[3*i+0]+=b.x,u[3*i+1]+=b.y,u[3*i+2]+=b.z))}checkWindingOrder(r,n,i){let o=this.positions,a=this.normals,s=o[3*i]-o[3*r],c=o[3*i+1]-o[3*r+1],l=o[3*i+2]-o[3*r+2],u=o[3*r]-o[3*n],d=o[3*r+1]-o[3*n+1],f=o[3*r+2]-o[3*n+2],g=c*f-l*d,y=l*u-s*f,x=s*d-c*u,b=a[3*r],w=a[3*r+1],E=a[3*r+2];return g*b+y*w+x*E<0}};var{floor:wee}=Math;function wN(e){let t=[];for(let r of e)t.push(...r),t.push(NaN,NaN,NaN);return t}function Lf(e,t,r,n){(r===void 0||isNaN(r))&&(r=IN(t.min,t.max)),r=ui(wee(r),2,2e3);let{xmin:i,xmax:o,ymin:a,ymax:s,zmin:c,zmax:l}=n.viewport;c!=null||(c=mo.zmin),l!=null||(l=mo.zmax);let u=CI(e,{min:t.min,max:t.max,nInitialSamples:r,xtolerance:(o-i)/1e3,ytolerance:(s-a)/1e3,ztolerance:(l-c)/1e3,map:d=>d});return wN(u.segments)}function EN(e,t,r,n){let i=n.degreeMode?Math.PI/180:1;return Lf(o=>{let a=e(o),s=a[0],c=a[1],l=a[2];return[s*Nn(c*i),s*fn(c*i),l]},t,r,n)}function E5(e,t,r,n){let i=n.degreeMode?Math.PI/180:1;return Lf(o=>{let a=e(o),s=a[0],c=a[1],l=a[2];return[s*fn(l*i)*Nn(c*i),s*fn(l*i)*fn(c*i),s*Nn(l*i)]},t,r,n)}function M5(e,t,r,n){let i=Eee(e,t,r,n);return wN(i)}function Eee(e,t,r,n){return new MN(e,t,new _t(r.xmin,r.xmax),new _t(r.ymin,r.ymax),new _t(r.zmin,r.zmax),n).run()}var Iee={},MN=class extends gy{constructor(r,n,i,o,a,s){super(II,i,o,a,s);this.f=r;this.g=n;this.vertexFGZs={};this.vertexZeroF={};this.vertexZeroG={};this.threshF=0;this.threshG=0;this.cubeID=0;this.edgesMaybeCrossF=0;this.edgesMaybeCrossG=0;this.tetEdgeCrossings=new Array(26);this.edgeFGZs=new Array(26);this.edgeCrossings=new Map;this.allFGZs=new Map}setAt(r,n,i,o,a){let s=this.f(i,o,a),c=this.g(i,o,a);r.set(n,s,c)}run(){return this.loopOverUnitCubes(this.onEachCube.bind(this)),this.traceCurves()}onEachCube(){this.cubeID=x5(this.i,this.j,this.k),this.pruneEdges(),this.edgesMaybeCrossF&&this.edgesMaybeCrossG&&(this.setVertexPositions(),this.setVertexZeros(),this.setEdgeCrossings(),this.insertCurveSegmentsFromCube())}pruneEdges(){this.edgesMaybeCrossF=0,this.edgesMaybeCrossG=0;for(let r=0;r<26;r++){let n=Eo[r*2],i=Eo[r*2+1],o=this.cubeVertexValue.getX(n),a=this.cubeVertexValue.getY(n),s=this.cubeVertexValue.getX(i),c=this.cubeVertexValue.getY(i);!(o>0&&s>0||o<0&&s<0)&&(isFinite(o)||isFinite(s))&&(this.edgesMaybeCrossF|=1<<r),!(a>0&&c>0||a<0&&c<0)&&(isFinite(a)||isFinite(c))&&(this.edgesMaybeCrossG|=1<<r)}}setVertexZeros(){let r=0,n=0;for(let a=0;a<9;a++){let s=this.cubeVertexValue.getX(a),c=this.cubeVertexValue.getY(a),l=Math.abs(s),u=Math.abs(c);l>r&&isFinite(l)&&(r=l),u>n&&isFinite(l)&&(n=u)}let i=this.threshF=r*Number.EPSILON*32,o=this.threshG=n*Number.EPSILON*32;for(let a=0;a<9;a++){let s=this.cubeVertexValue.getX(a),c=this.cubeVertexValue.getY(a),l=Math.abs(s),u=Math.abs(c);if(this.vertexZeroF[a]=l<=i,this.vertexZeroG[a]=u<=o,l<=i&&u<=o){let d=this.cubeVertex[a],f=this.createFGZ(v5(this.cubeID,a),d);this.vertexFGZs[a]=f}else this.vertexFGZs[a]=void 0}}getEdgeCrossings(r){let n=this.edgesMaybeCrossF>>r&1,i=this.edgesMaybeCrossG>>r&1;if(!n&&!i)return Iee;let o=wv(this.cubeID,r),a=this.edgeCrossings.get(o);if(a!==void 0)return a;let s=this.getEdgeCrossingsUncached(r,n,i);return this.edgeCrossings.set(o,s),s}getEdgeCrossingsUncached(r,n,i){let o=Eo[r*2],a=Eo[r*2+1],s=this.cubeVertexValue.getX(o),c=this.cubeVertexValue.getY(o),l=this.cubeVertexValue.getX(a),u=this.cubeVertexValue.getY(a),d=this.cubeVertex[o],f=this.cubeVertex[a],g=!n||s===0||l===0?void 0:Ev(this.f,d,f,s,l),y=!i||c===0||u===0?void 0:Ev(this.g,d,f,c,u),x=this.threshF;!g&&y&&Math.abs(s)<=x&&Math.abs(l)<=x&&Math.abs(this.f(y[0],y[1],y[2]))<=x&&(g=y);let b=this.threshG;return!y&&g&&Math.abs(c)<=b&&Math.abs(u)<=b&&Math.abs(this.g(g[0],g[1],g[2]))<=b&&(y=g),{f:g,g:y}}getTriangleCrossing(r){let n=yN(this.cubeID,r),i=this.allFGZs.get(n);if(i!==void 0)return i;let o=this.getTriangleCrossingUncached(r);return this.allFGZs.set(n,o),o}createFGZ(r,n){let i=this.allFGZs.get(r);if(i)return i;let o={id:r,pos:n,connections:[],visited:!1};return this.allFGZs.set(r,o),o}getTriangleCrossingUncached(r){let n=[],i=[],o=hN[r];for(let s=0;s<3;s++){let c=o[s];if(this.vertexFGZs[c])return null;this.vertexZeroF[c]&&n.push(this.cubeVertex[c]),this.vertexZeroG[c]&&i.push(this.cubeVertex[c])}let a=mN[r];for(let s=0;s<3;s++){let c=a[s],l=this.tetEdgeCrossings[c];if(this.edgeFGZs[c]||!l)continue;let u=l.f,d=l.g,f=Eo[2*c],g=Eo[2*c+1];u&&!this.vertexZeroF[f]&&!this.vertexZeroF[g]&&n.push(u),d&&!this.vertexZeroG[f]&&!this.vertexZeroG[g]&&i.push(d)}if(n.length===2&&i.length===2){let s=Cee(n[0],n[1],i[0],i[1]);return s?{id:yN(this.cubeID,r),pos:s,connections:[],visited:!1}:null}else return null}setEdgeCrossings(){for(let r=0;r<26;r++){let n=this.getEdgeCrossings(r),i=n.f,o=n.g,a=Eo[r*2],s=Eo[r*2+1];if(this.vertexFGZs[a]||this.vertexFGZs[s])this.tetEdgeCrossings[r]=void 0,this.edgeFGZs[r]=void 0;else if(i&&this.vertexZeroG[a]&&this.vertexZeroG[s]){let c=this.createFGZ(wv(this.cubeID,r),i);this.edgeFGZs[r]=c,this.tetEdgeCrossings[r]=void 0}else if(o&&this.vertexZeroF[a]&&this.vertexZeroF[s]){let c=this.createFGZ(wv(this.cubeID,r),o);this.edgeFGZs[r]=c,this.tetEdgeCrossings[r]=void 0}else if(i&&o&&rd(i,o)<1e-8){let c=this.createFGZ(wv(this.cubeID,r),i);this.edgeFGZs[r]=c,this.tetEdgeCrossings[r]=void 0}else this.edgeFGZs[r]=void 0,this.tetEdgeCrossings[r]=n}}insertCurveSegmentsFromCube(){for(let r=0;r<12;r++)this.insertCurveSegmentsFromTetrahedron(r)}insertCurveSegmentsFromTetrahedron(r){let n=[],i=b5[r];for(let u=0;u<4;u++){let d=this.getTriangleCrossing(i[u]);d&&n.push(d)}let o=[],a=TI[r];for(let u=0;u<6;u++){let d=this.edgeFGZs[a[u]];d&&o.push(d)}let s=[],c=[Eo[a[0]*2],Eo[a[0]*2+1],Eo[a[3]*2],Eo[a[3]*2+1]];for(let u of c){let d=this.vertexFGZs[u];d&&s.push(d)}let l=[...s,...o,...n];switch(l.length){case 0:case 1:break;case 2:this.connectCrossings(l[0],l[1]);break;case 3:n.length===2&&this.connectCrossings(n[0],n[1]);break;case 4:n.length===4&&(this.connectCrossings(n[0],n[1]),this.connectCrossings(n[2],n[3]));break;default:throw new Error("Programming error: 5 is impossible.")}}connectCrossings(r,n){r.connections.some(i=>i.id===n.id)||n.connections.some(i=>i.id===r.id)||r.connections.length>=2||n.connections.length>=2||(r.connections.push(n),n.connections.push(r))}traceCurves(){let r={xtolerance:this.size.x*.1,ytolerance:this.size.y*.1,ztolerance:this.size.z*.1,map:i=>i},n=new bc(r);for(let i of this.allFGZs.values())i&&!i.visited&&i.connections.length===1&&this.traceCurve(n,i);for(let i of this.allFGZs.values())i&&!i.visited&&this.traceCurve(n,i);return n.finish().segments}traceCurve(r,n){let i=n;for(;;){r.addPoint(n.pos),n.visited=!0;let o;for(let a of n.connections)a.visited||(o=a);if(!o)break;n=o}i.connections.length===2&&r.addPoint(i.pos),r.breakSegment()}},[PI,I5,CN]=[new Yt,new Yt,new Yt],C5=new Yt,[PN,SN,P5]=[new Yt,new Yt,new Yt],[SI,S5,MI]=[new Yt,new Yt,new Yt];function Cee(e,t,r,n){PI.set(e[0],e[1],e[2]),I5.set(t[0],t[1],t[2]),CN.set(r[0],r[1],r[2]),C5.set(n[0],n[1],n[2]),PN.subVectors(I5,PI),SN.subVectors(C5,CN),P5.subVectors(CN,PI),SI.crossVectors(PN,SN),S5.crossVectors(P5,SN);let i=SI.dot(S5)/SI.dot(SI);return 0<=i&&i<=1?(MI.addVectors(PI,PN.multiply(i)),[MI.x,MI.y,MI.z]):null}var D5=80;var DN=class extends cy{constructor(r,n,i,o,a,s){let c=i.width/1e8,l=o.width/1e8;super({resolution:a,uRange:i,vRange:o,du:c,dv:l,extraAttrCount:s});this.vertices=[];this.fn=r=>{let n=this._fn(r),i=this.tangentInForced(r,[this.du,0],n),o=this.tangentInForced(r,[0,this.dv],n),a=Vm(i,o);return{uv:r,f:n,normal:a,dfEast:i,dfNorth:o}};this._fn=u=>r(u[0],u[1]),this.xmin=n.xmin*6-n.xmax*5,this.xmax=n.xmax*6-n.xmin*5,this.ymin=n.ymin*6-n.ymax*5,this.ymax=n.ymax*6-n.ymin*5,this.zmin=n.zmin*6-n.zmax*5,this.zmax=n.zmax*6-n.zmin*5,this.distThresh=((n.xmax-n.xmin)*1e-6)**2}getVertexCount(){return this.vertices.length}getUV(r){return this.vertices[r].uv}getNormal(r){return this.vertices[r].normal}_addVertex(r){return this.vertices.push(r)-1}copyVertex(r){return this.addVertex(this.vertices[r])}getF(r){return this.vertices[r].f}getDfNorth(r){return this.vertices[r].dfNorth}getDfEast(r){return this.vertices[r].dfEast}insidePaddedDomain(r){return this.zmin<=r[2]&&r[2]<=this.zmax&&this.ymin<=r[1]&&r[1]<=this.ymax&&this.xmin<=r[0]&&r[0]<=this.xmax}tangentInForced(r,n,i){let o=Hb(r,n);return wS(this._fn(o),i)}_isVertexAtCrease(r){let n=this.getUV(r),i=this.getDfEast(r),o=this.getDfNorth(r),a=this.getF(r),s=this.tangentInForced(n,[-this.du,0],a);if(ES(s,i)/Math.sqrt(km(s)*km(i))>-ly)return!0;let l=this.tangentInForced(n,[0,-this.dv],a);return ES(o,l)/Math.sqrt(km(o)*km(l))>-ly}hintedNormal(r,n){let i=this.getUV(r),o=this.getF(r),a=Vm(this.tangentInForced(i,n[0],o),this.tangentInForced(i,n[1],o));return Fm(...a)?a:this.getNormal(r)}getVertex(r){if(this.allowVertex(r))return this.getF(r)}getExtraAttr(r,n){return this.vertices[r].f[3+n]}findJumpBetweenTwoSamples(r,n){let i=this.getUV(r),o=this.getF(r),a=0,s=this.getUV(n),c=this.getF(n),l=1,u=g=>this._fn(Ci(i,s,g));if(!isFinite(o[0])||!isFinite(o[1])||!isFinite(o[2])||!isFinite(c[0])||!isFinite(c[1])||!isFinite(c[2]))return;let f=l1(a,o,l,c,u,(this.xmax-this.xmin)*1e-6,0,0);if(f)return[this.fn(Ci(i,s,pc(f[0],0,1e-5))),this.fn(Ci(i,s,pc(f[1],1,1e-5)))]}clip(r){return this.insidePaddedDomain(r)?r:[NaN,NaN,NaN]}findFiniteBetweenTwoSamples(r,n){let i=this.getUV(r),o=this.getF(r),a=this.getUV(n),s=this.getF(n),c=u=>this.clip(this._fn(Ci(i,a,u))),l=c1(0,this.clip(o),1,this.clip(s),c);if(l!==void 0)return this.fn(Ci(i,a,l))}allowVertex(r){return this.insidePaddedDomain(this.getF(r))}isDegenerate(r,n,i){let o=this.getF(r),a=this.getF(n);if(rd(o,a)<this.distThresh)return!0;let s=this.getF(i);return rd(a,s)<this.distThresh||rd(o,s)<this.distThresh}};function Pv(e,t,r,n,i,o){let a=new DN(e,t,r,n,i,o);return pI(a)}function _N(e){return Math.abs(e)<5e-8}var Sv=class extends bc{constructor(t,r,n){let{tolerance:i,mathToPixels:o}=t;super({tolerance:i,map:a=>o.mapCoordinatePair(a)}),this.fn=r,this.mappedFn=a=>o.mapY(r(a)),this.derivative=n,this.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},this.zeroBuffer=[],this.extremumBuffer=[]}getPOI(){return Nl.pointsOfInterest?(this.poiData.intercept=this.findIntercept(this.fn),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}}addPoint(t){this.segment.length===0&&_N(t[1])&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.updateZeroBuffer(t),this.updateExtremumBuffer(t),super.addPoint(t)}updateZeroBuffer(t){let[r,n]=this.map?this.map(t):t;if(!isFinite(r)||!isFinite(n)){this.zeroBuffer.length=0;return}switch(this.zeroBuffer.length){case 0:{if(_N(t[1]))return;this.zeroBuffer.push(t);return}case 1:if(t[1]===0){this.zeroBuffer.push(t);return}else if(t[1]>0!=this.zeroBuffer[0][1]>0){let i=SS(this.zeroBuffer[0][0],this.zeroBuffer[0][1],t[0],t[1],this.fn);i&&(this.poiData.zeros.x.push(i[0]),this.poiData.zeros.y.push(i[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}case 2:{if(t[1]===0)return;if(t[1]>0!=this.zeroBuffer[0][1]>0){let i=Yb(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],t[0],t[1],this.fn);i&&(this.poiData.zeros.x.push(i[0]),this.poiData.zeros.y.push(i[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(t);return}}}}updateExtremumBuffer(t){let[r,n]=this.map?this.map(t):t;if(!isFinite(r)||!isFinite(n)){this.extremumBuffer.length=0;return}switch(this.extremumBuffer.length){case 0:{this.extremumBuffer.push(t);return}case 1:{t[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),this.extremumBuffer.push(t);return}case 2:if(t[1]===this.extremumBuffer[1][1]){this.extremumBuffer.push(t);return}else if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let i=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1]);i&&(this.poiData.extrema.x.push(i[0]),this.poiData.extrema.y.push(i[1]),!Gm(this.extremumBuffer[0][0],this.mappedFn(this.extremumBuffer[0][0]),i[0],this.mappedFn(i[0]),t[0],this.mappedFn(t[0]),this.mappedFn,this.ytolerance)&&i[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=i)),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}case 3:{if(t[1]===this.extremumBuffer[1][1])return;if(t[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let i,o=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),a=this.fn(o);a===this.extremumBuffer[1][1]?i=Yb(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],t[0],t[1],this.fn):i=this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],o,a,this.extremumBuffer[2][0],this.extremumBuffer[2][1]),i&&(this.poiData.extrema.x.push(i[0]),this.poiData.extrema.y.push(i[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}else{this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(t);return}}}}bisectExtremumUsingDerivative(t,r,n,i,o,a){let s;if(this.derivative){let c=this.derivative(t),l=this.derivative(o);if(!isNaN(c)&&!isNaN(l)&&(i>r&&c>0&&l<0||i<r&&c<0&&l>0)){let u=SS(t,c,o,l,this.derivative);u&&(s=[u[0],this.fn(u[0])])}}return s||(s=I2(t,r,n,i,o,a,this.fn)),s}breakSegment(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),_N(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]}findIntercept(t){if(!t)return{x:[],y:[]};let r=t(0);return isFinite(r)?{x:[0],y:[t(0)]}:{x:[],y:[]}}finish(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}}};var{floor:_5}=Math,A5=1e4,DI=5,O5=(e,t,r)=>({x:e,y:t,z:r}),L5=(e,t,r)=>({x:r,y:e,z:t}),N5=(e,t,r)=>({x:e,y:r,z:t}),_I=class{constructor(){this.xmin=mo.xmin;this.xmax=mo.xmax;this.ymin=mo.ymin;this.ymax=mo.ymax;this.zmin=mo.zmin;this.zmax=mo.zmax}},Pee=0;function Na(){return"result_"+Pee++}function See(){return{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}}function G5(e){return{graphMode:15,error:e,segments:[]}}function ON(e,t){let r=e[0]+t.min*e[1],n=e[0]+t.max*e[1],i={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}};if(!isFinite(r)||!isFinite(n))return{segments:[],poi:i,resolved:!0};let o=[[t.min,r,t.max,n]],a=-e[0]/e[1];return!isNaN(a)&&a>=t.min&&a<=t.max&&(i.zeros.x.push(a),i.zeros.y.push(0)),0>=t.min&&0<=t.max&&(i.intercept.x.push(0),i.intercept.y.push(e[0])),{segments:o,poi:i,resolved:!0}}function Mee(e,t){let r=ON(e[0],t),n=ON(e[1],t);return r.segments.length&&n.segments.length&&r.segments[0].length===4&&n.segments[0].length===4?{segments:[[r.segments[0][1],n.segments[0][1],r.segments[0][3],n.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function Dee(e,t){let r=e(t);return{segments:[[...r,...r]],resolved:!0}}function R5(e,t,r){let{mappedFn:n,jumpTolerance:i,screen:o}=r,[a,s]=e,[c,l]=t,u=ru(a,c),d=n(u),f=o.height;if(!(s<0&&l<0&&(s>=d||l>=d))&&!(s>f&&l>f&&(s<=d||l<=d)))return Gm(a,s,u,d,c,l,n,i)}var AN=(e,t,r)=>{let{fn:n,mappedFn:i,jumpTolerance:o,accumulator:a}=r;if(!isFinite(o)||o<=0)return;let s=R5(e,t,r);if(!s)return;let c=(t[0]-e[0])/10,l=[-c,c],u;for(let d=0;d<l.length;d++){let f=e[0]+l[d],g=i(f);isFinite(g)||([f,g]=e,f=e[0],g=e[1]);let y=t[0]+l[d],x=i(y);if(isFinite(x)?u=y:[y,x]=t,R5([f,g],[y,x],r)){let[b,w]=s;a.addPoint([b,n(b)]),a.breakSegment(),a.addPoint([w,n(w)]);return}}return u},LN=class{constructor(t,r,n){let i=o=>r.mathToPixels.mapY(t(o));this.derivative=n,this.accumulator=new Sv(r,t,n),this.fn=t,this.mathToPixels=r.mathToPixels,this.mappedFn=i,this.jumpTolerance=r.tolerance||0,this.screen=r.screen}};function k5(e,t,r,n){let i=r,o=e(i),a=t.mapY(o);return n>0&&!isFinite(a)&&(i=r+n,o=e(i),a=t.mapY(o)),n>0&&!isFinite(a)&&(i=r-n,o=e(i),a=t.mapY(o)),[i,o,a]}function _ee(e,t,r){let n=new LN(e,t,r),{mathToPixels:i,mappedFn:o}=n,a=t.nInitialSamples,[s,c,l]=k5(e,i,t.min,0);isFinite(l)&&n.accumulator.addPoint([s,c]);for(var u=1;u<a;u++){let d=i.interpolateX(t.min,t.max,u/(a-1)),f=u===a-1?0:Math.abs(s-d)/10,[g,y,x]=k5(e,i,d,f);if(isFinite(x)&&isFinite(l)){let b=AN([s,l],[g,x],n);b!==void 0&&(g=b,y=e(g),x=i.mapY(y)),n.accumulator.addPoint([g,y])}else if(isFinite(x)&&!isFinite(l)){let b=ya(s,l,g,x,o);if(b!==void 0){b!==g&&n.accumulator.addPoint([b,e(b)]);let w=AN([b,o(b)],[g,x],n);w!==void 0&&(g=w,y=e(g),x=i.mapY(y)),n.accumulator.addPoint([g,y])}}else if(!isFinite(x)&&isFinite(l)){let b=ya(s,l,g,x,o);if(b!==void 0){let w=AN([s,l],[b,o(b)],n);w!==void 0&&(b=w),b!==s&&n.accumulator.addPoint([b,e(b)]),n.accumulator.breakSegment()}}s=g,c=y,l=x}return n.accumulator.finish()}function Aee(e){let{fn:t,min:r,max:n}=e,i=Math.floor(r),o=Math.ceil(n),a=!0;o-i+1>A5&&(o=i+(A5-1),a=!1);let s=[];for(let c=i;c<=o;c++){let l=t(c);!isFinite(c)||!isFinite(l)||s.push([c,l])}return{segments:s,resolved:a}}function Oee(e,t,r,n){let i=t.min,o=t.max-t.min,a=t.rtoleranceMath,s=Math.floor(o/(Math.PI/r)),c,l,u;function d(f,g){let y=g%2===0?1:-1;if(!n&&y===-1)return!1;let x=g*(Math.PI/r),b=[i,i+1,i+2,i+3],w=!1;for(let E=0,I=b.length;E<I;E++){let S=f(b[E]),D=f(b[E]+x);if(isFinite(S)&&isFinite(D)&&(w=!0),isFinite(S)!==isFinite(D)||Math.abs(S-y*D)>a)return!1}return!!w}for(c=1;c<=s;c++)if(d(e,c)){for(u=c,l=2;l*c<=s;l++)d(e,l*c)||(u=void 0);if(u)break}return u?u*(Math.PI/r):null}function B5(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function CI(e,t){if(t.max<t.min)return{segments:[],resolved:!0};if(t.parameterTransform){let d=t.parameterTransform,f=e;e=g=>f(d(g))}let{xtolerance:r,ytolerance:n,ztolerance:i,map:o}=t,a=new bc({xtolerance:r,ytolerance:n,ztolerance:i,map:o}),s=10,c=t.min,l=e(c);isFinite(l[0])&&isFinite(l[1])&&a.addPoint(l);let u=t.nInitialSamples;for(let d=1;d<u;d++){let f=d/(u-1),g=(1-f)*t.min+f*t.max,y=e(g);Mv(e,c,l,g,y,s,a,t.screen),c=g,l=y}return a.finish()}function Lee(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Mv(e,t,r,n,i,o,a,s){if(n===t)return;let{xtolerance:c,ytolerance:l,ztolerance:u,map:d}=a,f=ru(t,n),g=e(f),y=d(r),x=d(i),b=d(g),w=isFinite(y[0])&&isFinite(y[1])&&(y.length===2||isFinite(y[2])),E=isFinite(x[0])&&isFinite(x[1])&&(x.length===2||isFinite(x[2])),I=isFinite(b[0])&&isFinite(b[1])&&(b.length===2||isFinite(b[2]));if(o===0||f===t||f===n){a.breakSegment(),E&&a.addPoint(i);return}if(!(!w&&!E)){if(w!==E){let S=t,D=n,O=r,_=i;for(;t!==f&&f!==n;)I==w?(t=f,r=g,y=b,w=I):(n=f,i=g,x=b,E=I),f=t+(n-t)/2,g=e(f),b=d(g),I=isFinite(b[0])&&isFinite(b[1])&&(b.length===2||isFinite(b[2]));w?(Mv(e,S,O,t,r,o-1,a,s),a.breakSegment()):(a.breakSegment(),a.addPoint(i),Mv(e,n,i,D,_,o-1,a,s));return}if(w&&I&&E){let S=Lee(y,x),D=El(b[0],b[1],b[2]||0,y[0],y[1],y[2]||0,x[0],x[1],x[2]||0),O=D>.2&&D<.8&&Math.abs(b[0]-(y[0]+D*(x[0]-y[0])))<=c&&Math.abs(b[1]-(y[1]+D*(x[1]-y[1])))<=l&&(y.length===2||Math.abs(b[2]-(y[2]+D*(x[2]-y[2])))<=u);if(S||O||s&&Nee(y,b,x,s)){a.addPoint(i);return}}Mv(e,t,r,f,g,o-1,a,s),Mv(e,f,g,n,i,o-1,a,s)}}function Nee(e,t,r,{width:n,height:i}){return e[0]<0&&r[0]<0&&(e[0]>=t[0]||r[0]>=t[0])||e[0]>n&&r[0]>n&&(e[0]<=t[0]||r[0]<=t[0])||e[1]<0&&r[1]<0&&(e[1]>=t[1]||r[1]>=t[1])||e[1]>i&&r[1]>i&&(e[1]<=t[1]||r[1]<=t[1])}function Ree(){return wc({positions:[],normals:[],faces:[],uvs:[],resolved:!0,extraAttrs:[]})}function NN(e,t,r,n,i,{isInequality:o}){let a=e.fn,s;return t&&!t.includes("z")?s=vI(a,r,n,"z"):t&&!t.includes("x")?s=vI(a,r,n,"x"):t&&!t.includes("y")?s=vI(a,r,n,"y"):s=w5(a,r,n,i,{isInequality:o}),wc(s)}function V5(e,t,r,n,i){let o=Pv(e,t,r,n,i,0);return wc(o)}function kee(e,t,r){let n=e.fn,i=gI((o,a)=>n(o,a),new _t(t.xmin,t.xmax),new _t(t.ymin,t.ymax),new _t(t.zmin,t.zmax),r);return wc(i)}function Vee(e,t,r){let n=e.fn,i=gI((o,a)=>n(o,a),new _t(t.ymin,t.ymax),new _t(t.zmin,t.zmax),new _t(t.xmin,t.xmax),r,[2,0,1]);return wc(i)}function Fee(e,t,r){let n=e.fn,i=gI((o,a)=>n(a,o),new _t(t.zmin,t.zmax),new _t(t.xmin,t.xmax),new _t(t.ymin,t.ymax),r,[1,2,0]);return wc(i)}function Gee(e,t,r,n,i,o){let a=o?Math.PI/180:1,s=e.fn,c=Pv((l,u)=>[l*Nn(u*a),l*fn(u*a),s(l,u)],t,r,n,i,0);return wc(c)}function Bee(e,t,r,n,i,o){let a=o?Math.PI/180:1,s=e.fn,c=Pv((l,u)=>{let d=s(l,u);return[d*Nn(l*a),d*fn(l*a),u,d]},t,r,n,i,1);return wc(c)}function qee(e,t,r,n,i,o){let a=o?Math.PI/180:1,s=e.fn,c=Pv((l,u)=>{let d=s(l,u);return[d*fn(u*a)*Nn(l*a),d*fn(u*a)*fn(l*a),d*Nn(u*a),d]},t,r,n,i,1);return wc(c)}function wc(e){let{positions:t,normals:r,faces:n,uvs:i,extraAttrs:o,resolved:a}=e;return{guid:Na(),positions:new Float32Array(t),normals:new Float32Array(r),faces:new Uint32Array(n),uvs:new Float32Array(i),resolved:a,extraAttrs:new Float32Array(o)}}function F5(e){for(let t of e)if(t!==0)return!1;return!0}function q5(e,t){let{min:r,max:n,mathToPixels:i,nInitialSamples:o}=t,a=i.interpolateX(r,n,0),s=e(a),c=F5(s),l=!1,u=[];for(var d=1;d<o;d++){let f=i.interpolateX(r,n,d/(o-1)),g=e(f),y=F5(g);if(c){a=f,s=g,y||(c=!1);continue}if(y){l?(c=!0,l=!1):l=!0;continue}let x=E2(a,s,f,g,e);x!==void 0&&u.push(x),a=f,s=g}return u}function IN(e,t){let r=t-e;return 1+Math.ceil(r/(r/1e3))}var Wc=.001,Zp=new jp(lN(),lN());function OI(e,t,r){var ce,ee,pe,re,k,Ke,ht,Ze,Te;let{viewport:n,screen:i,xAxisScale:o,yAxisScale:a,degreeMode:s}=e,c=s?Math.PI/180:1,l=e.viewport.xmin,u=e.viewport.xmax,d=e.viewport.ymin,f=e.viewport.ymax,g=(ce=e.viewport.zmin)!=null?ce:mo.zmin,y=(ee=e.viewport.zmax)!=null?ee:mo.zmax,x=((pe=t.domain)==null?void 0:pe.type)==="2d",{uMin:b,uMax:w,vMin:E,vMax:I}=((re=t.domain)==null?void 0:re.type)==="2d"?t.domain:{uMin:0,uMax:1,vMin:0,vMax:1};var S=t.lineWidth;if(t.willConvertTo3D||S>3){let Vt=t.willConvertTo3D?200:e.screen.width;var D=S*(u-l)/Vt;let yt=t.willConvertTo3D?200:e.screen.height;var O=S*(f-d)/yt;l-=D,u+=D,d-=O,f+=O}let A=1/4,R=t.domainBound,W,j=jp.fromRects(xI(n),bI(i),{xAxisScale:o,yAxisScale:a}),Q={xmin:l,xmax:u,ymin:d,ymax:f,zmin:g,zmax:y};switch(t.graphMode){case 1:switch(W=ii(zs([d,f]),R),W.type){case"empty":return!1;case"interval":d=W.bounds[0],f=W.bounds[1]}let Vt=Math.max(DI,1+Math.ceil(Math.abs(j.mapY(f)-j.mapY(d))/A)),yt=new jp(j.yScale,j.xScale);return{min:d,max:f,tolerance:A,nInitialSamples:Vt,mathToPixels:yt,screen:{width:i.height,height:i.width}};case 2:{switch(W=ii(zs([l,u]),R),W.type){case"empty":return!1;case"interval":l=W.bounds[0],u=W.bounds[1]}let qe=Math.max(DI,1+Math.ceil(Math.abs(j.mapX(u)-j.mapX(l))/A));return{min:l,max:u,tolerance:A,nInitialSamples:qe,mathToPixels:j,screen:i}}case 6:{let qe=e.degreeMode?Math.PI/180:1;if(((k=t.domain)==null?void 0:k.type)!=="1d")throw new Error("Expected polar graph to have domain");let{min:at,max:Ne}=t.domain;switch(W=ii(zs([at,Ne]),R),W.type){case"empty":return!1;case"interval":at=W.bounds[0],Ne=W.bounds[1]}let he=Math.max(DI,1+Math.min(Math.ceil(qe*Math.abs(Ne-at)/(2*Math.PI)*1e3),12e3)),ie=Math.abs(j.mapX(u)-j.mapX(l)),ct=Math.abs(j.mapY(f)-j.mapY(d)),je=Math.hypot(ie,ct),Je=Math.hypot(u-l,f-d)/je,er={min:at,max:Ne,screen:i,nInitialSamples:he,xtolerance:A,ytolerance:A,rtoleranceMath:Je,map:([wt,Qe])=>j.mapCoordinatePair(B5([wt,Qe]))};if(!t.domain.isExplicit){let wt=Oee(r,er,qe,t.operator==="=");wt&&(er.max=er.min+wt,er.nInitialSamples=Math.max(DI,1+Math.min(Math.ceil(qe*Math.abs(er.max-er.min)/(2*Math.PI)*1e3),12e3)))}return er}case 5:case 100:{let qe={min:0,max:1},{min:at,max:Ne}=((Ke=t.domain)==null?void 0:Ke.type)==="1d"?t.domain:qe;switch(W=ii(zs([at,Ne]),R),W.type){case"empty":return!1;case"interval":at=W.bounds[0],Ne=W.bounds[1]}let he;return(!isFinite(at)||!isFinite(Ne))&&(he=z5,at=AI(at),Ne=AI(Ne)),{min:at,max:Ne,screen:i,nInitialSamples:IN(at,Ne),xtolerance:A,ytolerance:A,ztolerance:A,parameterTransform:he,map:([ie,ct])=>j.mapCoordinatePair([ie,ct])}}case 8:return{xmin:l,xmax:u,ymin:d,ymax:f,mathToPixels:j,tolerance:A};case 106:return{...Q,u:new _t(l,u),v:new _t(d,f)};case 120:case 122:case 107:return{...Q,u:new _t(d,f),v:new _t(g,y)};case 121:case 123:case 108:return{...Q,u:new _t(l,u),v:new _t(g,y)};case 109:return{...Q,u:new _t(b,x?w:mo.xmax),v:new _t(E,x?I:2*Math.PI)};case 124:case 110:{let{min:qe,max:at}=((ht=t.domain)==null?void 0:ht.type)==="1d"?t.domain:{min:0,max:2*Math.PI};return{...Q,u:new _t(qe,at),v:new _t(g,y)}}case 211:{let{min:qe,max:at}=((Ze=t.domain)==null?void 0:Ze.type)==="1d"?t.domain:{min:0,max:2*Math.PI/c};return{...{xmin:qe,xmax:at,ymin:g,ymax:y},u:new _t(qe,at),v:new _t(g,y),mathToPixels:Zp,tolerance:Wc}}case 212:{let qe=x?w:2*Math.PI/c,at=x?I:Math.PI/c;return{...{xmin:b,xmax:qe,ymin:E,ymax:at},u:new _t(b,qe),v:new _t(E,at),mathToPixels:Zp,tolerance:Wc}}case 215:case 214:return{...{xmin:b,xmax:w,ymin:E,ymax:I},u:new _t(b,w),v:new _t(E,E),mathToPixels:Zp,tolerance:Wc};case 213:{let qe=x?w:mo.xmax,at=x?I:2*Math.PI/c;return{...{xmin:b,xmax:qe,ymin:E,ymax:at},u:new _t(b,qe),v:new _t(E,at),mathToPixels:Zp,tolerance:Wc}}case 111:return{...Q,u:new _t(b,x?w:2*Math.PI/c),v:new _t(E,x?I:Math.PI/c)};case 117:case 118:case 119:case 129:case 130:case 103:case 112:case 126:case 113:case 127:case 210:case 114:return{...Q,u:new _t(b,w),v:new _t(E,I)};case 200:case 201:case 202:case 206:case 205:case 203:case 204:case 207:case 208:{if(t.graphMode===200&&(t.slice_coordinate==="z"||t.slice_coordinate==="_implicit"))return{xmin:l,xmax:u,ymin:d,ymax:f,mathToPixels:j,tolerance:Wc};if(t.graphMode===201&&(t.slice_coordinate==="x"||t.slice_coordinate==="_implicit"))return{...{xmin:d,xmax:f,ymin:g,ymax:y},mathToPixels:Zp,tolerance:Wc};if(t.graphMode===202&&(t.slice_coordinate==="y"||t.slice_coordinate==="_implicit"))return{...{xmin:l,xmax:u,ymin:g,ymax:y},mathToPixels:Zp,tolerance:Wc};let{min:qe,max:at}=((Te=t.domain)==null?void 0:Te.type)==="1d"?t.domain:{min:0,max:2*Math.PI};return{x:new _t(l,u),y:new _t(d,f),z:new _t(g,y),t:new _t(qe,at),u:new _t(b,w),v:new _t(E,I)}}case 209:return t.slice_coordinate==="z"?{xmin:l,xmax:u,ymin:d,ymax:f,mathToPixels:j,tolerance:Wc}:t.slice_coordinate==="x"?{...{xmin:d,xmax:f,ymin:g,ymax:y},mathToPixels:Zp,tolerance:Wc}:t.slice_coordinate==="y"?{...{xmin:l,xmax:u,ymin:g,ymax:y},mathToPixels:Zp,tolerance:Wc}:t.slice_coordinate==="_implicit"?{...Q,u:new _t(l,u),v:new _t(d,f)}:!1;default:return!1}}function z5(e){return Math.sinh(10*e)/(1-e*e)}function AI(e){if(e===1/0)return 1;if(e===-1/0)return-1;let t=Math.asinh(e);return 2*t/(10+Math.sqrt(100+4*t*t))}function LI(e){let{viewState:t,graphInfo:r,compiled:n,maxOverride:i,showPoint:o}=e,a=n.fn,s=OI(t,r,a),c;if(!s)c={segments:[],resolved:!0};else{let{min:d,max:f}=s;c=Aee({fn:a,min:Math.max(d,0),max:i!==void 0?Math.min(i,f):f})}let{points:l,droppedIndices:u}=Av(c.segments);return{segments:[l],droppedIndices:u,graphMode:3,color:r.color,style:r.pointStyle,poi:$c(c.segments),resolved:c.resolved,showPoint:o}}function zee(e){switch(e){case 120:case 122:return 107;case 121:case 123:return 108;case 124:return 110;case 126:return 112;case 127:return 113;default:return e}}function wd(e){var x,b,w,E,I,S,D,O,_;let{viewState:t,graphInfo:r,compiled:n,derivative:i}=e,o=n.fn,{degreeMode:a}=t,s=a?Math.PI/180:1,c=OI(t,r,o),l,u,d,f=zee(r.graphMode),g=t.xAxisScale==="linear"&&t.yAxisScale==="linear";if(!c)l={segments:[],resolved:!0};else{switch(f){case 1:case 2:let A=i?i.fn:void 0;l=r.isLinear&&g&&pf(r.linearCoefficients)?ON(r.linearCoefficients,c):_ee(o,c,A);break;case 6:l=CI(ee=>[ee,o(ee)],c);break;case 8:l=Tv(o,c);break;case 5:c.max===c.min?l=Dee(o,c.min):l=r.isLinear&&g&&pf(r.linearCoefficients)?Mee(r.linearCoefficients,c):CI(o,c);break;case 100:let R=n.fn,{min:W,max:j}=((x=r.domain)==null?void 0:x.type)==="1d"?r.domain:{min:0,max:1};if(!isFinite(W)||!isFinite(j)){W=AI(W),j=AI(j);let ee=R;R=pe=>ee(z5(pe))}let Q=new _t(W,j),ce=Lf(R,Q,r.resolution,t);return{graphMode:100,guid:Na(),points:ce,color:r.color,thickness:r.lineWidth};case 112:case 113:case 130:case 103:case 106:case 107:case 108:case 109:case 110:case 111:{let ee=c,{u:pe,v:re}=ee,k=f===112||f===113,Ke=r.graphMode===122||r.graphMode===123,ht=k?Cv:Ke?2:D5,{resolution:Ze}=r,Te=Ze===void 0||isNaN(Ze)?ht:ui(_5(Ze),2,100),Vt=zs([pe.min,pe.max]).type!=="empty"&&zs([re.min,re.max]).type!=="empty",yt;switch(Vt&&f){case 103:{let Ne=n.fn;yt=V5(Ne,ee,pe,re,Te);break}case 130:{yt=V5((he,ie)=>{let[ct,je]=n.fn(he,ie);return[ct,je,0]},ee,pe,re,Te);break}case 106:yt=kee(n,ee,Te);break;case 107:yt=Vee(n,ee,Te);break;case 108:yt=Fee(n,ee,Te);break;case 109:yt=Gee(n,ee,pe,re,Te,a);break;case 110:yt=Bee(n,ee,pe,re,Te,a);break;case 111:yt=qee(n,ee,pe,re,Te,a);break;case 112:case 113:yt=NN(n,e.dependencies,e.gradient,c,Te,{isInequality:(b=e.isImplicit3dInequality)!=null?b:!1});break;case!1:yt=Ree();break}let qe=r.graphMode===113||r.graphMode===127;return{meshData:yt,resolved:yt.resolved,color:r.color,surfaceOpacity:qe?1:(w=r.surfaceOpacity)!=null?w:1,uvArgs:(E=Zs[r.graphMode])!=null?E:[],extraMeshArgs:(I=Nf[r.graphMode])!=null?I:[],graphMode:f,compiled:n,restrictionShader:e.restrictionShader3d}}case 200:case 201:case 202:case 211:case 206:case 205:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:{let ee=(he,ie,ct)=>{let je=(_u,_d)=>{let _i=ct(_u,_d);return isNaN(_i[0])||isNaN(_i[1])||isNaN(_i[2])?NaN:he(_u,_d)},Fe=t.viewport,{xmin:Je,xmax:er,ymin:wt,ymax:Qe,zmin:zt,zmax:Ms}=Fe,Qs=(Je+er)/2,Ft=(wt+Qe)/2,lg=(zt+Ms)/2,Hf=er-Je,ky=Qe-wt,$f=Ms-zt,Ga=Tv(je,{...ie,map3d:(_u,_d)=>{let[_i,Ad,Yf]=ct(_u,_d);return isNaN(_i)||isNaN(Ad)||isNaN(Yf)?[NaN,NaN,NaN]:[(_i-Qs)/Hf,(Ad-Ft)/ky,(Yf-lg)/$f]}});return{segments:Ga.segments,resolved:Ga.resolved,graphMode:8,color:r.color,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,compiled:n,poi:{}}},pe=n.fn,re=(S=r.slice_value)!=null?S:0,k=(D=r.slice_coordinate)!=null?D:"",Ke=c,ht,Ze,Te,Vt=!0,yt=(he,ie)=>{let je=ee(he,c,(wt,Qe)=>{let{x:zt,y:Ms,z:Qs}=ie(wt,Qe,he(wt,Qe));return[zt,Ms,Qs]}),Fe=r.lineWidth,Je=RI(je,t,Fe,re),er=Je.points;for(let wt=0;wt<er.length/3;wt++){let Qe=er[3*wt],zt=er[3*wt+1],Ms=er[3*wt+2],{x:Qs,y:Ft,z:lg}=ie(Qe,zt,Ms);er[3*wt]=Qs,er[3*wt+1]=Ft,er[3*wt+2]=lg}return Je},qe=(he,ie)=>{let ct=[];for(let Je=0;Je<he.segments.length;Je++){let er=he.segments[Je];for(let wt=0;wt<er.length/2;wt++){let Qe=er[2*wt],zt=er[2*wt+1];ct.push(ie(Qe,zt))}Je<he.segments.length-1&&ct.push([NaN,NaN,0])}let je=r.lineWidth,Fe=t.viewport;return Dv(ct,Fe,je)},at=c,Ne=(he,ie)=>{var je;let ct=ee(he,at,ie);return Vt=(je=ct.resolved)!=null?je:!0,qe(ct,ie)};switch(f){case 200:{if(k==="z")return yt((ie,ct)=>pe(ie,ct)-re,O5);if(k==="_implicit"){let ie=r.slice_function.fn;Te=Ne((Fe,Je)=>ie(Fe,Je,pe(Fe,Je)),(Fe,Je)=>[Fe,Je,pe(Fe,Je)]);break}let he=k==="x";ht=he?Ke.y:Ke.x,Ze=he?ie=>[re,ie,pe(re,ie)]:ie=>[ie,re,pe(ie,re)],Te=Lf(Ze,ht,r.resolution,t);break}case 201:{if(k==="x")return yt((ie,ct)=>pe(ie,ct)-re,L5);if(k==="_implicit"){let ie=r.slice_function.fn;Te=Ne((Fe,Je)=>ie(pe(Fe,Je),Fe,Je),(Fe,Je)=>[pe(Fe,Je),Fe,Je]);break}let he=k==="y";ht=he?Ke.z:Ke.y,Ze=he?ie=>[pe(re,ie),re,ie]:ie=>[pe(ie,re),ie,re],Te=Lf(Ze,ht,r.resolution,t);break}case 202:{if(k==="y")return yt((ie,ct)=>pe(ie,ct)-re,N5);if(k==="_implicit"){let ie=r.slice_function.fn;Te=Ne((Fe,Je)=>ie(Fe,pe(Fe,Je),Je),(Fe,Je)=>[Fe,pe(Fe,Je),Je]);break}let he=k==="x";ht=he?Ke.z:Ke.x,Ze=he?ie=>[re,pe(re,ie),ie]:ie=>[ie,pe(ie,re),re],Te=Lf(Ze,ht,r.resolution,t);break}case 209:{let he=n.fn;if(k==="x")return yt((ie,ct)=>he(re,ie,ct),L5);if(k==="y")return yt((ie,ct)=>he(ie,re,ct),N5);if(k==="z")return yt((ie,ct)=>he(ie,ct,re),O5);if(k==="_implicit"){let{resolution:ie}=r,ct=ie===void 0||isNaN(ie)?Cv:ui(_5(ie),2,100);Te=M5(n.fn,r.slice_function.fn,c,ct);let je=t.viewport,Fe=[];for(let Je=0;Je<Te.length/3;Je++)Fe.push([Te[3*Je],Te[3*Je+1],Te[3*Je+2]]);Te=Dv(Fe,je,r.lineWidth);break}else throw new Error("Programming Error: unexpected slice coordinate")}case 206:case 205:{let he=k==="z";ht=he?Ke.t:Ke.z,Ze=he?ie=>[pe(ie,re),ie,re]:ie=>[pe(re,ie),re,ie],Te=EN(Ze,ht,r.resolution,t);break}case 211:{let he=n.fn,ie;switch(k){case"x":ie=(wt,Qe)=>he(wt,Qe)*Nn(wt*s)-re;break;case"y":ie=(wt,Qe)=>he(wt,Qe)*fn(wt*s)-re;break;case"r":ie=(wt,Qe)=>he(wt,Qe)-re;break;case"_implicit":let er=r.slice_function.fn;ie=(wt,Qe)=>er(he(wt,Qe)*Nn(wt*s),he(wt,Qe)*fn(wt*s),Qe,he(wt,Qe),wt);break;default:throw new Error("Programming Error: bad slice")}let ct=k==="x",je=k==="y",Fe=(er,wt)=>[ct?re:he(er,wt)*Nn(er*s),je?re:he(er,wt)*fn(er*s),wt],Je=ee(ie,at,Fe);Te=qe(Je,Fe),Vt=(O=Je.resolved)!=null?O:!0;break}case 213:{let he=k==="x",ie=k==="y",ct=k==="z",je=n.fn,Fe;switch(k){case"x":Fe=(Qe,zt)=>Qe*Nn(zt*s)-re;break;case"y":Fe=(Qe,zt)=>Qe*fn(zt*s)-re;break;case"z":Fe=(Qe,zt)=>je(Qe,zt)-re;break;case"_implicit":let wt=r.slice_function.fn;Fe=(Qe,zt)=>wt(Qe*Nn(zt*s),Qe*fn(zt*s),je(Qe,zt),Qe,zt);break;default:throw new Error("Programming Error: bad slice")}let Je=(wt,Qe)=>[he?re:wt*Nn(Qe*s),ie?re:wt*fn(Qe*s),ct?re:je(wt,Qe)],er=ee(Fe,at,Je);Te=qe(er,Je);break}case 212:{let he=k==="x",ie=k==="y",ct=k==="z",je=n.fn,Fe;switch(k){case"x":Fe=(Qe,zt)=>je(Qe,zt)*fn(zt*s)*Nn(Qe*s)-re;break;case"y":Fe=(Qe,zt)=>je(Qe,zt)*fn(zt*s)*fn(Qe*s)-re;break;case"z":Fe=(Qe,zt)=>je(Qe,zt)*Nn(zt*s)-re;break;case"rho":Fe=(Qe,zt)=>je(Qe,zt)-re;break;case"_implicit":let wt=r.slice_function.fn;Fe=(Qe,zt)=>wt(je(Qe,zt)*fn(zt*s)*fn(Qe*s),je(Qe,zt)*fn(zt*s)*Nn(Qe*s),je(Qe,zt)*Nn(zt*s),je(Qe,zt),Qe,zt);break;default:throw new Error("Programming Error: bad slice")}let Je=(wt,Qe)=>[he?re:je(wt,Qe)*fn(Qe*s)*Nn(wt*s),ie?re:je(wt,Qe)*fn(Qe*s)*fn(wt*s),ct?re:je(wt,Qe)*Nn(Qe*s)],er=ee(Fe,at,Je);Te=qe(er,Je),Vt=(_=er.resolved)!=null?_:!0;break}case 215:case 214:{let he=f===214?n.fn:(ct,je)=>{let[Fe,Je]=n.fn(ct,je);return[Fe,Je,0]},ie;switch(k){case"x":ie=(je,Fe)=>he(je,Fe)[0]-re;break;case"y":ie=(je,Fe)=>he(je,Fe)[1]-re;break;case"z":ie=(je,Fe)=>he(je,Fe)[2]-re;break;case"u":ie=(je,Fe)=>je-re;break;case"v":ie=(je,Fe)=>Fe-re;break;case"_implicit":let ct=r.slice_function.fn;ie=(je,Fe)=>{let[Je,er,wt]=he(je,Fe);return ct(Je,er,wt,je,Fe)};break;default:throw new Error("Programming Error: bad slice")}Te=Ne(ie,he);break}case 203:case 204:{let he=k==="r";ht=he?Ke.v:Ke.u,Ze=he?ie=>[re,ie,pe(re,ie)]:ie=>[ie,re,pe(ie,re)],Te=EN(Ze,ht,r.resolution,t);break}case 207:case 208:{let he=k==="theta";ht=he?Ke.v:Ke.u,Ze=he?ie=>[pe(re,ie),re,ie]:ie=>[pe(ie,re),ie,re],Te=E5(Ze,ht,r.resolution,t);break}}return{graphMode:100,guid:Na(),points:Te,resolved:Vt,color:r.color,thickness:r.lineWidth}}default:throw new Error("Programming Error: unexpected graphmode "+f)}d=l.poi}if((!d||d.zeros.x.length+d.extrema.x.length+d.intercept.x.length>250)&&(d=See()),f===1)for(let A in d){if(!d.hasOwnProperty(A))continue;let R=A;u=d[R].y,d[R].y=d[R].x,d[R].x=u}let y={segments:l.segments,resolved:l.resolved,graphMode:f,color:r.color,style:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,poi:d,compiled:n};if(f===6){let A=c;y.sampledDomain={min:A.min,max:A.max}}return l.fillSegments&&(y.fillSegments=l.fillSegments),y}function Uee(e,t,r){let n,i,o,a,s=[],c=null;switch(r){case 6:c=B5;break;case 1:c=function(l){return[l[1],l[0]]};break}for(n=0;n<e.length;n++)for(a=e[n],i=0;i<a.length;i+=2)o=[a[i],a[i+1]],c&&(o=c(o)),s.push(o[0],o[1]);for(n=t.length-1;n>=0;n--)for(a=t[n],i=a.length-2;i>=0;i-=2)o=[a[i],a[i+1]],c&&(o=c(o)),s.push(o[0],o[1]);return s}function NI(e,t,r){let n=u=>u[u.length-2],i=[],o=0,a=0,s=[],c=[],l=-1/0;for(;;){for(;a<e.length&&!(e[a].length>=2);)a+=1;for(;o<t.length&&!(t[o].length>=2);)o+=1;(a>=e.length||e[a][0]>l)&&(o>=t.length||t[o][0]>l)&&(s.length>0&&c.length>0&&i.push(Uee(s,c,r)),s=[],c=[],l=Math.max(l,a<e.length?n(e[a]):1/0),l=Math.max(l,o<t.length?n(t[o]):1/0));let u=!1;if(a<e.length&&e[a][0]<=l&&(l=Math.max(l,n(e[a])),s.push(e[a]),a+=1,u=!0),o<t.length&&t[o][0]<=l&&(l=Math.max(l,n(t[o])),c.push(t[o]),o+=1,u=!0),!u)break}return i}function Av(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],[o,a]=i;!isNaN(o)&&!isNaN(a)?t.push(i):r[n]=!0}return{points:t,droppedIndices:r}}var Zs={[8]:["x","y"],[106]:["x","y"],[120]:["y","z"],[122]:["y","z"],[107]:["y","z"],[121]:["x","z"],[123]:["x","z"],[108]:["x","z"],[109]:["r","theta"],[124]:["theta","z"],[110]:["theta","z"],[111]:["theta","phi"],[130]:["u","v"],[103]:["u","v"],[126]:["x","y"],[112]:["x","y","z"],[113]:["x","y","z"],[127]:["x","y"],[201]:["y","z"],[202]:["x","z"],[200]:["x","y"],[206]:["theta","z"],[205]:["theta","z"],[211]:["theta","z"],[203]:["r","theta"],[204]:["r","theta"],[213]:["r","theta"],[207]:["theta","phi"],[208]:["theta","phi"],[212]:["theta","phi"],[214]:["u","v"],[215]:["u","v"],[209]:["x","y","z"],[210]:["x","y","z"]},Nf={[110]:["r"],[111]:["rho"]};var Hee=(e,t)=>{let r=e.segments[0],n=t.segments[0],i=[[...r,...n]];return{...e,segments:i}};function $ee(e){let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:o}=e,a=Bn(r),s=ii(r.domainBound,zs(o));if(!Wa(s))return a.domainBound=s,a.lineStyle="SOLID",wd({graphInfo:a,viewState:t,compiled:n,derivative:i})}function Qp(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,included:o,showPoint:a}=e,s=Bn(r),c=ii(r.domainBound,zs(i));if(!Wa(c))return s.domainBound=c,s.pointStyle=o?"POINT":"OPEN",LI({graphInfo:s,viewState:t,compiled:n,showPoint:a,maxOverride:void 0})}function H5(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,maxOverride:o,showPoint:a}=e,[s,c]=i,l=[],u;s=Math.ceil(s),c=Math.floor(c);let d=o!==void 0?o:1/0;if(s===-1/0&&c>=d)u=Qp({bounds:[s,d],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:a}),l.push(u);else if(s===-1/0&&c<1/0)u=Qp({bounds:[s,c],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:a}),l.push(u),l.push(Qp({bounds:[c+1,d],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:a}));else if(s>-1/0&&c>=d)u=Qp({bounds:[s,d],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:a}),l.push(Qp({bounds:[-1/0,s-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:a})),l.push(u);else{u=Qp({bounds:[s,c],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:a});let f=Qp({bounds:[-1/0,s-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:a}),g=Qp({bounds:[c+1,d],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:a});l.push(u);let y;f&&g&&(y=Hee(f,g),l.push(y))}return{cdfTopBranch:u,topBranches:l}}var $5=e=>{let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:o}=e,[a,s]=o,c=$ee({bounds:[a,s],viewState:t,graphInfo:r,compiled:n,derivative:i}),l=[wd({viewState:t,graphInfo:r,compiled:n,derivative:i})];return{cdfTopBranch:c,topBranches:l}};var RN=class{constructor(t){this.parentType=t;this.count=0;this.intersections=[]}addPoint(t){this.intersections.push(t),this.count+=1}addPoints(t){this.intersections.push(...t),this.count+=t.length}addIntersection(t,r){r.valueType===z?this.addPoint(r.value):this.addPoints(r.value)}getPoints(){return this.intersections}},kI=class{constructor(t){this.parentType=t;this.count=0;this.intersectionsByIndex=new Map;if(t===zn)this.scalarType=Ye;else if(t===li)this.scalarType=ot;else if(t===ci)this.scalarType=Oe;else throw new Error(`Expected ListOfSegment or ListOfArc but got ${xr(t)}`)}getListItemIntersections(t){let r=this.intersectionsByIndex.get(t);return r||(r=new RN(this.scalarType),this.intersectionsByIndex.set(t,r)),r}addIntersection(t,r){let n=mu(t);if(n!==void 0){let i=n-1,o=this.getListItemIntersections(i);r.valueType===on?o.addPoints(r.value):o.addPoint(r.value),this.count+=1}else{Om(r.valueType,[on]);for(let i=0;i<r.value.length;i++)this.getListItemIntersections(i).addPoint(r.value[i]);this.count+=r.value.length}}};function Y5(e=void 0){let{xmin:t,xmax:r,ymin:n,ymax:i,zmin:o,zmax:a}=e!=null?e:new _I,s=[t,n,a,t,i,a,r,i,a,r,n,a,t,n,o,t,i,o,r,i,o,r,n,o,t,n,o,t,n,a,t,i,a,t,i,o,r,n,o,r,n,a,r,i,a,r,i,o,r,n,o,r,n,a,t,n,a,t,n,o,r,i,o,r,i,a,t,i,a,t,i,o],c=[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],l=[0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,1,1,0,1,0,1],u=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return{positions:new Float32Array(s),normals:new Float32Array(c),faces:new Uint16Array(u),uvs:new Float32Array(l)}}var{abs:eg,min:kN,max:VN}=Math;function FN(e,t){let{xmin:r,xmax:n,ymin:i,ymax:o,zmin:a,zmax:s}=t,c=[[r,i,s],[r,o,s],[n,o,s],[n,i,s],[r,i,a],[r,o,a],[n,o,a],[n,i,a]],l=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],u=[];for(let[A,R]of l){let W=c[A],j=c[R],Q=e(...W),ce=e(...j),ee=Q/(Q-ce);0<=ee&&ee<=1&&u.push(gc(W,j,ee))}if(u.length<3)return;let d=kN(...u.map(A=>A[0])),f=VN(...u.map(A=>A[0])),g=kN(...u.map(A=>A[1])),y=VN(...u.map(A=>A[1])),x=kN(...u.map(A=>A[2])),b=VN(...u.map(A=>A[2])),w=e(r,i,a),E=(e(n,i,a)-w)/(n-r),I=(e(r,o,a)-w)/(o-i),S=(e(r,i,s)-w)/(s-a),D,O,_;return eg(S)>=eg(E)&&eg(S)>=eg(I)?(D=(A,R)=>[A,R,a-(w+E*(A-r)+I*(R-i))/S],O=new _t(d,f),_=new _t(g,y)):eg(I)>=eg(S)&&eg(I)>=eg(E)?(D=(A,R)=>[A,i-(w+E*(A-r)+S*(R-a))/I,R],O=new _t(d,f),_=new _t(x,b)):(D=(A,R)=>[r-(w+I*(A-i)+S*(R-a))/E,A,R],O=new _t(g,y),_=new _t(x,b)),{explicitPlane:D,u:O,v:_}}function VI(e,t){let r=[],n=[],i=[],o=[],a=FN(e,t);if(a){let{explicitPlane:s,u:c,v:l}=a;r.push(...s(c.min,l.min),...s(c.max,l.min),...s(c.min,l.max),...s(c.max,l.max));let u=new Yt(r[0],r[1],r[2]),d=new Yt(r[3],r[4],r[5]),f=new Yt(r[6],r[7],r[8]),g=new Yt().subVectors(f,u),y=new Yt().subVectors(u,d),x=g.cross(y).normalize();n.push(x.x,x.y,x.z,x.x,x.y,x.z,x.x,x.y,x.z,x.x,x.y,x.z),i.push(0,0,0,1,1,0,1,1),o.push(0,1,2,3,2,1)}return{positions:r,normals:n,faces:o,uvs:i,resolved:!0,extraAttrs:[]}}function W5(e){let t=[];for(let n=0;n<e.instructionsLength();n++)t.push(!1);let r=[];t[e.getReturnIndex()]=!0;for(let n=e.instructionsLength()-1;n>=0;n--){if(!t[n])continue;let i=e.getInstruction(n);if(i.type===2&&r.push(e.argNames[n]),pt(i))continue;let o=kp(e,i)?[i.args[1]]:i.args;for(let a of o)t[a]=!0}return r}var X5=e=>e==="u"||e==="v";N.Base.prototype.getGraphMode=function(e,t){return 10};N.Base.prototype.graphmodeDependencies=nl;function nl(e,t){let r=t.getDependencies();if(e.is3dProduct()&&t instanceof dn){let n=new Set(W5(t._chunk));return r.filter(i=>n.has(i))}else return r}function Xee(e,t){var r;return e&&e.hasOwnProperty("dragMode")?e.dragMode==="AUTO"?r=t.defaultDragMode:r=e.dragMode:r=t.defaultDragMode,n1(r,t.moveStrategy)}function K5(e,t){let r=e.is3dPolicy();if(t.isMovablePoint&&!r&&Xee(this.userData,t)!=="NONE")return t.valueType===$?26:4;var n=nl(e,t);switch(t.valueType){case ji:case oe:if(r){if(n.length===0)return 114;if(e.validParametricVariables(n))return n.length==1?100:Pu(103,t)}return 10;case $:case Dn:case z:case on:{let i=Le(t.valueType,$);return i&&!e.plotComplexAsPoints()?10:n.length===0?i?25:3:r&&e.validParametricVariables(n)?n.length===1?5:n.every(X5)?Pu(130,t):10:e.validParametricVariables(n)?5:10}case C:case ke:return!e.is3dPolicy()&&n.length===1?2:r&&n.length===2&&n.indexOf("x")>-1&&n.indexOf("y")>-1?Pu(106,t):10}if(n.length>0)return 10;switch(t.valueType){case ki:case ea:return e.plotComplexAsPoints()?5:10;case Ni:case jo:return 5;case Ri:case Zo:return r?100:10;case fo:case ta:return e.plotComplexAsPoints()?r?Pu(130,t):10:10;case po:case Jo:return r?Pu(130,t):10;case go:case Qo:return r?Pu(103,t):10;case Mr:case Zi:return r?119:10;case Pt:case Qi:return r?129:10;case Hn:case Ji:return r?117:10;case $n:case No:return r?118:10;case et:case ti:return 16;case We:case wi:return 20;case Oe:case ci:return 21;case Ye:case zn:return 17;case Re:case Ei:return 18;case ot:case li:return 19;case Ve:case Ii:return this instanceof Ut&&this.getDependencies().length===1?10:24;case st:case Un:case $e:case ri:return 23;default:return 10}}N.Expression.prototype.getGraphMode=K5;function j5(e,t){var r=t._expression.getDependencies();if(r.length>1)return 10;if(t._expression.isList&&t._expression.length===0)return 10;var n=t._symbol;let i=t.getDependencies();return e.graphMode(n,r,i)}N.Equation.prototype.getGraphMode=N.CallAssignment.prototype.getGraphMode=N.BaseComparator.prototype.getGraphMode=N.ComparatorChain.prototype.getGraphMode=function(e,t){if(t.isError)return 10;var r=nl(e,t);let n=t.getDependencies();if(e.is3dPolicy()){let i=10;return r.length>0&&(n.includes("z")?i=this.isInequality()?113:112:i=this.isInequality()?127:126),Pu(i,t)}return t.isConstant?10:t instanceof N.SolvedEquation?j5(e,t):r.length===1||r.length===2?8:10};function BN(e){var t;return e===106||e===200||e===107||e===201||e===108||e===202?["x","y","z","_implicit"]:e===110||e===211?["x","y","z","r","theta","_implicit"]:e===111||e===212?["x","y","z","rho","theta","phi","_implicit"]:e===109||e===213?["x","y","z","r","theta","_implicit"]:e===103||e===214||e===130||e===215?["x","y","z","u","v","_implicit"]:e===113||e===210||e===112||e===209?["x","y","z","_implicit"]:(t=Zs[e])!=null?t:[]}function Pu(e,t){let r=BN(e),n=t._chunk;try{let o=fd(n,r,{allowSlices:!0}).getSliceVariablesOrImplicit();if(o.length!==1)return e;let a=o[0];return r.indexOf(a)<0?10:s5(e,a)}catch(i){return 10}}N.DoubleInequality.prototype.getGraphMode=function(e,t){let r=t.getDependencies();return e.graphMode(t._symbol,[],r)};N.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof N.SolvedEquation)return j5(e,t);if(this.isEquation(e,t))return this.asEquation().getGraphMode(e,t);let r=nl(e,t),n=this._symbol,i=t.getDependencies();switch(t.valueType){case C:case ke:case Rt:switch(r.length){case 0:{let a=e.graphMode(n,[],i);return e.is3dPolicy()?Pu(a,t):a}case 1:if(t.valueType===ke&&!e.graphableListVariables(n,r[0]))return 10;if(this.isSlider)return 10;let o=e.graphMode(n,r,i);return e.is3dPolicy()?Pu(o,t):o;default:return e.is3dPolicy()?Pu(e.graphMode(n,r,i),t):10}case oe:if(e.assignmentForbidden(n)||r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:return 114;case 1:return 100;case 2:return 103;default:return 10}default:return K5.call(this,e,t)}};N.FunctionDefinition.prototype.getGraphMode=function(e,t){let r=e.is3dPolicy();if(this._argSymbols.length!==1&&!r)return 10;if(this.recursionInfo){let o=t instanceof dn?t.getRecursiveFunctionMetadata():void 0;if((o==null?void 0:o.type)==="missing-non-recursive-branch")return 10;if((o==null?void 0:o.recursiveStructure.domainInfo[this._symbol][0])===1)return 10}var n=e.functionDefinitionGraphMode(this._symbol,this._argSymbols),i=nl(e,t);switch(t.valueType){case C:case ke:if(r)return n;switch(i.length){case 0:return n;case 1:return i[0]!==this._argSymbols[0]?10:n;default:return 10}break;default:return 10}};N.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple?t.isModelValid?t.model.getDependencies().length!==1?10:2:10:10};function qN(e,t){return t.isError?10:11}N.Histogram.prototype.getGraphMode=qN;N.DotPlot.prototype.getGraphMode=qN;N.BoxPlot.prototype.getGraphMode=qN;N.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError||this.opacity.isError?10:3:10};function Z5(e){let t=0,r=0,n=[],i=xo(e,e.getReturnIndex());for(let o=0;o<e.instructionsLength();o++){if(!i[o])continue;let a=e.getInstruction(o);a.type===25?n[o]=1:a.type===31||a.type===32?n[o]=n[a.args[0]]+n[a.args[1]]:n[o]=0,kp(e,a)&&(t+=1,r+=n[a.args[0]])}return{numRestrictions:t,numEqualityRestrictions:r}}function hy(e,t,r){try{return Kee(e,t,r)}catch(n){return n instanceof q?n:Ie(n)}}function Kee(e,t,r){var u,d;if(!e.is3dProduct()||r.isError)return r;if(!(r instanceof dn))return Ie("Expected peel error to be checked on an IRExpression");function n(f,g){let y=g.filter(x=>f.indexOf(x)<0);if(y.length)return zD(y[0]).allowExport().setDependencies(y)}function i(){let f=qI(a),g=jee(e,r);return n(f,g)}function o(){let f=J5(a),g=Zee(e,r,a);return n(f,g)}let a=t.getGraphMode(e,r),s=r._chunk,{numRestrictions:c,numEqualityRestrictions:l}=Z5(s);if(l!==0)if(l===1){if(c!==l&&!t.isInequality())return $M();let y=fd(s,[],{allowSlices:!0}).getSliceVariablesOrImplicit();if(y.length!==1)return lu();let x=BN(a),b=y[0];if(x.indexOf(b)<0)return b==="_implicit"?lu().allowExport():HD(b).allowExport().setDependencies([b])}else return HM();return(d=(u=i())!=null?u:o())!=null?d:r}function jee(e,t){let r=nl(e,t);return t.getDependencies().filter(i=>r.indexOf(i)<0)}function Zee(e,t,r){let n=nl(e,t),i=new Set;if(t instanceof dn){let a=t.getRestrictedFunctionForGLSL(qI(r),rg).concrete;for(let s of a.getDependencies())n.indexOf(s)>-1||i.add(s)}return[...i]}function qI(e){var r;if(!wu(e))return[];let t=Jee(e)?["x","y","z"]:[];return e===211&&t.push("r"),e===212&&t.push("rho"),t.push(...(r=Nf[e])!=null?r:[]),t.push(...J5(e).filter(n=>t.indexOf(n)<0)),t}function Jee(e){return Qee(e)||e==200||e==201||e==202||e==211||e==212||e==213||e==214||e==215}function Qee(e){if(!wu(e))return!1;switch(e){case 106:case 107:case 108:case 110:case 111:case 109:case 122:case 123:case 112:case 113:case 127:case 130:case 103:case 210:return!0;case 124:case 120:case 121:case 126:case 114:case 117:case 118:case 119:case 129:case 128:case 100:case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return!1;default:return!1}}function J5(e){var t;return wu(e)?(t=Zs[e])!=null?t:[]:[]}function zN(e,t){let r;switch(t){case"solvedEquation":r=2;break;case"baseComparator":r=4;break;default:r=1;break}return Math.floor(e/r)}var rte=!1,rg=200,UI=N.List;function zi(){return{}}function Ff(e,t,r){let n=1/0;for(let o of t){let a=e[o];Array.isArray(a)&&a.length<n&&(n=a.length)}let i=1;return r==="solvedEquation"?i=2:r==="baseComparator"&&(i=4),i*n}function Su(e,t,r){return Array.isArray(e)?e[zN(t,r)]:e}function nte(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=Gs(r,n),o=Gs(30,30),a=Math.round(2-Math.log(i/o)/Math.LN10);if(a<=0)return Math.round(e)+"";{let s=Math.pow(10,a);return Math.round(e*s)/s+""}}function ite(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=r*n,o=30*30,a=Math.round(2-Math.log(i/o)/Math.LN10);if(a<=0)return Math.round(e)+"";{let s=Math.pow(10,a);return Math.round(e*s)/s+""}}function ote(e,t){return t.degreeMode?Math.round(e/(Math.PI/180)*10)/10+"\xB0":Math.round(e*100)/100+""}function ng(e,t,r){let n=zN(t,r),i=e.userData.lineStyle,o=Su(e.metaData.computedLineWidth,t,r),a=Su(e.metaData.computedLineOpacity,t,r),s=Su(e.metaData.computedFillOpacity,t,r),c=Su(e.metaData.computedSurfaceOpacity,t,r),l=e.metaData.colorLatexValue?Su(e.metaData.colorLatexValue,t,r):e.userData.color,u=Su(e.metaData.computedResolution,t,r);return{listIndex:n,style:i,lineWidth:o,lineOpacity:a,fillOpacity:s,surfaceOpacity:c,color:l,resolution:u}}N.Base.prototype._graph=ate;function ate(e,t,r,n,i,o){var g,y,x;if(t instanceof N.SolvedEquation){let b=this._graph(e,t._expression,r,n,i,t.branchMultiplier===2?"solvedEquation":void 0),w=c$(this,t,r,e);return w&&(b||(b=[]),Array.prototype.push.apply(b,w)),b}function a(b){let w=b.editableLabelMode;return w==="TEXT"||w==="MATH"}function s(b,w){return"colorLatex"in b&&fte(b.colorLatex)?b.colorLatex:w}let c=t.getExpressionType(n.graphMode,t.valueType),l=fv(c,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill}),u={lineOpacity:"computedLineOpacity",lineWidth:"computedLineWidth",color:"colorLatexValue",fillOpacity:"fillOpacity",surfaceOpacity:"surfaceOpacity",resolution:"resolution"},d=(b,w)=>{let E=Ff(this.metaData,Object.keys(b).map(S=>u[S]),o),I=[];return UI.wrap(t).eachElement((S,D)=>{if(D>=E)return;let O=this.getGraphInfo(e,S);O.graphMode=n.graphMode;let _=ng(this,D,o);O.listIndex=_.listIndex,O.style=_.style,"lineWidth"in b&&(O.lineWidth=_.lineWidth),"lineOpacity"in b&&(O.lineOpacity=_.lineOpacity),"fillOpacity"in b&&(O.fillOpacity=_.fillOpacity),"surfaceOpacity"in b&&(O.surfaceOpacity=_.surfaceOpacity),"color"in b&&(O.color=s(this.userData,_.color)),"resolution"in b&&(O.resolution=_.resolution),I.push(...w(S,O))}),I},f=n.graphMode;switch(f){case 26:case 4:{let{points:E,droppedIndices:I}=Av([t.asValue()]),S=this.userData.shouldGraph&&l.points,D=this.userData.showLabel&&!S;return S?[{segments:[E],graphMode:f,droppedIndices:I,color:ju(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,pointSize:this.metaData.computedMovablePointSize,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:a(this.userData),labels:this.computedLabels||[],poi:$c(E),movablePointInfo:[]}]:D?[{segments:[E],graphMode:3,color:ju(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:a(this.userData),labels:this.computedLabels||[],poi:$c(E),showPoint:!1}]:[]}case 25:case 3:{let E=[],I=this.userData.shouldGraph&&l.points,S=this.userData.shouldGraph&&l.lines,D=["colorLatexValue"];I&&D.push("computedPointOpacity","computedPointSize"),(this.userData.showLabel||I)&&D.push("computedLabelSize","computedLabelAngle");let O=Ff(this.metaData,D,o),_=UI.wrap(t).asValue();aa(_),_.length>O&&(_.length=O);let A=this.userData.showLabel&&!I&&!S,R=Av(_);if(this.userData.showLabel||I){let W={segments:[R.points],graphMode:f,droppedIndices:R.droppedIndices,color:this.metaData.colorLatexValue||this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:I,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointSize:this.metaData.computedPointSize,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,interactiveLabel:!!this.userData.interactiveLabel,editableLabel:a(this.userData),nakedLabel:A,labels:this.computedLabels||[],poi:$c(_)};e.is3dPolicy()?E.push(...dte(W)):E.push(W)}if(S){let W=this.metaData.computedLineWidth,j={segments:n$(_),graphMode:5,color:ju(this.userData,this.metaData),style:this.userData.lineStyle,lineWidth:W,lineOpacity:this.metaData.computedLineOpacity,poi:zi()};E.push(e$(e,j,r,W))}return E}case 114:{let E=[],I=this.userData.shouldGraph&&l.points,S=this.userData.shouldGraph&&l.lines,D=["colorLatexValue"];I&&D.push("computedPointOpacity","computedPointSize");let O=UI.wrap(t).asValue();aa(O);let _=Ff(this.metaData,D,o),A=Math.min(O.length,_);if(I)for(let R=0;R<A;R++){let{color:W}=ng(this,R,o),j=Su(this.metaData.computedPointSize,R,o);E.push({graphMode:114,position:O[R],radius:.02*j,guid:Na(),color:W})}if(S){let R=Su(this.metaData.computedLineWidth,0,o),{color:W}=ng(this,0,o);E.push({graphMode:100,points:Dv(O,r.viewport,R),thickness:R,guid:Na(),color:W})}return E}case 117:{let E=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0,I=this.metaData.computedSurfaceOpacity,S=[],D=[],O=[],_=[],A=[],[R,W,j]=[new Yt,new Yt,new Yt],[Q,ce,ee]=[new Yt,new Yt,new Yt],pe=(k,Ke,ht,Ze,Te,Vt,yt,qe,at)=>{if(Q.set(k,Ke,ht),ce.set(Ze,Te,Vt),ee.set(yt,qe,at),!Q.isFinite()||!ce.isFinite()||!ee.isFinite())return;let Ne=S.length/3;S.push(Q.x,Q.y,Q.z,ce.x,ce.y,ce.z,ee.x,ee.y,ee.z),R.subVectors(Q,ee),W.subVectors(ce,Q),j.crossVectors(R,W),D.push(j.x,j.y,j.z,j.x,j.y,j.z,j.x,j.y,j.z),O.push(Ne,Ne+1,Ne+2),_.push(0,0,0,1,1,0)},re=()=>{let k={guid:Na(),resolved:!0,positions:new Float32Array(S),normals:new Float32Array(D),faces:new Uint32Array(O),uvs:new Float32Array(_),extraAttrs:new Float32Array([])};return A.length&&(k.colors=new Float32Array(A)),k};if(t.valueType===Ji&&!Array.isArray(I)){let k=this.metaData.computedSurfaceOpacity,Ke="";if(E){let ht=(g=this.metaData.colorLatexValue)!=null?g:this.userData.color;Ke=s(this.userData,ht)}return d({color:!0},(ht,Ze)=>{if(ht.valueType===Hn){let[[Te,Vt,yt],[qe,at,Ne],[he,ie,ct]]=ht.asValue();if(pe(Te,Vt,yt,qe,at,Ne,he,ie,ct),!E){let[je,Fe,Je]=vG(Ze.color);A.push(je,Fe,Je,je,Fe,Je,je,Fe,Je)}}return[]}),[{meshData:re(),color:Ke,surfaceOpacity:k!=null?k:1,graphMode:117}]}return d({color:!0,surfaceOpacity:!0},(k,Ke)=>{var ie;let[[ht,Ze,Te],[Vt,yt,qe],[at,Ne,he]]=k.asValue();return S=[],D=[],O=[],_=[],pe(ht,Ze,Te,Vt,yt,qe,at,Ne,he),[{meshData:re(),color:s(this.userData,Ke.color),surfaceOpacity:(ie=Ke.surfaceOpacity)!=null?ie:1,graphMode:117}]})}case 119:{let E=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0;if(t.valueType===Zi&&E&&!Array.isArray(this.metaData.computedLineWidth)){let I=(y=this.metaData.colorLatexValue)!=null?y:this.userData.color,S=this.metaData.computedLineWidth,D=[];return d({color:!0},O=>{if(O.valueType===Mr){let[[_,A,R],[W,j,Q]]=O.asValue();D.push(_,A,R,W,j,Q,NaN,NaN,NaN)}return[]}),[{graphMode:119,guid:Na(),points:D,color:I,thickness:S!=null?S:1}]}return d({color:!0,lineWidth:!0},(I,S)=>{let{lineWidth:D,color:O}=S,_=I.asValue(),[[A,R,W],[j,Q,ce]]=_;return i$(A,R,W,j,Q,ce)?[]:[{graphMode:119,guid:Na(),points:[A,R,W,j,Q,ce],color:O,thickness:D}]})}case 129:let b=this.metaData.colorLatexValue?!Array.isArray(this.metaData.colorLatexValue):!0;if(t.valueType===Qi&&b&&!Array.isArray(this.metaData.computedLineWidth)){let E=(x=this.metaData.colorLatexValue)!=null?x:this.userData.color,I=this.metaData.computedLineWidth,S=[];return d({color:!0},D=>{if(D.valueType===Pt){let[[O,_,A],[R,W,j]]=D.asValue();S.push(R,W,j,O+R,_+W,A+j)}return[]}),[{graphMode:129,guid:Na(),points:S,color:E,thickness:I!=null?I:1}]}return d({color:!0,lineWidth:!0},(E,I)=>{let{lineWidth:S,color:D}=I,O=E.asValue(),[[_,A,R],[W,j,Q]]=O;return i$(_,A,R,W,j,Q)?[]:[{graphMode:129,guid:Na(),points:[W,j,Q,_+W,A+j,R+Q],color:D,thickness:S}]});case 118:return d({color:!0,resolution:!0,surfaceOpacity:!0},(E,I)=>{let{color:S,surfaceOpacity:D}=I,O=E.asValue(),[[_,A,R],W]=O,j=Math.abs(W);return isNaN(_)||isNaN(A)||isNaN(R)||isNaN(W)?[]:[{graphMode:118,position:[_,A,R],radius:[j,j,j],guid:Na(),color:S,surfaceOpacity:D!=null?D:1}]});case 5:case 100:{let E=this.userData,I=this.metaData,S=[],D=d({color:!0,lineOpacity:!0,lineWidth:!0,resolution:!0},(_,A)=>{var W;let R=_.getDependencies();if(R.length===0&&!Qd(_.valueType)){let{points:j,droppedIndices:Q}=Av([_.asValue()]);return[{segments:[j],graphMode:3,droppedIndices:Q,color:ju(E,I),style:E.lineStyle,showPoint:!1,poi:$c(j)}]}else{let j=_.getCompiledFunction(R);A.domain=(W=j.domain)!=null?W:{type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax};let Q=wd({viewState:r,graphInfo:A,compiled:j});return[e$(e,Q,r,A.lineWidth)]}}),O=[];for(let _ of D)_&&O.push(_);if(l.fill)if(O.forEach((_,A)=>{let{color:R,fillOpacity:W,listIndex:j}=ng(this,A,o);S.push({segments:_.segments,color:R,fillOpacity:W,listIndex:j,graphMode:7,poi:zi()})}),l.lines)O=O.concat(S);else return S;return O}case 20:return d({lineOpacity:!0,lineWidth:!0,color:!0},(E,I)=>{let[[S,D],O]=E.asValue();return isNaN(S)||isNaN(D)||isNaN(O)?[]:[{segments:[[S,D,O]],resolved:!0,graphMode:I.graphMode,color:I.color,style:I.lineStyle,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:I.listIndex,operator:I.operator,poi:zi()}]});case 21:return d({color:!0,lineWidth:!0,lineOpacity:!0},(E,I)=>{let S=ph(E.asValue());if(!S)return[];let D=[];return S.type==="arc"?D.push({graphMode:f,segments:[[S.center[0],S.center[1],S.radius,S.startAngle,S.endAngle]],color:I.color,style:I.lineStyle,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:I.listIndex,operator:n.operator,poi:zi()}):S.type==="rays"?D.push({graphMode:19,segments:[[S.start1[0],S.start1[1],S.end1[0],S.end1[1]]],color:I.color,style:I.lineStyle,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:I.listIndex,operator:n.operator,poi:zi()},{graphMode:19,segments:[[S.start2[0],S.start2[1],S.end2[0],S.end2[1]]],color:I.color,style:I.lineStyle,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:I.listIndex,operator:n.operator,poi:zi()}):D.push({graphMode:17,segments:[[S.start[0],S.start[1],S.end[0],S.end[1]]],color:I.color,style:I.lineStyle,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:I.listIndex,operator:n.operator,poi:zi()}),[...D,...HN(D,i)]});case 17:case 18:case 19:return d({color:!0,lineWidth:!0,lineOpacity:!0},(E,I)=>{let[[S,D],[O,_]]=E.asValue();if(isNaN(S)||isNaN(D)||isNaN(O)||isNaN(_))return[];let A=[],R={segments:[[S,D,O,_]],resolved:!0,graphMode:I.graphMode,color:I.color,style:I.lineStyle,arrowMode:I.arrowMode,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:I.listIndex,operator:n.operator,poi:zi()};if(A.push(t$(e,R,r)),A.push(...HN([R],i)),this.userData.showLabel&&n.graphMode===17){let W=I.listIndex,j=this.computedLabels&&this.computedLabels[W||0];A.push({graphMode:22,objectType:17,segments:[[S,D,O,_]],color:I.color,listIndex:W,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:j?[j]:[nte(Gs(O-S,_-D),r)]})}return A});case 24:return d({lineOpacity:!0,lineWidth:!0,color:!0},(E,I)=>{let[S,D]=E.asValue(),[[O,_],[A,R]]=[D,[D[0]+S[0],D[1]+S[1]]];if(isNaN(A)||isNaN(R)||isNaN(O)||isNaN(_))return[];let W={segments:[[O,_,A,R]],resolved:!0,graphMode:I.graphMode,color:I.color,style:I.lineStyle,arrowMode:I.arrowMode,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:I.listIndex,operator:n.operator,poi:zi()};return[t$(e,W,r)]});case 23:return d({lineOpacity:!0,lineWidth:!0,color:!0},(E,I)=>{let{value:S,valueType:D}=E.asTypedValue(),[[O,_],A,R]=S;if(isNaN(O)||isNaN(_)||isNaN(A)||isNaN(R))return[];let W=I.listIndex,j=D===$e,Q=j?R:Math.abs(R),ce=[];if(ce.push({graphMode:23,segments:[[O,_,A,R,j?1:0]],color:I.color,style:I.lineStyle,lineWidth:I.lineWidth,lineOpacity:I.lineOpacity,listIndex:W,operator:n.operator,poi:zi()}),this.userData.showAngleLabel){let ee=this.computedLabels&&this.computedLabels[W||0];ce.push({graphMode:22,objectType:23,segments:[[O,_,A,R]],color:I.color,listIndex:W,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:ee?[ee]:[ote(Q,r)]})}return ce});case 1:case 2:case 8:case 112:case 126:case 113:case 127:case 6:case 130:case 103:case 106:case 107:case 108:case 109:case 110:case 111:case 120:case 121:case 122:case 123:case 124:{let E=t.valueType===C;return d({lineOpacity:!0,lineWidth:!0,resolution:!0,fillOpacity:!0,surfaceOpacity:!0,color:!0},(I,S)=>{var re,k,Ke,ht,Ze,Te,Vt,yt,qe,at,Ne;(n.graphMode===6||n.graphMode===110||n.graphMode===124)&&(S.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let D=(re=Zs[n.graphMode])!=null?re:[],O=I.getCompiledFunction(D);(n.graphMode==130||n.graphMode==103||n.graphMode==111||n.graphMode==109)&&(S.domain=(k=O.domain)!=null?k:{type:"2d",uMin:this.metaData.evaluatedDomain3DMin1,uMax:this.metaData.evaluatedDomain3DMax1,vMin:this.metaData.evaluatedDomain3DMin2,vMax:this.metaData.evaluatedDomain3DMax2});let _=[],A;try{A=I.getCompiledDerivative()}catch(he){}let R=lte(this,I,O,r,S,A,E);if(R)return R;let W=QL(S.graphMode),j=(Ke=this.userData.extendTo3D)!=null?Ke:!1,Q=W&&!j,ce=!e.is3dPolicy()||Q,ee=(ht=this.userData.lines)!=null?ht:ce,pe=(Ze=this.userData.lines)!=null?Ze:!Q;if(S.graphMode===127&&!j&&((Te=this.userData.lines)==null||Te)){let he=(Vt=Zs[S.graphMode])!=null?Vt:[],ie=I._chunk.copy();ie.GreaterEqual([ie.getReturnIndex(),ie.Constant(0)]);let ct=I.getCompiledFunction(he),je=0,Fe=r.viewport,er=VI((zt,Ms,Qs)=>Qs-je,Fe);return[{meshData:wc(er),color:S.color,surfaceOpacity:(yt=S.surfaceOpacity)!=null?yt:1,uvArgs:(qe=Zs[S.graphMode])!=null?qe:[],extraMeshArgs:(at=Nf[S.graphMode])!=null?at:[],graphMode:106,compiled:ct,restrictionShader:Ap(ie,rg)}]}if(W&&(this.userData.lines===!0?(ee=Q,pe=!Q):this.userData.lines===!1&&(ee=!1,pe=!1)),pe&&wu(S.graphMode)){let he=qI(S.graphMode);if(S.graphMode===113||S.graphMode===127){let{positions:ie,normals:ct,faces:je,uvs:Fe}=Y5(),Je={guid:Na(),isDomainCube:!0,resolved:!0,positions:ie,normals:ct,faces:je,uvs:Fe,extraAttrs:new Float32Array([])},er=I.toImplicitBool();_.push({meshData:Je,graphMode:113,color:S.color,surfaceOpacity:1,uvArgs:[],extraMeshArgs:[],compiled:O,restrictionShader:Ap(er._chunk,rg)});let wt=az(er._chunk,I._chunk,he);for(let Qe of wt){let zt=Q5(S,{concrete:new dn(Qe.value),restriction:Qe.restriction&&Ap(Qe.restriction,rg)},r);_.push(zt)}}else{let ie=I.getRestrictedFunctionForGLSL(he,rg),ct=Q5(S,ie,r);_.push(ct)}}if(ee&&ste(this,S),!wu(S.graphMode)){let he=wd({viewState:r,graphInfo:S,compiled:O,derivative:A}),ie=l$(zp(this),I);if(ie&&(he.boundingBox=ie),e.is3dPolicy()&&ee&&YN(he.graphMode)){let ct=(Ne=S.lineWidth)!=null?Ne:1;_.push(RI(he,r,ct))}else if(he.fillSegments){let{fillSegments:ct,...je}=he;ee||(je.lineWidth=0),_.push(je)}else ee||(he.lineWidth=0),(ee||!wu(n.graphMode))&&_.push(he);S.graphMode===8&&S.operator!=="="&&_.push({graphMode:7,segments:he.fillSegments,poi:zi(),listIndex:S.listIndex,color:S.color,fillOpacity:S.fillOpacity})}return _})}case 200:case 201:case 202:case 206:case 205:case 211:case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:case 209:return d({color:!0,lineWidth:!0,lineOpacity:!0,resolution:!0},(E,I)=>{var re;switch(f){case 206:case 211:I.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain};break;case 203:case 204:case 213:case 207:case 208:case 212:case 214:case 215:I.domain={type:"2d",uMin:this.metaData.evaluatedDomain3DMin1,uMax:this.metaData.evaluatedDomain3DMax1,vMin:this.metaData.evaluatedDomain3DMin2,vMax:this.metaData.evaluatedDomain3DMax2};break}let S=(re=Zs[f])!=null?re:[],D={allowSlices:!0},O=fd(E._chunk,S,D),{valueChunk:_,slices:A}=O.getValueAndRestrictionChunk(),R=_.getCompiledFunction(S),W=A[0],j=W.type==="implicit",Q=j?NaN:W.value,ce=j?"_implicit":W.variable,ee,pe=k=>wd({viewState:r,graphInfo:{...I,slice_coordinate:ce,slice_value:Q,slice_function:k},compiled:R});if(j){let k=["x","y","z"],Ke=["x","y","z","r","theta"],ht=["x","y","z","rho","theta","phi"],Ze=["x","y","z","u","v"],Te=W.sliceChunk;switch(f){case 200:case 201:case 202:ee=Te.getCompiledFunction(k);break;case 211:case 213:ee=Te.getCompiledFunction(Ke);break;case 212:ee=Te.getCompiledFunction(ht);break;case 215:case 214:ee=Te.getCompiledFunction(Ze);break;case 209:{let Vt=(at,Ne)=>{let he=Ne.getCompiledFunction(k),ie=at._symbol,ct=at._expression.args,je=[];for(let Fe of ct){if(!(Fe instanceof dn))throw Ie("Programming Error: bad type");if(ie==="x")R=Fe._chunk.getCompiledFunction(["y","z"]),I.graphMode=201;else if(ie==="y")R=Fe._chunk.getCompiledFunction(["x","z"]),I.graphMode=202;else if(ie==="z")R=Fe._chunk.getCompiledFunction(["x","y"]),I.graphMode=200;else throw Ie("Programming Error: bad lhs");je.push(pe(he))}return je},yt=(at,Ne)=>{let he=r.viewport,ie=Ne.getCompiledFunction(k),ct=at.getCompiledFunction(k).fn,je=FN(ct,he);if(je){let{explicitPlane:Fe,u:Je,v:er}=je;return I.graphMode=214,R={args:["u","v"],source:"",constants:[],fn:Fe,executionMetadata:{}},I.domain={type:"2d",uMin:Je.min,uMax:Je.max,vMin:er.min,vMax:er.max},[pe(ie)]}else return[]};if(Te.isImplicitPlane())return yt(Te,_);if(_.isImplicitPlane())return yt(_,Te);let qe=JL(e,_);return qe instanceof N.SolvedEquation&&!qe.isError?Vt(qe,Te):(qe=JL(e,Te),qe instanceof N.SolvedEquation&&!qe.isError?Vt(qe,_):[pe(Te.getCompiledFunction(k))])}}}return[pe(ee)]});case 210:return d({color:!0,surfaceOpacity:!0,resolution:!0},(E,I)=>{var k,Ke,ht,Ze,Te,Vt,yt,qe;let S=(k=Zs[f])!=null?k:[],D={allowSlices:!0},O=fd(E._chunk,S,D),{restrictionChunk:_,slices:A}=O.getSlicesAndRestrictionChunk(),R=_.getCompiledFunction(S);if(A[0].type==="implicit"){let at=A[0].sliceChunk,Ne;try{Ne=at.copy().gradient(["x","y","z"]).getCompiledFunction(["x","y","z"]).fn}catch(je){}let he=(Ke=I.resolution)!=null?Ke:NaN;return isNaN(he)&&(he=Cv),he=ui(he,0,100),[{meshData:NN(at.getCompiledFunction(S),void 0,Ne,r.viewport,he,{isInequality:!1}),color:I.color,surfaceOpacity:(ht=I.surfaceOpacity)!=null?ht:1,uvArgs:(Ze=Zs[I.graphMode])!=null?Ze:[],extraMeshArgs:(Te=Nf[I.graphMode])!=null?Te:[],graphMode:f,compiled:R,restrictionShader:Ap(_,rg)}]}let W=A[0].value,j=A[0].variable,Q=r.viewport,ce;switch(j){case"x":ce=(at,Ne,he)=>at-W;break;case"y":ce=(at,Ne,he)=>Ne-W;break;case"z":ce=(at,Ne,he)=>he-W;break;default:return[]}let ee=VI(ce,Q);return[{meshData:wc(ee),color:I.color,surfaceOpacity:(Vt=I.surfaceOpacity)!=null?Vt:1,uvArgs:(yt=Zs[I.graphMode])!=null?yt:[],extraMeshArgs:(qe=Nf[I.graphMode])!=null?qe:[],graphMode:f,compiled:R,restrictionShader:Ap(_,rg)}]});case 16:{let E=[],I=this.userData.lines===void 0?!0:this.userData.lines,S=this.userData.fill===void 0?!0:this.userData.fill;if(!S&&!I)return E;let D=Ff(this.metaData,["computedLineOpacity","computedLineWidth","colorLatexValue","fillOpacity"],o),O=t.asValue();xe(t.valueType)||(O=[O]);for(let _=0;_<O.length;_++){if(_>D-1)continue;let A=O[_];if(!A.length)continue;let R=this.getGraphInfo(e,t),{listIndex:W,lineWidth:j,lineOpacity:Q,fillOpacity:ce,color:ee}=ng(this,_,o);!this.userData.shouldOmitLastPolygonSegment&&A.length>2&&(A=[...A,A[0]]),aa(A);let pe=n$(A);if(pe.length){if(S&&A.length>2&&E.push({segments:pe,graphMode:7,poi:zi(),color:ee,fillOpacity:ce,style:R.style,listIndex:W}),I&&(E.push({segments:pe,graphMode:5,poi:zi(),color:ee,style:this.userData.lineStyle,lineWidth:j,lineOpacity:Q,listIndex:W}),i))for(let re=0;re<A.length-1;re++){Om(i.parentType,[et,ti]);let k=i.getEdgeIntersections(re);if(!k)continue;let[Ke,ht]=A[re],[Ze,Te]=A[re+1];E.push(...HN([{segments:[[Ke,ht,Ze,Te]],resolved:!0,graphMode:17,color:ee,style:this.userData.lineStyle,arrowMode:R.arrowMode,lineWidth:j,lineOpacity:Q,listIndex:W,poi:zi()}],k))}if(rte&&this.userData.showLabel){let re=this.computedLabels&&this.computedLabels[W||0];E.push({graphMode:22,objectType:16,segments:pe,color:ee,listIndex:W,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:re?[re]:[ite(MA(A),r)]})}}}return E}case 7:case 11:case 10:case 15:case 22:case 128:return!1;default:let w=f;throw new Error(`Unexpected graphMode: ${w}`)}}function Q5(e,t,r){var l,u,d;let n=(l=Zs[e.graphMode])!=null?l:[],i=t.concrete.getCompiledFunction(n),o,a,s=!1;if(e.graphMode===112||e.graphMode===126||e.graphMode===113){e.operator!=="="&&(s=!0);try{o=t.concrete.gradient(["x","y","z"])._chunk,a=o.getCompiledFunction(["x","y","z"]).fn}catch(f){}}if(e.graphMode===112&&a&&o){let f=cte(i.fn,a,o,r.viewport);if(f)return{graphMode:118,position:f.center,radius:f.radii,guid:Na(),color:e.color,restrictionShader:t.restriction,surfaceOpacity:(u=e.surfaceOpacity)!=null?u:1}}let c=e.graphMode;if((c===112||c===113||c===127||c===106||c===107||c===108)&&t.concrete._chunk.isLinearIn(["x","y","z"])||c===106&&t.concrete._chunk.isConstant()){let f=r.viewport,g;switch(c){case 106:g=(b,w,E)=>E-i.fn(b,w);break;case 107:g=(b,w,E)=>b-i.fn(w,E);break;case 108:g=(b,w,E)=>w-i.fn(b,E);break;case 112:case 113:case 127:g=i.fn;break}let y=wc(VI(g,f)),x=c===113||c===127;return c===127&&(c=113),{meshData:y,color:e.color,surfaceOpacity:x?1:(d=e.surfaceOpacity)!=null?d:1,uvArgs:[],extraMeshArgs:[],graphMode:c,compiled:i,restrictionShader:t.restriction}}return wd({viewState:r,graphInfo:e,compiled:i,restrictionShader3d:t.restriction,isImplicit3dInequality:s,gradient:a,dependencies:t.concrete._dependencies})}function ste(e,t){var n,i,o;if(QL(t.graphMode))switch(t.graphMode){case 121:case 123:{t.graphMode=2,t.willConvertTo3D=!0,(n=t.lineWidth)!=null||(t.lineWidth=1);break}case 120:case 122:{t.graphMode=1,t.willConvertTo3D=!0,(i=t.lineWidth)!=null||(t.lineWidth=1);break}case 124:let{min:a,max:s}=((o=t.domain)==null?void 0:o.type)==="1d"?t.domain:{min:0,max:2*Math.PI};t.graphMode=6,t.domain={type:"1d",min:a,max:s,isExplicit:e.metaData.isExplicitDomain};break;case 126:t.graphMode=8;break}}function cte(e,t,r,n){if(n.zmin===void 0||n.zmax===void 0)return;let i=r.argNames.indexOf("x"),o=r.argNames.indexOf("y"),a=r.argNames.indexOf("z");if(i===-1||o===-1||a===-1)return;let s=r.getInstruction(r.getReturnIndex());if(s.type!==38||s.args.length!==3)return;let[c,l,u]=s.args,d=Bo(r,i,{allowRestriction:!1,allowClosedBlockReferences:!1}),f=Bo(r,o,{allowRestriction:!1,allowClosedBlockReferences:!1}),g=Bo(r,a,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Fr(d,c)!==1||Fr(f,l)!==1||Fr(g,u)!==1||Fr(f,c)!==0||Fr(g,c)!==0||Fr(d,l)!==0||Fr(g,l)!==0||Fr(d,u)!==0||Fr(f,u)!==0)return;let{xmin:y,ymin:x,zmin:b,xmax:w,ymax:E,zmax:I}=n,S=t(y,x,b),D=t(w,E,I),O=.5*(D[0]-S[0])/(w-y),_=.5*(D[1]-S[1])/(E-x),A=.5*(D[2]-S[2])/(I-b),R=(y*D[0]-w*S[0])/(D[0]-S[0]),W=(x*D[1]-E*S[1])/(D[1]-S[1]),j=(b*D[2]-I*S[2])/(D[2]-S[2]),Q=-e(R,W,j),ce=Math.sqrt(Q/O),ee=Math.sqrt(Q/_),pe=Math.sqrt(Q/A);if(!(!isFinite(R)||!isFinite(W)||!isFinite(j)||!isFinite(ce)||!isFinite(ee)||!isFinite(pe)||ce===0||ee===0||pe===0))return{center:[R,W,j],radii:[ce,ee,pe]}}function lte(e,t,r,n,i,o,a){let s=e.metaData.evaluatedCDFMin,c=e.metaData.evaluatedCDFMax,l=zp(e),u=l$(l,t),d=l&&l.discrete;if(s!==void 0&&c!==void 0&&!isNaN(s)&&!isNaN(c)&&a){let f=[];if(d){let g={viewState:n,graphInfo:i,compiled:r,bounds:[s,c],maxOverride:r$(l,t),showPoint:e.userData.shouldGraph},y=H5(g),x=y.cdfTopBranch,b=y.topBranches;if(b.forEach(function(w){!w||!u||(w.boundingBox=u)}),b.every(w=>w!==void 0)&&(f=b,x&&x.segments[0].length)){let w=[];x.segments[0].forEach(function(E){!isNaN(E[0])&&!isNaN(E[1])&&w.push([E[0],0,E[0],E[1]])}),f.push({graphMode:5,segments:w,boundingBox:u,poi:zi(),color:i.color})}}else{let y=$5({viewState:n,graphInfo:i,compiled:r,derivative:o,bounds:[s,c]}),x=y.cdfTopBranch,b=y.topBranches;if(b.forEach(function(w){!w||!u||(w.boundingBox=u)}),f=b,x&&x.segments.length){let w,E;for(let I=0;I<x.segments.length;I++){let S=x.segments[I];if(S.length>=4){w=S[0];break}}for(let I=x.segments.length-1;I>=0;I--){let S=x.segments[I];if(S.length>=4){E=S[S.length-2];break}}if(w!==void 0&&E!==void 0&&isFinite(w)&&isFinite(E)){let I=NI(x.segments,[[w,0,E,0]],x.graphMode);f.push({graphMode:7,segments:I,poi:zi(),color:i.color})}}}return f}else if(d){let f=LI({viewState:n,graphInfo:i,compiled:r,showPoint:e.userData.shouldGraph,maxOverride:r$(l,t)});return u&&(f.boundingBox=u),[f]}else return}function o$(e){return ute(e)||YN(e)||a$(e)}function ute(e){return e===3}function UN(e,t){let r=t!=null?t:{};if(!Array.isArray(e))return()=>e;let n=Object.keys(r).length===0?e:e.filter((i,o)=>!r[o]);return i=>n[i]}function dte(e){var o,a;let t=e.droppedIndices,r=UN((o=e.pointSize)!=null?o:1,t),n=UN(e.color,t),i=UN((a=e.pointOpacity)!=null?a:1,t);return e.segments[0].map(([s,c],l)=>({graphMode:114,position:[s,c,0],radius:.02*r(l),guid:Na(),color:n(l),fillOpacity:i(l)}))}function e$(e,t,r,n){return e.is3dPolicy()&&YN(t.graphMode)?RI(t,r,n!=null?n:1):t}function YN(e){switch(e){case 1:case 2:case 6:case 8:case 5:return!0;default:return!1}}function RI(e,t,r,n=0){var a;let i=s$(e,t,n),o=Dv(i,t.viewport,r);return{graphMode:128,guid:Na(),points:o,resolved:e.resolved,color:e.color,thickness:(a=e.lineWidth)!=null?a:1}}function t$(e,t,r){return e.is3dPolicy()&&a$(t.graphMode)?pte(t,r):t}function a$(e){switch(e){case 17:case 24:return!0;default:return!1}}function pte(e,t){var n;let r=s$(e,t);return{graphMode:e.graphMode===17?119:e.graphMode===24?129:128,guid:Na(),points:gte(r),color:e.color,thickness:(n=e.lineWidth)!=null?n:1}}function gte(e){let t=[];for(let[r,n,i]of e)t.push(r,n,i);return t}function s$(e,t,r=0){function n(o,a){if(e.graphMode===1)return[a,o];if(e.graphMode===6){let s=t.degreeMode?o*Math.PI/180:o;return[a*Math.cos(s),a*Math.sin(s)]}else return[o,a]}let i=[];for(let o=0;o<e.segments.length;o++){let a=e.segments[o];for(let s=0;s<a.length/2;s++){let[c,l]=n(a[2*s],a[2*s+1]);i.push([c,l,r])}o<e.segments.length-1&&i.push([NaN,NaN,0])}return i}function Dv(e,t,r){if(t.zmin===void 0||t.zmax===void 0)return[];let{xmin:n,xmax:i,ymin:o,ymax:a,zmin:s,zmax:c}=t,l=i-n,u=a-o,d=c-s,f=r/200,g=[],y=1e-4;for(let w=0;w<e.length;w++){let E=e[w];if(isFinite(E[0])&&isFinite(E[1])&&isFinite(E[2])){let I=g[g.length-1];I!==void 0&&Math.abs(E[0]-I[0])<y*l&&Math.abs(E[1]-I[1])<y*u&&Math.abs(E[2]-I[2])<y*d||g.push(E)}else g.push(void 0)}let x=[],b=g.length;for(let w=0;w<b;w++){let E=g[w];if(!E){x.push(NaN,NaN,NaN);continue}let[I,S,D]=E,O=g[w-1],_=g[w+1];if(O&&_){let[A,R,W]=O,[j,Q,ce]=_,ee=(I-A)/l,pe=(j-I)/l,re=(S-R)/u,k=(Q-S)/u,Ke=(D-W)/d,ht=(ce-D)/d,Ze=xa(ee,re,Ke),Te=xa(pe,k,ht);if((pe*ee+k*re+ht*Ke)/(Ze*Te)<.7&&Ze>f&&Te>f){let yt=.5*(f/Ze),qe=.5*(f/Te),at=il(A,I,1-yt),Ne=il(R,S,1-yt),he=il(W,D,1-yt),ie=il(I,j,qe),ct=il(S,Q,qe),je=il(D,ce,qe);x.push(at,Ne,he),x.push(il(at,I,.5),il(Ne,S,.5),il(he,D,.5)),x.push(I,S,D),x.push(il(I,ie,.5),il(S,ct,.5),il(D,je,.5)),x.push(ie,ct,je)}else x.push(I,S,D)}else x.push(I,S,D)}return x}function il(e,t,r){return(1-r)*e+r*t}function fte(e){return e.startsWith("shader:")}function zI(e,t,r){return{resolved:!0,graphMode:t,segments:r,operator:e.operator,poi:zi(),color:e.color,style:"DASHED",lineWidth:1,lineOpacity:.5,isIntersectionExtension:!0}}function HN(e,t){if(!t)return[];let r=[];for(let n of e){let i=t;if("listIndex"in n&&n.listIndex!==void 0&&t instanceof kI&&(i=t.getListItemIntersections(n.listIndex)),n.graphMode===17||n.graphMode===19){Om(i.parentType,[Ye,ot]);let o=i.getPoints();if(!o)continue;let a=0,s,c=1,l,[u,d,f,g]=n.segments[0];for(let y=0;y<o.length;y++){let[x,b]=o[y],w=El(x,b,0,u,d,0,f,g,0);w<a&&(a=w,s=y),n.graphMode===17&&w>c&&(c=w,l=y)}s!==void 0&&r.push(zI(n,17,[[u,d,o[s][0],o[s][1]]])),l!==void 0&&r.push(zI(n,17,[[f,g,o[l][0],o[l][1]]]))}else if(n.graphMode===21){Om(i.parentType,[Oe]);let o=i.getPoints();if(!o)continue;let[a,s,c,l,u]=n.segments[0],d=u-l+(u<l?1:-1)*2*Math.PI,f=[];for(let g of o){let[y,x]=g,b=Math.atan2(x-s,y-a),w=a2(b,l,d);0<w&&w<1&&f.push(w)}if(f.length){f.push(0,1),f.sort();let g=0,y=0;for(let w=0;w<f.length-1;w++){let E=f[w+1]-f[w];(g===void 0||E>g)&&(g=E,y=w)}let x=f[y],b=f[y+1];x>0&&r.push(zI(n,21,[[a,s,c,l,l+x*d]])),b<1&&r.push(zI(n,21,[[a,s,c,u,u-(1-b)*d]]))}}}return r}function mte(){throw new Error("Programming error: this function is not expected to be called")}function c$(e,t,r,n){let i=[];for(let o=0;o<t.otherVariableSolutionData.length;o++){let a=t.otherVariableSolutionData[o];if(!a)continue;let{coefficients:s,restriction:c}=a,l=s.argNames[0];if(l!=="x"&&l!=="y")continue;let u=s.getCompiledFunction().fn,d,f;l==="y"?(d=1,f=2):(d=2,f=1);let g=void 0,{listIndex:y,style:x,lineWidth:b,lineOpacity:w,color:E}=ng(e,o,g),I=OI(r,{graphMode:d,domainBound:Gi(),lineWidth:b,operator:"="},mte);if(!I)continue;let S=q5(u,I);for(let D of S){let O=new dn(c.substituteConstantArguments({[l]:D})),_=e.getGraphInfo(n,O);_={..._,graphMode:f,lineWidth:b};let R=e._graph(n,O,r,_,void 0,t.branchMultiplier===2?"solvedEquation":void 0);if(pf(R))for(let W of R)i.push({...W,listIndex:y,style:x,lineWidth:b,lineOpacity:w,color:E})}}return i.length>0?i:!1}N.Base.prototype.tryGraph=function(e,t,r,n){var i,o;try{let a=this.graph(e,t,r,n);if(Array.isArray(a))for(let s of a)"compiled"in s&&((i=s.compiled)!=null&&i.executionMetadata.recursionTerminationStatus)&&(s.recursionTerminationStatus=(o=s.compiled)==null?void 0:o.executionMetadata.recursionTerminationStatus);return a}catch(a){let s=a instanceof N.Error?a.getError():Ie(a).getError();return[G5(s)]}};N.Base.prototype.graph=function(e,t,r,n){let i=this.getGraphInfo(e,t);return this._graph(e,t,r,i,n)};N.BaseComparator.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=n.graphMode,o="baseComparator",a=this.userData.lines===void 0?!0:this.userData.lines;if(i===8||i===112||i===113||i===127||i===210)return this._graph(e,t,r,n);if(i===10||!(t instanceof N.SolvedEquation))return!1;let s=this.getOperator(),c=[],l=[],u=!0;t._expression.eachElement(function(b){c.push(b.getCompiledFunction());try{l.push(b.getCompiledDerivative())}catch(w){u=!1}}),u||(l=void 0);let d=[],f=[-1,0,0,1],g=Ff(this.metaData,["computedLineWidth","computedLineOpacity","computedFillOpacity","colorLatexValue"],o),y=Math.min(c.length,g);for(let b=0;b<y;b++){let w=this.getGraphInfo(e,t._expression.args[b]);w.graphMode=i;let{listIndex:E,style:I,color:S,lineWidth:D,lineOpacity:O,fillOpacity:_}=ng(this,b,o);w.listIndex=E,w.style=I,w.color=S,n.graphMode===6&&(w.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let A=wd({viewState:r,graphInfo:w,compiled:c[b],derivative:l?l[b]:void 0});A.lineWidth=D,A.lineOpacity=O,A.fillOpacity=_,A.operator=sf(Vo[s].inclusive,f[b%4]),a||(A.lineWidth=0),d.push(A)}for(let b=0;b<y;b+=4){let w=NI(d[b+1].segments,d[b+2].segments,i);d.push({graphMode:7,listIndex:d[b].listIndex,segments:w,poi:zi(),fillOpacity:d[b].fillOpacity,color:d[b].color})}let x=c$(this,t,r,e);if(x){for(let b of x)b.operator=sf(Vo[s].inclusive,0);Array.prototype.push.apply(d,x)}return d};N.DoubleInequality.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);if(n.graphMode===10)return!1;let i=[],o=sf(Vo[this._operators[0]].inclusive,0),a=sf(Vo[this._operators[1]].inclusive,0),s=this.userData,c=this.metaData,l=s.lines===void 0?!0:s.lines,u=["colorLatexValue","computedFillOpacity"];l&&u.push("computedLineWidth","computedLineOpacity");let d=Ff(c,u),f=t._expressions;return aa(f),UI.eachArgs(f,(g,y)=>{let x=y;if(x>=d)return;g[0].userData=g[1].userData=s,g[0].metaData=g[1].metaData=c;let b=void 0,{color:w,lineWidth:E,lineOpacity:I,fillOpacity:S}=ng(this,x,b),D=this._graph(e,g[0],r,n)[0];D.listIndex=x,D.operator=o,D.color=w,D.lineWidth=E,D.lineOpacity=I,i.push(D);let O=this._graph(e,g[1],r,n)[0];O.listIndex=x,O.operator=a,O.color=w,O.lineWidth=E,O.lineOpacity=I,i.push(O);let _=D.segments,A=O.segments;aa(_),aa(A);let R=NI(_,A,D.graphMode);l||(D.lineWidth=0,O.lineWidth=0),i.push({graphMode:7,listIndex:D.listIndex,segments:R,lineOpacity:I,fillOpacity:S,poi:zi(),color:w})}),i};N.Regression.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);return this._graph(e,t.model,r,n)};function WN(e,t){let r=1/0,n=-1/0,i=1/0,o=-1/0;for(let s of t)for(var a=0;a<s.length;a+=2){let c=s[a],l=s[a+1];c<r&&(r=c),c>n&&(n=c),l<i&&(i=l),l>o&&(o=l)}if(isFinite(r)&&isFinite(i))return{type:e,xmin:r,ymin:i,xmax:n,ymax:o}}function l$(e,t){if(!e||!(t instanceof dn))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type!==37)return;let i=e.discrete?"discreteDistribution":"continuousDistribution";if(e.symbol==="binomialdist"&&n.symbol==="binompdf"){let o=wn(r,n.args[1]),a=wn(r,n.args[2]),s=Mw(a*o,o,a);return{type:i,xmin:0,xmax:o,ymin:0,ymax:s}}if(e.symbol==="poissondist"&&n.symbol==="poissonpdf"){let o=wn(r,n.args[1]),a=Math.max(oh(Math.floor(o),o),oh(Math.ceil(o),o));return{type:i,xmin:0,xmax:2.5*o,ymin:0,ymax:a}}if(e.symbol==="normaldist"&&n.symbol==="normalpdf"){let o=wn(r,n.args[1]),a=wn(r,n.args[2]),s=yA(o,o,a);return{type:i,xmin:o-2*Math.abs(a),xmax:o+2*Math.abs(a),ymin:0,ymax:s}}if(e.symbol==="uniformdist"&&n.symbol==="uniformpdf"){let o=wn(r,n.args[1]),a=wn(r,n.args[2]),s=(o+a)/2,c=a-o,l=TA(s,o,a);return{type:i,xmin:o-c/3,xmax:a+c/3,ymin:0,ymax:l}}if(e.symbol==="tdist"&&n.symbol==="tpdf"){let o=wn(r,n.args[1]),a=Sw(0,o);return{type:i,xmin:-3,xmax:3,ymin:0,ymax:a}}}function r$(e,t){if(e===void 0||e.symbol!=="binomialdist"||!(t instanceof dn))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type===37&&n.symbol==="binompdf")return wn(r,n.args[1])}function u$(e,t,r){let n={};r-=.5*t;for(var i=e.length-1;i>=0;i--){let o=e[i],a=Math.floor((o-r)/t);n[a]?n[a].data.push(o):n[a]={id:a,data:[o],min:a*t+r,max:a*t+r+t,center:a*t+r+t/2}}return n}N.Histogram.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[0].asValue(),o=t.args[1].asValue(),a=this.userData.vizProps&&this.userData.vizProps.binAlignment==="left"?o/2:0;aa(i);let s=u$(i,o,a),c=1;this.userData.vizProps&&this.userData.vizProps.histogramMode==="density"?c=1/(i.length*o):this.userData.vizProps&&this.userData.vizProps.histogramMode==="relative"&&(c=1/i.length);let l=[],u=[];for(let f in s){let g=s[f],y=g.data.length;u.push([g.min,0*c,g.min,y*c,g.max,y*c,g.max,0*c]);let x=0;s[g.id+1]&&(x=s[g.id+1].data.length);let b=[g.min,0*c,g.min,y*c,g.max,y*c];x<y&&b.push(g.max,x*c),l.push(b)}let d=WN("histogram",u);return d&&o&&(d.binWidth=o),[{segments:u,graphMode:7,boundingBox:d,poi:zi(),color:n.color,fillOpacity:.4},{segments:l,graphMode:2,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:n.color}]};N.DotPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[1].asValue(),o=this.userData.vizProps&&this.userData.vizProps.binAlignment==="left"?i/2:0,a=t.args[0].asValue();aa(a);let s=u$(a,i,o),c=!1,l,u=[];for(let w in s){let E=s[w];for(var d=E.data.length-1;d>=0;d--)E.center!==E.data[d]&&(c=!0)}if(this.userData.vizProps&&this.userData.vizProps.dotplotXMode==="exact")for(let w in s){l=s[w].data,l.reverse();for(let I=0;I<l.length;I++)u.push([l[I],I+1])}else for(let w in s){let E=s[w];l=E.data;for(let I=0;I<l.length;I++)u.push([E.center,I+1])}let f=WN("dotplot",u);f&&i&&(f.ymin=0,f.xmin-=.5*i,f.xmax+=.5*i,f.binWidth=i);let{computedPointOpacity:g,computedPointSize:y}=this.metaData,x=Su(g,0),b=this.userData.pointSize?Su(y,0):14;return[{segments:[u],graphMode:3,boundingBox:f,poi:$c(u),color:n.color,style:this.userData.pointStyle,pointSize:b,pointOpacity:x,showPoint:!0,needsDotplotXMode:c}]};N.BoxPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=this.metaData.evaluatedAxisOffset,o=this.metaData.evaluatedBreadth,a=t.args[0].asValue();if(aa(a),isNaN(o)||isNaN(i))return!1;let s=Math.min.apply(null,a),c=Math.max.apply(null,a),l=Zg(a,1),u=Zg(a,2),d=Zg(a,3),f=i,g=f-o/2,y=f+o/2,x=o/10,b=[];if(this.userData.vizProps.showBoxplotOutliers){let S=d-l,D=l-1.5*S,O=d+1.5*S;s=1/0,c=-1/0,a.forEach(function(_){D<=_&&_<s&&(s=_),c<_&&_<=O&&(c=_),(_<D||_>O)&&b.push([_,f])})}let w=[[l,g,d,g,d,y,l,y,l,g],[u,g,u,y],[l,f,s,f],[d,f,c,f],[s,f-x,s,f+x],[c,f-x,c,f+x]];if(this.userData.vizProps&&this.userData.vizProps.alignedAxis==="y"){for(let S of w)for(var E=0;E<S.length;E+=2){let D=S[E];S[E]=S[E+1],S[E+1]=D}for(let S of b){let D=S[0];S[0]=S[1],S[1]=D}}let I=[{segments:w,graphMode:5,boundingBox:WN("boxplot",w.concat(b)),poi:zi(),color:n.color}];return b.length&&I.push({segments:[b],graphMode:3,color:n.color,style:"OPEN",showPoint:!0,poi:$c(b)}),I};function hte(e){return Array.prototype.concat.apply([],e)}N.Table.prototype.isValueDraggable=function(e,t,r){if(!e.columns[t].isIndependent)return!1;let i=this.columns[t].values,o=i&&i[r];return!!(o&&isFinite(o.asValue())&&o.getDependencies().length===0)};N.Table.prototype.graph=function(e,t,r){let n={};if(t.columns[0].isError)return n;let o=t.columns[0].asValue();for(let a=1;a<this.columns.length;a++){let s=t.columns[a];if(s.isError)continue;let c=s.asValue(),l=this.columns[a].header.userData,u=this.columns[a].header.metaData;if(l.hidden)continue;let d=Ff(u,["colorLatexValue","computedPointSize","computedPointOpacity"]),f=l.dragMode,g=f==="X"||f==="XY",y=f==="Y"||f==="XY",x=!!l.points,b=!!l.lines,w=[],E=[],I=[],S=[],D=[],O=[],_=1/0,A=-1/0,R=1/0,W=-1/0,j={};for(let ce=0;ce<o.length;ce++){let ee=o[ce],pe=c[ce];if(!isFinite(ee)||!isFinite(pe)){j[ce]=!0,b&&(O.length>1&&D.push(O),O=[]);continue}if(x){if(ce>=d)continue;let re=g&&this.isValueDraggable(t,0,ce),k=y&&this.isValueDraggable(t,a,ce);re||k?(I.push([ee,pe]),S.push({index:ce,dragX:re,dragY:k})):E.push([ee,pe])}b&&O.push([ee,pe]),ee<_&&(_=ee),ee>A&&(A=ee),pe<R&&(R=pe),pe>W&&(W=pe)}let Q={type:"table",xmin:_,xmax:A,ymin:R,ymax:W};I.length&&w.push({graphMode:4,segments:[I],color:u.colorLatexValue||l.color,tableId:l.tableId,poi:$c(I),movablePointInfo:S,boundingBox:Q,pointOpacity:u.computedPointOpacity,pointSize:u.computedMovablePointSize}),E.length&&w.push({segments:[E],droppedIndices:j,graphMode:3,showPoint:!0,poi:$c(E),color:u.colorLatexValue||l.color,pointSize:u.computedPointSize,pointOpacity:u.computedPointOpacity,style:l.pointStyle,tableId:l.tableId,boundingBox:Q}),(D.length||O.length)&&(D.push(O),w.push({segments:D.map(hte),graphMode:5,poi:zi(),color:ju(l,u),style:l.lineStyle,lineWidth:Array.isArray(u.computedLineWidth)?u.computedLineWidth[0]:u.computedLineWidth,lineOpacity:Array.isArray(u.computedLineOpacity)?u.computedLineOpacity[0]:u.computedLineOpacity,tableId:l.tableId,boundingBox:Q})),w.length&&(n[l.id]=w)}return n};function yte(e,t,r){return e?t===0&&r===0?e[2].type!=="none"||e[3].type!=="none":t!==0&&r!==0?e[0].type!=="none"&&e[1].type!=="none":t!==0?e[0].type!=="none":r!==0?e[1].type!=="none":!1:!1}N.Image.prototype.graph=function(e,t,r){let n=[];if(t.center.valueType!==z||t.center.getDependencies().length!==0||!t.radianAngle.isConstant||!t.width.isConstant||!t.height.isConstant||!t.opacity.isConstant)return n;let i=[],o=[],a=t.width.asValue()/2,s=t.height.asValue()/2,c=t.radianAngle.asValue();for(var l=-1;l<=1;l++)for(var u=-1;u<=1;u++){let[d,f]=t.center.asValue(),g=[d+l*a*Math.cos(c)+u*s*Math.sin(c),f-l*a*Math.sin(c)+u*s*Math.cos(c)];yte(t.moveStrategy,l,u)&&(i.push(g),o.push([l,u]))}return n.push({segments:[i],scaleFactors:[o],graphMode:4,color:ju(this.userData,this.metaData),style:this.userData.style,poi:$c(i),movablePointInfo:[],pointOpacity:1}),n};function n$(e){let t=[],r=[];for(let[n,i]of e)!isNaN(n)&&!isNaN(i)?t.push(n,i):(t.length>=4&&r.push(t),t=[]);return t.length>=4&&r.push(t),r}function i$(...e){return e.some(t=>isNaN(t))}function ol(e){if(typeof e=="string")return e;if(e===void 0)return"";if(isNaN(e))return"\\frac{0}{0}";if(e===1/0)return"\\infty";if(e===-1/0)return"-\\infty";let t=e+"";return t=t.replace(/^1e\+?([-\d]+)/,"10^{$1}"),t=t.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),t}function Wn(e,t){if(xe(e)){let r=[];for(let n=0;n<t.length;n++)r.push(Wn(It(e),t[n]));return`\\left[${r.join(",")}\\right]`}switch(e){case C:return ol(t);case z:{let[o,a]=t;return`\\left(${ol(o)},${ol(a)}\\right)`}case oe:{let[o,a,s]=t;return`\\left(${ol(o)},${ol(a)},${ol(s)}\\right)`}case gn:return"\\operatorname{rgb}\\left("+[Wn(C,t[0]),Wn(C,t[1]),Wn(C,t[2])].join(",")+"\\right)";case et:{let o=[];for(let a of t)o.push(Wn(z,a));return"\\operatorname{polygon}\\left("+o.join(",")+"\\right)"}case Ye:return"\\operatorname{segment}\\left("+[Wn(z,t[0]),Wn(z,t[1])].join(",")+"\\right)";case Re:return"\\operatorname{line}\\left("+[Wn(z,t[0]),Wn(z,t[1])].join(",")+"\\right)";case ot:return"\\operatorname{ray}\\left("+[Wn(z,t[0]),Wn(z,t[1])].join(",")+"\\right)";case Ve:let r=t[0],n=t[1],i=[n[0]+r[0],n[1]+r[1]];return`\\operatorname{vector}\\left(${Wn(z,n)},${Wn(z,i)}\\right)`;case We:return"\\operatorname{circle}\\left("+[Wn(z,t[0]),Wn(C,t[1])].join(",")+"\\right)";case Oe:return"\\operatorname{arc}\\left("+[Wn(z,t[0]),Wn(z,t[1]),Wn(z,t[2])].join(",")+"\\right)";case st:return"\\operatorname{angle}\\left("+[Wn(z,t[0]),Wn(C,t[1]),Wn(C,t[2])].join(",")+"\\right)";case $e:return"\\operatorname{directedangle}\\left("+[Wn(z,t[0]),Wn(C,t[1]),Wn(C,t[2])].join(",")+"\\right)";case In:return`\\operatorname{tone}\\left(${Wn(C,t[0])},${Wn(C,t[1])}\\right)`;default:throw new Error("Cannot serialize a value of type "+dt(e)+".")}}function XN(e){let t={};for(let r of _n(e.updateRules))t[r]=bte(e,r);return t}function bte(e,t){let{valueType:r,value:n}=e.updateRules[t];return`${ni(t)}=${Wn(r,n)}`}function xte(e){return e.isError?e.getError():e.asValue()===void 0?"":+e.asValue()}function vte(e,t,r){let n=[];for(var i=0;i<t.columns.length;i++){let o=r.columns[i],a=o.isError?[]:o.rawArgs.map(xte),s={dependent:!o.isIndependent,discrete:!!o.isIndependent,values:a};o.isError&&(s.error=o.getError()),n.push(s)}return{column_data:n}}function Tte(e,t,r){let n={variables:[],errorMap:{},dimensions:{}};if(e.areAllScalesLinear()||(n.errorMap.scale=!0),r.center.isError&&(n.errorMap.center=!0),r.radianAngle.isError&&(n.errorMap.angle=!0),r.width.isError&&(n.errorMap.width=!0),r.height.isError&&(n.errorMap.height=!0),r.opacity.isError&&(n.errorMap.opacity=!0),Object.keys(n.errorMap).length>0)return n.variables=t.getSliderVariables(e,r),n;n.dimensions.x=[],n.dimensions.y=[],n.dimensions.radianAngle=[],n.dimensions.width=[],n.dimensions.height=[],n.dimensions.opacity=[];let i=[r.center,r.radianAngle,r.width,r.height,r.opacity];return i.some(a=>a&&a.valueType&&xe(a.valueType))&&(n.is_concrete_list=!0),N.List.eachArgs(i,function(a){let s=a[0].asValue(),c=+a[1].asValue(),l=Math.atan2(Math.sin(c),Math.cos(c));n.dimensions.x.push(+s[0]),n.dimensions.y.push(+s[1]),n.dimensions.radianAngle.push(l),n.dimensions.width.push(+a[2].asValue()),n.dimensions.height.push(+a[3].asValue()),n.dimensions.opacity.push(Math.max(0,Math.min(1,+a[4].asValue())))}),(e.graphingEnabled()?t.getGraphMode(e,r):10)!==10&&(n.is_graphable=!0),r.moveStrategy&&(n.move_strategy=r.moveStrategy),t.center&&(t.center.type==="Identifier"?(n.center_reference_id=t.center.referencedStatementId,n.center_reference_symbol=t.center._symbol):t.center.type==="ParenSeq"&&r.center.valueType===z&&(n.center_is_point_literal=!0)),n}function wte(e,t,r){let n=r.handler,i=r.minStep,o={},a={};for(let d of n.getDependencies())e.validActionVariable(d)||(o[d]=!0);for(let d of i.getDependencies())a[d]=!0;let s;if(mf(i))s={status:"error",error:i.getError()};else{let d=i.asValue();typeof d=="number"&&!isNaN(d)&&d>=0?s={status:"valid",value:d}:s={status:"error",error:ND().getError()}}let c=Object.keys(o);c.length>0&&(n=un(c).setDependencies(n.getDependencies()));let l;n.isError&&!Pte(e,n)?l={status:"error",error:n.getError()}:n.isEmptyAction?l={status:"empty"}:l={status:"maybe-valid"};let u={handler:l,minStep:s,variables:[]};return Cte(u,e,{...o,...a}),u}function p$(){return{operator:"=",variables:[]}}function g$(e,t,r,n){if(oE(r))return vte(e,r,n);if(iq(r))return Tte(e,r,n);let i=p$();if(r instanceof N.Ticker)return e.graphingEnabled()?wte(e,r,n):(i.error=Ie("Ticker without graphing").getError(),i);if(e.is3dProduct()){let l=e,u=r.getGraphMode(l,n);if((u===100||u===5)&&n.getDependencies().length===1){let d=n.getDependencies()[0];(d==="u"||d==="v"||d==="t")&&(i.internal_domain_dependency=d)}}let o=dv(r.userData);if(o){let l=n.getCursorContext();if(l)i.cursor_context={...l,selection:o};else if(mf(n)){let u=Ite(e,t,r);u&&(i.cursor_context={...u,selection:o})}}if(r instanceof hs&&n instanceof dn?i.recursion=n.getRecursiveFunctionMetadata():r instanceof hs&&n instanceof q&&n.recursionMetadata&&(i.recursion=n.recursionMetadata),r instanceof Yh&&(i.recursion_base_case={symbol:r._symbol,argValue:r.specifiedArg.valid?r.specifiedArg.argValue:void 0}),n.isError&&!(r instanceof N.FunctionDefinition&&!n.blocksExport)&&!n.silent){i.error=n.getError(),i.variables=r.getSliderVariables(e,n),i.is_single_identifier=r instanceof N.Identifier,n.actionValue&&(i.action_value=XN(n.actionValue));let l=d$(e,t,r,n);return l&&(i.geometry=l),i}if(n.valueType===gn&&n.getDependencies().length===0){let l=n.asValue();i.rgb_value=ex(l[0],l[1],l[2]).formatHex()}n.valueType===nr&&n.getDependencies().length===0&&(i.action_value=XN(n.asValue())),n.moveStrategy&&(i.move_strategy=n.moveStrategy,i.default_drag_mode=n.defaultDragMode),r.isInequality()&&(i.is_inequality=!0),i.operator=r.getOperator(),n instanceof N.SolvedEquation?n._expression.asValue()!==!0&&n._expression.asValue()!==!1&&(i.assignment=n._symbol):r instanceof N.Assignment&&(r._symbol.startsWith("_")||(i.assignment=r._symbol)),r instanceof N.FunctionDefinition&&(i.function_definition=r._symbol);let a=e.graphingEnabled()?r.getGraphMode(e,n):10;if(e.graphingEnabled()&&e.is3dPolicy()&&!wu(a)&&!o$(a)&&(a=10),a!==10&&(i.is_graphable=!0,i.expression_type=r.getExpressionType(a,n.valueType),e.is3dPolicy()&&(i.expression_type==="SINGLE_POINT"?i.expression_type="POINT3D":i.expression_type==="POINT_LIST"&&(i.expression_type="POINT3D_LIST")),n.valueType&&Qd(n.valueType)&&(i.map_type=n.valueType),n.isShadeBetween()&&(i.is_shade_between=!0),i.expression_type!=="POINT3D"&&i.expression_type!=="POINT3D_LIST")){let l=r.tableInfo(e,n);l&&(i.is_tableable=!0,i.table_info=l)}if(n.valueType!==void 0&&xe(n.valueType)&&(i.is_concrete_list=!0,n.valueType===uo&&n.getDependencies().length===0)){let l=n.asValue();l&&(i.rgb_value=l.map(u=>ex(u[0],u[1],u[2]).formatHex()))}if(i.variables=i.is_graphable?[]:r.getSliderVariables(e,n),i.is_single_identifier=r instanceof N.Identifier,n.isTypedConstant){let l=n.asTypedValue();i.typed_constant_value=l,Ete(l==null?void 0:l.valueType)&&(i.geometry=d$(e,t,r,n))}if(n.getEvaluationInfo()&&i.operator==="="&&!r.isConstant&&!r.isFunction&&!(r instanceof N.RecursiveFunctionBaseCase)&&n.valueType!==tt&&n.valueType!==vi&&!(r instanceof N.Equation)&&!(r instanceof N.ComparatorChain)&&!(e.isComplexEnabled()&&by(r))&&(i.is_evaluable=!0),n instanceof N.OptimizedRegression){let l=n,u={};for(let d of _n(l.parameters))l.parameters.hasOwnProperty(d)&&(u[ni(d)]=+l.parameters[d].asValue());i.is_regression=!0,i.regression={parameters:u,residualVariable:ni(l.residualVariable),residualSuggestionId:l.residualSuggestionId,shouldSuggestLogMode:l.shouldSuggestLogMode,isLinear:l.isLinear,statistics:l.statistics,parameterWarning:l.parameterWarning}}let c=zp(r);return c&&c.discrete&&(i.is_discrete_distribution=!0),i}function Ete(e){switch(e){case z:case on:case Re:case Ei:case Ye:case zn:case ot:case li:case Ve:case Ii:case We:case wi:case Oe:case ci:case et:case ti:case st:case Un:case $e:case ri:case xt:case Oo:return!0;default:return!1}}function d$(e,t,r,n){let i={};n.valueType!==void 0&&(i.valueType=n.valueType),i.valueType&&Le(i.valueType,z)&&e.graphingEnabled()&&yv(r.getGraphMode(e,n))&&(i.isMovablePoint=!0);let{identifier:o,listAccess:a,tree:s}=fE(r);if(o&&(i.identifier=o),a&&(i.listAccess=a),s&&(i.call=s,n.valueType&&Le(n.valueType,xt)&&r instanceof hs)){let l=r._expression;i.transformation_preview_info={type:s.symbol,args:l.args.slice(1).map(u=>u.tryGetConcreteTree(e,t).asTypedValue())}}let c=n.moveStrategy&&n.moveStrategy[0];if(c&&"initialValue"in c&&c.initialValue!==void 0&&(i.gliderParameter=c.initialValue),Object.keys(i).length>0){let l=r.getLegalExports(e);return{parentDependencies:r.getDependencies().filter(d=>!An[d]&&!l.includes(d)),...i}}}function Ite(e,t,r){let n=dv(r.userData);if(!n)return;let{input:i,start:o,end:a}=n;if(i.trim()==="")return{type:"empty",allowedTypes:[nn]};let s="\\cursor",c=i.slice(0,o)+s+" "+i.slice(a),l={start:o,end:o+s.length},u=Gp(c,{...r.parseOptions});return u.userData={...r.userData,latex:c,latexSelection:l},u.isError?u.getCursorContext():iy({policy:e,frame:t},u).getCursorContext()}function Cte(e,t,r){let n=e.variables;if(n&&n.length){let i={};for(let o of n)i[o]=!0;for(let o of _n(r))i[o]=!0;r=i}e.variables=t.sliderVariables(_n(r))}function Pte(e,t){if(t.blocksExport)return!1;let r=t.getDependencies();if(r.length===0)return!1;for(let n of r)if(!e.validActionVariable(n))return!1;return!0}function f$(e){return e instanceof N.Constant||e instanceof N.ParenSeq&&e.args.length===1&&e.args[0]instanceof N.Constant}function Nv(e){return!!(e instanceof N.Identifier&&e._symbol===Za||(e instanceof N.Multiply||e instanceof N.CrossMultiply||e instanceof N.DotMultiply)&&e.args.length===2&&e.args.some(t=>t instanceof N.Identifier&&t._symbol===Za)&&e.args.some(t=>f$(t))||e instanceof N.Negative&&e.args[0]instanceof N.Identifier&&e.args[0]._symbol===Za||e instanceof N.FunctionCall&&e._symbol===Za&&e.args.length===1&&e.args[0]instanceof N.Constant)}function by(e){return!!(Nv(e)||(e instanceof N.Add||e instanceof N.Subtract)&&e.args.some(t=>Nv(t))&&e.args.some(t=>f$(t))||e instanceof N.Assignment&&by(e._expression))}var me=class{constructor(t,r,n,i){this.policy=t,this.rawTree=n,this.concreteTree=i,this.evaluationState=g$(t,r,n,i)}graph(t,r){return this.rawTree.tryGraph(this.policy,this.concreteTree,t,r)}getGraphMode(){return this.policy.graphingEnabled()?this.rawTree.getGraphMode(this.policy,this.concreteTree):10}getGraphInfo(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)}shouldIntersect(){if(!this.evaluationState.is_graphable||!this.rawTree.userData.shouldGraph||!Nl.pointsOfInterest)return!1;var t=this.getGraphMode();return t===1||t===2}};N.Base.prototype.analyze=function(e,t){return la(this)?ua(e,t,this):new me(e,t,this,this.tryGetConcreteTree(e,t))};function HI(e,t,r,n){if(n.isError)return new me(e,t,r,n);if(!e.areAllScalesLinear()&&!Gb(n.valueType)){let l=Hm(dt(n.valueType));return l.setCursorContext(n.getCursorContext()),new me(e,t,r,l)}var i=nl(e,n),o=n.getDependencies();let a,s=Le(n.valueType,$)&&e.validParametricVariables(i)&&e.plotComplexAsPoints();switch(n instanceof N.IRExpression&&o.length>0&&!s&&(n=n.coerceToNumericIfPossible()),n.valueType){case cr:case Ti:case Rt:{a=n;break}case gn:case uo:case Ye:case zn:case We:case wi:case Oe:case ci:case Re:case Ei:case ot:case li:case Ve:case Ii:case st:case Un:case $e:case ri:case xt:case Oo:case nr:case et:case ti:case Mr:case Zi:case Pt:case Qi:case Hn:case Ji:case $n:case No:case In:case Lo:i.length?a=un(r.getSliderVariables(e,n)).setDependencies(i):a=n;break;case z:case oe:case on:case ji:case $:case Dn:if(i.length)if(e.validParametricVariables(i))a=n;else{var c=r.getSliderVariables(e,n);a=un(c).setDependencies(c)}else a=n;break;case Ni:case ki:case po:case fo:case Ri:case go:case jo:case ea:case Jo:case ta:case Zo:case Qo:{i.length===0?a=n:a=un(r.getSliderVariables(e,n)).setDependencies(i);break}case C:case ke:i.length===0?a=n:i.length<=(e.is3dPolicy()?2:1)?e.is3dPolicy()&&o.length>i.length&&!e.validImplicitVariables(o)?a=un(r.getSliderVariables(e,n)).setDependencies(o):e.validExpressionVariables(i)?a=n:a=J1(e.implicitDependency(i)).setDependencies(i):e.validImplicitVariables(i)?a=J1().setDependencies(i):a=un(r.getSliderVariables(e,n)).setDependencies(o);break;default:a=Ie(`Programming error: unexpected value type ${n.valueType}`)}return mf(a)&&a.setCursorContext(n.getCursorContext()),a=hy(e,r,a),new me(e,t,r,a)}function m$(e){return new N.FunctionCall("pdf",[e,new N.Identifier("x")])}N.Identifier.prototype.analyze=function(e,t,r){if(e.plotComplexAsPoints()&&this._symbol===Za){let o=ZN(this,e,t,r);if(o)return new me(e,t,this,o)}let n=this.tryGetConcreteTree(e,t,{coerceToNumber:"all-except-complex"}),i=HI(e,t,this,n);return la(this)&&!QN(i)?ua(e,t,this):i};N.FunctionCall.prototype.analyze=function(e,t,r){var n;tI[this._symbol]&&Df(t,this).length===0&&!e.is3dPolicy()?n=m$(this).tryGetConcreteTree(e,t):n=this.tryGetConcreteTree(e,t);var i=HI(e,t,this,n);if(la(this)&&!QN(i))return ua(e,t,this);var o=this.getMoveStrategy(e,t,n,r);if(o){var a=this.getDefaultDragMode(o),s=n.asCompilerValue(),c=[new N.Constant(s[0]),new N.Constant(s[1])];return new me(e,t,this,new N.MovablePoint(c,o,a))}return i};function jN(e,t){return!t.plotComplexAsPoints()||!e._dependencies.includes(Za)||e._dependencies.length===1&&!by(e)?!1:!!((e instanceof N.Add||e instanceof N.Subtract)&&!e.args[0]._dependencies.includes(Za)&&e.args[1]._dependencies.includes(Za)||Nv(e))}function ZN(e,t,r,n,i){if(!jN(e,t))return;let o=e;if(Nv(o)){let u=new N.Constant(0),d=o.getInputSpan();if(d){let f=d.input.slice(0,d.start)+"0+"+d.input.slice(d.start),g=d.start;u.setInputSpan({input:f,start:g,end:g+1}),e.setInputSpan({input:f,start:g,end:d.end+2})}o=new N.Add([u,o]),o.setInputSpan(e.getInputSpan())}let a=o.tryGetConcreteTree(t,r),s=o.getMoveStrategy(t,r,a,n);if(!s)return;let c=(i!=null?i:e).getDefaultDragMode(s),l=a.asCompilerValue();return a=new N.MovableComplexNumber([new N.Constant(l[0]),new N.Constant(l[1])],s,c),a.metaData=e.metaData,a}N.Expression.prototype.analyze=function(e,t,r){let n=HI(e,t,this,this.tryGetConcreteTree(e,t));if(la(this)&&!QN(n))return ua(e,t,this);if(e.plotComplexAsPoints()){let i=ZN(this,e,t,r);if(i)return new me(e,t,this,i)}return n};N.FunctionDefinition.prototype.analyze=function(e,t){var c;if(la(this))return ua(e,t,this);if(An[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split("_")[0];if((c=An[r])!=null&&c.isFunction)return new me(e,t,this,Xm(this._symbol,r));let n=this.tryGetConcreteTree(e,t);if(n instanceof N.Error&&!n.blocksExport&&this._argSymbols.length===1){let l=Fi(t);l[this._argSymbols[0]]=new Ut("identityTransformation");let u=this._expression.tryGetConcreteTree(e,l);if(u instanceof dn&&Le(u.valueType,xt))return new me(e,t,this,u)}if(e.is3dPolicy()&&e.assignmentForbidden(this._symbol))return new me(e,t,this,nw(this._symbol));if(n.isError)return new me(e,t,this,n);var i=this._argSymbols,o=n.getDependencies();n instanceof N.IRExpression&&o.length>0&&(n=n.coerceToNumericIfPossible());var a=o.filter(function(l){return i.indexOf(l)===-1});if(e.unplottablePolarFunction(this._symbol,o))return new me(e,t,this,YD());if(a.some(function(l){return e.assignmentForbidden(l)}))return new me(e,t,this,xx(a,this._symbol,i).setDependencies(o));if(a.length){var s=this.getSliderVariables(e,n);return new me(e,t,this,un(s).setDependencies(s))}return!e.areAllScalesLinear()&&!Gb(n.valueType)?new me(e,t,this,Hm(dt(n.valueType))):(n=hy(e,this,n),new me(e,t,this,n))};N.Assignment.prototype.analyze=function(e,t,r){if(la(this))return ua(e,t,this);var n=this._symbol;if(!e.validLHS(n))return new me(e,t,this,$D(n));if(An.hasOwnProperty(n)||e.isComplexEnabled()&&n===Za)return this.asEquation().analyze(e,t);var i;if(this._expression instanceof N.FunctionCall&&tI[this._expression._symbol]&&Df(t,this).length===0&&!e.is3dPolicy())i=m$(this._expression).tryGetConcreteTree(e,t);else{var o=Fi(t);o[n]=e.validSolvedVariable(n)?void 0:zg(),i=this.tryGetConcreteTree(e,o)}if(i.isError)return new me(e,t,this,i);if(!e.areAllScalesLinear()&&!Gb(i.valueType))return new me(e,t,this,Hm(dt(i.valueType)));if(this.isEquation(e,i))return this.asEquation().analyze(e,t);let a=i.valueType===gn||i.valueType===uo;if(e.assignmentForbidden(n)&&a){let g=UD(n).allowExport().setDependencies([n]);return new me(e,t,this,g)}let s=i.getDependencies(),c=nl(e,i);i instanceof N.IRExpression&&s.length>0&&(i=i.coerceToNumericIfPossible());let l=c.includes("x")||c.includes("y"),u=c.includes("r")||c.includes("theta");if(n==="r"&&s.includes("phi")){let g=c.includes("z")?W1():BD();return new me(e,t,this,g)}if(n==="rho"&&c.includes("z")){let g=s.includes("phi")?W1():qD();return new me(e,t,this,g)}let d=this.getSliderVariables(e,i,s);if(e.tooManySliderVariables(s,d,a)||l&&u){let g=un(d).allowExport().setDependencies(d);return new me(e,t,this,g)}if(e.plotComplexAsPoints()){let g=ZN(this._expression,e,t,r,this);if(g)return new me(e,t,this,g)}let f=this.getMoveStrategy(e,t,i,r);if(f){let g=this.getDefaultDragMode(f);return i=new N.MovablePoint([i.slot(0),i.slot(1)],f,g),new me(e,t,this,i)}return i=hy(e,this,i),new me(e,t,this,i)};N.RecursiveFunctionBaseCase.prototype.analyze=function(e,t){if(la(this))return ua(e,t,this);if(!this.specifiedArg.valid)return new me(e,t,this,this.specifiedArg.error);let r=this.tryGetConcreteTree(e,t);if(r.isError)return new me(e,t,this,r);var n=this._argSymbols,i=r.getDependencies();if(e.is3dPolicy()&&e.assignmentForbidden(this._symbol))return new me(e,t,this,nw(this._symbol));var o=i.filter(function(s){return n.indexOf(s)===-1});if(o.includes(this.specifiedArg.argSymbol))return new me(e,t,this,$S(this.specifiedArg.argSymbol));for(let s of o)if(e.assignmentForbidden(s))return new me(e,t,this,HS(s));if(o.length){var a=this.getSliderVariables(e,r);return new me(e,t,this,un(a).setDependencies(a))}return!e.areAllScalesLinear()&&!Gb(r.valueType)?new me(e,t,this,Hm(dt(r.valueType))):new me(e,t,this,r)};N.Regression.prototype.analyzeRegression=function(e,t,r,n,i){if(la(this))return ua(e,t,this);var o={policy:e,frame:t,exportFrame:r,lastExportFrame:n,priorAnalysis:i};return new me(e,t,this,n5(o,this))};function JN(e,t){var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();return n.length?new me(e,t,this,un(this.getSliderVariables(e,r)).setDependencies(n)):new me(e,t,this,this.tryGetConcreteTree(e,t))}N.Histogram.prototype.analyze=function(e,t){return la(this)?ua(e,t,this):e.areAllScalesLinear()?JN.call(this,e,t):new me(e,t,this,BM())};N.DotPlot.prototype.analyze=function(e,t){return la(this)?ua(e,t,this):e.areAllScalesLinear()?JN.call(this,e,t):new me(e,t,this,qM())};N.BoxPlot.prototype.analyze=function(e,t){return la(this)?ua(e,t,this):e.areAllScalesLinear()?JN.call(this,e,t):new me(e,t,this,zM())};function h$(e){return function(t,r){if(la(this))return ua(t,r,this);var n=this.tryGetConcreteTree(t,r),i=n.getDependencies();if(i.length)return new me(t,r,this,un(this.getSliderVariables(t,n)).setDependencies(i));var o=new me(t,r,this,this.tryGetConcreteTree(t,r));if(!n.isError){o.evaluationState.expression_type="TTEST";var a=n.args.map(function(s){return s.asValue()});o.evaluationState.ttest_results=e.apply(null,a)}return o}}N.TTest.prototype.analyze=h$(EA);N.IndependentTTest.prototype.analyze=h$(IA);N.Stats.prototype.analyze=function(e,t){if(la(this))return ua(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();if(n.length)return new me(e,t,this,un(this.getSliderVariables(e,r)).setDependencies(n));var i=new me(e,t,this,this.tryGetConcreteTree(e,t));if(!r.isError){i.evaluationState.expression_type="STATS";var o=r.args.map(function(a){return a.asValue()});i.evaluationState.stats_results=CA.apply(null,o)}return i};N.Equation.prototype.analyze=N.CallAssignment.prototype.analyze=N.BaseComparator.prototype.analyze=Ste;function Ste(e,t){if(la(this))return ua(e,t,this);var r=this.getOperator()!=="=";if(r&&!Nl.plotInequalities)return new me(e,t,this,X1());var n=o5({policy:e,frame:t},this);if(n.isError)return new me(e,t,this,n);let i=nl(e,n);if(n instanceof N.SolvedEquation&&i.length){var o=i.concat(n._symbol);if(!e.validImplicitVariables(o))return new me(e,t,this,zg().setDependencies(o))}return this.getGraphMode(e,n)===8&&!e.validImplicitVariables(i)?new me(e,t,this,zg().setDependencies(i)):(n=hy(e,this,n),new me(e,t,this,n))}N.DoubleInequality.prototype.analyze=function(e,t){if(la(this))return ua(e,t,this);if(!Nl.plotInequalities)return new me(e,t,this,X1());var r=this.tryGetConcreteTree(e,t);if(r.isError)return new me(e,t,this,r);var n=r.getDependencies();return Vo[this._operators[0]].direction!==Vo[this._operators[1]].direction?new me(e,t,this,j1()):e.validDoubleInequalitySymbol(r._symbol)?e.validDoubleInequalityVariables(n)?n.length>2?new me(e,t,this,un(this.getSliderVariables(e,r)).setDependencies(n)):r._expressions[0].getDependencies().indexOf(r._symbol)!==-1||r._expressions[1].getDependencies().indexOf(r._symbol)!==-1?new me(e,t,this,Z1().setDependencies(n)):new me(e,t,this,r):new me(e,t,this,K1().setDependencies(n)):new me(e,t,this,K1().setDependencies(n))};N.ComparatorChain.prototype.analyze=function(e,t){if(la(this))return ua(e,t,this);var r=this.tryGetConcreteTree(e,t);if(r.isError)return new me(e,t,this,r);var n=r.getDependencies();if(n.length)if(e.is3dPolicy()){if(!e.validImplicitVariables(n))return new me(e,t,this,(this.symbols.includes("=")?XD():JD()).setDependencies(n));if(!(this.symbols.every(o=>o==="<"||o==="<=")||this.symbols.every(o=>o===">"||o===">=")||this.symbols.every(o=>o==="=")))return new me(e,t,this,j1().setDependencies(n));if(this.symbols.includes("=")&&!n.includes("z"))return new me(e,t,this,QD().setDependencies(n));let i=this._difference.tryGetConcreteTree(e,t);return i=hy(e,this,i),new me(e,t,this,i)}else return this.symbols.includes("=")?new me(e,t,this,e_()):this.symbols.length>2?new me(e,t,this,nM()):e.validDoubleInequalityVariables(n)?new me(e,t,this,Z1()):new me(e,t,this,un(this.getSliderVariables(e,r)).setDependencies(n));return new me(e,t,this,r)};N.ParenSeq.prototype.analyze=function(e,t,r){if(la(this))return ua(e,t,this);var n=this.tryGetConcreteTree(e,t);if(n.isError)return new me(e,t,this,n);var i=this.getMoveStrategy(e,t,n,r);if(i){var o=this.getDefaultDragMode(i),a=n.asCompilerValue(),s=[new N.Constant(a[0]),new N.Constant(a[1])];return new me(e,t,this,new N.MovablePoint(s,i,o))}return HI(e,t,this,n)};function Mte(e,t){return e.filter(function(r){return!t[r]})}function y$(e){if(e instanceof xf){if(e.header instanceof N.Identifier)return e.header._symbol}else if(e instanceof Cp)return e.headerSymbol}function Dte(e){for(var t={},r=0;r<e.length;r++){var n=e[r];let i=y$(n);i!==void 0&&(t[i]===void 0&&(t[i]=0),t[i]+=1)}return t}N.Table.prototype.analyze=function(e,t){var r=Fi(t),n=[],i=Dte(this.columns),o;for(o=0;o<this.columns.length;o++){var a=this.columns[o];if(a instanceof xf&&a.header instanceof N.Identifier){var s=a.header._symbol,c=r[s],l=i[s]>1;if(l&&!c&&(r[s]=OD(s)),c&&c.isError){let w=c;(w.isTableCycleWithoutGlobalDefinition||w.isMultiplyDefinedByTables&&!l)&&(r[s]=void 0)}}var u=a.analyze(e,r);if(o===0&&u.concreteTree.isIndependent){let w=y$(u.concreteTree);if(!w)throw Ie("Column independent without header symbol");e.validFirstColumnVariable(w)||(u=new me(e,t,a,r_()))}if(u.concreteTree.isIndependent)u.rawTree.exportToLocal(e,u.concreteTree,r);else if(!u.concreteTree.isError){var d=u.concreteTree.getDependencies(),f=Mte(d,r);f.length&&(u=new me(e,t,a,un(f).setDependencies(f)))}n.push(u.concreteTree)}var g=1;for(let w of n)w.isList&&(g=Math.max(w.length,g));let y=[];for(let w of n)y.push(_te(w,g));var x=new N.Table(y),b=new me(e,t,this,x);return b.evaluationState.is_graphable=!0,b};function _te(e,t){if(e.isError)return e;if(e.isConstant){let r=[];for(let n=0;n<t;n++)r.push(e);return new N.TableColumnValue(r,void 0)}else if(e.isList){if(e instanceof N.TableColumnValue)return e;let r=e.mapElements(n=>n);return new N.TableColumnValue(r,void 0)}else throw Ie("Invalid column.")}N.TableColumn.prototype.analyze=function(e,t){var r=this.header.tableError();if(r)return new me(e,t,this,t_(r));var n=this.tryGetConcreteTree(e,t);return new me(e,t,this,n)};N.Image.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(e,t);if(n.radianAngle.isError||n.center.isError||n.width.isError||n.height.isError||n.opacity.isError)return new me(e,t,this,n);var i=n.center.getDependencies(),o=n.radianAngle.getDependencies(),a=n.width.getDependencies(),s=n.height.getDependencies(),c=n.opacity.getDependencies();return i.length||o.length||a.length||s.length||c.length?new me(e,t,this,new N.Image({center:i.length?un(o).setDependencies(i):n.center,radianAngle:o.length?un(o).setDependencies(o):n.radianAngle,width:a.length?un(a).setDependencies(a):n.width,height:s.length?un(s).setDependencies(s):n.height,opacity:c.length?un(c).setDependencies(c):n.opacity})):(n.moveStrategy=this.getMoveStrategy(e,t,n,r),new me(e,t,this,n))};N.Slider.prototype.analyze=function(e,t){if(la(this))return ua(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.sliderInfo,i;if(n.missingVars.length){var o=gP(n.missingVars);i=new me(e,t,this,un(e.sliderVariables(o)).setDependencies(o).allowExport())}else i=new me(e,t,this,r);var a=i.evaluationState;if(Nl.sliders){a.assignment=n.exportedSymbol,a.slider_min_number=n.values.min,a.slider_max_number=n.values.max,a.slider_step_number=n.values.step,a.slider_min_valid=n.valids.min,a.slider_max_valid=n.valids.max,a.slider_step_valid=n.valids.step;var s=a.slider_min_valid&&a.slider_max_valid&&a.slider_step_valid;a.is_slider=!0,a.raw_slider_latex=this.getInputString(),a.is_slidable=s,a.is_animatable=a.is_slidable&&!a.is_graphable,n.errMsg&&(a.error=n.errMsg.getError())}return delete a.is_evaluable,i};function la(e){return e.userData&&"latex"in e.userData&&Dg(e.userData.latex).slice(-1)==="="}function ua(e,t,r){return new me(e,t,r,hx("="))}function QN(e){return e.concreteTree.isConstant&&e.concreteTree.valueType===C||e.concreteTree.isTypedConstant&&e.concreteTree.valueType===$}N.Base.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new me(e,t,this,r):new me(e,t,this,Ie(`Unexpected node type ${this.type}`))};N.Expression.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new me(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],o,a=An[i];return a?o=a.isFunction?ba(i):Hg(i):o=Ix(i),new me(e,t,this,o)}return new me(e,t,this,r)};N.Assignment.prototype.analyzeFourFunction=function(e,t){return new me(e,t,this,Cx())};N.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return new me(e,t,this,$g())};function b$(e,t){return new me(e,t,this,Us())}N.Equation.prototype.analyzeFourFunction=b$;N.CallAssignment.prototype.analyzeFourFunction=b$;function eR(e,t){return new me(e,t,this,ms())}N.DoubleInequality.prototype.analyzeFourFunction=eR;N.ComparatorChain.prototype.analyzeFourFunction=eR;N.BaseComparator.prototype.analyzeFourFunction=eR;N.Regression.prototype.analyzeFourFunction=function(e,t){return new me(e,t,this,sd())};N.ParenSeq.prototype.analyzeFourFunction=function(e,t){return new me(e,t,this,cd())};N.Base.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new me(e,t,this,r):new me(e,t,this,Ie(`Unexpected node type ${this.type}`))};N.Expression.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new me(e,t,this,r);var n=r.getDependencies();return n.length>0?new me(e,t,this,un(n)):new me(e,t,this,r)};N.Assignment.prototype.analyzeScientific=function(e,t){var r=this._symbol;if(An[r])return new me(e,t,this,Xm(r));var n=Fi(t);n[r]=Us();var i=this.tryGetConcreteTree(e,n);if(i.isError)return new me(e,t,this,i);var o=i.getDependencies();return this.isEquation(e,i)?new me(e,t,this,Us()):o.length>0?new me(e,t,this,un(o)):new me(e,t,this,i)};N.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(An[this._symbol])return new me(e,t,this,Xm(this._symbol));var r=this.tryGetConcreteTree(e,t);if(r.isError)return new me(e,t,this,r);var n=this._argSymbols,i=r.getDependencies();if(i.indexOf(this._symbol)!==-1)return new me(e,t,this,qg([this._symbol]));var o=i.filter(function(a){return n.indexOf(a)===-1});return o.length?new me(e,t,this,xx(o,this._symbol,n)):new me(e,t,this,r)};function x$(e,t){return new me(e,t,this,Us())}N.Equation.prototype.analyzeScientific=x$;N.CallAssignment.prototype.analyzeScientific=x$;function tR(e,t){return new me(e,t,this,ms())}N.DoubleInequality.prototype.analyzeScientific=tR;N.ComparatorChain.prototype.analyzeScientific=tR;N.BaseComparator.prototype.analyzeScientific=tR;N.Regression.prototype.analyzeScientific=function(e,t){return new me(e,t,this,sd())};N.ParenSeq.prototype.analyzeScientific=function(e,t){return new me(e,t,this,cd())};N.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new me(e,t,this,r):new me(e,t,this,Ie(`Unexpected node type ${this.type}`))};N.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new me(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],o,a=An[i];return a?o=a.isFunction?ba(i):Hg(i):o=Ix(i),new me(e,t,this,o)}return new me(e,t,this,r)};N.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return new me(e,t,this,Cx())};N.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return new me(e,t,this,$g())};function v$(e,t){return new me(e,t,this,Us())}N.Equation.prototype.analyzeSingleExpressionScientific=v$;N.CallAssignment.prototype.analyzeSingleExpressionScientific=v$;function rR(e,t){return new me(e,t,this,ms())}N.DoubleInequality.prototype.analyzeSingleExpressionScientific=rR;N.ComparatorChain.prototype.analyzeSingleExpressionScientific=rR;N.BaseComparator.prototype.analyzeSingleExpressionScientific=rR;N.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return new me(e,t,this,sd())};N.ParenSeq.prototype.analyzeSingleExpressionScientific=function(e,t){return new me(e,t,this,cd())};N.Base.prototype.getGraphInfo=function(e,t){var r=t.getDependencies(),n,i;switch(r.length){case 0:n=T$(t),i=t.boundDomain("x");break;case 1:i=t.boundDomain(r[0]),qs(i)&&!Wa(i)&&(n=T$(t));break;default:i=Gi();break}return{graphMode:this.getGraphMode(e,t),color:ju(this.userData,this.metaData),pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,arrowMode:this.userData.arrowMode,operator:this.getOperator(),isLinear:!!n,linearCoefficients:n,domainBound:i}};function T$(e){switch(e.valueType){case C:return nR(e);case z:{var t=nR(e.slot(0)),r=nR(e.slot(1));return!t||!r?void 0:[t,r]}default:return}}function nR(e){var t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;var r=e.getPolynomialCoefficients(t[0]);return[r[0]?+r[0].asValue():0,r[1]?+r[1].asValue():0];default:return}}var w$=new N.Constant(Et(0,1));N.Assignment.prototype.getMoveStrategy=function(e,t,r,n){return this._expression.getMoveStrategy(e,t,r,n)};function Ate(e){return{type:"updateSliderNonlinear",id:e.id,initialValue:e.initialValue,min:e.min,max:e.max,compiled:e.compiled,movesOn:e.movesOn,hasLinearComponent:e.hasLinearComponent}}function Ote(e){return{type:"updateGliderParameter",span:e.span,movesOn:e.movesOn}}function Lte(e){return{type:"updateSliderForGlider",id:e.sliderId,movesOn:e.movesOn,min:e.min,max:e.max}}function E$(e,t,r,n,i,o){var a=t.getDependencies();for(let b of a)if(i[b])return;for(var s=a.length-1;s>=0;s--){var c=a[s];if(!o[c]){var l=n[c];if(l!==void 0){var u=r[c];if(u.order===1){var d=u.tree,f=d.getPolynomialCoefficients(c),g=f[1]||w$,y=f[0]||w$;if(!(!y.isConstant||!g.isConstant)&&!(!isFinite(y.asValue())||!isFinite(g.asValue()))&&g.asValue()!==0){var x=[-y.asValue()/g.asValue(),1/g.asValue()];return{symbol:c,id:l,coefficients:x}}}}}}}function Nte(e,t){for(var r in t){var n=t[r].evaluationState,i=n.assignment;if(i===e)return r}}function Rte(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}function iR(e,t){var r=Rte(e),n={};for(var i in t){var o=t[i].evaluationState.assignment;t[i].evaluationState.is_slidable&&r[o]&&(n[o]=i)}return n}function I$(e,t,r,n){for(var i=[],o=0;o<r.length;o++){var a=r[o],s={};i.push(s);for(var c=0;c<n.length;c++){var l=n[c],u=Fi(t);u[l]=void 0;var d=a.tryGetConcreteTree(e,u);if(d.isError){s[l]={tree:d,order:1/0};continue}else s[l]={tree:d,order:d.polynomialOrder(l)}}}return i}function C$(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];t[i].order!==0&&(r[i]=!0)}}N.ParenSeq.prototype.getMoveStrategy=function(e,t,r,n){if(!(e.plotComplexAsPoints()&&this._dependencies.includes(Za)))return P$(this,e,t,r,n)};function P$(e,t,r,n,i){var S;let o=t.plotComplexAsPoints()&&n.valueType===$;if(n.valueType!==z&&!o||n.getDependencies().length!==0)return;if(o&&by(e)){let D=e.getInputSpan();return D?[{type:"updateCoordinate",inputSpan:D},{type:"updateCoordinate",inputSpan:D}]:void 0}let a=e.getDependencies(),s=iR(a,i),c=_n(s),l=e.args;o&&(l=[new N.FunctionCall("real",[e.args[0]]),new N.FunctionCall("imag",[e.args[1]])]);let u=I$(t,r,l,c),d=[],f={},g={};for(let D=0;D<2;D++){let O=l[D],_=e.args[D];if(_.isConstant&&!o){let R=_.getInputSpan();d[D]=R?{type:"updateCoordinate",inputSpan:R}:{type:"none"};continue}let A=E$(t,O,u[D],s,f,g);A&&(t.plotComplexAsPoints()&&n.valueType===$&&e instanceof N.Subtract&&D===1&&(A.coefficients=A.coefficients.map(R=>-R)),d[D]={type:"updateSlider",id:A.id,coefficients:A.coefficients},f[A.symbol]=!0,C$(c,u[D],g)),d[D]||(d[D]={type:"none"})}let[y,x]=d,b;if(y.type==="none"&&x.type==="none"&&c.length===1&&(b=c[0]),!b)return y.type!=="none"||x.type!=="none"?d:void 0;let w=s[b],E;try{let D=Fi(r);D[b]=void 0,E=e.getConcreteTree(t,D).getCompiledFunction()}catch(D){return}S3(E);let I=i[w].evaluationState;return[Ate({id:w,initialValue:(S=I.typed_constant_value)==null?void 0:S.value,min:I.slider_min_number,max:I.slider_max_number,compiled:E,hasLinearComponent:y.type==="updateSlider"||x.type==="updateSlider"}),{type:"none"}]}N.FunctionCall.prototype.getMoveStrategy=function(e,t,r,n){if(this._symbol==="glider"&&!(!r.isTypedConstant||r.valueType!==z)){var i,o,a;switch(this.args[1].type){case"Constant":{var s=this.args[1].asValue();if(typeof s!="number"||(i=this.args[0].getConcreteTree(e,t),!i.isTypedConstant))return;a=i.asTypedValue();let g=this.args[1].getInputSpan();return[g?Ote({span:g,movesOn:a}):{type:"none"},{type:"none"}]}case"Identifier":{var c=this.args[1]._symbol,l=iR([c],n),u=l[c];if(u===void 0)return;var d=n[u].evaluationState,f=Fi(t);return f[c]=void 0,i=this.args[0].getConcreteTree(e,f),i.isTypedConstant?(a=i.asTypedValue(),o={min:d.slider_min_number,max:d.slider_max_number},[Lte({min:o.min,max:o.max,movesOn:a,sliderId:u}),{type:"none"}]):void 0}default:return}}};N.Image.prototype.getMoveStrategy=function(e,t,r,n){if(!(r.center.valueType!==z||r.center.getDependencies().length!==0||!r.width.isConstant||!r.height.isConstant||!r.radianAngle.isConstant||!r.opacity.isConstant)){var i=this.getDependencies(),o=iR(i,n),a=_n(o),s=[this.width,this.height];this.center.type==="ParenSeq"?s.push(this.center.args[0],this.center.args[1]):this.center.type==="Identifier"&&(this.center.referencedStatementId=Nte(this.center._symbol,n));for(var c={},l={},u=I$(e,t,s,a),d=[],f=[2,3,0,1],g=0;g<f.length;g++){var y=f[g],x=s[y];if(!x){d[y]={type:"none"};continue}if(x.isConstant){let w=x.getInputSpan();d[y]=w?{type:"updateCoordinate",inputSpan:w}:{type:"none"};continue}var b=E$(e,x,u[y],o,c,l);b&&(d[y]={type:"updateSlider",id:b.id,coefficients:b.coefficients},c[b.symbol]=!0,C$(a,u[y],l)),d[y]||(d[y]={type:"none"})}if(!(d[0].type==="none"&&d[1].type==="none"&&d[2].type==="none"&&d[3].type==="none"))return d}};N.Expression.prototype.getMoveStrategy=function(e,t,r,n){if(jN(this,e))return P$(this,e,t,r,n)};N.Assignment.prototype.getDefaultDragMode=function(e){return e[0].type!=="none"&&e[1].type!=="none"?"XY":e[0].type!=="none"?"X":e[1].type!=="none"?"Y":"NONE"};N.Expression.prototype.getDefaultDragMode=function(e){return e[0].type==="updateSlider"&&e[1].type==="updateSlider"?"XY":e[0].type==="updateSlider"?"X":e[1].type==="updateSlider"?"Y":e[0].type==="updateSliderNonlinear"&&e[0].hasLinearComponent?"X":"NONE"};N.FunctionCall.prototype.getDefaultDragMode=function(e){return this._symbol!=="glider"?"NONE":N.Assignment.prototype.getDefaultDragMode.call(this,e)};var kte=N.List;N.Base.prototype.tableInfo=function(e,t){return!1};N.Identifier.prototype.tableInfo=function(e,t){return e.validFirstColumnVariable(this._symbol)?{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}:!1};N.Expression.prototype.tableInfo=function(e,t){var r=t.getDependencies();if(zp(this))return!1;switch(t.valueType){case z:case on:if(r.length!==0||t.isMovablePoint&&(t.moveStrategy[0].type==="updateSlider"||t.moveStrategy[1].type==="updateSlider"))return!1;var n=kte.wrap(t).asValue();return{independent_variable:"x",dependent_column:"y",by_reference:!1,values:n};case C:if(r.length!==1)return!1;var i=r[0];return e.validFirstColumnVariable(i)?{independent_variable:i,dependent_column:this.getInputString(),by_reference:!1}:!1;default:return!1}};N.Assignment.prototype.tableInfo=function(e,t){if(t instanceof N.SolvedEquation||!this.getInputString().length||zp(this)||Am(t.valueType))return!1;let r=t.getDependencies();if(r.length>1)return!1;let n;if(r.length===0){if(!e.tableableAsConstant(this._symbol))return!1;n=e.implicitIndependent(this._symbol)}else n=r[0];if(!e.validFirstColumnVariable(n))return!1;let i=e.assignmentForbidden(this._symbol)?Dg(this.getInputString().replace(/[^=]*=/,"")):Dg(this.getInputString().split("=")[0]);return{independent_variable:n,dependent_column:i,by_reference:!e.assignmentForbidden(this._symbol)}};N.FunctionDefinition.prototype.tableInfo=function(e,t){if(this._argSymbols.length!==1||!this.getInputString().length)return!1;var r=t.getDependencies();if(r.length>1)return!1;var n=this._argSymbols[0];if(!e.validFirstColumnVariable(n))return!1;var i=e.assignmentForbidden(this._symbol),o=i?Dg(this.getInputString().replace(/[^=]*=/,"")):Dg(this.getInputString().split("=")[0]);return{independent_variable:n,dependent_column:o,by_reference:!i}};N.BaseComparator.prototype.tableInfo=function(e,t){return!1};N.ComparatorChain.prototype.tableInfo=function(e,t){return!1};N.DoubleInequality.prototype.tableInfo=function(e,t){return!1};N.Equation.prototype.tableInfo=function(e,t){return!1};N.Base.prototype.tableError=function(){return this.isInequality()?L("shared-calculator-error-table-inequality-supplement"):!(this instanceof N.Expression)&&!(this instanceof N.IRExpression)?L("shared-calculator-error-table-generic-supplement"):!1};N.List.prototype.tableError=function(){return L("shared-calculator-error-table-list-supplement")};N.Equation.prototype.tableError=N.Assignment.prototype.tableError=function(){return L("shared-calculator-error-table-equation-supplement")};N.ComparatorChain.prototype.tableError=function(){return this.symbols.includes("=")?L("shared-calculator-error-table-equation-supplement"):L("shared-calculator-error-table-inequality-supplement")};N.FunctionDefinition.prototype.tableError=function(){return L("shared-calculator-error-table-function-definition-supplement")};N.Regression.prototype.tableError=function(){return L("shared-calculator-error-table-regression-supplement")};N.List.prototype.elementAt=function(e){return e=Math.floor(e),e>=0&&e<this.args.length?this.args[e]:new N.Constant(NaN)};N.List.prototype.eachElement=function(t){for(var r=0;r<this.length;r++)t(this.elementAt(r),r)};N.List.prototype.mapElements=function(t){for(var r=[],n=0;n<this.length;n++)r.push(t(this.elementAt(n),n));return r};N.IRExpression.prototype.elementAt=function(e){var t=this._chunk.elementAt(e);return new dn(t)};function Vte(){return ni(this._symbol)+" "}N.Identifier.prototype.printLatex=Vte;N.Constant.prototype.printLatex=function(){return ol(this.asValue())};N.Ticker.prototype.printLatex=function(){return"\\ticker\\left("+this.args.map(ka).join(", ")+"\\right)"};N.Negative.prototype.printLatex=function(){return"-\\left("+this.args[0].printLatex()+"\\right)"};N.Add.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)+\\left("+this.args[1].printLatex()+"\\right)"};N.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+" \\% \\operatorname{of} "+this.args[1].printLatex()};N.Subtract.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)-\\left("+this.args[1].printLatex()+"\\right)"};N.Multiply.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)*\\left("+this.args[1].printLatex()+"\\right)"};N.DotMultiply.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)\\cdot\\left("+this.args[1].printLatex()+"\\right)"};N.CrossMultiply.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)\\times\\left("+this.args[1].printLatex()+"\\right)"};N.Divide.prototype.printLatex=function(){return"\\frac{"+this.args[0].printLatex()+"}{"+this.args[1].printLatex()+"}"};N.Exponent.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)^{"+this.args[1].printLatex()+"}"};N.Assignment.prototype.printLatex=function(){return ni(this._symbol)+"="+this._expression.printLatex()};N.Equation.prototype.printLatex=N.CallAssignment.prototype.printLatex=function(){return this._lhs.printLatex()+"="+this._rhs.printLatex()};function $I(e){switch(e){case">":return">";case"<":return"<";case">=":return"\\ge ";case"<=":return"\\le ";case"=":return"="}return""}N.BaseComparator.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)"+$I(this.operator)+"\\left("+this.args[1].printLatex()+"\\right)"};N.ComparatorChain.prototype.printLatex=function(){let e="";for(let t=0;t<this.symbols.length;t++)e+=`\\left(${this.args[t].printLatex()}\\right)${$I(this.symbols[t])}`;return e+=`\\left(${this.args[this.args.length-1].printLatex()}\\right)`,e};N.DoubleInequality.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)"+$I(this.args[1])+this.args[2].printLatex()+$I(this.args[3])+"\\left("+this.args[4].printLatex()+"\\right)"};N.Or.prototype.printLatex=function(){return this.args[0].printLatex()+","+this.args[1].printLatex()};function ka(e){return e.printLatex()}function Fte(){switch(this._symbol){case"sqrt":return"\\sqrt{"+this.args[0].printLatex()+"}";case"nthroot":return"\\sqrt["+this.args[1].printLatex()+"]{"+this.args[0].printLatex()+"}";case"logbase":return"\\log_{"+this.args[1].printLatex()+"}\\left("+this.args[0].printLatex()+"\\right)";default:return ni(this._symbol)+"\\left("+this.args.map(ka).join(", ")+"\\right)"}}N.FunctionCall.prototype.printLatex=Fte;N.RecursiveFunctionBaseCase.prototype.printLatex=function(){return this.originalNode.printLatex()};N.SeededFunctionCall.prototype.printLatex=function(){return ni(this._symbol)+"\\left("+this.args.slice(1).map(ka).join(", ")+"\\right)"};N.DotAccess.prototype.printLatex=function(){return"("+this.args[0].printLatex()+").("+this.args[1].printLatex()+")"};N.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case"logbase":return"\\log_{"+this.args[0].args[1].printLatex()+"}"+Array(this.order+1).join("'")+"\\left("+this.args[0].args[0].printLatex()+"\\right)";default:return ni(this.args[0]._symbol)+Array(this.order+1).join("'")+"\\left("+this.args[0].args.map(ka).join(", ")+"\\right)"}};N.List.prototype.printLatex=function(){return"\\left["+this.args.map(ka).join(", ")+"\\right]"};N.Range.prototype.printLatex=function(){return"\\left["+this.args[0].args.map(ka).join(", ")+" ... "+this.args[1].args.map(ka).join(", ")+"\\right]"};N.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+"\\to("+this.args[1].printLatex()+")"};N.ListAccess.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)\\left["+this.args[1].printLatex()+"\\right]"};N.ParenSeq.prototype.printLatex=function(){return"\\left("+this.args.map(ka).join(", ")+"\\right)"};N.BareSeq.prototype.printLatex=function(){return this.args.map(ka).join(", ")};N.NamedCoordinateAccess.prototype.printLatex=function(){return"\\left(\\left("+this.args[0].printLatex()+"\\right)."+this.symbol+"\\right)"};N.Norm.prototype.printLatex=function(){return"\\left|"+this.args[0].printLatex()+"\\right|"};N.Sum.prototype.printLatex=function(){return"\\sum_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)"};N.Product.prototype.printLatex=function(){return"\\prod_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)"};N.Integral.prototype.printLatex=function(){return"\\int_{"+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)d"+this.args[0].printLatex()};N.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+"\\left("+this.args[1].printLatex()+"\\right)^{"+this.args[2].printLatex()+"}"};N.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+"\\left("+this.args[1].printLatex()+"\\right)!"};function oR(e){return e.isConstant&&e.asValue()===!0}function Gte(e){return e.isConstant&&e.isNaN()}N.Piecewise.prototype.printLatex=function(){var e=this;if(oR(e.args[0]))return e.args[1].printLatex();for(var t=["\\left\\{"];;){if(oR(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),": "),Gte(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),", "),!(e.args[2]instanceof N.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push("\\right\\}"),t.join("")};N.Restriction.prototype.printLatex=function(){return oR(this.args[0])?"\\left\\{\\right\\}":"\\left\\{"+this.args[0].printLatex()+"\\right\\}"};N.FunctionDefinition.prototype.printLatex=function(){return ni(this._symbol)+"\\left("+this._argSymbols.map(ni).join(", ")+"\\right) = "+this._expression.printLatex()};N.Derivative.prototype.printLatex=function(){return"\\frac{d}{d"+ni(this._symbol)+"}\\left("+this.args[0].printLatex()+"\\right)"};N.Regression.prototype.printLatex=function(){return"\\left("+this._lhs.printLatex()+"\\right)\\sim\\left("+this._rhs.printLatex()+"\\right)"};N.Histogram.prototype.printLatex=function(){return"\\histogram\\left("+this.args.map(ka).join(", ")+"\\right)"};N.DotPlot.prototype.printLatex=function(){return"\\dotplot\\left("+this.args.map(ka).join(", ")+"\\right)"};N.BoxPlot.prototype.printLatex=function(){return"\\boxplot\\left("+this.args.map(ka).join(", ")+"\\right)"};N.TTest.prototype.printLatex=function(){return"\\TTest\\left("+this.args.map(ka).join(", ")+"\\right)"};N.IndependentTTest.prototype.printLatex=function(){return"\\IndependentTTest\\left("+this.args.map(ka).join(", ")+"\\right)"};N.Stats.prototype.printLatex=function(){return"\\Stats\\left("+this.args.map(ka).join(", ")+"\\right)"};N.AssignmentExpression.prototype.printLatex=function(){return ni(this._symbol)+"="+this.args[1].printLatex()};N.ListComprehension.prototype.printLatex=function(){return"\\left["+this._body.printLatex()+"\\operatorname{for}"+this._inputLists.map(ka).join(", ")+"\\right]"};N.Substitution.prototype.printLatex=function(){return"\\left(\\left("+this._body.printLatex()+"\\right)\\operatorname{with}"+this._assignments.map(ka).join(", ")+"\\right)"};N.Construction.prototype.printLatex=function(){return"\\construction "};N.ImaginaryUnit.prototype.printLatex=function(){return Za};N.MovableComplexNumber.prototype.printLatex=function(){return Ub(this.asValue())};N.Base.prototype.getExpressionType=function(e,t){switch(e){case 114:return t&&xe(t)?"POINT3D_LIST":"POINT3D";case 100:case 128:return"CURVE3D_xyz_t";case 119:return"SEGMENT3D";case 129:return"VECTOR3D";case 130:case 103:return"SURFACE_xyz_uv";case 110:return"SURFACE_r_\u03B8z";case 124:return"SURFACE_r_\u03B8z_AMBIGUOUS";case 109:return"SURFACE_z_r\u03B8";case 111:return"SURFACE_r_\u03B8\u03C6";case 107:case 108:case 106:return"SURFACE";case 118:return"SPHERE3D";case 117:return"TRIANGLE3D";case 120:case 121:return"SURFACE_AMBIGUOUS";case 122:case 123:return"SURFACE_CONSTANT_AMBIGUOUS";case 112:case 113:case 210:return"IMPLICIT_SURFACE";case 126:case 127:return"IMPLICIT_SURFACE_AMBIGUOUS";case 3:case 4:case 25:case 26:return t&&xe(t)?"POINT_LIST":"SINGLE_POINT";case 1:case 2:return"X_OR_Y";case 5:return"PARAMETRIC";case 6:return"POLAR";case 8:return"IMPLICIT";case 24:case 17:return"VECTOR2D";case 200:case 201:case 202:case 205:case 209:return"SLICE";case 211:case 206:return"SLICE_r\u03B8z_at_z";case 203:return"SLICE_zr\u03B8_at_r";case 204:return"SLICE_zr\u03B8_at_\u03B8";case 213:return"SLICE_zr\u03B8_at_xyz";case 207:return"SLICE_r\u03B8\u03C6_at_\u03B8";case 208:return"SLICE_r\u03B8\u03C6_at_\u03C6";case 212:return"SLICE_r\u03B8\u03C6_at_xyz";case 214:case 215:return"SLICE_xyz_uv";default:return t!==void 0&&Le(t,et)?"POLYGON":"X_OR_Y"}};N.Histogram.prototype.getExpressionType=function(e,t){return"HISTOGRAM"};N.DotPlot.prototype.getExpressionType=function(e,t){return"DOTPLOT"};N.BoxPlot.prototype.getExpressionType=function(e,t){return"BOXPLOT"};var YI=class extends Pe{};var WI=class extends Pe{constructor(t){super(t),this._symbol="sphere"}};function Bte(e){return function(r){return new e(r)}}var qte=[xh,vh,mp,Th,wh,Eh,Ea,YI,yp,Ih,bp,xp,vp,Ch,Ph,Sh,gu,Dl,Oh,Lh,Nh,kh,Gc,Vh,wa,Gh,zh,Fh,Bh,WI,qh,Ta,Uh,Hh];for(let e of qte)e.prototype.copyWithArgs=Bte(e);Bc.prototype.copyWithArgs=function(e){return new ja[this.operator](e)};hp.prototype.copyWithArgs=function(e){return new hp(this.symbols,e)};Yr.prototype.copyWithArgs=function(e){return new Yr(this._constantValue)};cf.prototype.copyWithArgs=function(e){return new cf(this.constructedObjectIds)};lf.prototype.copyWithArgs=function(e){return new lf(this._symbol,e)};uf.prototype.copyWithArgs=function(e){return new uf(this.tag,e)};Tn.prototype.copyWithArgs=function(e){return new Tn(new Ut(this._symbol),e)};Ut.prototype.copyWithArgs=function(e){return new Ut(this._symbol)};vf.prototype.copyWithArgs=function(e){return new vf};pd.prototype.copyWithArgs=function(e){return new pd(e[0],e[1],e.slice(2),this.shouldCoerceToList,this.parameters)};_l.prototype.copyWithArgs=function(e){return new _l(this.symbol,e)};ff.prototype.copyWithArgs=function(e){return new ff(this.order,e)};hf.prototype.copyWithArgs=function(e){return new hf(this.value)};bf.prototype.copyWithArgs=function(e){return new bf(e[0],e.slice(1))};yf.prototype.copyWithArgs=function(e){return new yf(this._stringValue)};Tf.prototype.copyWithArgs=function(e){return new Tf(e,this.moveStrategy,this.defaultDragMode)};zd();var KI=class{constructor(t,r){this.cb=t;this.document=r;this.observedAriaLiveElements=new WeakMap;this.destroyed=!1;this.onAriaLabelFocus=t=>{let r=t.target;if(this.isElement(r)){let n=r.getAttribute("aria-label");n&&this.cb(n,"label")}};this.document.documentElement.addEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver=new MutationObserver(n=>this.handleAriaLiveContentMutations(n)),r.documentElement.querySelectorAll('[aria-live="assertive"]').forEach(n=>this.startObservingAriaLiveElement(n)),this.treeObserver=new MutationObserver(n=>this.handleDocumentTreeMutations(n)),this.treeObserver.observe(r.documentElement,{childList:!0,subtree:!0,attributeFilter:["aria-live"]})}destroy(){this.destroyed=!0,this.document.documentElement.removeEventListener("focus",this.onAriaLabelFocus,!0),this.ariaLiveContentObserver.disconnect()}isObservingElement(t){return!!this.observedAriaLiveElements.get(t)}handleAriaLiveContentMutations(t){var n;let r=new Map;for(let i of t){if(!this.observedAriaLiveElements.get(i.target))continue;let o=r.get(i.target);o||(o=[],r.set(i.target,o)),o.push(i)}for(let[i,o]of r){let a=i.cloneNode(!0),s=[a.textContent||""];for(let c=o.length-1;c>=0;c--){let l=o[c];switch(l.type){case"attributes":{l.attributeName!==null&&a.setAttribute(l.attributeName,l.oldValue||""),s.push(a.textContent||"");break}case"characterData":{l.oldValue!==null&&(a.textContent=l.oldValue),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}case"childList":{if(l.addedNodes.length>1||l.removedNodes.length>1)throw new Error(`Expected at most one removed node and one added node, but got ${l.removedNodes.length} removed nodes and ${l.addedNodes.length} added nodes`);l.addedNodes.length===1&&((n=a.firstChild)==null||n.remove()),l.removedNodes.length===1&&l.removedNodes.forEach(u=>a.appendChild(u.cloneNode(!0))),a.textContent&&a.textContent!==s[s.length-1]&&s.push(a.textContent);break}}}for(let c of s.reverse())this.cb(c,"alert")}}startObservingAriaLiveElement(t){this.destroyed||t.getAttribute("aria-live")==="assertive"&&(this.observedAriaLiveElements.get(t)||(this.observedAriaLiveElements.set(t,!0),t.textContent&&this.cb(t.textContent,"alert"),this.ariaLiveContentObserver.observe(t,{attributes:!0,characterData:!0,childList:!0,attributeOldValue:!0,characterDataOldValue:!0})))}stopObservingAriaLiveElement(t){this.observedAriaLiveElements.set(t,!1)}handleDocumentTreeMutations(t){for(let r of t)r.addedNodes.forEach(n=>{this.isElement(n)&&n.getAttribute("aria-live")==="assertive"&&this.startObservingAriaLiveElement(n)}),this.isElement(r.target)&&r.attributeName==="aria-live"&&(r.target.getAttribute("aria-live")==="assertive"?this.startObservingAriaLiveElement(r.target):this.stopObservingAriaLiveElement(r.target)),r.removedNodes.forEach(n=>{this.isElement(n)&&(this.stopObservingAriaLiveElement(n),n.querySelectorAll('[aria-live="assertive"]').forEach(i=>this.stopObservingAriaLiveElement(i)))})}isElement(t){var n;let r=(n=this.document.defaultView)==null?void 0:n.Element;return r?t instanceof r:!1}};var ig,jI=[],M$="",$te;function D$(e){jI.push(e)}function ZI(e){if(e!==void 0&&D$(e),ig&&jI.length>0){let t=jI.join(" ").replace(/ +(?= )/g,"");ig.setAttribute("aria-relevant",M$===t&&LP?"all":"additions text"),ig.textContent=t,M$=t}jI.length=0}function Yte(){ig=document.createElement("p"),ig.setAttribute("aria-live","assertive"),ig.setAttribute("aria-atomic","true"),ig.classList.add("dcg-aria-alert"),document.body.appendChild(ig),zu("logAria")&&($te=new KI((e,t)=>Ki.log(`[aria ${t}] ${e}`),document))}nG(Yte);var A$={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wte(e){let t=[],r=e.toLowerCase();if(r.slice(0,3)==="rgb")try{t=r.replace(/[^\d,]/g,"").split(",").slice(0,3).map(function(i){return parseInt(i,10)})}catch(i){aR(e)}else if(r[0]==="#"){var n=/^#?([a-f\d])([a-f\d])([a-f\d])$/;r=r.replace(n,function(i,o,a,s){return o+o+a+a+s+s});try{t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(r).slice(1).map(function(i){return parseInt(i,16)})}catch(i){aR(e)}}else t=A$[r];return Xte(t)||aR(e),{R:t[0],G:t[1],B:t[2]}}function Xte(e){return!Hd(e)||e.length!==3?!1:pP(e,function(t){return Number.isInteger(t)&&t>=0&&t<=255})}function aR(e){throw new Error("Invalid color string: "+e)}function Kte({R:e,G:t,B:r}){return .2126729*(e/255)**2.4+.7151522*(t/255)**2.4+.072175*(r/255)**2.4}var sR=.342;function O$(e,t=!1,r=sR){if(typeof e!="string"||!e)return!1;try{let n=Wte(e);return Kte(n)>r?!t:t}catch(n){return!1}}zd();var jte={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:"",disableGraphInteractions:!1};var Qte=10,EVe=ha.RED,IVe=ha.BLUE,CVe=ha.GREEN,PVe=ha.PURPLE,SVe=ha.ORANGE,MVe=ha.BLACK;var ere=e=>{if(!Array.isArray(e))return[e];let t=Array(Math.min(e.length,Qte));for(let r=0;r<t.length;r++)t[r]=e[Math.round(r*e.length/t.length)];return t};function R$(e,t,r=sR){switch(e.type){case"single-color":case"color-array":return ere(e.value).some(i=>O$(i,t,r));case"shader":case"image":return!0;default:let n=e;throw new Error("Unexpected ColorSwatchSpec type: "+n.type)}}var ore={enabled:!1,latex:"",hoveredImage:"",depressedImage:""},cR={center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:"1",clickableInfo:ore,description:"",draggable:!1},aFe={folderId:"",hidden:!1,secret:!1,readonly:!1,disableGraphInteractions:!1,foreground:!1,name:"",...cR};fa();var CFe={id:!1,type:!1,image_url:!0,name:!0,folderId:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,foreground:!0,...i1(cR)};function k$(e){var t;return!!(e.clickableInfo.enabled&&e.formula&&((t=e.formula.click_handler)==null?void 0:t.status)==="maybe-valid")}function tC(e){if(e.type!=="folder"&&e.folderId){let t=e.controller.getListModel(),r=dre(t,e.folderId);if(r&&r.type==="folder")return r}}function dre(e,t,r){let n=e.__itemIdToModel[t];if(n)return n;if(r&&r.includePreviewItems)return e.__toolPreviewIdToModel[t]}function kv(e){return!!e.controller.getListModel().selectedItemMap[e.id]}function uR(e){return e?e.type==="image"&&k$(e)||e.type==="expression"&&rC(e):!1}Bd();var k2e="data:audio/mpeg;base64,//uQx"+"A".repeat(23)+"WGluZwAAAA8AAAACAAACcQCA"+"gICA".repeat(16)+"/".repeat(66)+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+"A".repeat(320)+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+"/".repeat(15)+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+"/".repeat(18)+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+"V".repeat(97)+"Q==";function vy(e){return!!e&&e.type==="expression"&&!!e.formula&&!!e.formula.typed_constant_value&&!!e.formula.geometry}function lR(e,t={isReverseDrag:!1}){let r=e.dragMode==="AUTO"&&e.formula.default_drag_mode!==void 0?e.formula.default_drag_mode:e.dragMode;return e.controller.isThreeDMode()&&(r="NONE"),e.dragMode==="AUTO"&&!t.isReverseDrag&&dR(e)&&(r="NONE"),n1(r,e.formula.move_strategy)}function dR(e){var r;if(!e)return!1;if(e.hidden)return!0;if((r=e==null?void 0:e.formula)!=null&&r.expression_type&&fre(e))return!0;let t=tC(e);return!!(t&&t.hidden)}function rC(e){var t;return!!(e.clickableInfo.enabled&&hre(e)&&((t=e.formula.click_handler)==null?void 0:t.status)==="maybe-valid")}var r3e={id:!1,type:!1,color:!0,folderId:!0,latex:!0,showLabel:!0,showAngleLabel:!0,label:!0,hidden:!0,secret:!0,readonly:!0,disableGraphInteractions:!0,points:!0,lines:!0,lineStyle:!0,arrowMode:!0,pointStyle:!0,fill:!0,dragMode:!0,labelSize:!0,labelOrientation:!0,suppressTextOutline:!0,interactiveLabel:!0,editableLabelMode:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0,strictIntersection:!0,angleType:!0,showAngleDirection:!0,extendTo3D:!1,...i1(bS)};function fre(e){if(mre(e)&&!e.controller.isThreeDMode())return!1;let{points:t,lines:r,fill:n}=e,i=fv(e.formula.expression_type,{points:t,lines:r,fill:n},o=>{ib("getReconciledExpressionProps [Chrome Switch Bug]",{metaData:{method:"areAllVisibilityPropsOff",type:o}})});return!i.points&&!i.lines&&!i.fill}function mre(e){return!!e.formula.is_inequality}function hre(e){if(!e||!DH(e.formula.expression_type))return!1;let t=lR(e);return!(t&&t!=="NONE")}function V$(e,t,r){let n=Intl.ListFormat;if(typeof n=="function")try{return new n(e,r).format(t)}catch(i){}return t.join(", ")}var yre=/`[^`]*`/g,bre=/^[\+\-]?[\d]*(\.\d+)?$/,xre=e=>{if(e!=null){let t=e.match(/`/g);return(t!=null&&t.length||0)%2==0}return!0},vre=e=>{let t=[];if(e==null||e.length==0)return t;let r=0,n;for(;n=yre.exec(e);){let o=e.slice(r,n.index);o.length>0&&t.push({from:r,to:n.index,type:"text",text:o}),r=n.index+n[0].length,t.push({from:n.index,to:r,type:"math",text:n[0].slice(1,-1)})}let i=e.slice(r);return i.length>0&&t.push({from:r,to:e.length,type:"text",text:i}),t},F$=Kd.StaticMath(document.createElement("span"));function Cd(e){let t="",r=[];xre(e)?r=vre(e):r=[{from:0,to:e.length,type:"text",text:e}];for(let n of r)t+=n.type==="text"?n.text:Mu(n.text);return t}function Mu(e){let t="";return bre.test(e)?(/^\+/.test(e)?(t="positive ",e=e.slice(1)):/^\-/.test(e)&&(t="negative ",e=e.slice(1)),t+=e.replace(/(\.)([0-9]+)/g,(r,n,i)=>n+i.split("").join(" ").trim())):(F$.latex(e),t=F$.mathspeak().trim()),t}var Po=1;function Ty(e,t){let r=[],n=e.formula.geometry&&e.formula.geometry.call;if(!n||!n.parents)return[];for(let i of n.parents)if(i.type==="arbitrary-expression")r.push(void 0);else{let o=ys(i),a=t.getGeoTokenInfoFromIdentifier(o);r.push(a?t.getItemModel(a.calcId):void 0)}return r}function Pd(e,t={}){let r=e.formula.typed_constant_value.value,n=e.formula.typed_constant_value.valueType;return t.listIndex!==void 0&&xe(n)&&(n=It(n),r=r[t.listIndex]),{value:r,valueType:n}}function pR(e,t,r){var x,b;let n=r.depth?r.depth:0,i,o=[],a=(x=e.formula.geometry.call)==null?void 0:x.symbol,s=Ty(e,t),[c,l]=s,{value:u}=Pd(e,r),[d,f]=u,g=(b=r.poi)==null?void 0:b.ariaLabel,y=g!==void 0&&g!==""?g:e.label;if(e.hidden&&n>=Po&&typeof d=="number"&&typeof f=="number")return[gR(t,d,f)];switch(a){case"intersection":y?i=t.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:Cd(y)}):i=t.s("graphing-calculator-narration-geometry-unlabeled-intersection",{index:e.id}),n<Po&&c!==void 0&&l!==void 0?o.push(t.s("graphing-calculator-narration-geometry-intersection-of-items",{intersectionDescription:i,item1:yi(c,t,{includeDetails:!1,depth:n+1}),item2:yi(l,t,{includeDetails:!1,depth:n+1})})):o.push(i);break;case"midpoint":y?i=t.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:Cd(y)}):i=t.s("graphing-calculator-narration-geometry-unlabeled-midpoint",{index:e.id}),n<Po&&c!==void 0?o.push(t.s("graphing-calculator-narration-geometry-midpoint-of-item",{midpointDescription:i,item:yi(c,t,{includeDetails:!1,depth:n+1})})):o.push(i);break;case"glider":y?i=t.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:Cd(y)}):i=t.s("graphing-calculator-narration-geometry-unlabeled-glider",{index:e.id}),n<Po&&c!==void 0?o.push(t.s("graphing-calculator-narration-geometry-glider-on-item",{gliderDescription:i,item:yi(c,t,{includeDetails:!1,depth:n+1})})):o.push(i);break;default:y?i=t.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:Cd(y)}):i=t.s("graphing-calculator-narration-geometry-unlabeled-point",{index:e.id}),r.includeDetails&&typeof d=="number"&&typeof f=="number"?o.push(t.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:i,x:og(t,d),y:ag(t,f)})):o.push(i)}return o}function G$(e,t,r){var d,f;let n=r.depth?r.depth:0,i=[],o=Ty(e,t),[a]=o,{value:s}=Pd(e,r),c=s[1],l=t.get2dProjection(),u=l&&l.viewport;return n<Po&&a!==void 0&&vy(a)&&!((f=(d=a.formula.geometry)==null?void 0:d.call)!=null&&f.symbol)&&typeof c=="number"&&u!==void 0?i.push(t.s("graphing-calculator-narration-geometry-circle-with-center-and-radius",{index:e.id,center:yi(a,t,{includeDetails:!1,depth:n+1}),radius:Mu(ep(c,u.xmax-u.xmin).latex)})):i.push(t.s("graphing-calculator-narration-geometry-unlabeled-circle",{index:e.id})),i}function B$(e,t,r){let n=r.depth?r.depth:0,i=[],o=Ty(e,t),[a,s,c]=o;return n<Po&&a!==void 0&&s!==void 0&&c!==void 0?i.push(t.s("graphing-calculator-narration-geometry-arc-through-points",{index:e.id,start:yi(a,t,{includeDetails:!1,depth:n+1}),middle:yi(s,t,{includeDetails:!1,depth:n+1}),end:yi(c,t,{includeDetails:!1,depth:n+1})})):i.push(t.s("graphing-calculator-narration-geometry-unlabeled-arc",{index:e.id})),i}function q$(e,t,r){let n=r.depth?r.depth:0,{value:i}=Pd(e,r),o=i.length;if(r.polygonEdge!==void 0)if(r.polygonEdge>=0&&r.polygonEdge<i.length){let c=i[r.polygonEdge],l=i[(r.polygonEdge+1)%i.length];i=[c,l]}else return[t.s("shared-calculator-narration-item-unknown")];let a,s=[];if(o===3?a=t.s("graphing-calculator-narration-geometry-unlabeled-triangle",{index:e.id}):o===4?a=t.s("graphing-calculator-narration-geometry-unlabeled-quadrilateral",{index:e.id}):o===5?a=t.s("graphing-calculator-narration-geometry-unlabeled-pentagon",{index:e.id}):o===6?a=t.s("graphing-calculator-narration-geometry-unlabeled-hexagon",{index:e.id}):o===7?a=t.s("graphing-calculator-narration-geometry-unlabeled-heptagon",{index:e.id}):o===8?a=t.s("graphing-calculator-narration-geometry-unlabeled-octagon",{index:e.id}):o===9?a=t.s("graphing-calculator-narration-geometry-unlabeled-nonagon",{index:e.id}):o===10?a=t.s("graphing-calculator-narration-geometry-unlabeled-decagon",{index:e.id}):a=t.s("graphing-calculator-narration-geometry-unlabeled-polygon",{index:e.id,sideCount:o}),r.polygonEdge!==void 0){let c=i.length>0?i[0][0]:void 0,l=i.length>0?i[0][1]:void 0,u=i.length>1?i[1][0]:void 0,d=i.length>1?i[1][1]:void 0;r.includeDetails&&n<Po&&typeof c=="number"&&typeof l=="number"&&typeof u=="number"&&typeof d=="number"?s.push(t.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:a,x1:og(t,c),y1:ag(t,l),x2:og(t,u),y2:ag(t,d)})):s.push(a)}else if(r.includeDetails&&n<Po){let c=[];if(o<=10){let l=Ty(e,t).filter(u=>vy(u)&&u.type==="expression"&&!u.hidden&&Pd(u,r).valueType===z);l.length===o&&l.forEach(u=>{c.push(yi(u,t,{includeDetails:!1,depth:n+1}))})}c.length?s.push(t.s("graphing-calculator-narration-geometry-polygon-through-vertices",{itemDescription:a,vertices:V$(t.getLanguage(),c)})):s.push(a)}else s.push(a);return s}function z$(e,t,r){var D,O,_;let n=r.depth?r.depth:0,i="",o=[],a=(D=e.formula.geometry.call)==null?void 0:D.symbol,s=e.formula.geometry.listAccess,{value:c,valueType:l}=Pd(e,r),[u,d]=c[0],[f,g]=c[1],y=Ty(e,t),x=e.label,[b,w]=y,E=t.get2dProjection(),I=E&&E.viewport,S=b!==void 0&&w===void 0&&s!==void 0;if(a==="parallel")n<Po&&b!==void 0&&w!==void 0?o.push(t.s("graphing-calculator-narration-geometry-parallel-to-line-through-point",{index:e.id,line:yi(b,t,{includeDetails:!1,depth:n+1}),point:yi(w,t,{includeDetails:!1,depth:n+1})})):e.hidden&&n>=Po?o.push(t.s("graphing-calculator-narration-geometry-hidden-parallel")):S?i=t.s("graphing-calculator-narration-geometry-unlabeled-parallel"):o.push(t.s("graphing-calculator-narration-geometry-unlabeled-parallel-with-index",{index:e.id}));else if(a==="perpendicular")n<Po&&b!==void 0&&w!==void 0?o.push(t.s("graphing-calculator-narration-geometry-perpendicular-to-line-through-point",{index:e.id,line:yi(b,t,{includeDetails:!1,depth:n+1}),point:yi(w,t,{includeDetails:!1,depth:n+1})})):e.hidden&&n>=Po?o.push(t.s("graphing-calculator-narration-geometry-hidden-perpendicular")):S?i=t.s("graphing-calculator-narration-geometry-unlabeled-perpendicular"):o.push(t.s("graphing-calculator-narration-geometry-unlabeled-perpendicular-with-index",{index:e.id}));else if(l===Re)e.hidden&&n>=Po?o.push(t.s("graphing-calculator-narration-geometry-hidden-line")):S?i=t.s("graphing-calculator-narration-geometry-unlabeled-line"):i=t.s("graphing-calculator-narration-geometry-unlabeled-line-with-index",{index:e.id});else if(l===ot){if(e.hidden&&n>=Po?o.push(t.s("graphing-calculator-narration-geometry-hidden-ray")):S?i=t.s("graphing-calculator-narration-geometry-unlabeled-ray"):i=t.s("graphing-calculator-narration-geometry-unlabeled-ray-with-index",{index:e.id}),y.length===1&&(b==null?void 0:b.type)==="expression"&&(((O=b==null?void 0:b.formula.geometry)==null?void 0:O.valueType)===st||((_=b==null?void 0:b.formula.geometry)==null?void 0:_.valueType)===$e)){let A=yi(b,t,{includeDetails:!1,depth:n+1});i=t.s("graphing-calculator-narration-geometry-anglebisector-of-item",{bisectorDescription:i,item:A})}}else if(l===Ye){if(e.hidden&&n>=Po?o.push(t.s("graphing-calculator-narration-geometry-hidden-segment")):x?i=t.s("graphing-calculator-narration-geometry-segment-with-assignment",{assignment:Cd(x)}):S?i=t.s("graphing-calculator-narration-geometry-unlabeled-segment"):i=t.s("graphing-calculator-narration-geometry-unlabeled-segment-with-index",{index:e.id}),r.includeDetails&&n<Po&&x===""&&s===void 0&&I!==void 0&&typeof u=="number"&&typeof d=="number"&&typeof f=="number"&&typeof g=="number"){let A=f-u,R=g-d,W=Math.sqrt(A*A+R*R);isNaN(W)||(i=t.s("graphing-calculator-narration-geometry-segment-length",{segmentDescription:i,length:Mu(ep(W,I.xmax-I.xmin).latex)}))}}else l===Ve&&(e.hidden&&n>=Po?o.push(t.s("graphing-calculator-narration-geometry-hidden-vector")):S?i=t.s("graphing-calculator-narration-geometry-unlabeled-vector"):i=t.s("graphing-calculator-narration-geometry-unlabeled-vector-with-index",{index:e.id}));return i!==""&&n<Po&&(b!==void 0&&w!==void 0?o.push(t.s("graphing-calculator-narration-geometry-straight-from-item-to-item",{straightType:i,start:yi(b,t,{includeDetails:!1,depth:n+1}),end:yi(w,t,{includeDetails:!1,depth:n+1})})):S&&o.push(t.s("graphing-calculator-narration-geometry-straight-index-of-item",{straightType:i,index:s,item:yi(b,t,{includeDetails:!1,depth:n+1})}))),!o.length&&i&&o.push(i),o}function U$(e,t,r){var x;let n=r.depth?r.depth:0,i=r.listIndex?r.listIndex:0,o="",a=[],{valueType:s}=Pd(e,r),c=e.label,l="",u=(x=t.getGrapher())==null?void 0:x.getGraphSketch(e.id);if(u&&"labels"in u){let w=u.labels[i];w&&"text"in w&&(l=Cd(w.text))}s===st?c?o=t.s("graphing-calculator-narration-geometry-labeled-angle",{label:Cd(c)}):l?o=t.s("graphing-calculator-narration-geometry-unlabeled-angle-with-measurement",{index:e.id,measurementText:l}):o=t.s("graphing-calculator-narration-geometry-unlabeled-angle",{index:e.id}):s===$e&&(c?o=t.s("graphing-calculator-narration-geometry-labeled-directed-angle",{label:Cd(c)}):l?o=t.s("graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement",{index:e.id,measurementText:l}):o=t.s("graphing-calculator-narration-geometry-unlabeled-directed-angle",{index:e.id}));let d=Ty(e,t),[f,g,y]=d;return n<Po&&f!==void 0&&"hidden"in f&&!f.hidden&&g!==void 0&&"hidden"in g&&!g.hidden&&y!==void 0&&"hidden"in y&&!y.hidden?a.push(t.s("graphing-calculator-narration-geometry-angle-through-points",{itemDescription:o,parent1:yi(f,t,{includeDetails:!1,depth:n+1}),parent2:yi(g,t,{includeDetails:!1,depth:n+1}),parent3:yi(y,t,{includeDetails:!1,depth:n+1})})):n<Po&&f!==void 0&&"hidden"in f&&!f.hidden&&g===void 0&&y===void 0?a.push(t.s("graphing-calculator-narration-geometry-angle-of-polygon",{itemDescription:o,parent:yi(f,t,{includeDetails:!1,depth:n+1})})):a.push(o),a}function H$(e,t,r){let{value:n,valueType:i}=Pd(e,r),o=[],a=n.length;switch(It(i)){case z:o.push(t.s("graphing-calculator-narration-geometry-list-of-points",{count:a}));break;case We:o.push(t.s("graphing-calculator-narration-geometry-list-of-circles",{count:a}));break;case Oe:o.push(t.s("graphing-calculator-narration-geometry-list-of-arcs",{count:a}));break;case et:o.push(t.s("graphing-calculator-narration-geometry-list-of-polygons",{count:a}));break;case Re:o.push(t.s("graphing-calculator-narration-geometry-list-of-lines",{count:a}));break;case ot:o.push(t.s("graphing-calculator-narration-geometry-list-of-rays",{count:a}));break;case Ye:o.push(t.s("graphing-calculator-narration-geometry-list-of-segments",{count:a}));break;case st:o.push(t.s("graphing-calculator-narration-geometry-list-of-angles",{count:a}));break;case $e:o.push(t.s("graphing-calculator-narration-geometry-list-of-directed-angles",{count:a}));break;default:o.push(t.s("graphing-calculator-narration-geometry-list-of-any",{count:a}));break}return o[0]=`${o[0]}.`,o}var Fv=ut(ft());var Vv=ut(ft());var iC=ut(ft());var Di=class extends iC.Class{template(){return this.props.children?this.props.children:iC.createElement("div",{onMount:t=>this.onMountMathquill(t)})}onMount(){this.props.children&&this.onMountMathquill(this.findRootNode())}onMountMathquill(t){this.props.tokenController&&(this.mathquillTokenHelper=new wy(this.props.tokenController(),t,!0)),this.staticMath=Kd.StaticMath(t,{...this.props.config()}),t.classList.add("dcg-static-mathquill-view"),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){var t;this.updateMathquillAria(),this.updateMathquillLatex(),(t=this.mathquillTokenHelper)==null||t.updateTokens(this.props.latex())}updateMathquillLatex(){if(!this.staticMath)return;let t=this.props.latex();this.lastLatex!==t&&(this.staticMath.latex(t),this.lastLatex=t,this.props.onReflow&&this.props.onReflow())}updateMathquillAria(){if(!this.staticMath||!this.props.getAriaLabel)return;let t=this.props.getAriaLabel();t!==this.staticMath.getAriaLabel()&&this.staticMath.setAriaLabel(t)}};var{For:Gqe,IfElse:Bqe}=Vv.Components;var $qe=1/2,Yqe=document.createElement("canvas");var{If:_ze,Input:Aze,For:Oze,Switch:Lze}=Fv.Components;function hR(e,t){return 1e3*(e.pixelsToMath.mapX(e.mathToPixels.mapX(t)+.5)-e.pixelsToMath.mapX(e.mathToPixels.mapX(t)-.5))}function gR(e,t,r){return og(e,t)+" "+ag(e,r)}function og(e,t){let r=e.getGraphSettings().showXAxis,n=e.get2dProjection();if(!n)return"";let{width:i}=n.screen;return r?e.s("graphing-calculator-narration-audio-trace-property-x",{x:Mu(ep(t,hR(n,t)).latex)}):e.s("graphing-calculator-narration-x-percentage-coordinate",{x:Math.round(n.mathToPixels.mapX(t)/i*1e3)/10})}function ag(e,t){let r=e.getGraphSettings().showYAxis,n=e.get2dProjection();if(!n)return"";let{height:i}=n.screen;return r?e.s("graphing-calculator-narration-audio-trace-property-y",{y:Mu(ep(t,hR(n,t)).latex)}):e.s("graphing-calculator-narration-y-percentage-coordinate",{y:Math.round(n.mathToPixels.mapY(t)/i*1e3)/10})}function j$(e,t){if(!e)return"";let{controller:r}=e;if(e.type==="expression"){let n=r.isItemSecret(e.id);switch(t){case"describe":return n?r.s("graphing-calculator-narration-describe-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-describe-expression",{index:e.displayIndex});case"delete":return n?r.s("graphing-calculator-narration-delete-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-delete-expression",{index:e.displayIndex});case"duplicate":return n?r.s("graphing-calculator-narration-duplicate-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-duplicate-expression",{index:e.displayIndex});case"show":return n?r.s("graphing-calculator-narration-show-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-show-expression",{index:e.displayIndex});case"hide":return n?r.s("graphing-calculator-narration-hide-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-hide-expression",{index:e.displayIndex});case"show-options":return n?r.s("graphing-calculator-narration-show-options-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-show-options-expression",{index:e.displayIndex});case"hide-options":return n?r.s("graphing-calculator-narration-hide-options-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-hide-options-expression",{index:e.displayIndex});case"create_table":return n?r.s("graphing-calculator-narration-create-table-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-create-table-expression",{index:e.displayIndex});case"rename":return n?r.s("graphing-calculator-narration-rename-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-rename-expression",{index:e.displayIndex});case"mute":return n?r.s("graphing-calculator-narration-mute-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-mute-expression",{index:e.displayIndex});case"unmute":return n?r.s("graphing-calculator-narration-unmute-secret-expression",{index:e.secretIndex}):r.s("graphing-calculator-narration-unmute-expression",{index:e.displayIndex})}}if(e.type==="image")switch(t){case"describe":return r.s("graphing-calculator-narration-describe-image",{index:e.displayIndex});case"delete":return r.s("graphing-calculator-narration-delete-image",{index:e.displayIndex});case"duplicate":return r.s("graphing-calculator-narration-duplicate-image",{index:e.displayIndex});case"show":return r.s("graphing-calculator-narration-show-image",{index:e.displayIndex});case"hide":return r.s("graphing-calculator-narration-hide-image",{index:e.displayIndex});case"show-options":return r.s("graphing-calculator-narration-show-options-image",{index:e.displayIndex});case"hide-options":return r.s("graphing-calculator-narration-hide-options-image",{index:e.displayIndex});case"edit_title":return r.s("graphing-calculator-narration-edit-image-title",{index:e.displayIndex})}if(e.type==="text")switch(t){case"describe":return r.s("graphing-calculator-narration-describe-text",{index:e.displayIndex});case"delete":return r.s("graphing-calculator-narration-delete-text",{index:e.displayIndex});case"duplicate":return r.s("graphing-calculator-narration-duplicate-text",{index:e.displayIndex});case"show":return r.s("graphing-calculator-narration-show-text",{index:e.displayIndex});case"hide":return r.s("graphing-calculator-narration-hide-text",{index:e.displayIndex});case"edit_title":return r.s("graphing-calculator-narration-edit-text-title",{index:e.displayIndex})}if(e.type==="table")switch(t){case"describe":return r.s("graphing-calculator-narration-describe-table",{index:e.displayIndex});case"delete":return r.s("graphing-calculator-narration-delete-table",{index:e.displayIndex});case"duplicate":return r.s("graphing-calculator-narration-duplicate-table",{index:e.displayIndex});case"show":return r.s("graphing-calculator-narration-show-table",{index:e.displayIndex});case"hide":return r.s("graphing-calculator-narration-hide-table",{index:e.displayIndex});case"rename":return r.s("graphing-calculator-narration-rename-table",{index:e.displayIndex})}if(e.type==="folder"){let n=!!e.title;switch(t){case"describe":return n?r.s("graphing-calculator-narration-describe-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-describe-folder-index",{index:e.displayIndex});case"collapse":return n?r.s("graphing-calculator-narration-collapse-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-collapse-folder-index",{index:e.displayIndex});case"expand":return n?r.s("graphing-calculator-narration-expand-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-expand-folder-index",{index:e.displayIndex});case"show":return n?r.s("graphing-calculator-narration-show-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-show-folder-index",{index:e.displayIndex});case"hide":return n?r.s("graphing-calculator-narration-hide-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-hide-folder-index",{index:e.displayIndex});case"duplicate":return n?r.s("graphing-calculator-narration-duplicate-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-duplicate-folder-index",{index:e.displayIndex});case"delete":return n?r.s("graphing-calculator-narration-delete-folder-title",{folder:e.title}):r.s("graphing-calculator-narration-delete-folder-index",{index:e.displayIndex});case"edit_title":return r.s("graphing-calculator-narration-edit-folder-title",{index:e.displayIndex})}}switch(t){case"describe":return r.s("graphing-calculator-narration-describe");case"delete":return r.s("graphing-calculator-narration-delete");case"duplicate":return r.s("graphing-calculator-narration-duplicate");case"expand":return r.s("graphing-calculator-narration-expand");case"collapse":return r.s("graphing-calculator-narration-collapse");case"show":return r.s("graphing-calculator-narration-show");case"hide":return r.s("graphing-calculator-narration-hide");case"show-options":return r.s("graphing-calculator-narration-show-options");case"hide-options":return r.s("graphing-calculator-narration-hide-options");case"create_table":return r.s("graphing-calculator-narration-create-table");case"rename":return r.s("graphing-calculator-narration-rename");case"edit_title":return r.s("graphing-calculator-narration-edit-title");case"mute":return r.s("graphing-calculator-narration-mute");case"unmute":return r.s("graphing-calculator-narration-unmute");default:return t}}function yi(e,t,r={includeDetails:!0}){var a;if(!e)return t.s("graphing-calculator-narration-geometry-nothing-selected");let n=r.description?r.description:"";if(e.type!=="expression"){if(e.type==="image"){let s=n!==""?n:j$(e,"describe"),c=r.listIndex||0,{x:l,y:u}=e.formula.dimensions;l&&u&&typeof l[c]=="number"&&typeof u[c]=="number"?n=t.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:s,x:og(t,l[c]),y:ag(t,u[c])}):n=s}}else(!e.latex||!((a=e.formula)!=null&&a.typed_constant_value))&&(n=n!==""?n:j$(e,"describe"));let i=r.poi&&r.poi.sketch.showPOI&&r.poi.type==="static-labeled-point";!n&&vy(e)?(n=kre(e,t,r),n=Fre(n,e,t,r)):r.includeDetails&&r.poi&&!i&&(n=t.s("graphing-calculator-narration-item-at-coordinates",{itemDescription:n,x:og(t,r.poi.x),y:ag(t,r.poi.y)}));let o=n;return r.includeSelectionState&&!uR(e)&&!i&&(o=K$(o,e,t)),uR(e)&&(o=t.s("shared-calculator-narration-item-clickable",{item:o})),o}function kre(e,t,r={includeDetails:!0}){var c;let{value:n,valueType:i}=Pd(e,r);if(!n)return t.s("shared-calculator-narration-item-unknown");let o=[];if(xe(i))o=H$(e,t,r);else switch(i){case z:o=pR(e,t,r);break;case We:o=G$(e,t,r);break;case Oe:o=B$(e,t,r);break;case et:o=q$(e,t,r);break;case Re:case ot:case Ye:case Ve:o=z$(e,t,r);break;case st:case $e:o=U$(e,t,r);break;default:o.push(t.s("shared-calculator-narration-item-unknown"))}let a=o.join(" "),s=(c=e.formula.geometry)==null?void 0:c.call;return s&&(a=Vre(a,s,t)),a}function Vre(e,t,r){let n,i=t.parents;if(t.symbol==="apply"){let o=i[0].type!=="arbitrary-expression"?ys(i[0]):void 0,a=o?r.getItemsByIdentifier(o):[];if(o&&a.length===0)n=o;else for(let s of a){if(s.type!=="expression")continue;let c=s.formula.geometry;if(!(!c||!c.call)){n=c.call.symbol;break}}}else if(Sp(t.symbol))n=t.symbol;else return e;switch(n){case"coterminal":case"supplement":return e;case"dilate":return r.s("graphing-calculator-narration-geometry-dilated-item",{item:e});case"rotate":return r.s("graphing-calculator-narration-geometry-rotated-item",{item:e});case"translate":return r.s("graphing-calculator-narration-geometry-translated-item",{item:e});case"reflect":return r.s("graphing-calculator-narration-geometry-reflected-item",{item:e});default:return r.s("graphing-calculator-narration-geometry-transformed-item",{item:e})}}function Fre(e,t,r,n){var i,o;return n.listIndex!==void 0&&((o=(i=t.formula)==null?void 0:i.geometry)!=null&&o.valueType)&&xe(t.formula.geometry.valueType)?r.s("graphing-calculator-narration-item-with-list-index",{listIndex:n.listIndex+1,item:e}):n.polygonEdge!==void 0?r.s("graphing-calculator-narration-geometry-edge-of-polygon",{polygonEdge:n.polygonEdge+1,item:e}):e}function K$(e,t,r){return(t&&kv(t)?r.s("shared-calculator-narration-item-selected",{item:e}):r.s("shared-calculator-narration-item-unselected",{item:e})).trim()}function oC(e){return{shouldBeFocused:()=>Gre(e),onFocusedChanged:t=>{Bre(e,t)}}}function Gre(e){let t=e.predicate;if(t&&!t())return!1;let r=e.controller.getFocusLocation();return r&&pi(r,e.location)}function Bre(e,t){let r=e.predicate;r&&!r()||(t?e.controller.dispatch({type:"set-focus-location",location:e.location}):e.controller.dispatch({type:"blur-focus-location",location:e.location}))}var{cos:Wo,sin:da,max:sg,min:Ey,abs:al,sign:Z$,hypot:J$,PI:Va}=Math,Gv=22,ro=Gv/2,no=Gv/2,Be=e=>e.toFixed(1),bR={type:"arc",center:[0,0],radius:1,startAngle:Va/4,endAngle:Va/4+Va},Q$=[[-1,0],[0,1],[1,-1]],xR={start:0,delta:Va/4},yR=Va/4,vR={angle:Va/8,side:1},qre=["dcg-token-perpendicular","dcg-token-parallel","dcg-token-translate","dcg-token-vector","dcg-token-segment","dcg-token-line","dcg-token-ray","dcg-token-angle","dcg-token-angles","dcg-token-directedangle","dcg-token-directedangles","dcg-token-arc","dcg-token-polygon"];function e8(e){return qre.includes(e)}function t8(e){switch(e.type){case"angle":case"angles":return Xre(e.start,e.delta);case"directedangle":case"directedangles":return Kre(e.start,e.delta);case"arc":return jre(e.arcDetails);case"polygon":return Zre(e.points);case"segment":return Jre(e.angle);case"line":return Qre(e.angle);case"anglebisector":case"ray":return ene(e.angle);case"vector":case"translate":return tne(e.angle);case"parallel":return rne(e.angle,e.side);case"perpendicular":return nne(e.angle)}}function r8(e,t,r){var n,i,o,a,s,c,l;switch(e){case"angle":case"angles":case"directedangle":case"directedangles":{let u=(n=zre(e,t))!=null?n:xR,{start:d,delta:f}=u;return{type:e,start:d,delta:f}}case"arc":{let u=(i=Ure(t))!=null?i:bR;return{type:e,arcDetails:u}}case"polygon":{let u=(o=Hre(t))!=null?o:Q$;return{type:e,points:u}}case"perpendicular":case"anglebisector":case"ray":case"line":case"segment":{let u=(a=n8(t))!=null?a:yR;return{type:e,angle:u}}case"translate":{let u=(s=Yre(t))!=null?s:yR;return{type:e,angle:u}}case"vector":{let u=(c=$re(t))!=null?c:yR;return{type:e,angle:u}}case"parallel":{let{angle:u,side:d}=(l=Wre(t,r))!=null?l:vR;return{type:e,angle:u,side:d}}}}function zre(e,t){if((t==null?void 0:t.valueType)!==st&&(t==null?void 0:t.valueType)!==$e)return;let[r,n,i]=t.value;return{type:e,start:n,delta:i}}function Ure(e){return(e==null?void 0:e.valueType)===Oe?ph(e.value):void 0}function Hre(e){return(e==null?void 0:e.valueType)===et?e.value:void 0}function n8(e){let t=e==null?void 0:e.valueType;if(t!==Ye&&t!==Re&&t!==ot)return;let[[r,n],[i,o]]=e.value;return a1(i-r,o-n)}function $re(e){if((e==null?void 0:e.valueType)!==Ve)return;let[t,r]=e.value[0];return a1(t,r)}function Yre(e){if((e==null?void 0:e.valueType)!==xt)return;let[t,r]=e.value[1];return a1(t,r)}function Wre(e,t){var i;if((e==null?void 0:e.valueType)!==Re)return vR;let r=(i=n8(e))!=null?i:vR.angle,n=1;if(t.length===2){let o=t[0],a=t[1],s=o==null?void 0:o.valueType;if((s===Ye||s===Re||s===ot)&&(a==null?void 0:a.valueType)===z){let[c,l]=o.value[0],[u,d]=o.value[1],[f,g]=a.value,y=u-c,b=-(d-l),w=y,E=u-f,I=d-g;n=b*E+w*I>0?1:-1}}return{angle:r,side:n}}function i8(e,t){(!isFinite(e)||!isFinite(t))&&(e=xR.start,t=xR.delta);let r=Wo(e),n=-da(e),i=Wo(e+t),o=-da(e+t),a=sg(0,r,i)-Ey(0,r,i),s=sg(0,n,o)-Ey(0,n,o),c=al(t)>Va,l=c?2:sg(a,s),u=.73*Gv/l,d=u*r,f=u*n,g=u*i,y=u*o,x=c?0:(Ey(0,d,g)+sg(0,d,g))/2,b=c?0:(Ey(0,f,y)+sg(0,f,y))/2,w=ro-x,E=no-b;return{x1:d,y1:f,x2:g,y2:y,tx:w,ty:E,r:u}}function Xre(e,t){let{x1:r,y1:n,x2:i,y2:o,tx:a,ty:s,r:c}=i8(e,t),l=.6,u=l*r,d=l*n,f=l*i,g=l*o,y=al(t)>Va?1:0,x=t>0?0:1,b=`M ${Be(u)} ${Be(d)} A ${Be(l*c)} ${Be(l*c)} 0 ${y} ${x} ${Be(f)} ${Be(g)}`;return`<g transform="translate(${a} ${s})"><polyline points="${Be(r)},${Be(n)},0,0,${Be(i)},${Be(o)}" /><path d = "${b}" class="dcg-token-angle-arc"/><path d = "${b} L 0 0" class="dcg-token-angle-fill"/></g>`}function Kre(e,t){let{x1:r,y1:n,x2:i,y2:o,tx:a,ty:s,r:c}=i8(e,t),l=.8,u=l*r,d=l*n,f=ui(1/(l*c),0,2),g=(al(t)-f)*Z$(t),y=(t+g)/2,x=l*c*Wo(e+g),b=-l*c*da(e+g),w=Z$(t),E=w*3.5,I=w*(60*Va)/180,S=.7,D=e+y,O=x+E*da(D+I*(1-S)),_=b+E*Wo(D+I*(1-S)),A=x+E*da(D-I*S),R=b+E*Wo(D-I*S),W=al(t)>Va?1:0,j=t>0?0:1,Q=`M ${Be(u)} ${Be(d)} A ${Be(l*c)} ${Be(l*c)} 0 ${W} ${j} ${Be(x)} ${Be(b)}`,ce=`M ${Be(O)} ${Be(_)} L ${Be(x)} ${Be(b)} L ${Be(A)} ${Be(R)}`;return`<g transform="translate(${a} ${s})"><polyline points="${Be(r)},${Be(n)},0,0,${Be(i)},${Be(o)}" />`+(al(t)<.05?"":`<path d = "${Q}" class="dcg-token-directedangle-arc"/>`)+(al(t)<.29?"":`<path d = "${ce}" class="dcg-token-directedangle-arrowhead"/>`)+"</g>"}function jre(e){if(e===void 0)return"";switch(e.type){case"arc":{let{startAngle:t,endAngle:r}=e;(!isFinite(t)||!isFinite(r))&&(t=bR.startAngle,r=bR.endAngle);let n=r-t,i=.386*Gv;if(al(n)>6.16)return`<circle cx="${Be(ro)}" cy="${Be(no)}" r="${Be(i)}">`;if(al(n)<Va/6){let E=(t+r)/2,I=i*da(E),S=i*Wo(E);return`<path d = "M ${Be(ro-I)} ${Be(no-S)} l ${Be(2*I)} ${Be(2*S)}" />`}let o=.66*Va;al(n)<o&&(i/=al(n)/2);let a=i*Wo(t),s=-i*da(t),c=i*Wo(r),l=-i*da(r),u=i*Wo((t+r)/2),d=-i*da((t+r)/2),f=ui(2*(Va-al(n)),0,1),g=f*(Ey(a,c,u)+sg(a,c,u))/2,y=f*(Ey(s,l,d)+sg(s,l,d))/2,x=ro-g,b=no-y;return`<path d = "${`M ${Be(a+x)} ${Be(s+b)} A ${Be(i)} ${Be(i)} 0 ${al(n)>Va?1:0} ${n>0?0:1} ${Be(c+x)} ${Be(l+b)}`}" />`}case"rays":{let{start1:t,end1:r}=e,n=r[0]-t[0],i=r[1]-t[1];(!isFinite(n)||!isFinite(n))&&(n=1,i=1);let o=J$(n,i),a=3,s=a*n/o,c=-a*i/o;return`<path d = "M ${Be(ro-s)} ${Be(no-c)} l ${Be(-5*s)} ${Be(-5*c)}" /><path d = "M ${Be(ro+s)} ${Be(no+c)} l ${Be(5*s)} ${Be(5*c)}" />`}case"segment":{let{start:t,end:r}=e,n=r[0]-t[0],i=r[1]-t[1];(!isFinite(n)||!isFinite(n))&&(n=1,i=1);let o=J$(n,i),a=7,s=a*n/o,c=a*i/o;return`<path d = "M ${Be(ro-s)} ${Be(no-c)} l ${Be(2*s)} ${Be(2*c)}" />`}}}function Zre(e){if(e.length<2)return"";e.some(w=>!isFinite(w[0])||!isFinite(w[1]))&&(e=Q$);let t=e[0];e=e.slice(1);let r=t[0],n=r,i=t[1],o=i;for(let w=0;w<e.length;w++){let E=e[w][0],I=e[w][1];E<r&&(r=E),E>n&&(n=E),I<i&&(i=I),I>o&&(o=I)}let a=(r+n)/2,s=(i+o)/2,c=sg(n-r,o-i),l=.8*Gv,u=w=>ro+l*(w-a)/c,d=w=>no-l*(w-s)/c,f=w=>`${w[0].toFixed(1)} ${w[1].toFixed(1)}`,g=u(t[0]),y=d(t[1]);if(!isFinite(g)||!isFinite(y))return"";let x=[];for(let w of e){let E=u(w[0]),I=d(w[1]);if(!isFinite(E)||!isFinite(I))return"";x.push(f([E,I]))}return`<path d = ${`"M ${f([g,y])} ${x.map(w=>`L ${w} `).join(" ")} Z"`} />`}function TR(e,t,r){let i=7*Wo(e),o=7*da(-e);return`<path d = "M ${Be(ro-t*i)} ${Be(no-t*o)} L ${Be(ro+r*i)} ${Be(no+r*o)}" />`}function Jre(e){return TR(e,1,1)}function Qre(e){return TR(e,2,2)}function ene(e){return TR(e,1,2)}function tne(e){let n=48*(Va/180),i=8.5-1,o=8.5-7*Wo(n),a=ro-i*Wo(e),s=no+i*da(e),c=ro+o*Wo(e),l=no-o*da(e),u=`M ${Be(a)} ${Be(s)} L ${Be(c)} ${Be(l)}`,d=ro+8.5*Wo(e),f=no+8.5*da(-e),g=d-7*Wo(e+n/2),y=f+7*da(e+n/2),x=d-7*Wo(e-n/2),b=f+7*da(e-n/2),w=`M ${Be(g)} ${Be(y)} L ${Be(d)} ${Be(f)} L ${Be(x)} ${Be(b)}`;return`<path d = "${u}"/><path d = "${w}" class="dcg-token-vector-arrowhead"/>`}function rne(e,t){let n=14*Wo(e),i=14*-da(e),o=4*Wo(e+t*Va/2),a=4*-da(e+t*Va/2);return`<path d = "M ${Be(ro-n)} ${Be(no-i)} L ${Be(ro+n)} ${Be(no+i)}" /><path d = "M ${Be(ro+o-n)} ${Be(no+a-i)} L ${Be(ro+o+n)} ${Be(no+a+i)}" class="dcg-token-parallel-parent"/>`}function nne(e){let r=14*Wo(e),n=14*-da(e);return`<path d = "M ${Be(ro-r)} ${Be(no-n)} L ${Be(ro+r)} ${Be(no+n)}" /><path d = "M ${Be(ro+n)} ${Be(no-r)} L ${Be(ro-n)} ${Be(no+r)}" class="dcg-token-parallel-parent"/>`}var{If:Bv}=io.Components,ine=.8,aC=class extends io.Class{init(){this.controller=this.props.controller()}template(){return io.createElement("span",{class:()=>{var r,n;let t=this.parentOrChildHovered();return{"dcg-geo-token-view":!0,"dcg-static-token":(n=(r=this.props).isStatic)==null?void 0:n.call(r),"dcg-selected-token":this.isTokenSelected(),"dcg-hidden-token":this.isHidden(),"dcg-token-has-label":this.showLabel(),"dcg-child-of-hovered-token":t==="child","dcg-parent-of-hovered-token":t==="parent","dcg-assignment-token":!!this.getAssignment(),"dcg-graph-interactions-disabled":this.isGraphInteractionDisabled(),"dcg-light-color":this.isLightColor()}},style:()=>({color:this.getColor()}),role:this.bindFn(this.getAriaRole),"dcg-token-type":()=>this.getTokenInfo().iconType,"aria-roledescription":()=>this.props.insideGroup()?void 0:this.controller.s("graphing-calculator-narration-geometry-construction-role-description"),"aria-label":this.bindFn(this.getAriaLabel),"aria-selected":this.bindFn(this.isTokenSelected),tabIndex:()=>this.props.putInTabOrder()?0:-1,manageFocus:()=>this.props.focusLocation?oC({controller:this.controller,location:this.props.focusLocation()}):void 0,onTapStart:this.bindFn(this.onTapStart),onTap:this.bindFn(this.onTap),onPointerOver:this.bindFn(this.onPointerOver),onPointerOut:this.bindFn(this.onPointerOut)},io.createElement("span",{class:io.const("dcg-token-background")}),io.createElement("span",{class:()=>({"dcg-token-icon":!0,[this.getAdditionalTokenClass()]:!!this.getAdditionalTokenClass(),"dcg-token-is-list":this.getIsList()&&!this.getAssignment()})},io.createElement(Bv,{predicate:()=>!!this.getIcon()},()=>io.createElement("i",{class:this.bindFn(this.getIcon)})),io.createElement(Bv,{predicate:()=>e8(this.getAdditionalTokenClass())},()=>io.createElement("div",{willUnmount:()=>this.willUnmountSVG(),didMount:t=>this.didMountSVG(t)}))),io.createElement(Bv,{predicate:()=>!!this.getAssignment()},()=>io.createElement(Di,{latex:this.bindFn(this.getAssignment),config:this.const({})})),io.createElement(Bv,{predicate:()=>this.showLabel()},()=>io.createElement("span",{class:()=>({"dcg-token-label":!0})},()=>this.getLabel())),io.createElement(Bv,{predicate:this.bindFn(this.isGraphInteractionDisabled)},()=>io.createElement("i",{class:io.const("dcg-icon-lock")})))}isLightColor(){let t=this.getColor();return!t||this.isTransformation()||this.isHidden()?!1:R$({type:"single-color",value:t},this.controller.invertSwatches(),ine)}didMountSVG(t){this.svgElement=t,this.renderSVGElement()}willUnmountSVG(){this.svgElement=void 0,this.lastSVGInputs=void 0}getTypedValue(t){var i;if(t===void 0)return;let r=this.controller.getItemsByIdentifier(t);if(!r||r.length!==1)return;let n=r[0];return(i=n==null?void 0:n.formula)==null?void 0:i.typed_constant_value}getParentValues(t){var o,a,s;let r=this.controller.getItemsByIdentifier(t);if(!r||r.length!==1)return[];let n=r[0],i=(s=(a=(o=n==null?void 0:n.formula)==null?void 0:o.geometry)==null?void 0:a.call)==null?void 0:s.parents;return i===void 0?[]:i.map(c=>{if(c.type==="arbitrary-expression")return;let l=ys(c);return this.getTypedValue(l)})}renderSVGElement(){if(!this.svgElement)return;let t=this.props.identifier(),r=this.getIconType(),n=this.getTypedValue(t),i=this.getParentValues(t),o=r8(r,n,i);o!==void 0&&(pi(o,this.lastSVGInputs)||(this.lastSVGInputs=o,this.svgElement.innerHTML=`<svg>${t8(o)}</svg>`))}getAdditionalTokenClass(){if(this.getAssignment()||this.hasError())return"";switch(this.getIconType()){case"glider":return"dcg-token-glider";case"line":return"dcg-token-line";case"segment":return"dcg-token-segment";case"ray":return"dcg-token-ray";case"intersection":return"dcg-token-intersection";case"midpoint":return"dcg-token-midpoint";case"parallel":return"dcg-token-parallel";case"perpendicular":return"dcg-token-perpendicular";case"anglebisector":return"dcg-token-ray";case"rotate":return"dcg-token-rotate";case"circle":return"dcg-token-circle";case"arc":return"dcg-token-arc";case"vector":return"dcg-token-vector";case"dilate":return"dcg-token-dilate";case"reflect":return"dcg-token-reflect";case"translate":return"dcg-token-translate";case"transformation":return"dcg-token-transformation";case"point":case"start":case"end":return"dcg-token-point";case"polygon":return"dcg-token-polygon";case"angle":return"dcg-token-angle";case"angles":return"dcg-token-angles";case"directedangle":case"directedangles":return"dcg-token-directedangle"}return""}getIdFromParentRef(t){if(t.type==="arbitrary-expression")return;let r=ys(t);return this.controller.getExpressionIdForIdentifier(r)}isGraphInteractionDisabled(){let t=this.props.controller().getExpressionIdForIdentifier(this.props.identifier())||"",r=this.controller.getItemModel(t);return!!r&&(r.type==="expression"||r.type==="image")&&!!r.disableGraphInteractions}parentOrChildHovered(){var l,u,d,f,g,y;if(!this.props.showParentChildrenHover||!this.props.showParentChildrenHover())return!1;let t=this.controller.getHoveredOrFocusedTokenIdentifier(),r=this.controller.getExpressionIdForIdentifier(t),n=this.props.identifier(),i=this.props.controller().getExpressionIdForIdentifier(n)||"";if(!r)return!1;let o=this.controller.getItemModel(r),a=this.controller.getItemModel(i);if(!o||o.type!=="expression"||!a||a.type!=="expression")return!1;let s=((d=(u=(l=o.formula)==null?void 0:l.geometry)==null?void 0:u.call)==null?void 0:d.parents)||[],c=((y=(g=(f=a.formula)==null?void 0:f.geometry)==null?void 0:g.call)==null?void 0:y.parents)||[];for(let x=0;x<s.length;x++)if(this.getIdFromParentRef(s[x])===i)return"parent";for(let x=0;x<c.length;x++)if(this.getIdFromParentRef(c[x])===r)return"child";return!1}willUnmount(){this.implicitMouseOut()}didUpdate(){this.renderSVGElement();let t=this.props.identifier();this.currentlyActiveIdentifier&&t!==this.currentlyActiveIdentifier&&this.implicitMouseOut()}implicitMouseOut(){this.currentlyActiveIdentifier&&this.controller.runAfterDispatch(()=>{let t=this.currentlyActiveIdentifier;t&&(this.currentlyActiveIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:t,style:"hovered"}))})}isHidden(){return this.getTokenInfo().isHidden}hasError(){let t=this.getTokenInfo();return!t||t.hasError}getIcon(){if(this.getAssignment())return;let t=this.getTokenInfo();if(this.hasError())return"dcg-icon-error";switch(t.iconType){case"point":case"glider":case"intersection":case"strictintersection":case"midpoint":case"start":case"end":return"dcg-icon-point";case"dilate":return"dcg-icon-dilation";case"rotate":return"dcg-icon-rotation";case"reflect":return"dcg-icon-reflection";case"transformation":return"dcg-icon-title";case"angle":case"angles":case"directedangle":case"directedangles":case"polygon":case"vector":case"translate":case"apply":case"arc":case"circle":case"clockwise":case"counterclockwise":case"error":case"line":case"parallel":case"perpendicular":case"anglebisector":case"ray":case"reflex":case"segment":case"segments":case"unknown":case"vertices":return;default:return t.iconType}}showLabel(){return!!this.getLabel()}getLabel(){if(this.getAssignment())return"";if(this.getIconType()!=="point"&&this.getIconType()!=="midpoint")return!1;let t=this.getTokenInfo().label.trim();return t.length<=2?t:""}getAssignment(){let t=this.props.identifier();return t[0]!=="$"?ni(t):""}getAriaLabel(){let t=this.getTokenInfo(),r=yi(this.controller.getItemModel(t==null?void 0:t.calcId),this.controller,{includeDetails:!1,depth:1});return this.isHidden()?this.controller.s("graphing-calculator-narration-geometry-hidden-construction-description",{description:r}):r}isTransformation(){var t;return((t=this.getTokenInfo())==null?void 0:t.groupType)==="transformation"}getColor(){if(this.getAssignment())return;let t=this.getTokenInfo();if(this.hasError())return"#fa824c";if(!(this.getIconType()==="translate"&&!this.isHidden()))return this.isTransformation()||this.isHidden()?"#aaa":t.color}getIconType(){return this.getTokenInfo().iconType}getIsList(){return this.getTokenInfo().isList}getTokenInfo(){let t=this.props.identifier();return this.controller.getTokenRenderInfoByIdentifier(t)}onPointerOver(t){var r,n;(n=(r=this.props).isStatic)!=null&&n.call(r)||t.pointerType==="mouse"&&(this.currentlyActiveIdentifier=this.props.identifier(),this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}))}onPointerOut(t){var r,n;(n=(r=this.props).isStatic)!=null&&n.call(r)||t.pointerType==="mouse"&&this.currentlyActiveIdentifier&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}),this.currentlyActiveIdentifier=void 0)}onTapStart(t){var r,n;(n=(r=this.props).isStatic)!=null&&n.call(r)||t.handle()}onTap(t){var r,n;(n=(r=this.props).isStatic)!=null&&n.call(r)||(t.handle(),this.props.focusLocation&&this.controller.dispatch({type:"set-focus-location",location:this.props.focusLocation()}),this.controller.dispatch({type:"select-expression-that-defines-token",identifier:this.props.identifier(),toggle:this.isTokenSelected(),multiSelectMode:this.controller.isMultiSelectEnabled()&&!!t.shiftKey}))}isTokenSelected(){let t=this.getTokenInfo();return!!(t&&t.isSelected)}getAriaRole(){var t,r;if(!((r=(t=this.props).isStatic)!=null&&r.call(t)))return this.props.insideGroup()?"option":"button"}};var Iy=e=>{let t=function(){return e};return t.isDcgViewConst=!0,t},wy=class{constructor(t,r,n){this.tokenController=t,this.mathNode=r,this.isStatic=n}updateTokens(t){if(!this.mathNode)return;if(!this.lastTokenInfo||this.lastTokenInfo.latex!==t)if(!this.tokenController.doesLatexContainToken(t))this.lastTokenInfo={latex:t,tokens:[]};else{let n=[];this.mathNode.querySelectorAll(".dcg-mq-token").forEach(i=>{n.push(i)}),this.lastTokenInfo={latex:t,tokens:n}}let r=this.lastTokenInfo.tokens;for(let n of r){let i=n.dcgTokenView;if(i)i.update();else{let o=n.getAttribute("data-dcg-mq-token")||"",a=o8.mountToNode(aC,n,{controller:Iy(this.tokenController),identifier:Iy("$"+o),insideMQ:Iy(!0),insideGroup:Iy(!1),putInTabOrder:Iy(!1),isStatic:Iy(this.isStatic)});n.dcgTokenView=a}}}};var{If:one}=Ec.Components,a8=500,ane=30,Sn=class e extends Ec.Class{constructor(){super(...arguments),this.lastLatexProp="",this.wasFocusedLastUpdate=!1}template(){return Ec.createElement("div",{class:Ec.const("dcg-mq-container")},Ec.createElement(one,{predicate:()=>this.getPlaceholder().trim().length>0},()=>Ec.createElement("span",{class:Ec.const("dcg-mq-placeholder")},Ec.createElement(Di,{config:()=>this.props.config(),latex:()=>this.getPlaceholder()}))),Ec.createElement("div",{class:()=>({"dcg-math-field":!0,"dcg-no-fadeout":this.props.noFadeout&&this.props.noFadeout(),"dcg-invalid":this.props.hasError(),"dcg-focus":this.props.isFocused()}),didMount:t=>this.didMountMathquill(t),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0}))}didMount(){this.props.children&&this.didMountMathquill(this.findRootNode())}willUnmount(){this.$mathField.off(".view"),this.mathField=void 0}getPlaceholder(){return!this.props.placeholder||this.props.isFocused()||this.props.latex()?"":this.props.placeholder()}didMountMathquill(t){this.cachedConfig=this.getCacheableMQConfig();let r={...this.cachedConfig,restrictMismatchedBrackets:"none",handlers:{reflow:i=>{this.props.onReflow&&this.mathField&&this.props.onReflow(i)}},onCut:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},onPaste:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},overrideTypedText:i=>{this.mathField&&this.viewCanAcceptText(i)&&(this.props.onUserTypedText?this.props.onUserTypedText(i):(this.mathField.typedText(i),this.props.onUserChangedLatex(this.mathField.latex())))},overrideKeystroke:(i,o)=>{if(i==="Backspace"&&o.preventDefault(),!this.mathField)return;if(i==="Spacebar"&&this.props.disableSpace&&this.props.disableSpace())return o.preventDefault();let a=Ai(o);if(a==="Up"||a==="Down"||a==="Left"||a==="Right"||a==="Esc"){let s=[];o.ctrlKey&&s.push("Ctrl"),o.metaKey&&s.push("Meta"),o.altKey&&s.push("Alt"),o.shiftKey&&s.push("Shift"),s.length?(s.push(a),i=s.join("-")):i=a}this.props.onUserPressedKey?this.props.onUserPressedKey(i,o):(this.mathField.keystroke(i,o),this.props.onUserChangedLatex(this.mathField.latex())),this.maybeTriggerOnSelectionChange()}};this.props.needsSystemKeypad&&this.props.needsSystemKeypad()&&(r.substituteTextarea=()=>{let i=document.createElement("textarea");return i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","none"),i.setAttribute("spellcheck","false"),i.setAttribute("autocomplete","off"),i}),this.props.tokenController&&(this.mathquillTokenHelper=new wy(this.props.tokenController(),t,!1)),this.$mathField=ze(t);let n=Kd.MathField(t,r);this.mathField=n,t._mqMathFieldInstance=this.mathField,t._mqViewInstance=this,this.$mathField.on("focusin.view focusout.view",i=>this.onFocusEvent(i)).on("paste.view",i=>this.onPasteEvent(i)),!i0&&(Tg||Tb)&&this.$mathField.on("keypress.view",i=>this.onKeypressEvent(i)),this.hookupMQTapTouch(n),this.updateMathquill()}getCacheableMQConfig(){let t={...this.props.config()};return this.props.capExpressionSize()&&(t.maxDepth=ane),t}didUpdate(){this.updateMathquill()}updateMathquill(){var t;this.updateMathquillConfig(),this.updateMathquillAria(),this.updateMathquillLatex(),this.updateMathquillFocused(),this.updateMathquillPostLabel(),(t=this.mathquillTokenHelper)==null||t.updateTokens(this.props.latex())}onFocusEvent(t){let r=this.isFocused();r!==this.shouldBeFocused()&&this.props.onFocusedChanged(r,t)}onPasteEvent(t){let r="",n=window.clipboardData,i=t.originalEvent;n&&n.getData?r=n.getData("Text"):i&&i.clipboardData&&i.clipboardData.getData&&(r=i.clipboardData.getData("text/plain"));var o=this.viewCanAcceptText(r);return!o&&this.props.onExpressionSizeExceeded&&this.props.onExpressionSizeExceeded(),o}viewCanAcceptText(t){return e.canAcceptText(this.mathField,this.props.capExpressionSize(),t)}static canAcceptText(t,r,n){if(!t)return!1;if(!r)return!0;let i=t.latex();return Z0(i)+Z0(n)<=a8}onKeypressEvent(t){if(t.stopPropagation(),t.preventDefault(),!!this.mathField){var r=t.key&&t.key.length===1?t.key:void 0;r&&this.viewCanAcceptText(r)&&(this.props.onUserTypedText?this.props.onUserTypedText(r):(this.mathField.typedText(r),this.props.onUserChangedLatex(this.mathField.latex())))}}hookupMQTapTouch(t){this.$mathField.on("dcg-tapstart.view",()=>{let r="dcg-tapend.mathquill-selection-change";ze(document).on(r,()=>{this.maybeTriggerOnSelectionChange(),ze(document).off(r)})}),t.ignoreNextMousedown(function(){return _G.shouldIgnoreMouseDown()}),this.$mathField.on("dcg-tap.view",r=>{let n=r;if(n.device!=="touch"||n.target.closest(".dcg-mq-ignore-mousedown"))return;let i=n.changedTouches[0];t.clickAt(i.clientX,i.clientY,i.target),this.isFocused()||t.focus()})}updateMathquillConfig(t={}){if(!this.mathField)return;let r={...this.getCacheableMQConfig(),...t};pi(r,this.cachedConfig)||(this.cachedConfig=r,this.mathField.config(r))}updateMathquillAria(){if(!this.mathField)return;let t=this.props.getAriaLabel();t!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(t)}updateMathquillPostLabel(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)}updateMathquillLatex(){let t=this.props.latex();this.mathField&&this.lastLatexProp!==t&&(this.props.capExpressionSize()&&Z0(t)>a8||(this.lastLatexProp=t,this.mathField.latex()!==t&&this.mathField.latex(t)))}updateMathquillFocused(){if(!this.mathField)return;let t=this.isFocused(),r=this.shouldBeFocused();r&&r!==this.wasFocusedLastUpdate&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.mathField.select(),this.wasFocusedLastUpdate=r,t!==r&&(r?this.mathField.focus():this.mathField.blur())}isFocused(){return!!(document.activeElement&&this.$mathField[0].contains(document.activeElement))}shouldBeFocused(){return this.props.isFocused()}maybeTriggerOnSelectionChange(){let t=this.props.onSelectionChanged;if(!t||!this.mathField)return;let r=this.mathField.selection();pi(r,this.lastSelection)||(this.lastSelection=r,t(r))}static getFocusedMathquill(){if(!document.activeElement)return;let t=document.activeElement.closest(".dcg-mq-editable-field");if(t)return t._mqMathFieldInstance}static getMQViewInstance(t){let r=t.el();if(r)return r._mqViewInstance}static applyArrowKeyAndReturnIfWasAtBounds(t,r,n){var i=t.selection();let o=i.startIndex===0&&i.endIndex===i.latex.length;if((r==="Up"||r==="Down")&&o)return t.keystroke(r,n),!0;t.keystroke(r,n);var a=t.selection(),s=a.latex!==i.latex||a.startIndex!==i.startIndex||a.endIndex!==i.endIndex;return!s}static temporarilyOverrideLeftRightIntoCommandGoes(t,r){var o;let n=e.getMQViewInstance(t);if(!n)return()=>{};let i=(o=n.getCacheableMQConfig().leftRightIntoCmdGoes)!=null?o:"up";return n.updateMathquillConfig({leftRightIntoCmdGoes:r}),()=>n.updateMathquillConfig({leftRightIntoCmdGoes:i})}static simulateKeypressFromKeypad(t,r){var o;var n=e.getMQViewInstance(t);if(!n)return;let i=(o=n.getCacheableMQConfig().leftRightIntoCmdGoes)!=null?o:"up";if((r==="Left"||r==="Right")&&n.updateMathquillConfig({leftRightIntoCmdGoes:void 0}),n.props.onUserPressedKey)n.props.onUserPressedKey(r);else{t.keystroke(r);let a=t.latex();n.props.onUserChangedLatex(a)}n.maybeTriggerOnSelectionChange(),(r==="Left"||r==="Right")&&n.updateMathquillConfig({leftRightIntoCmdGoes:i})}static simulateUserChangedLatex(t){var r=e.getMQViewInstance(t);if(r&&r.mathField){let n=r.mathField.latex();r.props.onUserChangedLatex(n)}}static handleKeystrokeAndDecideIfSpecialEvent(t,r,n){return r==="Enter"||r==="Delete"&&t.latex()===""||r==="Backspace"&&t.latex()===""?!0:r==="Up"||r==="Down"||r==="Left"||r==="Right"?e.applyArrowKeyAndReturnIfWasAtBounds(t,r,n):(t.keystroke(r,n),!1)}};var sne={loga:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\log_{}\\left(\\right)")&&(e.write("\\log_{}"),e.typedText("("),e.keystroke("Left"),e.keystroke("Down"))},nthroot:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\sqrt[]{}")&&(e.write("\\sqrt[]{}"),e.keystroke("Left"),e.keystroke("Left"))},ddx:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\frac{d}{dx}")&&e.write("\\frac{d}{dx}")},arcsin:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\sin^{-1}\\left(\\right)")&&(e.write("sin^{-1}"),e.typedText("("))},arccos:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\cos^{-1}\\left(\\right)")&&(e.write("cos^{-1}"),e.typedText("("))},arctan:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\tan^{-1}\\left(\\right)")&&(e.write("tan^{-1}"),e.typedText("("))},arcsec:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\sec^{-1}\\left(\\right)")&&(e.write("sec^{-1}"),e.typedText("("))},arccsc:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\csc^{-1}\\left(\\right)")&&(e.write("csc^{-1}"),e.typedText("("))},arccot:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\cot^{-1}\\left(\\right)")&&(e.write("cot^{-1}"),e.typedText("("))},"A^T":(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"^{T}")&&(e.typedText("^T"),e.keystroke("Right"))},"A^-1":(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"^{-1}")&&(e.typedText("^-1"),e.keystroke("Right"))},"A^2":(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"^{2}")&&(e.typedText("^2"),e.keystroke("Right"))},"a^2":(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"^{2}")&&(e.typedText("^2"),e.keystroke("Right"))},"a^3":(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"^{3}")&&(e.typedText("^3"),e.keystroke("Right"))},"a/b":(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\frac{}{}")&&(e.write("\\frac{}{}"),e.keystroke("Left"))},integral:(e,t)=>{Sn.canAcceptText(e,t.capExpressionSize,"\\int_{}^{}")&&e.cmd("integral")}};function s8(e,t,r){sne[t](e,r)}var qv=class e{constructor(t=100){this.clear(),this._sizeLimit=t}clone(){let t=new e(this._sizeLimit);return t._stack=this._stack.slice(),t._stackPointer=this._stackPointer,t}clear(){this._stack=[],this._stackPointer=-1}getState(){return this._stack[this._stackPointer]}serializeForBugsnag(){function t(r){try{return JSON.stringify(r,null,2)}catch(n){return"[[could not jsonify]]"}}return{currentState:t(this._stack[this._stackPointer]),undoState:t(this._stack[this._stackPointer-1]),redoState:t(this._stack[this._stackPointer+1])}}addState(t){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(t),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1}replaceState(t){this.canRedo()&&this._stack.splice(this._stackPointer+1),this.replaceInteriorState(t)}replaceInteriorState(t){this._stack.length===0?(this._stack.push(t),this._stackPointer=0):this._stack[this._stackPointer]=t}canUndo(){return this._stackPointer>0}canRedo(){return this._stackPointer<this._stack.length-1}undo(){this.canUndo()&&(this._stackPointer-=1)}redo(){this.canRedo()&&(this._stackPointer+=1)}};var zv=class{constructor(t,r){this._queuedCallbacks=[];this.raw=(t,r)=>vg(t,r);this.s=yb(this.getLanguage.bind(this));this.hasTranslation=t=>hb(t,this.getLanguage());this.unpack=t=>bb(t,this.getLanguage());this.dispatch=t=>{cT("dispatch",{type:t.type}),this.dispatcher.dispatch(t);let r;for(;r=this._queuedCallbacks.shift();)r()};this.model=t,this.dispatcher=new $T,this.stateStack=new qv,this.stateStack.addState(this.getPersistedState()),this.settingsProxy=r,this.syncPublicSettings(),this.dispatcher.register(n=>{if(this.enqueueEvent("render"),n.type==="render")return;let i=!1;switch(n.type){case"clear-all":this.model.clearAll(),this.model.focusLastExpression();break;case"clear-focused-expression":this.model.clearFocusedExpression();break;case"undo":this.undo(),i=!0;break;case"redo":this.redo(),i=!0;break;case"set-state-from-api":n.opts.allowUndo||this.stateStack.clear(),this.model.setStateFromAPI(n.state);break;case"clear-from-api":n.opts.allowUndo||this.stateStack.clear(),this.model.clearAll();break;case"add-new-matrix":let o=this.model.addNewMatrixExpression();this.model.focusMatrixExpressionCell(o,0,0);break;case"focus-latex-expression":this.model.focusLatexExpression(n.id);break;case"focus-first-expression":this.model.focusFirstExpression();break;case"focus-last-expression":this.model.focusLastExpression();break;case"blur-latex-expression":this.model.blurLatexExpression(n.id);break;case"focus-matrix-expression-cell":this.model.focusMatrixExpressionCell(n.id,n.row,n.col);break;case"blur-matrix-expression-cell":this.model.blurMatrixExpressionCell(n.id,n.row,n.col);break;case"blur-resize-button":this.model.blurResizeButton(n.id,n.op);break;case"focus-resize-button":this.model.focusResizeButton(n.id,n.op);break;case"focus-add-matrix-button":this.model.focusAddMatrixButton();break;case"blur-add-matrix-button":this.model.blurAddMatrixButton();break;case"mq-updated-latex":t.setLatexAtFocus(n.latex);break;case"add-matrix-row":t.addMatrixRow(n.id),this.alertSizeOfMatrix(n.id);break;case"remove-matrix-row":t.removeMatrixRow(n.id),this.alertSizeOfMatrix(n.id);break;case"add-matrix-col":t.addMatrixCol(n.id),this.alertSizeOfMatrix(n.id);break;case"remove-matrix-col":t.removeMatrixCol(n.id),this.alertSizeOfMatrix(n.id);break;case"set-display-as-fraction":this.model.setDisplayAsFraction(n.id,n.value);break;case"keypad/press-key":this.applyPressedKey(n);break;case"edit-bar/press-key":this.editBarPressedKey(n.key,n.evt);break;case"keypad/type-text":this.applyTypedText(n.text);break;case"keypad/custom-command":this.applyCustomCommand(n.command);break;case"tab-backward-from-control-bar":this.model.attemptToMoveFocusWithTab({shiftKey:!0})&&n.evt.preventDefault();break;case"update-inverted-colors":this.model.setOption("invertedColors",!!n.invertedColors);break;case"update-projector-mode":this.model.setOption("projectorMode",!!n.mode);break;case"update-cap-expression-size":this.model.setOption("capExpressionSize",!!n.mode);break;case"update-text-color":this.model.setOption("textColor",n.textColor);break;case"update-background-color":this.model.setOption("backgroundColor",n.backgroundColor);break;case"update-font-size":this.model.setOption("fontSize",n.fontSize);break;case"update-decimal-to-fraction":this.model.setOption("decimalToFraction",n.value);break;case"keypad/shift":case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;case"update-language":this.setLanguage(n.language);break;case"toggle-settings-menu":this.toggleSettingsMenu();break;case"enable-settings-menu":this.model.setOption("settingsMenu",!0);break;case"disable-settings-menu":this.model.setOption("settingsMenu",!1);break;case"close-settings-menu":this.closeSettingsMenu();break;case"ui/container-resized":this.model.setContainerSize(n.size);break;default:return n}this.model.updateTheComputedWorld(),i||(this.model.getShouldDebounceUndoRedo()?(this.commitUndoRedoDebounced(),this.model.clearShouldDebounceUndoRedo()):this.commitUndoRedoSynchronously()),this.runAfterDispatch(this.syncPublicSettings.bind(this))})}runAfterDispatch(t){this._queuedCallbacks.push(t)}enqueueEvent(t){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(t)})}getPersistedState(){return this.model.getPersistedState()}setStateFromAPI(t,r){this.dispatch({type:"set-state-from-api",state:t,opts:r})}clearFromAPI(t){this.dispatch({type:"clear-from-api",opts:t})}focusFirstExpression(){this.dispatch({type:"focus-first-expression"})}syncPublicSettings(){this.settingsProxy.setProperty("invertedColors",this.model.isEnabled("invertedColors")),this.settingsProxy.setProperty("projectorMode",this.model.isEnabled("projectorMode")),this.settingsProxy.setProperty("capExpressionSize",this.model.isEnabled("capExpressionSize")),this.settingsProxy.setProperty("invertedColors",this.getInvertedColors()),this.settingsProxy.setProperty("textColor",this.getTextColor()),this.settingsProxy.setProperty("backgroundColor",this.getBackgroundColor()),this.settingsProxy.setProperty("fontSize",this.getFontSize()),this.settingsProxy.setProperty("language",this.getLanguage())}ensureMathquillIsFocusedAndReturnFocusedMathquill(){let t=Sn.getFocusedMathquill();return t||(this.model.setFocusInPreparationForKeypadEvent(),this.onEventEmitted&&this.onEventEmitted("render"),Sn.getFocusedMathquill())}applyTypedText(t){let r=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();r&&Sn.canAcceptText(r,this.model.isEnabled("capExpressionSize"),t)&&(r.typedText(t),this.model.setLatexAtFocus(r.latex()))}applyCustomCommand(t){let r=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();r&&(s8(r,t,{capExpressionSize:this.model.isEnabled("capExpressionSize")}),this.model.setLatexAtFocus(r.latex()))}applyPressedKey(t){let r=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();if(!r)return;let{key:n,source:i,evt:o}=t;if(n==="Up"||n==="Down"||n==="Left"||n==="Right"){let a=i==="keypad"?Sn.temporarilyOverrideLeftRightIntoCommandGoes(r,void 0):void 0,s=Sn.applyArrowKeyAndReturnIfWasAtBounds(r,n,o);a==null||a(),s&&this.model.moveFocusInDirection(n)}else n==="Enter"?(o&&(o.preventDefault(),o.stopPropagation()),this.model.addBlankLatexExpressionAfterFocus()):n==="Backspace"?this.model.attemptToMoveFocusWithBackspace()||(r.keystroke(n,o),this.model.setLatexAtFocus(r.latex())):n==="Delete"?(r.keystroke(n,o),this.model.setLatexAtFocus(r.latex())):n==="Tab"||n==="Shift-Tab"?this.model.attemptToMoveFocusWithTab({shiftKey:n==="Shift-Tab"})?o&&(o.preventDefault(),o.stopPropagation()):(r.keystroke(n,o),this.model.setLatexAtFocus(r.latex())):(r.keystroke(n,o),this.model.setLatexAtFocus(r.latex()))}editBarPressedKey(t,r){t==="Tab"&&this.model.attemptToMoveFocusWithTab({shiftKey:!!(r!=null&&r.shiftKey)})&&r&&r.preventDefault()}commitUndoRedoDebounced(){let t=this.getPersistedState(),r=this.stateStack.getState();if(pi(r,t))return;let n=new Date().getTime();n-this._lastDebouncedTime<1e3?this.stateStack.replaceState(t):this.stateStack.addState(t),this._lastDebouncedTime=n,this.enqueueEvent("change")}commitUndoRedoSynchronously(){let t=this.getPersistedState(),r=this.stateStack.getState();pi(r,t)||(this._lastDebouncedTime=0,this.stateStack.addState(t),this.enqueueEvent("change"))}undo(){this.stateStack.canUndo()&&(this.stateStack.undo(),this.model.setState(this.stateStack.getState()),this.enqueueEvent("change"))}redo(){this.stateStack.canRedo()&&(this.stateStack.redo(),this.model.setState(this.stateStack.getState()),this.enqueueEvent("change"))}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}getInvertedColors(){return this.model.isEnabled("invertedColors")}hasTextColor(){return this.getTextColor()!=="#000000"}getTextColor(){return tS(this.model.getTextColor()||"#000")}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return tS(this.model.getBackgroundColor()||"#fff")}getFontSize(){return this.model.getFontSize()}setLanguage(t){t!=="en"&&!xF(t)?Ki.warn(`Translation for '${t}' isn't currently available. Using '${this.getLanguage()}' instead.`):this.model.setOption("language",t)}getLanguage(){return this.model.getLanguage()}getSettingsMenu(){return this.model.isEnabled("settingsMenu")}closeSettingsMenu(){this.model.setSettingsMenuOpen({isOpen:!1})}toggleSettingsMenu(){this.model.setSettingsMenuOpen({isOpen:!this.isSettingsMenuOpen()})}isSettingsMenuOpen(){return this.model.isSettingsMenuOpen()}isProjectorMode(){return this.model.isEnabled("projectorMode")}getContainerSize(){return this.model.getContainerSize()}isNarrow(){return this.getContainerSize().width<570}isVeryNarrow(){return this.getContainerSize().width<420}isVeryVeryNarrow(){return this.getContainerSize().width<370}shouldShowClear(){return this.model.shouldShowClear()}shouldRender(){let{width:t,height:r}=this.getContainerSize();return t>0&&r>0}alertSizeOfMatrix(t){let r=this.model.getExpressionById(t);if(!r||r.type!=="matrix")return;let n=r.matrix.length,i=n===0?0:r.matrix[0].length;ZI(this.s("matrix-calculator-narration-new-dimensions",{rows:n,cols:i}))}getMathquillConfig(){return{autoCommands:Y0(),...W0()}}};var lne=["education","commercial","generic"],dHe=[...lne,"uncategorized"];var wR="v1_10",mHe=`dcg-calculator-api-container-${wR}`,c8=`dcg-matrix-api-container-${wR}`,hHe=`dcg-geometry-api-container-${wR}`;var Js=ut(ft());var l8=ut(ft()),bi=class extends l8.Class{init(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var oo=ut(ft());var Bf=ut(ft());var u8=ut(ft()),Gf=class extends u8.Class{init(){this.controller=this.props.controller()}};var Uv=class extends Gf{template(){return Bf.createElement("div",{class:Bf.const("dcg-keypad-control-bar dcg-do-not-blur"),role:Bf.const("group"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad-controlbar")},Bf.createElement("div",{class:Bf.const("dcg-keypad-control-bar-contents")},this.props.children))}};var Cy=ut(ft()),Du=class extends Cy.Class{template(){return Cy.createElement("div",{didMount:e=>{this.didMountRoot(e),this.props.didMount&&this.props.didMount(e)},class:()=>({"dcg-keypad-control-btn":!0,"dcg-menu-btn":!!this.props.menu(),"dcg-btn-blue":!!this.props.menu(),"dcg-disabled":!!this.props.disabled(),"dcg-selected":!!this.props.disabled()&&this.props.selected(),"dcg-selectable-btn":this.props.disabled()&&this.props.selectable()}),role:Cy.const("button"),"aria-disabled":()=>this.props.disabled(),"aria-label":this.props.ariaLabel||this.props.command,"dcg-command":this.props.command,onTap:e=>{this.props.disabled()||this.props.onTap(e)},onKeyDown:e=>{this.props.onKeyDown&&this.props.onKeyDown(e)},onFocusIn:e=>this.onFocusEvent(e),onFocusOut:e=>this.onFocusEvent(e),"aria-pressed":()=>!this.hasPopup()&&this.props.selectable()&&!this.props.disabled()&&this.props.selected()||void 0,"aria-expanded":()=>this.hasPopup()&&this.props.selectable()&&!this.props.disabled()&&this.props.selected()||void 0,tabIndex:()=>this.props.disabled()||this.props.ignoreInTabOrder()?-1:0},this.props.children)}didMountRoot(e){var t,r;this.root=e,(r=(t=this.props).shouldBeFocused)!=null&&r.call(t)&&!this.isFocused()&&this.root.focus()}didUpdate(){var e,t;(t=(e=this.props).shouldBeFocused)!=null&&t.call(e)&&!this.isFocused()&&this.root.focus()}hasPopup(){return this.props.ariaPopup?this.props.ariaPopup():!1}isFocused(){return!!(document.activeElement&&this.root.contains(document.activeElement))}onFocusEvent(e){if(!this.props.shouldBeFocused||!this.props.onFocusedChanged)return;let t=this.isFocused();t!==this.props.shouldBeFocused()&&this.props.onFocusedChanged(t,e)}};var cs=ut(ft());var Fa=ut(ft());fa();var Ps=ut(ft());var{For:une,If:dne}=Ps.Components,sC=class extends Ps.Class{constructor(){super(...arguments),this.btnViews={}}init(){this.config=this.props.staticConfig()}template(){return Ps.createElement("div",{class:Ps.const("dcg-segmented-control-container"),role:()=>{var t,r;return(r=(t=this.props).treatAsMultiSelect)!=null&&r.call(t)?"listbox":"radiogroup"},"aria-multiselectable":()=>{var t,r;return(r=(t=this.props).treatAsMultiSelect)!=null&&r.call(t)?!0:void 0},onKeyDown:this.bindFn(this.handleRadioKeydown),"aria-label":this.props.ariaGroupLabel},Ps.createElement(une,{each:()=>this.config,key:t=>t.key},(t,r)=>Ps.createElement("div",{class:()=>({"dcg-segmented-control-btn":!0,"dcg-selected":t.selected(),"dcg-theme-mini":this.getTheme()==="mini","dcg-theme-default":this.getTheme()==="default","dcg-disabled":this.isDisabled(),[t.class?t.class():""]:!!t.class}),role:()=>{var n,i;return(i=(n=this.props).treatAsMultiSelect)!=null&&i.call(n)?"option":"radio"},tabIndex:()=>this.getTabIndexForOption(t),"aria-label":()=>this.getAriaLabel(t),style:()=>({"min-width":this.props.minButtonWidth?this.props.minButtonWidth()+"px":void 0}),"aria-checked":()=>{var n,i;return(i=(n=this.props).treatAsMultiSelect)!=null&&i.call(n)?void 0:t.selected()},"aria-selected":()=>{var n,i;return(i=(n=this.props).treatAsMultiSelect)!=null&&i.call(n)?t.selected():void 0},onTap:n=>{this.isDisabled()||t.onSelect(n.device)},didMount:n=>this.btnViews[r]=n,manageFocus:()=>{if(t.focusHelperOptions)return oC(t.focusHelperOptions)}},Ps.createElement(Rs,{tooltip:()=>t.tooltip?t.tooltip():"",gravity:()=>t.tooltipGravity?t.tooltipGravity():"s",disabled:()=>!(t.tooltip&&t.tooltip())},Ps.createElement("div",{class:Ps.const("dcg-segmented-control-interior")},()=>t.label?t.label():"",Ps.createElement(dne,{predicate:()=>!!t.icon},()=>Ps.createElement("i",{class:()=>t.icon?t.icon():""})))))))}getAriaLabel(t){return t.ariaLabel?t.ariaLabel():t.label?t.label():t.tooltip?t.tooltip():""}isDisabled(){return this.props.disabled&&this.props.disabled()}getTheme(){return this.props.theme?this.props.theme():"default"}handleRadioKeydown(t){var s,c,l;let r=Ai(t);if(r!=="Up"&&r!=="Down"&&r!=="Left"&&r!=="Right"&&r!=="Home"&&r!=="End"||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return;t.preventDefault(),t.stopPropagation();let n=fP(this.config,u=>this.btnViews[u.key]===document.activeElement),i=this.config.length,o=n;r==="Home"&&(o=0),r==="End"&&(o=this.config.length-1),(r==="Up"||r==="Left")&&(o=(n-1+i)%i),(r==="Down"||r==="Right")&&(o=(n+1)%i);let a=this.config[o];a&&((s=this.btnViews[a.key])==null||s.focus(),!((l=(c=this.props).treatAsMultiSelect)!=null&&l.call(c))&&a.onSelect("keyboard"))}getTabIndexForOption(t){let r=t.key===this.config[0].key,n=this.config.find(i=>i.selected());return t.key===(n==null?void 0:n.key)||r&&!n?0:-1}};var{If:pne}=Fa.Components,cC=class extends bi{template(){return Fa.createElement("div",{class:()=>({"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-point-left":this.controller.getContainerSize().height<=420}),role:Fa.const("region"),"aria-label":()=>this.controller.s("matrix-calculator-narration-settings-menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown)},Fa.createElement("div",{class:Fa.const("dcg-popover-interior")},Fa.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-displaysize-container":!0})},Fa.createElement(sC,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),Fa.createElement(Ku,{onChange:this.bindFn(this.onToggleInvertedColors),checked:()=>this.controller.getInvertedColors(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-reverse-contrast")},Fa.createElement("span",{class:Fa.const("dcg-checkbox-label")},()=>this.controller.s("shared-calculator-button-reverse-contrast"))),Fa.createElement(pne,{predicate:()=>!!this.getVersionNumber()},()=>Fa.createElement("div",{class:Fa.const("dcg-version-number")},Fa.const("Version: "),()=>this.getVersionNumber()))))}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.controller.isProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1)},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.controller.isProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0)}]}onSelectProjectorModeOption(t){this.controller.dispatch({type:"update-projector-mode",mode:t})}getVersionNumber(){let t=window;if(t&&t.AppBridge)return t.AppBridge.versionNumber}didUnmountSettingsDropdown(){ze(document.documentElement).off(".dcg-settings-view")}didMountSettingsDropdown(t){this.settingsGroupNode=t,ze(document.documentElement).on("dcg-tapstart.dcg-settings-view",r=>{r.target.closest(".dcg-basic-settings-container")||this.controller.dispatch({type:"close-settings-menu"})}),ze(document.documentElement).on("keydown.dcg-settings-view",r=>{if(Ai(r)==="Esc"&&(this.controller.dispatch({type:"close-settings-menu"}),this.controller.dispatch({type:"focus-last-expression"})),Ai(r)==="Tab"&&!r.altKey&&!r.metaKey&&!r.ctrlKey){let n=document.activeElement,i=ze(this.props.settingsButtonNode()),o=this.settingsGroupNode.querySelectorAll(".dcg-settings-menu-option"),a=ze(o[o.length-1]);!r.shiftKey&&n===a[0]?(i.trigger("focus"),r.preventDefault(),r.stopPropagation()):r.shiftKey&&n===i[0]&&(a.trigger("focus"),r.preventDefault(),r.stopPropagation())}})}onToggleInvertedColors(){this.controller.dispatch({type:"update-inverted-colors",invertedColors:!this.controller.getInvertedColors()})}setDefaultDisplaySize(){this.controller.dispatch({type:"update-projector-mode",mode:!1})}setLargeDisplaySize(){this.controller.dispatch({type:"update-projector-mode",mode:!0})}};var{If:gne}=cs.Components,lC=class extends bi{template(){let e=this.props.controller();return cs.createElement("div",{class:cs.const("dcg-basic-settings-container")},cs.createElement(Du,{menu:cs.const(!1),didMount:t=>this.settingsButtonNode=t,command:this.const("settings"),ariaLabel:()=>e.s("matrix-calculator-button-settings"),onTap:this.bindFn(this.onToggleSettingsMenu),ignoreInTabOrder:cs.const(!1),selectable:cs.const(!0),selected:()=>this.controller.isSettingsMenuOpen(),disabled:cs.const(!1),ariaPopup:this.const(!0)},cs.createElement("i",{class:cs.const("dcg-icon-wrench"),"aria-hidden":cs.const("true")})),cs.createElement(gne,{predicate:()=>this.controller.isSettingsMenuOpen()},()=>cs.createElement(cC,{controller:this.props.controller,settingsButtonNode:()=>this.settingsButtonNode})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var{If:ER}=oo.Components,uC=class extends bi{template(){return oo.createElement(Uv,{controller:this.props.controller},oo.createElement(Du,{menu:()=>!0,disabled:()=>!this.model.hasUnusedMatrixVariables(),selected:()=>!1,selectable:()=>!1,ignoreInTabOrder:()=>!1,command:()=>"add-matrix",ariaLabel:()=>this.controller.s("matrix-calculator-button-new"),onTap:()=>{this.model.hasUnusedMatrixVariables()&&this.dispatch({type:"add-new-matrix"})},onKeyDown:e=>{e.key==="Tab"&&e.shiftKey&&this.dispatch({type:"tab-backward-from-control-bar",evt:e})},shouldBeFocused:()=>this.model.isAddMatrixButtonFocused(),onFocusedChanged:(e,t)=>{this.controller.dispatch({type:e?"focus-add-matrix-button":"blur-add-matrix-button"})}},oo.createElement("span",null,()=>this.controller.s("matrix-calculator-button-new"))),oo.createElement(Du,{menu:()=>!1,disabled:()=>!this.controller.canUndo(),selected:()=>!1,selectable:()=>!1,ignoreInTabOrder:()=>!1,command:()=>"undo",ariaLabel:()=>this.controller.s("shared-calculator-narration-undo"),onTap:()=>this.dispatch({type:"undo"})},oo.createElement("i",{class:oo.const("dcg-icon-undo"),"aria-hidden":oo.const("true")})),oo.createElement(Du,{menu:()=>!1,disabled:()=>!this.controller.canRedo(),selected:()=>!1,selectable:()=>!1,ignoreInTabOrder:()=>!1,command:()=>"redo",ariaLabel:()=>this.controller.s("shared-calculator-narration-redo"),onTap:()=>this.dispatch({type:"redo"})},oo.createElement("i",{class:oo.const("dcg-icon-redo"),"aria-hidden":oo.const("true")})),oo.createElement(ER,{predicate:()=>this.controller.shouldShowClear()},()=>oo.createElement(Du,{menu:()=>!1,disabled:()=>!1,selected:()=>!1,selectable:()=>!1,ignoreInTabOrder:()=>!1,command:()=>"clear",ariaLabel:()=>this.controller.s("shared-calculator-button-clear"),onTap:()=>this.dispatch({type:"clear-focused-expression"})},()=>this.controller.s("shared-calculator-button-clear"))),oo.createElement(ER,{predicate:()=>!this.controller.shouldShowClear()},()=>oo.createElement(Du,{menu:()=>!1,disabled:()=>!this.model.canClear(),selected:()=>!1,selectable:()=>!1,ignoreInTabOrder:()=>!1,command:()=>"clear-all",ariaLabel:()=>this.controller.s("shared-calculator-button-clear-all"),onTap:()=>this.dispatch({type:"clear-all"})},()=>this.controller.s("shared-calculator-button-clear-all"))),oo.createElement(ER,{predicate:()=>this.props.controller().getSettingsMenu()},()=>oo.createElement(lC,{controller:this.props.controller})))}};var Ss=ut(ft());var d8=function(e,t,r){if(e===void 0||t===void 0)return!1;let n,i=t.getBoundingClientRect().height,o=e.getBoundingClientRect().height,a=VP(e),s=VP(t);if(!a||!s)return!1;let c=t.scrollTop,l=a.top+c-s.top,u=l-r,d=o+l+r-i;return u>=d?n=Math.min(Math.max(c,d),u):n=.5*(u+d),n!==c?(t.scrollTop=n,t.scrollTop!=c):!1};var Gn=ut(ft());var Sd=ut(ft());var Py=class extends Sd.Class{template(){return Sd.createElement(Rs,{tooltip:this.props.error,sticky:this.const(!0),gravity:this.props.gravity,additionalClass:this.const("dcg-tooltipped-error-container")},Sd.createElement("div",{class:()=>{var t,r;return{"dcg-tooltipped-error":!0,"dcg-small":((r=(t=this.props).size)==null?void 0:r.call(t))==="small","dcg-white":this.props.isWhite&&this.props.isWhite()}}},Sd.createElement("i",{class:Sd.const("dcg-icon-error"),"aria-hidden":Sd.const("true")})))}};var IR={};nb(IR,{add:()=>yne,det:()=>_ne,div:()=>Tne,inv:()=>Dne,isMatrix:()=>dC,leftScale:()=>Cne,mul:()=>Ene,nadd:()=>hne,ndiv:()=>vne,neg:()=>mne,nmul:()=>wne,nneg:()=>fne,npow:()=>Pne,nsqrt:()=>Mne,nsub:()=>bne,pow:()=>Sne,rightScale:()=>Ine,rref:()=>Lne,sub:()=>xne,trace:()=>Ane,transpose:()=>One});var fne=ko,mne=kH,hne=bo;function yne(e,t){if(!mv(e,t))throw O_();return OH(e,t)}var bne=Ro;function xne(e,t){if(!mv(e,t))throw L_();return LH(e,t)}var vne=yo,Tne=RH,wne=Pi;function dC(e){return Array.isArray(e)}function Ene(e,t){if(yc(e).numCols!==yc(t).numRows)throw N_();return xd(e,t)}var Ine=RL;function Cne(e,t){return RL(t,e)}var Pne=Gx;function Sne(e,t){if(t=ae(t),Math.floor(t)!==t)throw R_();if(!vd(e))throw k_();if(t<0&&iI(e))throw ow();return NH(e,t)}var Mne=Ow;function Dne(e){if(!vd(e))throw __();if(iI(e))throw ow();return VL(e)}function _ne(e){if(!vd(e))throw M_();return kL(e)}function Ane(e){if(!vd(e))throw D_();return VH(e)}var One=nI,Lne=oI;var xi=ut(ft());var{For:p8,IfElse:Nne}=xi.Components,Sy=class extends bi{template(){let e=this.props.editableId()||"";return xi.createElement("div",{class:xi.const("dcg-matrix-container"),style:()=>({"border-color":this.controller.getTextColor()})},xi.createElement("div",{class:xi.const("dcg-top-occluder")}),xi.createElement("div",{class:xi.const("dcg-bottom-occluder")}),xi.createElement("div",{"aria-label":()=>this.props.variable?this.controller.s("matrix-calculator-narration-matrix-with-variable",{variable:this.props.variable()}):this.controller.s("matrix-calculator-narration-matrix-without-variable"),role:xi.const("grid"),class:xi.const("dcg-matrix-view")},xi.createElement(p8,{each:()=>this.getRowKeys()},t=>xi.createElement("div",{role:xi.const("row"),class:xi.const("dcg-matrix-view-row")},xi.createElement(p8,{each:()=>this.getColumnKeys()},r=>xi.createElement(CR,{controller:this.props.controller,isEditable:()=>!!this.props.editableId(),isFocused:()=>this.model.isMatrixExpressionCellFocused(e,t,r),ariaLabel:()=>this.controller.s("shared-calculator-narration-table-cell-coordinates",{rowNumber:t+1,columnNumber:r+1}),latex:()=>this.getCellContents(t,r),onFocusedChanged:n=>{n?this.dispatch({type:"focus-matrix-expression-cell",id:e,row:t,col:r}):this.dispatch({type:"blur-matrix-expression-cell",id:e,row:t,col:r})}}))))))}getCellContents(e,t){return this.props.matrix()[e][t]}getRowKeys(){let e=[],t=this.props.matrix();if(t)for(let r=0;r<t.length;r++)e.push(r);return e}getColumnKeys(){let e=[],t=this.props.matrix(),r=t&&t[0];if(r)for(let n=0;n<r.length;n++)e.push(n);return e}},CR=class extends bi{template(){return xi.createElement("div",{role:xi.const("gridcell"),class:xi.const("dcg-matrix-view-cell")},Nne(this.props.isEditable,{true:()=>xi.createElement(Sn,{latex:this.props.latex,isFocused:this.props.isFocused,capExpressionSize:()=>this.model.isEnabled("capExpressionSize"),config:()=>this.controller.getMathquillConfig(),getAriaLabel:()=>this.props.ariaLabel(),getAriaPostLabel:()=>"",noFadeout:this.const(!0),hasError:()=>!1,onFocusedChanged:this.props.onFocusedChanged,placeholder:this.const("0"),selectOnFocus:this.const(!0),onUserPressedKey:(t,r)=>{this.dispatch({type:"keypad/press-key",key:t,evt:r,source:"keyboard"})},onUserTypedText:t=>{this.dispatch({type:"keypad/type-text",text:t})},onUserChangedLatex:t=>{this.dispatch({type:"mq-updated-latex",latex:t})}}),false:()=>xi.createElement(Di,{config:this.const({}),latex:this.props.latex})}))}};var{SwitchUnion:Rne,If:g8}=Gn.Components,pC=class extends bi{template(){return Gn.createElement("div",{class:()=>({"dcg-latex-expression":!0,"dcg-focused":this.model.isLatexExpressionFocused(this.props.id()),"dcg-do-not-blur":!0})},Gn.createElement(Sn,{latex:()=>this.getItem().latex,isFocused:()=>this.model.isLatexExpressionFocused(this.props.id()),capExpressionSize:()=>this.model.isEnabled("capExpressionSize"),config:()=>this.controller.getMathquillConfig(),getAriaLabel:()=>this.controller.s("shared-calculator-narration-expression"),getAriaPostLabel:()=>{if(this.hasError())return this.getError();let e=this.getAnswer();switch(e.type){case"number":return this.controller.s("shared-calculator-narration-evaluation",{answer:Mu(nu(ae(e.value),{displayAsFraction:this.shouldDisplayEvaluationAsFraction()}))});case"matrix":var t=this.getMatrixEvaluationAria(e.matrix);try{let n=this.controller.s("matrix-calculator-narration-evaluation",{rowCount:t.length,columnCount:t[0].length});for(var r=0;r<t.length;r++)n+=" "+this.controller.s("matrix-calculator-narration-evaluation-row",{rowNumber:r+1,values:t[r].map(i=>i.toString()).join(", ")});return n}catch(n){return this.controller.raw("")}default:return this.controller.raw("")}},hasError:()=>this.hasError(),onUserPressedKey:(e,t)=>{this.dispatch({type:"keypad/press-key",key:e,evt:t,source:"keyboard"})},onUserTypedText:this.bindFn(this.onUserTypedText),onUserChangedLatex:e=>{this.dispatch({type:"mq-updated-latex",latex:e})},onFocusedChanged:e=>{e?this.dispatch({type:"focus-latex-expression",id:this.props.id()}):this.dispatch({type:"blur-latex-expression",id:this.props.id()})}}),Rne("type",()=>this.getAnswer())({number:e=>Gn.createElement("div",{class:Gn.const("dcg-evaluation dcg-number-evaluation")},Gn.createElement("span",{class:Gn.const("dcg-output")},Gn.createElement(Di,{latex:()=>"="+nu(ae(e().value),{displayAsFraction:this.shouldDisplayEvaluationAsFraction()}),config:this.const({})})),this.fractionToggleTemplate()),matrix:e=>Gn.createElement("div",{class:Gn.const("dcg-evaluation dcg-matrix-evaluation")},Gn.createElement("span",{class:Gn.const("dcg-equals-sign")},Gn.const("=")),Gn.createElement(Sy,{controller:this.props.controller,editableId:this.const(void 0),matrix:()=>this.getMatrixEvaluationLatex(e().matrix)}),this.fractionToggleTemplate()),none:()=>{}}),Gn.createElement(g8,{predicate:()=>this.hasError()},()=>Gn.createElement("div",{class:Gn.const("dcg-latex-expression-error")},Gn.createElement(Py,{error:this.bindFn(this.getError),gravity:this.const("w")}))))}fractionToggleTemplate(){return Gn.createElement(g8,{predicate:this.bindFn(this.canDisplayEvaluationAsFraction)},()=>Gn.createElement(Rs,{tooltip:this.bindFn(this.getFractionMessage),gravity:this.const("s")},Gn.createElement("span",{role:Gn.const("button"),tabIndex:Gn.const("0"),"aria-label":this.bindFn(this.getFractionDisplayAriaLabel),class:()=>({"dcg-basic-fraction-toggle":!0,"dcg-selected":this.isFractionEvaluation()}),onTap:this.bindFn(this.toggleFractionEvaluation)},Gn.createElement("i",{class:Gn.const("dcg-icon-fraction"),"aria-hidden":Gn.const("true")}))))}onUserTypedText(e){let t=this.getItem().latex;e==="x"&&t&&t.match(/(.*)matri$/)&&this.model.hasUnusedMatrixVariables()?(this.dispatch({type:"mq-updated-latex",latex:t.replace(/(.*)matri$/,"$1")}),this.dispatch({type:"add-new-matrix"})):this.dispatch({type:"keypad/type-text",text:e})}getItem(){return this.model.getExpressionById(this.props.id())}hasError(){return!!this.model.getEvaluations()[this.props.id()].error}getError(){let e=this.model.getEvaluations()[this.props.id()].error;return e!==void 0?this.controller.unpack(e):this.controller.raw("")}getAnswer(){var e=this.model.getEvaluations()[this.props.id()].answer;return e===void 0?{type:"none"}:dC(e)?{type:"matrix",matrix:e}:{type:"number",value:e}}getMatrixEvaluationLatex(e){let t=this.isFractionEvaluation(),r=[];for(let n of e){let i=[];for(let o of n)i.push(nu(ae(o),{digits:6,bigCutoff:1e6,smallCutoff:.001,displayAsFraction:t}));r.push(i)}return r}getMatrixEvaluationAria(e){let t=this.isFractionEvaluation(),r=[];for(let n of e){let i=[];for(let o of n)i.push(Mu(nu(ae(o),{digits:6,bigCutoff:1e6,smallCutoff:.001,displayAsFraction:t})));r.push(i)}return r}canDisplayEvaluationAsFraction(){if(!this.model.isEnabled("decimalToFraction"))return!1;let e=this.model.getEvaluations()[this.props.id()].answer;if(e===void 0)return!1;if(dC(e)){let t=!1;for(let r of e)for(let n of r){if(!Zr(n))return!1;zb(ae(n))&&(t=!0)}return t}return zb(ae(e))}getFractionMessage(){return this.shouldDisplayEvaluationAsFraction()?this.controller.s("shared-calculator-label-tooltip-convert-to-decimal"):this.controller.s("shared-calculator-label-tooltip-convert-to-fraction")}getFractionDisplayAriaLabel(){return this.shouldDisplayEvaluationAsFraction()?this.controller.s("shared-calculator-narration-display-as-decimal"):this.controller.s("shared-calculator-narration-display-as-fraction")}shouldDisplayEvaluationAsFraction(){return this.canDisplayEvaluationAsFraction()&&this.isFractionEvaluation()}toggleFractionEvaluation(){this.controller.dispatch({type:"set-display-as-fraction",id:this.props.id(),value:!this.getItem().displayAsFraction})}isFractionEvaluation(){return this.getItem().displayAsFraction}};var Ic=ut(ft());var{If:kne}=Ic.Components,gC=class extends bi{template(){return Ic.createElement("div",{class:()=>({"dcg-matrix-expression":!0,"dcg-focused":this.model.isExpressionFocused(this.props.id()),"dcg-do-not-blur":!0}),onTapStart:e=>this.onTapBlankSpace(e)},Ic.createElement("span",{class:Ic.const("dcg-variable-definition")},Ic.createElement(Di,{config:this.const({}),latex:()=>this.getItem().variable+"="})),Ic.createElement(Sy,{controller:this.props.controller,editableId:this.props.id,matrix:()=>this.getItem().matrix,variable:()=>this.getItem().variable}),Ic.createElement(kne,{predicate:()=>!!this.getEvaluation().error},()=>Ic.createElement("div",{class:Ic.const("dcg-matrix-expression-error-container")},Ic.createElement(Py,{error:this.bindFn(this.getError),gravity:this.const("w")}))))}getItem(){return this.model.getExpressionById(this.props.id())}getError(){let e=this.getEvaluation().error;return e!==void 0?this.controller.unpack(e):this.controller.raw("")}onTapBlankSpace(e){e.target.classList.contains("dcg-matrix-expression")&&this.dispatch({type:"focus-matrix-expression-cell",id:this.props.id(),row:0,col:0})}getEvaluation(){return this.model.getEvaluations()[this.props.id()]}};var{For:Vne,Switch:Fne}=Ss.Components,fC=class extends bi{template(){return Ss.createElement("div",{class:Ss.const("dcg-matrix-list-container"),didMount:e=>this.didMountNode(e)},Ss.createElement("div",{class:Ss.const("dcg-matrix-list-placeholder")}),Ss.createElement("div",{class:()=>({"dcg-matrix-list":!0,"dcg-projector-mode":this.controller.isProjectorMode()}),role:Ss.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-expression-list")},Ss.createElement(Vne,{each:()=>this.model.getExpressionOrder()},e=>Ss.createElement(Fne,{key:()=>this.model.getExpressionById(e).type},t=>t==="latex"?Ss.createElement(pC,{controller:this.props.controller,id:this.const(e)}):t==="matrix"?Ss.createElement(gC,{controller:this.props.controller,id:this.const(e)}):Ss.createElement("span",null)))))}didMountNode(e){this.node=e}didUpdate(){let e=this.node.querySelector(".dcg-focused");e&&d8(e,this.node,0)}};var Wt=ut(ft());var mC=ut(ft());var Hv=class extends Gf{template(){return mC.createElement("div",{class:mC.const("dcg-basic-keypad dcg-do-not-blur")},this.props.children)}};var K=ut(ft());var Md=ut(ft()),yn=class extends Md.Class{template(){return Md.createElement("div",{class:()=>({"dcg-keypad-btn-container":!0,"dcg-disabled":this.isDisabled()}),style:()=>{var t;return{"flex-grow":(t=this.getColSpan())==null?void 0:t.toString()}}},Md.createElement("span",{role:Md.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":this.bindFn(this.isDisabled),"aria-controls":this.props.ariaControls?this.props.ariaControls:this.const(void 0),"aria-expanded":this.props.ariaExpanded?this.bindFn(this.getAriaExpanded):this.const(void 0),onTap:()=>{this.isDisabled()||this.props.onTap()}},Md.createElement("span",{class:Md.const("dcg-keypad-btn-content")},this.props.children)))}getClasses(){let t={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},r=this.props.style();switch(r){case"default":t["dcg-btn-light-on-gray"]=!0;break;case"highlight":t["dcg-btn-dark-on-gray"]=!0;break;case"popover":t["dcg-btn-light-gray"]=!0;break;case"blue":t["dcg-btn-short-blue"]=!0;break;case"tall-blue":t["dcg-btn-tall-blue"]=!0;break;default:return r}return t}isActive(){return this.props.active?this.props.active():!1}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}getColSpan(){if(this.props.colspan)return this.props.colspan()}isDisabled(){return this.props.disabled&&this.props.disabled()}getAriaExpanded(){return this.props.ariaExpanded?this.props.ariaExpanded():void 0}};var{IfElse:h8,If:f8,Switch:Gne}=K.Components;function Sr(e,t){return e===void 0?K.const(t):typeof e=="function"?e:K.const(e)}function My(e){return(t,r,n={},i)=>K.createElement(yn,{command:K.const(e.command||e.typedText||e.keys[0]),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):e.typedText||e.keys[0],colspan:Sr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:e.typedText||e.keys[0]})},h8(()=>e.keys[0]==="{"||e.keys[0]==="[",{true:()=>K.createElement("span",{class:K.const("dcg-mq-math-mode"),style:K.const("font-size: 120%")},K.const(e.keys[0]),K.const("\xA0"),K.createElement("span",{style:K.const("color: #999")},K.const(e.keys[1]))),false:()=>K.createElement("span",{class:K.const("dcg-either-or-btn")},K.createElement(Di,{config:K.const({}),latex:K.const(e.keys[0])}),K.createElement("span",{style:K.const("color: #999")},K.createElement(Di,{config:K.const({}),latex:K.const(e.keys[1])})))}))}function Dy(e){return(t,r,n={},i)=>K.createElement(yn,{command:K.const(e.command||e.typedText||e.keys[1]),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):e.typedText||e.keys[0],colspan:Sr(n.colspan,1),style:Sr(n.style,"default"),onTap:()=>r({type:"keypad/type-text",text:e.typedText||e.keys[1]})},h8(()=>e.keys[1]==="}"||e.keys[1]==="]",{true:()=>K.createElement("span",{class:K.const("dcg-mq-math-mode"),style:K.const("font-size: 120%")},K.createElement("span",{style:K.const("color: #999")},K.const(e.keys[0])),K.const("\xA0"),K.const(e.keys[1])),false:()=>K.createElement("span",null,K.createElement("span",{style:K.const("color: #999")},K.createElement(Di,{config:K.const({}),latex:K.const(e.keys[0])})),K.createElement(Di,{config:K.const({}),latex:K.const(e.keys[1])}))}))}function Bne(e){return(t,r,n={},i)=>K.createElement(yn,{command:K.const(e.command),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:Sr(n.colspan,1),style:()=>n.style||"default",onTap:()=>{r({type:"keypad/audio-trace",command:e.command})}},K.createElement(f8,{predicate:K.const(e.iconClass!==void 0)},()=>K.createElement("span",{class:()=>({"dcg-button-icon":!0,"dcg-icon-only":e.contentKey===void 0})},K.createElement("i",{class:K.const(e.iconClass),"aria-hidden":K.const("true")}))),K.createElement(f8,{predicate:K.const(e.contentKey!==void 0)},()=>K.createElement("span",null,()=>i(e.contentKey)||t)))}function we(e){return(t,r,n={},i)=>K.createElement(yn,{command:K.const(e.command||t),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:Sr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:e.typedText||t})},K.createElement(Di,{config:K.const({}),latex:K.const(e.content||t)}))}function m8(e){return(t,r,n={},i)=>K.createElement(yn,{command:K.const(e.command||t),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:Sr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:e.typedText||t})},K.createElement("span",{class:K.const("dcg-mq-math-mode")},K.const(e.content||t)))}function Se(e){return(t,r,n={},i)=>K.createElement(yn,{command:K.const(t),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):t,colspan:Sr(n.colspan,1),style:()=>n.style||"default",onTap:()=>r({type:"keypad/type-text",text:t+"("})},K.createElement(Gne,{key:()=>!!t.match(/^[a-z]{2,}$/)},o=>o?K.createElement("span",{class:K.const("dcg-mq-math-mode dcg-static-mathquill-view")},K.createElement("span",{class:K.const("dcg-mq-root-block")},K.createElement("span",{class:K.const("dcg-mq-operator-name")},()=>t))):K.createElement(Di,{config:K.const({}),latex:K.const(t)})))}function Xo(e){return(t,r,n={},i)=>K.createElement(yn,{command:K.const(e.command),ariaLabel:()=>e.ariaLabelKey?i(e.ariaLabelKey):e.command,colspan:Sr(n.colspan,1),style:()=>n.style||"default",onTap:()=>{r({type:"keypad/custom-command",command:e.command})}},K.createElement(Di,{config:K.const({}),latex:K.const(e.content)}))}var qne={"{":m8({ariaLabelKey:"shared-calculator-narration-keypad-key-left-bracket"}),"}":m8({ariaLabelKey:"shared-calculator-narration-keypad-key-right-bracket"}),"(":we({ariaLabelKey:"shared-calculator-narration-keypad-key-left-paren"}),")":we({ariaLabelKey:"shared-calculator-narration-keypad-key-right-paren"}),sqrt:we({content:"\\sqrt{}",ariaLabelKey:"shared-calculator-narration-keypad-key-sqrt"}),"/":we({ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),division:we({content:"\xF7",typedText:"/",command:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),obelus:we({content:"\xF7",typedText:"\xF7",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),"*":we({ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),multiplication:we({content:"\xD7",typedText:"*",command:"*",ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),"\xB1":we({ariaLabelKey:"shared-calculator-narration-keypad-plus-minus"}),"-":we({ariaLabelKey:"shared-calculator-narration-keypad-key-minus"}),"+":we({ariaLabelKey:"shared-calculator-narration-keypad-key-plus"}),".":we({ariaLabelKey:"shared-calculator-narration-keypad-key-decimal"}),ans:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-ans"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/type-text",text:e})},K.const("ans")),enter:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-enter"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Enter",source:"keypad"})},K.createElement("i",{class:K.const("dcg-icon-arrow-enter"),"aria-hidden":K.const("true")})),undo:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-enter"),colspan:Sr(r.colspan,1),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"undo",source:"button-tap"})},K.createElement("i",{class:K.const("dcg-icon-undo"),"aria-hidden":K.const("true")})),redo:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-enter"),colspan:Sr(r.colspan,1),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"redo",source:"button-tap"})},K.createElement("i",{class:K.const("dcg-icon-redo"),"aria-hidden":K.const("true")})),shift:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-shift"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",active:Sr(r.active,!1),onTap:()=>t({type:"keypad/shift"})},K.createElement("i",{class:K.const("dcg-icon-shift"),"aria-hidden":K.const("true")})),left:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-left-arrow"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Left",source:"keypad"})},K.createElement("i",{class:K.const("dcg-icon-arrow-left"),"aria-hidden":K.const("true")})),right:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-right-arrow"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Right",source:"keypad"})},K.createElement("i",{class:K.const("dcg-icon-arrow-right"),"aria-hidden":K.const("true")})),123:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-toggle-numbers"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/123"})},K.const("1 2 3")),ABC:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-toggle-letters"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/abc"})},K.const("A B C")),Audio:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-toggle-audio-trace"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"on"})},K.createElement("i",{class:K.const("dcg-icon-volume"),"aria-hidden":K.const("true")})),backspace:(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("shared-calculator-narration-keypad-key-backspace"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/press-key",key:"Backspace",source:"keypad"})},K.createElement("i",{class:K.const("dcg-icon-delete"),"aria-hidden":K.const("true")})),pi:we({content:"\\pi",ariaLabelKey:"shared-calculator-narration-keypad-key-pi"}),alpha:we({content:"\\alpha",ariaLabelKey:"shared-calculator-narration-keypad-key-alpha"}),beta:we({content:"\\beta",ariaLabelKey:"shared-calculator-narration-keypad-key-beta"}),theta:we({content:"\\theta",ariaLabelKey:"shared-calculator-narration-keypad-key-theta"}),tau:we({content:"\\tau",ariaLabelKey:"shared-calculator-narration-keypad-key-tau"}),phi:we({content:"\\phi",ariaLabelKey:"shared-calculator-narration-keypad-key-phi"}),rho:we({content:"\\rho",ariaLabelKey:"shared-calculator-narration-keypad-key-rho"}),"a^2":Xo({command:"a^2",content:"a^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"a^3":Xo({command:"a^3",content:"a^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"x^3":Xo({command:"a^3",content:"x^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"a^b":we({content:"a^b",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),a_b:we({content:"a_b",typedText:"_",ariaLabelKey:"shared-calculator-narration-keypad-key-subscript"}),"a/b":Xo({content:"\\frac{a}{b}",command:"a/b",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),"x^2":Xo({command:"a^2",content:"x^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"x^y":we({content:"x^y",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),"x/y":we({content:"\\frac{x}{y}",typedText:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),nthroot:Xo({command:"nthroot",content:"\\sqrt[n]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-nthroot"}),ythroot:Xo({command:"nthroot",content:"\\sqrt[y]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-ythroot"}),sin:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-sin"}),cos:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-cos"}),tan:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-tan"}),tone:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-tone"}),sec:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-sec"}),csc:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-csc"}),cot:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-cot"}),sinh:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-sinh"}),cosh:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-cosh"}),tanh:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-tanh"}),sech:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),csch:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),coth:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-coth"}),arcsin:Xo({command:"arcsin",content:"sin^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsin"}),arccos:Xo({command:"arccos",content:"cos^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccos"}),arctan:Xo({command:"arctan",content:"tan^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arctan"}),arccsc:Xo({command:"arccsc",content:"csc^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccsc"}),arcsec:Xo({command:"arcsec",content:"sec^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsec"}),arccot:Xo({command:"arccot",content:"cot^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccot"}),"|a|":we({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"|x|":we({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),ln:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-ln"}),midpoint:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-midpoint"}),segment:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-segment"}),line:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-line"}),ray:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-ray"}),parallel:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-parallel"}),perpendicular:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-perpendicular"}),circle:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-circle"}),arc:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-arc"}),angle:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-angle"}),directedangle:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angle"}),glider:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-glider"}),coterminal:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-coterminal"}),supplement:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-supplement"}),dilate:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-dilate"}),rotate:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-rotate"}),translate:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-translate"}),reflect:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-reflect"}),vertices:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-vertices"}),angles:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-angles"}),directedangles:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angles"}),segments:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-segments"}),radius:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-radius"}),center:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-center"}),intersection:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-intersection"}),area:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-area"}),perimeter:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-perimeter"}),log:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-log"}),quantile:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-quantile"}),quartile:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-quartile"}),var:Se({}),varp:Se({}),nCr:Se({}),loga:Xo({command:"loga",content:"log_a",ariaLabelKey:"shared-calculator-narration-keypad-key-loga"}),stdev:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-stdev"}),mad:Se({}),nPr:Se({}),total:Se({}),count:Se({}),length:Se({}),for:Se({}),min:Se({}),max:Se({}),cov:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-cov"}),covp:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-covp"}),corr:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-corr"}),spearman:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-spearman"}),stats:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-stats"}),polygon:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-polygon"}),distance:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-distance"}),triangle:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-triangle"}),sphere:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-sphere"}),vector:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-vector"}),mean:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-mean"}),stdevp:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-stdevp"}),mod:Se({}),"e^x":we({typedText:"e^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),"10^n":we({content:"\\times10^{n}",typedText:"*10^",ariaLabelKey:"shared-calculator-narration-keypad-key-10-n"}),"a^{-1}":we({typedText:"^-1",ariaLabelKey:"shared-calculator-narration-keypad-key-reciprocal"}),sum:we({content:"\\sum",ariaLabelKey:"shared-calculator-narration-keypad-key-sum"}),prod:we({content:"\\prod",ariaLabelKey:"shared-calculator-narration-keypad-key-product"}),floor:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-floor"}),ceil:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-ceil"}),round:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-round"}),abs:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"!":we({ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),"n!":we({typedText:"!",ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),median:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-median"}),lcm:Se({}),gcd:Se({}),gcf:Se({}),ddx:Xo({command:"ddx",content:"\\frac{d}{dx}"}),integral:Xo({command:"integral",content:"\\int",ariaLabelKey:"shared-calculator-narration-keypad-key-int"}),"%":we({content:"\\%",ariaLabelKey:"shared-calculator-narration-keypad-key-percent-of"}),"->":we({content:"\\to",ariaLabelKey:"shared-calculator-narration-keypad-key-action-to"}),with:we({typedText:"with",content:"with",ariaLabelKey:"shared-calculator-narration-keypad-key-action-with"}),prime:we({typedText:"'",content:"f'",ariaLabelKey:"shared-calculator-narration-keypad-key-prime"}),exp:Se({}),sign:Se({}),normaldist:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-normaldist"}),poissondist:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-poissondist"}),binomialdist:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-binomialdist"}),uniformdist:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-uniformdist"}),erf:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-erf"}),histogram:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-histogram"}),boxplot:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-boxplot"}),dotplot:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-dotplot"}),tscore:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-tscore"}),ittest:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-ittest"}),ttest:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-ttest"}),tdist:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-tdist"}),pdf:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),cdf:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),random:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-random"}),inversecdf:Se({ariaLabelKey:"shared-calculator-narration-keypad-key-inversecdf"}),hsv:Se({}),rgb:Se({}),sort:Se({}),shuffle:Se({}),unique:Se({}),join:Se({}),"A^-1":Xo({command:"A^-1",content:"A^{-1}",ariaLabelKey:"matrix-calculator-narration-keypad-key-inverse"}),"A^T":Xo({command:"A^T",content:"A^T",ariaLabelKey:"matrix-calculator-narration-keypad-key-transpose"}),"A^2":Xo({command:"A^2",content:"A^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"A^n":we({content:"A^n",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),det:Se({ariaLabelKey:"matrix-calculator-narration-keypad-key-det"}),trace:Se({ariaLabelKey:"matrix-calculator-narration-keypad-key-trace"}),rref:Se({ariaLabelKey:"matrix-calculator-narration-keypad-key-rref"}),a:we({}),b:we({}),c:we({}),d:we({}),e:we({}),f:we({}),g:we({}),h:we({}),i:we({}),j:we({}),k:we({}),l:we({}),m:we({}),n:we({}),o:we({}),p:we({}),q:we({}),r:we({}),s:we({}),t:we({}),u:we({}),v:we({}),w:we({}),x:we({}),boldX:we({content:"x",typedText:"x"}),y:we({}),boldY:we({content:"y",typedText:"y"}),z:we({}),boldZ:we({content:"z",typedText:"z"}),A:we({}),B:we({}),C:we({}),D:we({}),E:we({}),F:we({}),G:we({}),H:we({}),I:we({}),J:we({}),K:we({}),L:we({}),M:we({}),N:we({}),O:we({}),P:we({}),Q:we({}),R:we({}),S:we({}),T:we({}),U:we({}),V:we({}),W:we({}),X:we({}),Y:we({}),Z:we({}),0:we({}),1:we({}),2:we({}),3:we({}),4:we({}),5:we({}),6:we({}),7:we({}),8:we({}),9:we({}),",":we({}),"=":we({}),"[":we({}),"]":we({}),"{}_left":My({keys:["{","}"]}),"{}_right":Dy({keys:["{","}"]}),"()_left":My({keys:["(",")"]}),"()_right":Dy({keys:["(",")"]}),"[]_left":My({keys:["[","]"]}),"[]_right":Dy({keys:["[","]"]}),",'_left":My({keys:[",","\u2032"]}),",'_right":Dy({keys:[",","\u2032"],typedText:"'"}),'"':we({}),"'":we({}),"~":we({}),":":we({}),">":we({}),"<":we({}),">=":we({content:"\\ge"}),"<=":we({content:"\\le"}),"!%_left":My({keys:["!","{}^{%}"]}),"!%_right":Dy({keys:["!","{}^{%}"],typedText:"%"}),"~:_left":My({keys:["~","{}^{:}"]}),"~:_right":Dy({keys:["~","{}^{:}"],typedText:":"}),"audio-trace-off":Bne({contentKey:"graphing-calculator-button-keypad-audio-trace-off",command:"off"}),"hear-graph":(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:Sr(r.style,"blue"),ariaLabel:K.const(void 0),onTap:()=>{t({type:"keypad/audio-trace",command:"hear-graph"})}},K.createElement("span",{class:K.const("dcg-play-icon-container")},K.createElement("i",{class:K.const("dcg-icon-play"),"aria-hidden":K.const("true")})),K.createElement("span",null,()=>n("graphing-calculator-button-audio-trace-hear-graph"))),"stop-graph":(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:Sr(r.style,"blue"),onTap:()=>{t({type:"keypad/audio-trace",command:"stop-graph"})}},K.createElement("span",{class:K.const("dcg-stop-icon-container")},K.createElement("span",{class:K.const("dcg-stop-icon")})),K.createElement("span",null,()=>n("graphing-calculator-button-audio-trace-stop-graph"))),"volume-down":(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-volume-down"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"volume-down"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-volume-down"),"aria-hidden":K.const("true")}))),"volume-up":(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-volume-up"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"volume-up"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-volume-up"),"aria-hidden":K.const("true")}))),"speed-down":(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-speed-down"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"speed-down"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-hide"),"aria-hidden":K.const("true")}))),"speed-up":(e,t,r={},n)=>K.createElement(yn,{command:K.const(e),ariaLabel:()=>n("graphing-calculator-narration-keypad-key-speed-up"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"speed-up"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-show"),"aria-hidden":K.const("true")}))),"previous-point":(e,t,r={},n)=>K.createElement(yn,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-previous-point"),command:K.const(e),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"previous-point"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-thin-arrow-left"),"aria-hidden":K.const("true")}))),"next-point":(e,t,r={},n)=>K.createElement(yn,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-next-point"),command:K.const(e),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"next-point"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-thin-arrow-right"),"aria-hidden":K.const("true")}))),"previous-poi":(e,t,r={},n)=>K.createElement(yn,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-previous-poi"),command:K.const(e),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"previous-poi"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-hide"),"aria-hidden":K.const("true")}))),"next-poi":(e,t,r={},n)=>K.createElement(yn,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-next-poi"),command:K.const(e),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"next-poi"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-show"),"aria-hidden":K.const("true")}))),"previous-curve":(e,t,r={},n)=>K.createElement(yn,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-previous-curve"),command:K.const(e),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"previous-curve"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-caret-up"),"aria-hidden":K.const("true")}))),"next-curve":(e,t,r={},n)=>K.createElement(yn,{ariaLabel:()=>n("graphing-calculator-narration-keypad-key-next-curve"),command:K.const(e),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>t({type:"keypad/audio-trace",command:"next-curve"})},K.createElement("span",{class:K.const("dcg-button-icon dcg-icon-only")},K.createElement("i",{class:K.const("dcg-icon-caret-down"),"aria-hidden":K.const("true")})))};function Kr(e,t,r={}){let n=e.dispatch;return qne[t](t,n,r,e.s)}function qf(e=1){return K.createElement("div",{style:K.const(`flex-grow:${e}`)})}var _y=ut(ft()),cg=class extends _y.Class{template(){return _y.createElement("div",{class:_y.const("dcg-keypad-row")},this.props.children)}};var jr=ut(ft());var $v=class extends bi{template(){return jr.createElement("div",{class:jr.const("dcg-edit-matrix-bar dcg-do-not-blur"),role:jr.const("toolbar"),"aria-label":()=>this.controller.s("matrix-calculator-narration-resize-controls")},jr.createElement("div",{class:jr.const("dcg-edit-section-title")},()=>this.controller.s("matrix-calculator-heading-edit-matrix",{variable:this.getItem().variable})),jr.createElement("div",{class:jr.const("dcg-resize-section")},jr.createElement(Ay,{id:()=>this.props.id(),op:jr.const("remove-matrix-row"),ariaLabel:()=>this.controller.s("matrix-calculator-narration-remove-row"),iconClass:jr.const("dcg-icon-minus"),controller:()=>this.props.controller()}),jr.createElement("span",{class:jr.const("dcg-resize-info")},jr.createElement("span",{class:jr.const("dcg-resize-category")},()=>this.controller.s("matrix-calculator-label-rows")),jr.createElement("span",{class:jr.const("dcg-resize-count")},()=>this.numRows())),jr.createElement(Ay,{id:()=>this.props.id(),op:jr.const("add-matrix-row"),ariaLabel:()=>this.controller.s("matrix-calculator-narration-add-row"),iconClass:jr.const("dcg-icon-plus"),controller:()=>this.props.controller()})),jr.createElement("div",{class:jr.const("dcg-resize-section")},jr.createElement(Ay,{id:()=>this.props.id(),op:jr.const("remove-matrix-col"),ariaLabel:()=>this.controller.s("matrix-calculator-narration-remove-column"),iconClass:jr.const("dcg-icon-minus"),controller:()=>this.props.controller()}),jr.createElement("span",{class:jr.const("dcg-resize-info")},jr.createElement("span",{class:jr.const("dcg-resize-category")},()=>this.controller.s("matrix-calculator-label-columns")),jr.createElement("span",{class:jr.const("dcg-resize-count")},()=>this.numCols())),jr.createElement(Ay,{id:()=>this.props.id(),op:jr.const("add-matrix-col"),ariaLabel:()=>this.controller.s("matrix-calculator-narration-add-column"),iconClass:jr.const("dcg-icon-plus"),controller:()=>this.props.controller()})))}numRows(){return this.getItem().matrix.length}numCols(){let t=this.getItem().matrix;return t.length===0?0:t[0].length}getItem(){return this.model.getExpressionById(this.props.id())}},Ay=class extends bi{template(){return jr.createElement("span",{class:()=>({"dcg-resize-action":!0,"dcg-disabled":this.isDisabled()}),tabIndex:()=>this.isDisabled()?-1:0,onTap:()=>{this.isDisabled()||this.controller.dispatch({type:this.props.op(),id:this.props.id()})},onMount:t=>this.didMountRoot(t),onFocusIn:()=>this.onFocusEvent(),onFocusOut:()=>this.onFocusEvent(),onKeyDown:t=>this.onKey(t),role:jr.const("button"),"aria-label":()=>this.props.ariaLabel(),"aria-disabled":()=>this.isDisabled(),"dcg-command":()=>this.props.op()},jr.createElement("i",{class:()=>this.props.iconClass(),"aria-hidden":jr.const("true")}))}didMountRoot(t){this.root=t,this.shouldBeFocused()&&!this.isFocused()&&this.root.focus()}didUpdate(){this.shouldBeFocused()&&!this.isFocused()&&this.root.focus()}onFocusEvent(){let t=this.isFocused();t!==this.shouldBeFocused()&&this.controller.dispatch({type:t?"focus-resize-button":"blur-resize-button",id:this.props.id(),op:this.props.op()})}shouldBeFocused(){return this.model.isResizeButtonFocused(this.props.id(),this.props.op())}isDisabled(){return this.model.isResizeOpDisabled(this.props.id(),this.props.op())}isFocused(){return!!(document.activeElement&&this.root.contains(document.activeElement))}onKey(t){t.key==="Tab"&&this.controller.dispatch({type:"edit-bar/press-key",key:t.key,evt:t})}};var{If:Ui}=Wt.Components,hC=class extends bi{template(){return Wt.createElement("div",{role:Wt.const("region"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad"),class:Wt.const("dcg-basic-keypad-container")},Wt.createElement(Hv,{controller:this.props.controller},Wt.createElement(cg,null,Wt.createElement(Ui,{predicate:this.bindFn(this.shouldShowEditMatrixBar)},()=>qf(4)),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"A")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"B")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"C")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"D")),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),Kr(this,"7",{style:"highlight"}),Kr(this,"8",{style:"highlight"}),Kr(this,"9",{style:"highlight"}),Kr(this,"division"),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),Kr(this,"("),Kr(this,")")),Wt.createElement(cg,null,Wt.createElement(Ui,{predicate:this.bindFn(this.shouldShowEditMatrixBar)},()=>qf(4)),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"E")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"F")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"G")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"H")),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),Kr(this,"4",{style:"highlight"}),Kr(this,"5",{style:"highlight"}),Kr(this,"6",{style:"highlight"}),Kr(this,"multiplication"),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),Kr(this,"left",{style:"highlight"}),Kr(this,"right",{style:"highlight"})),Wt.createElement(cg,null,Wt.createElement(Ui,{predicate:this.bindFn(this.shouldShowEditMatrixBar)},()=>qf(4)),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"A^2")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"A^-1")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"A^T")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"A^n")),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),Kr(this,"1",{style:"highlight"}),Kr(this,"2",{style:"highlight"}),Kr(this,"3",{style:"highlight"}),Kr(this,"+"),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),qf(.5),Kr(this,"backspace",{style:"highlight",colspan:1.5})),Wt.createElement(cg,null,Wt.createElement(Ui,{predicate:this.bindFn(this.shouldShowEditMatrixBar)},()=>qf(4)),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"rref")),Wt.createElement(Ui,{predicate:this.bindFn(this.showBtn)},()=>Kr(this,"det")),Wt.createElement(Ui,{predicate:()=>!this.controller.isNarrow()&&this.showBtn()},()=>Kr(this,"trace")),Wt.createElement(Ui,{predicate:()=>!this.controller.isNarrow()&&this.showBtn()},()=>qf(1)),Wt.createElement(Ui,{predicate:()=>this.controller.isNarrow()&&this.showBtn()},()=>Kr(this,"trace",{colspan:2})),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),Kr(this,"0",{style:"highlight"}),Kr(this,".",{style:"highlight"}),Kr(this,"sqrt"),Kr(this,"-"),Wt.createElement("div",{class:Wt.const("dcg-partition-placeholder")}),Kr(this,"enter",{style:"blue",colspan:2}))),Wt.createElement(Ui,{predicate:()=>this.shouldShowEditMatrixBar()},()=>Wt.createElement($v,{id:()=>this.model.getIdOfFocus(),controller:this.props.controller})))}showBtn(){return!this.shouldShowEditMatrixBar()}shouldShowEditMatrixBar(){let e=this.model.getIdOfFocus();return e===void 0?!1:this.model.getExpressionById(e).type==="matrix"}};var{If:Une}=Js.Components,yC=class extends bi{template(){return Js.createElement(Une,{predicate:()=>this.controller.shouldRender()},()=>Js.createElement("div",{class:this.const(c8),style:Js.const("width: 100%; height: 100%; position: relative;")},Js.createElement("div",{class:()=>({"dcg-calc-matrix-main-wrapper":!0,"dcg-container":!0,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-narrow":this.controller.isNarrow(),"dcg-very-narrow":this.controller.isVeryNarrow(),"dcg-very-very-narrow":this.controller.isVeryVeryNarrow()}),didMount:this.bindFn(this.didMountRoot),onKeyDown:this.bindFn(this.handleRootKeydown),"x-ms-format-detection":Js.const("none"),style:()=>({"--dcg-custom-background-color":this.controller.hasBackgroundColor()?this.controller.getBackgroundColor():void 0,"--dcg-custom-text-color":this.controller.hasTextColor()?this.controller.getTextColor():void 0,filter:this.model.isEnabled("invertedColors")?"invert(100%)":"none"})},Js.createElement("div",{class:()=>({"dcg-calc-matrix-main":!0,"dcg-projector-mode":this.controller.isProjectorMode()}),style:()=>({"font-size":`${this.controller.getFontSize()}px`}),role:Js.const("application"),"aria-label":()=>this.props.controller().s("matrix-calculator-narration-title")},Js.createElement(fC,{controller:this.props.controller}),Js.createElement(uC,{controller:this.props.controller}),Js.createElement(hC,{controller:this.props.controller})))))}didMountRoot(e){Nb(e)}handleRootKeydown(e){return YF(e)?(this.dispatch({type:"undo"}),!1):WF(e)?(this.dispatch({type:"redo"}),!1):!(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&Ai(e)===NP&&(!document.activeElement||!kb(document.activeElement)))}};function $l(e){return $V(e)}function Dd(e){this.setState(e)}Dd.prototype.setState=function(e){this.state=e};Dd.prototype.getState=function(){return this.state};Dd.prototype.set=function(e,t){if(arguments.length===1){this.state=e;return}else if(typeof e=="string"){this.state=$l(this.state),this.state[e]=t;return}var r=e.length-2,n=e[r+1],i;this.state=i=$l(this.state);for(var o=0;o<=r;o++){var a=e[o];i=i[a]=$l(i[a])}i[n]=t};Dd.prototype.deepMutate=function(e,t){if(arguments.length===1){t=e,this.state=Bn(this.state),t(this.state);return}else if(typeof e=="string"){this.state=$l(this.state),this.state[e]=Bn(this.state[e]),t(this.state[e]);return}for(var r=e.length-2,n=e[r+1],i=this.state=$l(this.state),o=0;o<=r;o++){var a=e[o];i=i[a]=$l(i[a])}i=i[n]=Bn(i[n]),t(i)};Dd.prototype.shallowMutate=function(e,t){if(arguments.length===1){t=e,this.state=$l(this.state),t(this.state);return}else if(typeof e=="string"){this.state=$l(this.state),this.state[e]=$l(this.state[e]),t(this.state[e]);return}for(var r=e.length-1,n=this.state=$l(this.state),i=0;i<=r;i++){var o=e[i];n=n[o]=$l(n[o])}t(n)};Dd.areShallowEqual=function(e,t){};Dd.areDeepEqual=function(e,t){};function y8(e){return{type:"constant",value:e,valueType:"number"}}function b8(e){return{type:"matrix",elements:e,valueType:"matrix"}}function bC(e,t,r){return{type:"intrinsic",symbol:e,args:t,valueType:r}}function xC(e){return{type:"constant",value:e}}function x8(e){return{type:"matrix",elements:e}}function vC(e){return{type:"identifier",symbol:e}}function PR(e,t){return{type:"functionCall",symbol:e,args:t}}function v8(e,t){return{type:"functionExponent",symbol:e,args:t}}function Oy(e,t){return{type:"op",symbol:e,args:t}}function T8(e){return Oy("add",e)}function w8(e){return Oy("sub",e)}function Ly(e){return Oy("mul",e)}function E8(e){return Oy("div",e)}function TC(e){return Oy("pow",e)}function I8(e){return Oy("neg",e)}function C8(e){return e=e.replace(/\\operatorname\{(.*)\}/,"$1"),e.replace(/[{}\\]/g,"")}var Yne={Constant:e=>xC(e),MixedNumber:e=>xC(e),Identifier:e=>vC(C8(e)),FunctionCall:function(e,t){let r;return typeof e=="string"?r=C8(e):r=e.symbol,PR(r,t)},FunctionExponent:function(e){return v8(e[0].symbol,e.slice(1))},Add:T8,Subtract:w8,Multiply:Ly,DotMultiply:Ly,CrossMultiply:Ly,Divide:E8,Exponent:TC,Negative:I8,Or:()=>{throw ms()},Ans:()=>{throw Ug("ans")},Assignment:()=>{throw A_()},Comparator:{"<":()=>{throw ms()},">":()=>{throw ms()},"<=":()=>{throw ms()},">=":()=>{throw ms()},"=":()=>{throw Us()}},Derivative:()=>{throw Cn()},ComparatorChain:e=>{throw e.includes("=")?Us():ms()},DoubleInequality:()=>{throw ms()},Equation:()=>{throw Us()},CallAssignment:()=>{throw Us()},FunctionDefinition:()=>{throw $g()},Integral:()=>{throw Cn()},List:()=>{throw Cn()},ListAccess:()=>{throw Cn()},ParenSeq:()=>{throw cd()},NamedCoordinateAccess:()=>{throw Cn()},Norm:()=>{throw ba("abs")},Piecewise:()=>{throw Cn()},Restriction:()=>{throw Cn()},Prime:()=>{throw Cn()},Product:()=>{throw Cn()},Range:()=>{throw Cn()},Regression:()=>{throw sd()},Sum:()=>{throw Cn()},DotAccess:()=>{throw Cn()},Histogram:function(){throw Cn()},DotPlot:function(){throw Cn()},BoxPlot:function(){throw Cn()},TTest:function(){throw Cn()},IndependentTTest:function(){throw Cn()},Stats:function(){throw Cn()},PercentOf:function(){throw Cn()},FunctionFactorial:function(){throw Cn()},SeededFunctionCall:function(){throw Cn()},BareSeq:function(){throw Cn()},AssignmentExpression:function(){throw Cn()},ListComprehension:function(){throw Cn()},Substitution:function(){throw Cn()},UpdateRule:function(){throw Cn()},Seed:function(){throw Cn()},ExtendSeed:function(){throw Cn()}};function Wne(e,t){return e}function Xne(){throw new Error("Programming error: function 'sample' not implemented in the matrix calculator.")}function MR(e){let t=ey(e),r=cv(t);return FE({nodes:Yne,setInput:Wne,nextSeed:Xne,allowIndex:!1,allowDt:!1,writeIntegral:!1,allowIntervalComprehensions:!1,specializeDoubleInequalities:!1,includeFunctionParametersInRandomSeed:!0},r)}function DR(e){let t=[];for(let r of e){let n=[];for(let i of r)i===""?n.push(xC(Et(0,1))):n.push(MR(i));t.push(n)}return x8(t)}var Kne={canDefine:e=>/^[A-F]$/.test(e)};function S8(){return{frame:{},policy:Kne}}function wC(e){throw new Error("Unexpected object: "+e)}var SR={add:[[["number","number"],"number","nadd"],[["matrix","matrix"],"matrix","add"]],sub:[[["number","number"],"number","nsub"],[["matrix","matrix"],"matrix","sub"]],mul:[[["number","number"],"number","nmul"],[["number","matrix"],"matrix","leftScale"],[["matrix","number"],"matrix","rightScale"],[["matrix","matrix"],"matrix","mul"]],div:[[["number","number"],"number","ndiv"],[["matrix","number"],"matrix","div"]],pow:[[["number","number"],"number","npow"],[["matrix","number"],"matrix","pow"]],sqrt:[[["number"],"number","nsqrt"]],neg:[[["number"],"number","nneg"],[["matrix"],"matrix","neg"]],inv:[[["matrix"],"matrix","inv"]],det:[[["matrix"],"number","det"]],trace:[[["matrix"],"number","trace"]],transpose:[[["matrix"],"matrix","transpose"]],rref:[[["matrix"],"matrix","rref"]]};function P8(e,t){for(let r=0;r<e.length;r++){if(t.length!==e[r][0].length)continue;let n=!0;for(let i=0;i<t.length;i++)if(t[i].valueType!==e[r][0][i]){n=!1;break}if(n)return e[r]}}function jne(e){var t=e[0][0].length;for(let r=1;r<e.length;r++)if(e[r][0].length!==t)return-1;return t}function M8(e){switch(e){case"matrix":return rn("shared-calculator-label-value-type-matrix");case"number":return rn("shared-calculator-label-value-type-number");default:return wC(e)}}function zf(e){return e.map(t=>M8(t.valueType))}function Yl(e,t){var r,n;switch(t.type){case"constant":return y8(t.value);case"matrix":{let i=t.elements.map(o=>o.map(a=>Yl(e,a)));return i.forEach(o=>o.forEach(a=>{if(a.valueType!=="number")throw V_([M8(a.valueType)])})),b8(i)}case"op":{if(t.symbol==="pow"&&t.args.length===2){let c=Yl(e,t.args[0]),l=t.args[1];if(c.valueType==="matrix"&&l.type==="identifier"&&l.symbol==="T")return bC("transpose",[c],"matrix")}let i=t.args.map(c=>Yl(e,c)),o=SR[t.symbol],a=P8(o,i),s=!0;if(!a){let c=t.symbol;switch(c){case"add":throw ox(zf(i),{blockExport:s});case"sub":throw ax(zf(i),{blockExport:s});case"mul":throw Fg(zf(i),{blockExport:s});case"div":throw sx(zf(i),{blockExport:s});case"pow":throw cx(zf(i),{blockExport:s});case"neg":throw lx(zf(i),{blockExport:s});default:return wC(c)}}return bC(a[2],i,a[1])}case"functionCall":{let i=SR[t.symbol];if(!i){if(t.args.length===1)return Yl(e,Ly([vC(t.symbol),t.args[0]]));throw e.frame[t.symbol]?Km(t.symbol):(r=An[t.symbol])!=null&&r.isFunction?ba(t.symbol):Wm(t.symbol)}let o=t.args.map(s=>Yl(e,s)),a=P8(i,o);if(!a){let s=jne(i);throw s>=0&&s!==o.length?fc(t.symbol,s,o.length,{includeUsageExample:!0}):ra(t.symbol,zf(o),{blockExport:!0})}return bC(a[2],o,a[1])}case"functionExponent":{let i=SR[t.symbol];return t.args.length===2&&!i?Yl(e,Ly([vC(t.symbol),TC([t.args[0],t.args[1]])])):Yl(e,TC([PR(t.symbol,[t.args[0]]),t.args[1]]))}case"identifier":{if(e.frame[t.symbol])return Yl(e,e.frame[t.symbol]);throw e.policy.canDefine(t.symbol)?un([t.symbol]):(n=An[t.symbol])!=null&&n.isFunction?ba(t.symbol):F_(t.symbol)}default:return wC(t)}}function Yv(e){switch(e.type){case"constant":return e.value;case"matrix":return e.elements.map(t=>t.map(r=>Yv(r)));case"intrinsic":return IR[e.symbol].apply(void 0,e.args.map(Yv));default:return wC(e)}}function D8(e){let t={},{expressions:r,order:n}=e,i=S8();return n.forEach(o=>{let a=r[o];if(a.type==="matrix")try{i.frame[a.variable]=DR(a.matrix)}catch(s){}}),n.forEach(o=>{let a=r[o],s={};try{if(a.type==="latex"){if(a.latex){let c=MR(a.latex);c.type!=="constant"&&(s.answer=Yv(Yl(i,c)))}}else if(a.type==="matrix")Yv(Yl(i,DR(a.matrix)));else return a}catch(c){c instanceof q?s.error=c.getError():s.error=Ie(c).getError()}t[a.id]=s}),t}var _8=6,A8="1",O8=["A","B","C","D","E","F","G","H"],Uf=["remove-matrix-row","add-matrix-row","remove-matrix-col","add-matrix-col"],Wv=class{constructor(t){this._nextObjectId=0;this.clearAll(),this.config=t}setOption(t,r){this.config[t]=r}generateObjectId(){return(this._nextObjectId++).toString()}updateNextObjectId(){let t=this.getState().order,r=/^[0-9]+$/;for(let n of t)if(r.test(n)){let i=parseInt(n,10);i>=this._nextObjectId&&(this._nextObjectId=i+1)}}generateMatrixVariable(){let t={},{expressions:r}=this.getState();for(let n in r){let i=r[n];i.type==="matrix"&&(t[i.variable]=!0)}for(let n of O8)if(!t[n])return n;return""}isEnabled(t){return!!this.config[t]}getTextColor(){return this.config.textColor}getBackgroundColor(){return this.config.backgroundColor}getFontSize(){return this.config.fontSize||16}getLanguage(){return this.config.language}hasUnusedMatrixVariables(){let{expressions:t}=this.getState();return xg(t,r=>r.type==="matrix").length<O8.length}clearShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!1}markShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!0}getShouldDebounceUndoRedo(){return this._shouldDebounceUndoRedo}clearAll(){let t=this.store?this.store.getState().ui.containerSize:{width:0,height:0},r={version:A8,expressions:{1:{id:"1",type:"latex",latex:"",displayAsFraction:!1}},order:["1"],ui:{focus:void 0,settingsMenuOpen:!1,containerSize:t}};this.store?this.store.set(r):this.store=new Dd(r),this.updateNextObjectId()}getPersistedState(){let{version:t,expressions:r,order:n}=this.getState();return{version:t,expressions:r,order:n}}getState(){return this.store.getState()}setState(t){this.store.set({version:t.version,expressions:t.expressions,order:t.order,ui:this.getState().ui}),this.updateNextObjectId()}setStateFromAPI(t){let r=t||{};var n=r.expressions||{},i=r.order||[];this.store.set({version:A8,expressions:n,order:i,ui:this.getState().ui}),this.updateNextObjectId()}shouldShowClear(){if(this.getNumberOfExpressions()===1)return!1;let t=this.getIdOfFocus();if(!t)return!1;let r=this.getExpressionById(t);return r?!!(r.type==="matrix"||r.latex):!1}canClear(){if(this.getNumberOfExpressions()>1)return!0;let t=this.getExpressionOrder()[0],r=this.getExpressionById(t);return r.type!=="latex"?!0:r.latex!==""}deleteExpression(t){this.store.shallowMutate("expressions",n=>{delete n[t]});let r=VV(this.getState().order,t);this.store.shallowMutate(n=>{n.order=r})}addBlankLatexExpressionAfterFocus(){let t=this.getIndexOfFocus(),r;t===-1?r=this.getState().order.length:r=t+1;let n=this.addNewLatexExpression(r,"");this.focusLatexExpression(n)}addNewLatexExpression(t,r){let n=this.generateObjectId();return this.store.shallowMutate("expressions",i=>{i[n]={id:n,type:"latex",latex:r,displayAsFraction:!1}}),this.store.shallowMutate("order",i=>{i.splice(t,0,n)}),n}clearFocusedExpression(){let t=this.getIdOfFocus();t&&(this.store.shallowMutate("expressions",r=>{r[t]={id:t,type:"latex",latex:"",displayAsFraction:!1}}),this.store.set(["ui","focus"],{type:"latex-expression",id:t}))}setExpressionLatex(t,r){this.store.shallowMutate(["expressions",t],n=>{n.type==="latex"&&(n.latex=r)})}addNewMatrixExpression(){let t=!1,r=this.getExpressionOrder(),n=r.length,i=this.generateMatrixVariable(),o=2,a=2,s,c,l=this.getIdOfFocus();l?(c=l,s=this.getIndexOfFocus()):(s=r.length-1,c=r[r.length-1]);let u=this.getExpressionById(c);if(u&&u.type==="latex"){let x=u.latex.replace(/\\ /gi,""),b=x.match(/^([A-Z])=?$/);if(x=="")n=s,t=!0;else if(b){let w=b[1],E=this.getState().expressions,I=!1;for(let S in E)E[S].type==="matrix"&&E[S].variable===w&&(I=!0);I||(i=w,t=!0,n=s)}}let d=[];for(var f=0;f<o;f++){let x=[];d.push(x);for(var g=0;g<a;g++)x.push("")}let y=this.generateObjectId();return this.store.shallowMutate("expressions",x=>{c&&t&&delete x[c],x[y]={id:y,type:"matrix",variable:i,matrix:d}}),this.store.shallowMutate("order",x=>{x.splice(n,t?1:0,y)}),y}addMatrixRow(t){this.store.deepMutate(["expressions",t],r=>{if(r.type!=="matrix"||r.matrix.length===0)return;let n=[];for(let i=0;i<r.matrix[0].length;i++)n.push("");r.matrix.push(n)})}removeMatrixRow(t){this.store.deepMutate(["expressions",t],r=>{r.type==="matrix"&&r.matrix.pop()})}addMatrixCol(t){this.store.deepMutate(["expressions",t],r=>{if(r.type==="matrix")for(let n of r.matrix)n.push("")})}removeMatrixCol(t){this.store.deepMutate(["expressions",t],r=>{if(r.type==="matrix")for(let n of r.matrix)n.pop()})}setLatexAtFocus(t){let r=this.getState().ui.focus;if(r)switch(r.type){case"latex-expression":this.setExpressionLatex(r.id,t);break;case"matrix-cell":this.setMatrixCellLatex(r.id,r.row,r.col,t);break;case"matrix-resize-button":case"add-matrix-button":break;default:return r}}setDisplayAsFraction(t,r){this.store.deepMutate(["expressions",t],n=>{n.type==="latex"&&(n.displayAsFraction=r)})}setMatrixCellLatex(t,r,n,i){this.store.deepMutate(["expressions",t],o=>{o.type==="matrix"&&(o.matrix[r][n]=i)})}setMatrixVariable(t,r){this.store.shallowMutate(["expressions",t],n=>{n.type==="matrix"&&(n.variable=r)})}isResizeOpDisabled(t,r){let n=this.getExpressionById(t);if(n.type!=="matrix")return!0;let i=n.matrix.length,o=i===0?0:n.matrix[0].length;switch(r){case"remove-matrix-row":return i<=1;case"add-matrix-row":return i>=_8;case"remove-matrix-col":return o<=1;case"add-matrix-col":return o>=_8}}setContainerSize(t){this.store.set(["ui","containerSize"],t)}getContainerSize(){return this.getState().ui.containerSize}setFocus(t){this.store.set(["ui","focus"],t)}setFocusInPreparationForKeypadEvent(){let{order:t,expressions:r}=this.getState(),n=t.length-1,i=t[n],o=r[i];if(o.type==="latex"&&!o.latex)this.focusLatexExpression(i);else{let a=this.addNewLatexExpression(n+1,"");this.focusLatexExpression(a)}}setSettingsMenuOpen(t){this.store.set(["ui","settingsMenuOpen"],t.isOpen)}isSettingsMenuOpen(){return this.getState().ui.settingsMenuOpen}isExpressionFocused(t){let r=this.getState().ui.focus;return!r||r.type==="add-matrix-button"?!1:r.id===t}isLatexExpressionFocused(t){let r=this.getState().ui.focus;return!r||r.type!=="latex-expression"?!1:r.id===t}isResizeButtonFocused(t,r){let n=this.getState().ui.focus;return!n||n.type!=="matrix-resize-button"?!1:n.id===t&&n.op===r}isAddMatrixButtonFocused(){let t=this.getState().ui.focus;return t?t.type==="add-matrix-button":!1}isMatrixExpressionFocused(t){let r=this.getState().ui.focus;return!r||r.type!=="matrix-cell"?!1:r.id===t}isMatrixExpressionCellFocused(t,r,n){let i=this.getState().ui.focus;return!i||i.type!=="matrix-cell"?!1:i.id===t&&i.row===r&&i.col===n}focusMatrixExpressionCell(t,r,n){this.setFocus({type:"matrix-cell",id:t,row:r,col:n})}focusResizeButton(t,r){this.setFocus({type:"matrix-resize-button",id:t,op:r})}focusAddMatrixButton(){this.setFocus({type:"add-matrix-button"})}focusLatexExpression(t){this.setFocus({type:"latex-expression",id:t})}blurLatexExpression(t){this.isLatexExpressionFocused(t)&&this.setFocus(void 0)}blurMatrixExpressionCell(t,r,n){this.isMatrixExpressionCellFocused(t,r,n)&&this.setFocus(void 0)}blurResizeButton(t,r){this.isResizeButtonFocused(t,r)&&this.setFocus(void 0)}blurAddMatrixButton(){this.isAddMatrixButtonFocused()&&this.setFocus(void 0)}getIdOfFocus(){let t=this.getState().ui.focus;if(t&&t.type!=="add-matrix-button")return t.id}getIndexOfFocus(){let t=this.getState().ui.focus;if(!t||t.type==="add-matrix-button")return-1;let r=this.getState().order;for(var n=0;n<r.length;n++)if(r[n]===t.id)return n;return-1}isFinalExpressionFocused(){return this.getIndexOfFocus()===this.getState().order.length-1}moveFocusInDirection(t){let r=this.getState().ui.focus;if(!r)return;let n=this.getIndexOfFocus();if(n!==-1)switch(r.type){case"latex-expression":t==="Up"?this.moveFocusFromIndexToIndex(n,n-1):t==="Down"&&this.moveFocusFromIndexToIndex(n,n+1);break;case"matrix-cell":let{lastRow:i,lastCol:o}=this.getSizeOfMatrixExpression(r.id);t==="Up"?r.row>0?this.focusMatrixExpressionCell(r.id,r.row-1,r.col):this.moveFocusFromIndexToIndex(n,n-1):t==="Down"?r.row<i?this.focusMatrixExpressionCell(r.id,r.row+1,r.col):this.moveFocusFromIndexToIndex(n,n+1):t==="Left"?r.col>0?this.focusMatrixExpressionCell(r.id,r.row,r.col-1):r.row>0&&this.focusMatrixExpressionCell(r.id,r.row-1,o):t==="Right"&&(r.col<o?this.focusMatrixExpressionCell(r.id,r.row,r.col+1):r.row<i&&this.focusMatrixExpressionCell(r.id,r.row+1,0));break;case"matrix-resize-button":case"add-matrix-button":break;default:return r}}moveFocusFromIndexToIndex(t,r){let{order:n,expressions:i}=this.getState(),o=n[r],a=i[o];if(a)switch(a.type){case"latex":this.focusLatexExpression(o);break;case"matrix":if(t<r)this.focusMatrixExpressionCell(o,0,0);else{let{lastRow:c,lastCol:l}=this.getSizeOfMatrixExpression(o);this.focusMatrixExpressionCell(o,c,l)}break;default:return a}}attemptToMoveFocusWithBackspace(){let{ui:t,expressions:r,order:n}=this.getState(),i=t.focus;if(!i||i.type==="add-matrix-button")return!1;let o=this.getIndexOfFocus();if(o===-1)return!1;let a=r[i.id];if(!a)return;let s=n.length;switch(i.type){case"latex-expression":return a.type==="latex"?a.latex||s===1?!1:(o>0?this.moveFocusInDirection("Up"):this.moveFocusInDirection("Down"),this.deleteExpression(i.id),!0):!1;case"matrix-cell":if(a.type==="matrix"){if(a.matrix[i.row][i.col])return!1;if(i.col===0){if(i.row===0){if(s===1)return this.clearAll(),this.focusLastExpression(),!1;o===0?this.moveFocusFromIndexToIndex(0,1):this.moveFocusInDirection("Up"),this.deleteExpression(i.id)}else this.moveFocusInDirection("Left");return!0}else this.moveFocusInDirection("Left")}return!1;case"matrix-resize-button":return!1;default:return i}}firstEnabledResizeOp(t){for(let r of Uf)if(!this.isResizeOpDisabled(t.id,r))return r;return Uf[Uf.length-1]}lastEnabledResizeOp(t){for(let r of Uf.slice().reverse())if(!this.isResizeOpDisabled(t.id,r))return r;return Uf[0]}nextEnabledResizeOp(t,r){let n=!1;for(let i of Uf){if(n&&!this.isResizeOpDisabled(t.id,i))return i;i===r&&(n=!0)}}prevEnabledResizeOp(t,r){let n=!1;for(let i of Uf.slice().reverse()){if(n&&!this.isResizeOpDisabled(t.id,i))return i;i===r&&(n=!0)}}attemptToMoveFocusWithTab({shiftKey:t}){let r=this.getState().ui.focus;if(!r)return!1;let n=this.getIndexOfFocus(),i;if(n!==-1){let o=this.getState().order[n-1];i=o?this.getExpressionById(o):void 0}switch(r.type){case"latex-expression":return t&&i&&i.type==="matrix"?(this.focusResizeButton(i.id,this.lastEnabledResizeOp(i)),!0):!1;case"matrix-cell":if(t)return i&&i.type==="matrix"&&r.row===0&&r.col===0?(this.focusResizeButton(i.id,this.lastEnabledResizeOp(i)),!0):!1;{if(this.getEvaluations()[r.id].error)return!1;let{lastRow:o,lastCol:a}=this.getSizeOfMatrixExpression(r.id);return r.row===o&&r.col===a?(this.focusResizeButton(r.id,this.firstEnabledResizeOp(this.getExpressionById(r.id))),!0):!1}case"matrix-resize-button":if(t){let o=this.prevEnabledResizeOp(this.getExpressionById(r.id),r.op);if(o!==void 0)return this.focusResizeButton(r.id,o),!0;let{lastRow:a,lastCol:s}=this.getSizeOfMatrixExpression(r.id);return this.focusMatrixExpressionCell(r.id,a,s),!0}else{let o=this.nextEnabledResizeOp(this.getExpressionById(r.id),r.op);return o!==void 0?(this.focusResizeButton(r.id,o),!0):this.isFinalExpressionFocused()?(this.focusAddMatrixButton(),!0):n===-1?!1:(this.moveFocusFromIndexToIndex(n,n+1),!0)}case"add-matrix-button":{if(!t)return!1;let o=this.getState().order,a=o[o.length-1];if(!a)return!1;let s=this.getExpressionById(a);return s.type!=="matrix"?!1:(this.focusResizeButton(s.id,this.lastEnabledResizeOp(s)),!0)}}}getSizeOfMatrixExpression(t){let r=this.getExpressionById(t);return r?{lastRow:r.matrix.length-1,lastCol:r.matrix[0].length-1}:{lastRow:0,lastCol:0}}getEvaluations(){let t=this.getState();return this._lastEvaluationState===t?this._evaluations:(this._lastEvaluationState=t,this._evaluations=D8(this._lastEvaluationState),this._evaluations)}getExpressionById(t){return this.getState().expressions[t]}getExpressionOrder(){return this.getState().order}focusFirstExpression(){let t=this.getExpressionOrder()[0];this.focusLatexExpression(t)}focusLastExpression(){let t=this.getExpressionOrder();this.focusLatexExpression(t[t.length-1])}getNumberOfExpressions(){return this.getState().order.length}updateTheComputedWorld(){var t=this.getIdOfFocus();t&&!this.getExpressionById(t)&&this.setFocus(void 0)}};function Zne(e){OP?setTimeout(e,25):requestAnimationFrame(e)}var L8=1,Ny={},Xv=!1;function R8(){Xv=!0,Zne(Jne)}var N8={};function Jne(){N8.rafSPY&&N8.rafSPY(),Xv=!1;for(let e in Ny)Ny[e].detectAndEnqueueEvent(),Xv=!0;if(Xv){R8();for(let e in Ny)Ny[e].dispatchQueuedEvent()}}var Kv=class{constructor(t,r){this.elt=t;this.cb=r;this.destroyed=!1;this.lastOffscreen=!1;this.id=L8.toString(),this.appliedScale={x:1,y:1},L8++}stopWatching(){delete Ny[this.id]}startWatching(){this.checkForChanges(),Ny[this.id]=this,Xv||R8()}resetAppliedScalingAndGetBoundingClientRect(){var t=this.elt.getBoundingClientRect(),r={x:t.width/this.elt.offsetWidth,y:t.height/this.elt.offsetHeight};if(r.x===this.appliedScale.x&&r.y===this.appliedScale.y)return t;let n=this.elt.querySelector(".dcg-dom-change-wrapper");return n&&(this.appliedScale=r,Xu(n,{transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%",transformOrigin:"0 0"})),t}detectAndEnqueueEvent(){if(this.destroyed)return;let t=!0;if(!(document.body&&document.body.contains(this.elt)))this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt,isOffscreen:!0});else{let n=this.resetAppliedScalingAndGetBoundingClientRect();t=n.top>window.innerHeight||n.bottom<0||n.left>window.innerWidth||n.right<0,this.lastSize?(n.width!==this.lastSize.width||n.height!==this.lastSize.height||window.devicePixelRatio!==this.lastSize.pixelRatio)&&(this.lastSize.width=n.width,this.lastSize.height=n.height,this.lastSize.pixelRatio=window.devicePixelRatio,this.queuedEvent={type:"resized",target:this.elt,size:{...this.lastSize},isOffscreen:t}):(this.lastSize={width:n.width,height:n.height,pixelRatio:window.devicePixelRatio},this.queuedEvent={type:"added",target:this.elt,size:{...this.lastSize},isOffscreen:t})}t!==this.lastOffscreen&&(this.lastOffscreen=t,this.queuedEvent||(this.queuedEvent={type:"offscreen-noop",target:this.elt,isOffscreen:t}))}dispatchQueuedEvent(){let t=this.queuedEvent;t&&(this.queuedEvent=void 0,this.cb(t))}checkForChanges(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()}destroy(){this.stopWatching();for(var t in this)this.hasOwnProperty(t)&&delete this[t];this.destroyed=!0}};fa();var Qne=function(){{var e=0,t=1,r=2,n=!1,i=function(){o(document),n=!0},o=function(a){n||ze(a).bind("touchstart",function(s){var c=ze(s.target),l=e,u=null;if(!c[0].closest("[disablescroll]"))for(;l===e&&c.length&&c[0].tagName!==void 0;){var d=getComputedStyle(c[0]).overflow,f=getComputedStyle(c[0]).overflowY;if(d!=="hidden"&&d!=="visible"&&f!=="hidden"&&f!=="hidden"){var g=c.scrollTop();g!==0&&(l=r),c.scrollTop(g+1),c.scrollTop()!==g&&(l=t|l,c.scrollTop(g))}c=ze(c[0].parentElement)}if(l!==e){u=[];for(var y=s.originalEvent.touches,x=0;x<y.length;x++){var b={};for(var w in y[x])y[x].hasOwnProperty(w)&&(b[w]=y[x][w]);u.push(b)}}ze(document).on("touchmove.scrollfix",function(E){if(u){var I=u[0],S=E.originalEvent.touches[0],D=S.screenY-I.screenY;(D>0&&!(l&r)||D<0&&!(l&t))&&(l=e),D&&(u=null)}l===e&&E.preventDefault()}),ze(document).on("touchend.scrollfix",function(){ze(document).off(".scrollfix")})})};return{limitScrollOnElement:o,limitScrollOnDocument:i}}}();var{limitScrollOnElement:k8,limitScrollOnDocument:f8e}=Qne;var jv=class{constructor(t){if(this.rootElt=t,this.eventModel=new mm,!t)throw new Error("must pass an HTMLElement to the API")}setupDomChangeDetector(t){this.autoSize=t,k8(this.rootElt),this.domChangeDetector=new Kv(this.rootElt,r=>{switch(r.type){case"added":this.view=this.onCreateView(),this.onResizeView(r.size);break;case"removed":this.onDestroyView(),this.view=void 0;break;case"resized":this.onResizeView(r.size);break}}),this.autoSize!==!1?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()}detach(){Ki.warn(".detach() is deprecated. It should no longer be necessary")}destroy(){this.view&&this.onDestroyView(),this.domChangeDetector.destroy();function t(o){Ki.warn("You've destroyed this API instance. You can no longer call ."+o+"()")}for(var r={},n=this;n;)Object.getOwnPropertyNames(n).forEach(a=>r[a]=!0),n=Object.getPrototypeOf(n);for(var i in r)typeof this[i]=="function"?this[i]=t.bind(this,i):this.hasOwnProperty(i)&&delete this[i];this.destroy=function(){}}resize(){this.domChangeDetector.checkForChanges()}updateView(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()}triggerEvent(t,r){this.eventModel.triggerEvent(t,r)}observeEvent(t,r){this.eventModel.observeEvent(t,r)}unobserveEvent(t){this.eventModel.unobserveEvent(t)}};function _R(e){return e==="es-ES"?(Ki.warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"),"es"):e}function tie(e){var t={language:"en",autosize:!0,invertedColors:!1,projectorMode:!1,capExpressionSize:!1,textColor:"#000",backgroundColor:"#fff",fontSize:16,settingsMenu:!0,decimalToFraction:!0};e||(e={});for(let r in e)if(t.hasOwnProperty(r)){let n=r;if(n==="textColor"||n==="backgroundColor"){let i=e[n];if(!i)continue;Ab(i)?t[n]=i:Ki.warn(`Invalid ${n}. Color must be a 3- or 6-character hex color (e.g. #000 or #001111)`)}else if(n==="fontSize"){let i=e[n];if(i===void 0)continue;typeof i!="number"?Ki.warn(`Invalid ${n}. fontSize must be a number`):t[n]=i}else if(n==="language"){let i=e[n];if(i===void 0)continue;typeof i!="string"?Ki.warn(`Invalid ${n}. language must be a string`):t[n]=_R(i)}else t[n]=!!e[n]}return t}function V8(e){return{allowUndo:!!(e&&e.allowUndo)}}var EC=class extends jv{constructor(t,r){typeof _Desmos!="undefined"&&typeof desmosLocaleData!="undefined"&&_Desmos.supportedLanguages===void 0&&(_Desmos.supportedLanguages=["en"].concat(Object.keys(desmosLocaleData))),super(t),this.rootElt=t;let n=tie(r);this.settings=new mm,this.model=new Wv(n),this.controller=new zv(this.model,this.settings),this.controller.onEventEmitted=i=>{i==="render"&&this.updateView()},this.setupDomChangeDetector(n.autosize)}updateSettings(t){if(t)for(let r in t)switch(r){case"language":let n=t[r];if(n===void 0)continue;this.controller.dispatch({type:"update-language",language:_R(n)});break;case"settingsMenu":t.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"invertedColors":let i=t[r];if(i===void 0)continue;this.controller.dispatch({type:"update-inverted-colors",invertedColors:i});break;case"projectorMode":{let l=t[r];if(l===void 0)continue;this.controller.dispatch({type:"update-projector-mode",mode:l});break}case"capExpressionSize":let o=t[r];if(o===void 0)return;this.controller.dispatch({type:"update-cap-expression-size",mode:o});break;case"decimalToFraction":this.controller.dispatch({type:"update-decimal-to-fraction",value:!!t[r]});break;case"textColor":let a=t[r];if(a===void 0)continue;if(!Ab(a)){Ki.warn("invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",textColor:a});break;case"backgroundColor":let s=t[r];if(s===void 0)continue;if(!Ab(s)){Ki.warn("invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-background-color",backgroundColor:s});break;case"fontSize":let c=t[r];if(c===void 0)continue;if(typeof c!="number"){Ki.warn(`Invalid ${r}. fontSize must be a number`);continue}this.controller.dispatch({type:"update-font-size",fontSize:c});break}}onCreateView(){return IC.mountToNode(yC,this.rootElt,{controller:()=>this.controller})}onDestroyView(){IC.unmountFromNode(this.rootElt)}onResizeView(t){this.controller.dispatch({type:"ui/container-resized",size:t})}getState(){return Bn(this.controller.getPersistedState())}setState(t,r){let n;typeof t=="string"?n=JSON.parse(t):n=Bn(t||{}),this.controller.setStateFromAPI(n,V8(r))}setBlank(t){this.controller.clearFromAPI(V8(t))}focusFirstExpression(){this.controller.focusFirstExpression()}};function AR(...e){return new EC(...e)}AR.prototype=EC.prototype;var nie=500*1024,F8=[];function G8(){for(var e=[],t=0,r=0;r<F8.length;r++){let n=F8[r];if(t+=n.size,t>nie)break;e.push(n.payload)}return e}Bd();var U8=ut(q8());function iie(e){return e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}var oie=["UnhandledRejection","lnrAppboy","socratic","MyAppGet","SymBrowser_","mobincube_","_avast_submit","Cannot redefine property: googletag","jcarousel","SyntaxError: Unexpected identifier 'script'","__gCrWeb.autofill.extractForms","BrowseITEXT","Can't find variable: removeAllHighlights","aAttribruteValue.parentNode.getAttribute","vid_mate_check","GetImageTagSrcFromPoint","Can't find variable: didEnterViewPort","tinyMCE is not defined","div:has(> iframe[id='198230182308109283091823098102938908128390'])"],z8=new RegExp(oie.map(iie).join("|"));function aie(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}function sie(){var e=window.Desmos&&window.Desmos.commit;return e}function cie(){var e="production";if(location&&location.hostname){var t=location.hostname,r=t.split("."),n=r.slice(0,r.length-2).join("."),i=r.slice(r.length-2).join(".");i==="desmos.com"&&(!n||n==="www"?e="production":e=n)}return e}var CC=class{constructor(){this.numberOfSentErrors=0;this.pageLoadId=aie();this.bugsnagClient=U8.default.start({apiKey:"7f7807097671acbc4557e64bbf5eb529",maxBreadcrumbs:40,appVersion:sie(),releaseStage:cie(),onError:t=>this.onError(t),enabledBreadcrumbTypes:["error","navigation","request","user"]})}onError(t){let r=n0;return r&&r[0]<=10||t.errors.some(n=>z8.test(n.errorClass)||z8.test(n.errorMessage))?!1:(this.beforeSendCb&&this.beforeSendCb(t),this.attachWebGLReport&&this.attachWebGLReport(t),this.numberOfSentErrors+=1,t.addMetadata("custom",{errorNumber:this.numberOfSentErrors,pageLoadId:this.pageLoadId}),!0)}setBeforeSendCB(t){this.beforeSendCb=t}setAttachWebGLReport(t){this.attachWebGLReport=t}leaveBreadcrumb(t,r,n){if(r){r={...r};for(let i in r)try{r[i]=JSON.stringify(r[i],null,2)}catch(o){r[i]="[[could not stringify]]"}}this.bugsnagClient.leaveBreadcrumb(t,r,n)}notify(t,r){this.bugsnagClient&&this.bugsnagClient.notify(t,n=>(r&&r.metaData&&n.addMetadata("custom",r.metaData),r&&r.context&&(n.context=r.context),r&&r.severity&&(n.severity=r.severity),!0))}};var $8=ut(ft());function H8(){window.TestBridge={}}function Y8(e,t={}){Nb(document.body);let r=document.getElementById("main-container");if(!r)throw'Expected to find an element with id="main-container"';let n=$8.mountToNode(e,r,t);return document.querySelector(".dcg-loading-div-container").style.display="none",H8(),n}function lie(e,t={}){return/testing/.test(document.location.search)||RR(new CC),Y8(e,t)}function W8(e){return lie(e)}var{If:uie}=sl.Components;function die(e){var t=Jk(),r=AR(e,t);window.Calc=r,r.focusFirstExpression();var n=r.controller;kR(function(o){var a=n.stateStack;a&&a.serializeForBugsnag&&o.addMetadata("states",a.serializeForBugsnag());let s=o.originalError;s&&s.dcgExtraErrorMetaData&&o.addMetadata("extraErrorData",s.dcgExtraErrorMetaData),o.addMetadata("codeEvents",G8())}),n.dispatch({type:"update-language",language:Ry}),ze(document.documentElement).on("keydown",function(o){o.target.closest(".dcg-calc-matrix-main-wrapper")||r.view&&r.view.handleRootKeydown(o)});var i=function(){var o=n.getInvertedColors();document.body.classList.toggle("dcg-inverted-colors",o);var a=n.getBackgroundColor();Xu(document.body,{background:a}),Xu(e,{borderColor:a})};return r.settings.observeAndSync("invertedColors",i),r.settings.observeAndSync("backgroundColor",i),n}var Ry=xb();function X8(e){Ry=e,W8(NR)}var LR=new vb({showLanguagePicker:!0,allowAllLanguages:!0,limitSignupRole:"student"}),NR=class extends sl.Class{init(){LR.onEventEmitted=t=>{t==="changeLang"&&this.calcController&&(Ry=LR.getLanguage(),this.calcController.dispatch({type:"update-language",language:Ry})),this.update()}}template(){return sl.createElement("div",null,sl.createElement(uie,{predicate:()=>window.platform==="www"},()=>sl.createElement(F0,{controller:this.const(LR),helpLink:this.const("https://help.desmos.com/hc/en-us/articles/4404851938445-Matrix-Calculator"),showPrintIcon:this.const(!1)})),sl.createElement("div",{id:sl.const("main"),class:sl.const("dcg-matrix-container"),didMount:this.bindFn(this.onCalcContainerMounted)}))}onCalcContainerMounted(t){this.calcController=die(t)}};QT(Ry).then(function(){return X8(Ry)},function(){return X8("en")});window.Desmos.MathQuill=Kd;})();
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
